!function(Ce,Ze){"object"==typeof exports&&typeof module<"u"?module.exports=Ze():"function"==typeof define&&define.amd?define(Ze):(Ce=typeof globalThis<"u"?globalThis:Ce||self).ApexCharts=Ze()}(this,function(){"use strict";function Ce(P,r){var i=Object.keys(P);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(P);r&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(P,l).enumerable})),i.push.apply(i,o)}return i}function Ze(P){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?Ce(Object(i),!0).forEach(function(o){st(P,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(P,Object.getOwnPropertyDescriptors(i)):Ce(Object(i)).forEach(function(o){Object.defineProperty(P,o,Object.getOwnPropertyDescriptor(i,o))})}return P}function ut(P){return(ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(P)}function F(P,r){if(!(P instanceof r))throw new TypeError("Cannot call a class as a function")}function de(P,r){for(var i=0;i<r.length;i++){var o=r[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(P,o.key,o)}}function me(P,r,i){return r&&de(P.prototype,r),i&&de(P,i),P}function st(P,r,i){return r in P?Object.defineProperty(P,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):P[r]=i,P}function _e(P,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");P.prototype=Object.create(r&&r.prototype,{constructor:{value:P,writable:!0,configurable:!0}}),r&&Ft(P,r)}function kt(P){return(kt=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)})(P)}function Ft(P,r){return(Ft=Object.setPrototypeOf||function(i,o){return i.__proto__=o,i})(P,r)}function cn(P){if(void 0===P)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P}function dn(P){var r=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,o=kt(P);if(r){var l=kt(this).constructor;i=Reflect.construct(o,arguments,l)}else i=o.apply(this,arguments);return function(u,h){if(h&&("object"==typeof h||"function"==typeof h))return h;if(void 0!==h)throw new TypeError("Derived constructors may only return object or undefined");return cn(u)}(this,i)}}function ar(P,r){return function(i){if(Array.isArray(i))return i}(P)||function(i,o){var l=null==i?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(null!=l){var u,h,p=[],v=!0,y=!1;try{for(l=l.call(i);!(v=(u=l.next()).done)&&(p.push(u.value),!o||p.length!==o);v=!0);}catch(C){y=!0,h=C}finally{try{v||null==l.return||l.return()}finally{if(y)throw h}}return p}}(P,r)||Et(P,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gt(P){return function(r){if(Array.isArray(r))return bn(r)}(P)||function(r){if(typeof Symbol<"u"&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(P)||Et(P)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Et(P,r){if(P){if("string"==typeof P)return bn(P,r);var i=Object.prototype.toString.call(P).slice(8,-1);return"Object"===i&&P.constructor&&(i=P.constructor.name),"Map"===i||"Set"===i?Array.from(P):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?bn(P,r):void 0}}function bn(P,r){(null==r||r>P.length)&&(r=P.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=P[i];return o}var pe=function(){function P(){F(this,P)}return me(P,[{key:"shadeRGBColor",value:function(r,i){var o=i.split(","),l=r<0?0:255,u=r<0?-1*r:r,h=parseInt(o[0].slice(4),10),p=parseInt(o[1],10),v=parseInt(o[2],10);return"rgb("+(Math.round((l-h)*u)+h)+","+(Math.round((l-p)*u)+p)+","+(Math.round((l-v)*u)+v)+")"}},{key:"shadeHexColor",value:function(r,i){var o=parseInt(i.slice(1),16),l=r<0?0:255,u=r<0?-1*r:r,h=o>>16,p=o>>8&255,v=255&o;return"#"+(16777216+65536*(Math.round((l-h)*u)+h)+256*(Math.round((l-p)*u)+p)+(Math.round((l-v)*u)+v)).toString(16).slice(1)}},{key:"shadeColor",value:function(r,i){return P.isColorHex(i)?this.shadeHexColor(r,i):this.shadeRGBColor(r,i)}}],[{key:"bind",value:function(r,i){return function(){return r.apply(i,arguments)}}},{key:"isObject",value:function(r){return r&&"object"===ut(r)&&!Array.isArray(r)&&null!=r}},{key:"is",value:function(r,i){return Object.prototype.toString.call(i)==="[object "+r+"]"}},{key:"listToArray",value:function(r){var i,o=[];for(i=0;i<r.length;i++)o[i]=r[i];return o}},{key:"extend",value:function(r,i){var o=this;"function"!=typeof Object.assign&&(Object.assign=function(u){if(null==u)throw new TypeError("Cannot convert undefined or null to object");for(var h=Object(u),p=1;p<arguments.length;p++){var v=arguments[p];if(null!=v)for(var y in v)v.hasOwnProperty(y)&&(h[y]=v[y])}return h});var l=Object.assign({},r);return this.isObject(r)&&this.isObject(i)&&Object.keys(i).forEach(function(u){o.isObject(i[u])&&u in r?l[u]=o.extend(r[u],i[u]):Object.assign(l,st({},u,i[u]))}),l}},{key:"extendArray",value:function(r,i){var o=[];return r.map(function(l){o.push(P.extend(i,l))}),o}},{key:"monthMod",value:function(r){return r%12}},{key:"clone",value:function(r){if(P.is("Array",r)){for(var i=[],o=0;o<r.length;o++)i[o]=this.clone(r[o]);return i}if(P.is("Null",r))return null;if(P.is("Date",r))return r;if("object"===ut(r)){var l={};for(var u in r)r.hasOwnProperty(u)&&(l[u]=this.clone(r[u]));return l}return r}},{key:"log10",value:function(r){return Math.log(r)/Math.LN10}},{key:"roundToBase10",value:function(r){return Math.pow(10,Math.floor(Math.log10(r)))}},{key:"roundToBase",value:function(r,i){return Math.pow(i,Math.floor(Math.log(r)/Math.log(i)))}},{key:"parseNumber",value:function(r){return null===r?r:parseFloat(r)}},{key:"stripNumber",value:function(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return Number.isInteger(r)?r:parseFloat(r.toPrecision(i))}},{key:"randomId",value:function(){return(Math.random()+1).toString(36).substring(4)}},{key:"noExponents",value:function(r){var i=String(r).split(/[eE]/);if(1===i.length)return i[0];var o="",l=r<0?"-":"",u=i[0].replace(".",""),h=Number(i[1])+1;if(h<0){for(o=l+"0.";h++;)o+="0";return o+u.replace(/^-/,"")}for(h-=u.length;h--;)o+="0";return u+o}},{key:"getDimensions",value:function(r){var i=getComputedStyle(r,null),o=r.clientHeight,l=r.clientWidth;return o-=parseFloat(i.paddingTop)+parseFloat(i.paddingBottom),[l-=parseFloat(i.paddingLeft)+parseFloat(i.paddingRight),o]}},{key:"getBoundingClientRect",value:function(r){var i=r.getBoundingClientRect();return{top:i.top,right:i.right,bottom:i.bottom,left:i.left,width:r.clientWidth,height:r.clientHeight,x:i.left,y:i.top}}},{key:"getLargestStringFromArr",value:function(r){return r.reduce(function(i,o){return Array.isArray(o)&&(o=o.reduce(function(l,u){return l.length>u.length?l:u})),i.length>o.length?i:o},0)}},{key:"hexToRgba",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#999999",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.6;"#"!==r.substring(0,1)&&(r="#999999");var o=r.replace("#","");o=o.match(new RegExp("(.{"+o.length/3+"})","g"));for(var l=0;l<o.length;l++)o[l]=parseInt(1===o[l].length?o[l]+o[l]:o[l],16);return void 0!==i&&o.push(i),"rgba("+o.join(",")+")"}},{key:"getOpacityFromRGBA",value:function(r){return parseFloat(r.replace(/^.*,(.+)\)/,"$1"))}},{key:"rgb2hex",value:function(r){return(r=r.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===r.length?"#"+("0"+parseInt(r[1],10).toString(16)).slice(-2)+("0"+parseInt(r[2],10).toString(16)).slice(-2)+("0"+parseInt(r[3],10).toString(16)).slice(-2):""}},{key:"isColorHex",value:function(r){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)|(^#[0-9A-F]{8}$)/i.test(r)}},{key:"getPolygonPos",value:function(r,i){for(var o=[],l=2*Math.PI/i,u=0;u<i;u++){var h={};h.x=r*Math.sin(u*l),h.y=-r*Math.cos(u*l),o.push(h)}return o}},{key:"polarToCartesian",value:function(r,i,o,l){var u=(l-90)*Math.PI/180;return{x:r+o*Math.cos(u),y:i+o*Math.sin(u)}}},{key:"escapeString",value:function(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x";return r.toString().slice().replace(/[` ~!@#$%^&*()|+\=?;:'",.<>{}[\]\\/]/gi,i)}},{key:"negToZero",value:function(r){return r<0?0:r}},{key:"moveIndexInArray",value:function(r,i,o){if(o>=r.length)for(var l=o-r.length+1;l--;)r.push(void 0);return r.splice(o,0,r.splice(i,1)[0]),r}},{key:"extractNumber",value:function(r){return parseFloat(r.replace(/[^\d.]*/g,""))}},{key:"findAncestor",value:function(r,i){for(;(r=r.parentElement)&&!r.classList.contains(i););return r}},{key:"setELstyles",value:function(r,i){for(var o in i)i.hasOwnProperty(o)&&(r.style.key=i[o])}},{key:"isNumber",value:function(r){return!isNaN(r)&&parseFloat(Number(r))===r&&!isNaN(parseInt(r,10))}},{key:"isFloat",value:function(r){return Number(r)===r&&r%1!=0}},{key:"isSafari",value:function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}},{key:"isFirefox",value:function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1}},{key:"isIE11",value:function(){if(-1!==window.navigator.userAgent.indexOf("MSIE")||window.navigator.appVersion.indexOf("Trident/")>-1)return!0}},{key:"isIE",value:function(){var r=window.navigator.userAgent,i=r.indexOf("MSIE ");if(i>0)return parseInt(r.substring(i+5,r.indexOf(".",i)),10);if(r.indexOf("Trident/")>0){var o=r.indexOf("rv:");return parseInt(r.substring(o+3,r.indexOf(".",o)),10)}var l=r.indexOf("Edge/");return l>0&&parseInt(r.substring(l+5,r.indexOf(".",l)),10)}},{key:"getGCD",value:function(r,i){var l=Math.pow(10,(arguments.length>2&&void 0!==arguments[2]?arguments[2]:7)-Math.floor(Math.log10(Math.max(r,i))));for(r=Math.round(Math.abs(r)*l),i=Math.round(Math.abs(i)*l);i;){var u=i;i=r%i,r=u}return r/l}},{key:"getPrimeFactors",value:function(r){for(var i=[],o=2;r>=2;)r%o==0?(i.push(o),r/=o):o++;return i}},{key:"mod",value:function(r,i){var l=Math.pow(10,(arguments.length>2&&void 0!==arguments[2]?arguments[2]:7)-Math.floor(Math.log10(Math.max(r,i))));return(r=Math.round(Math.abs(r)*l))%(i=Math.round(Math.abs(i)*l))/l}}]),P}(),hi=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w,this.setEasingFunctions()}return me(P,[{key:"setEasingFunctions",value:function(){var r;if(!this.w.globals.easing){switch(this.w.config.chart.animations.easing){case"linear":r="-";break;case"easein":r="<";break;case"easeout":r=">";break;case"easeinout":default:r="<>";break;case"swing":r=function(i){var o=1.70158;return(i-=1)*i*((o+1)*i+o)+1};break;case"bounce":r=function(i){return i<1/2.75?7.5625*i*i:i<2/2.75?7.5625*(i-=1.5/2.75)*i+.75:i<2.5/2.75?7.5625*(i-=2.25/2.75)*i+.9375:7.5625*(i-=2.625/2.75)*i+.984375};break;case"elastic":r=function(i){return i===!!i?i:Math.pow(2,-10*i)*Math.sin((i-.075)*(2*Math.PI)/.3)+1}}this.w.globals.easing=r}}},{key:"animateLine",value:function(r,i,o,l){r.attr(i).animate(l).attr(o)}},{key:"animateMarker",value:function(r,i,o,l,u,h){i||(i=0),r.attr({r:i,width:i,height:i}).animate(l,u).attr({r:o,width:o.width,height:o.height}).afterAll(function(){h()})}},{key:"animateCircle",value:function(r,i,o,l,u){r.attr({r:i.r,cx:i.cx,cy:i.cy}).animate(l,u).attr({r:o.r,cx:o.cx,cy:o.cy})}},{key:"animateRect",value:function(r,i,o,l,u){r.attr(i).animate(l).attr(o).afterAll(function(){return u()})}},{key:"animatePathsGradually",value:function(r){var C=this.w,k=0;C.config.chart.animations.animateGradually.enabled&&(k=C.config.chart.animations.animateGradually.delay),C.config.chart.animations.dynamicAnimation.enabled&&C.globals.dataChanged&&"bar"!==C.config.chart.type&&(k=0),this.morphSVG(r.el,r.realIndex,r.j,"line"!==C.config.chart.type||C.globals.comboCharts?r.fill:"stroke",r.pathFrom,r.pathTo,r.speed,r.delay*k)}},{key:"showDelayedElements",value:function(){this.w.globals.delayedElements.forEach(function(r){var i=r.el;i.classList.remove("apexcharts-element-hidden"),i.classList.add("apexcharts-hidden-element-shown")})}},{key:"animationCompleted",value:function(r){var i=this.w;i.globals.animationEnded||(i.globals.animationEnded=!0,this.showDelayedElements(),"function"==typeof i.config.chart.events.animationEnd&&i.config.chart.events.animationEnd(this.ctx,{el:r,w:i}))}},{key:"morphSVG",value:function(r,i,o,l,u,h,p,v){var y=this,C=this.w;u||(u=r.attr("pathFrom")),h||(h=r.attr("pathTo"));var k=function(S){return"radar"===C.config.chart.type&&(p=1),"M 0 ".concat(C.globals.gridHeight)};(!u||u.indexOf("undefined")>-1||u.indexOf("NaN")>-1)&&(u=k()),(!h||h.indexOf("undefined")>-1||h.indexOf("NaN")>-1)&&(h=k()),C.globals.shouldAnimate||(p=1),r.plot(u).animate(1,C.globals.easing,v).plot(u).animate(p,C.globals.easing,v).plot(h).afterAll(function(){pe.isNumber(o)?o===C.globals.series[C.globals.maxValsInArrayIndex].length-2&&C.globals.shouldAnimate&&y.animationCompleted(r):"none"!==l&&C.globals.shouldAnimate&&(!C.globals.comboCharts&&i===C.globals.series.length-1||C.globals.comboCharts)&&y.animationCompleted(r),y.showDelayedElements()})}}]),P}(),On=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w}return me(P,[{key:"getDefaultFilter",value:function(r,i){var o=this.w;r.unfilter(!0),(new window.SVG.Filter).size("120%","180%","-5%","-40%"),"none"!==o.config.states.normal.filter?this.applyFilter(r,i,o.config.states.normal.filter.type,o.config.states.normal.filter.value):o.config.chart.dropShadow.enabled&&this.dropShadow(r,o.config.chart.dropShadow,i)}},{key:"addNormalFilter",value:function(r,i){var o=this.w;o.config.chart.dropShadow.enabled&&!r.node.classList.contains("apexcharts-marker")&&this.dropShadow(r,o.config.chart.dropShadow,i)}},{key:"addLightenFilter",value:function(r,i,o){var l=this,u=this.w,h=o.intensity;r.unfilter(!0),new window.SVG.Filter,r.filter(function(p){var v=u.config.chart.dropShadow;(v.enabled?l.addShadow(p,i,v):p).componentTransfer({rgb:{type:"linear",slope:1.5,intercept:h}})}),r.filterer.node.setAttribute("filterUnits","userSpaceOnUse"),this._scaleFilterSize(r.filterer.node)}},{key:"addDarkenFilter",value:function(r,i,o){var l=this,u=this.w,h=o.intensity;r.unfilter(!0),new window.SVG.Filter,r.filter(function(p){var v=u.config.chart.dropShadow;(v.enabled?l.addShadow(p,i,v):p).componentTransfer({rgb:{type:"linear",slope:h}})}),r.filterer.node.setAttribute("filterUnits","userSpaceOnUse"),this._scaleFilterSize(r.filterer.node)}},{key:"applyFilter",value:function(r,i,o){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;switch(o){case"none":this.addNormalFilter(r,i);break;case"lighten":this.addLightenFilter(r,i,{intensity:l});break;case"darken":this.addDarkenFilter(r,i,{intensity:l})}}},{key:"addShadow",value:function(r,i,o){var l,u=this.w,h=o.blur,p=o.top,v=o.left,y=o.color,C=o.opacity;if((null===(l=u.config.chart.dropShadow.enabledOnSeries)||void 0===l?void 0:l.length)>0&&-1===u.config.chart.dropShadow.enabledOnSeries.indexOf(i))return r;var k=r.flood(Array.isArray(y)?y[i]:y,C).composite(r.sourceAlpha,"in").offset(v,p).gaussianBlur(h).merge(r.source);return r.blend(r.source,k)}},{key:"dropShadow",value:function(r,i){var o,l,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,h=i.top,p=i.left,v=i.blur,y=i.color,C=i.opacity,k=i.noUserSpaceOnUse,S=this.w;return r.unfilter(!0),pe.isIE()&&"radialBar"===S.config.chart.type||(null===(o=S.config.chart.dropShadow.enabledOnSeries)||void 0===o?void 0:o.length)>0&&-1===(null===(l=S.config.chart.dropShadow.enabledOnSeries)||void 0===l?void 0:l.indexOf(u))||(y=Array.isArray(y)?y[u]:y,r.filter(function(R){var N;N=pe.isSafari()||pe.isFirefox()||pe.isIE()?R.flood(y,C).composite(R.sourceAlpha,"in").offset(p,h).gaussianBlur(v):R.flood(y,C).composite(R.sourceAlpha,"in").offset(p,h).gaussianBlur(v).merge(R.source),R.blend(R.source,N)}),k||r.filterer.node.setAttribute("filterUnits","userSpaceOnUse"),this._scaleFilterSize(r.filterer.node)),r}},{key:"setSelectionFilter",value:function(r,i,o){var l=this.w;if(void 0!==l.globals.selectedDataPoints[i]&&l.globals.selectedDataPoints[i].indexOf(o)>-1){r.node.setAttribute("selected",!0);var u=l.config.states.active.filter;"none"!==u&&this.applyFilter(r,i,u.type,u.value)}}},{key:"_scaleFilterSize",value:function(r){!function(i){for(var o in i)i.hasOwnProperty(o)&&r.setAttribute(o,i[o])}({width:"200%",height:"200%",x:"-50%",y:"-50%"})}}]),P}(),Ke=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w}return me(P,[{key:"roundPathCorners",value:function(r,i){function o(ne,ve,ge){var Le=ve.x-ne.x,qe=ve.y-ne.y,Pe=Math.sqrt(Le*Le+qe*qe);return l(ne,ve,Math.min(1,ge/Pe))}function l(ne,ve,ge){return{x:ne.x+(ve.x-ne.x)*ge,y:ne.y+(ve.y-ne.y)*ge}}function u(ne,ve){ne.length>2&&(ne[ne.length-2]=ve.x,ne[ne.length-1]=ve.y)}function h(ne){return{x:parseFloat(ne[ne.length-2]),y:parseFloat(ne[ne.length-1])}}r.indexOf("NaN")>-1&&(r="");var p=r.split(/[,\s]/).reduce(function(ne,ve){var ge=ve.match("([a-zA-Z])(.+)");return ge?(ne.push(ge[1]),ne.push(ge[2])):ne.push(ve),ne},[]).reduce(function(ne,ve){return parseFloat(ve)==ve&&ne.length?ne[ne.length-1].push(ve):ne.push([ve]),ne},[]),v=[];if(p.length>1){var y=h(p[0]),C=null;"Z"==p[p.length-1][0]&&p[0].length>2&&(p[p.length-1]=C=["L",y.x,y.y]),v.push(p[0]);for(var k=1;k<p.length;k++){var S=v[v.length-1],R=p[k],N=R==C?p[1]:p[k+1];if(N&&S&&S.length>2&&"L"==R[0]&&N.length>2&&"L"==N[0]){var B,U,j=h(S),K=h(R),x=h(N);B=o(K,j,i),U=o(K,x,i),u(R,B),R.origPoint=K,v.push(R);var I=l(B,K,.5),W=l(K,U,.5),q=["C",I.x,I.y,W.x,W.y,U.x,U.y];q.origPoint=K,v.push(q)}else v.push(R)}if(C){var J=h(v[v.length-1]);v.push(["Z"]),u(v[0],J)}}else v=p;return v.reduce(function(ne,ve){return ne+ve.join(" ")+" "},"")}},{key:"drawLine",value:function(r,i,o,l){var u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"#a8a8a8",h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,p=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,v=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"butt";return this.w.globals.dom.Paper.line().attr({x1:r,y1:i,x2:o,y2:l,stroke:u,"stroke-dasharray":h,"stroke-width":p,"stroke-linecap":v})}},{key:"drawRect",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#fefefe",p=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,v=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,y=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,C=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,k=this.w.globals.dom.Paper.rect();return k.attr({x:r,y:i,width:o>0?o:0,height:l>0?l:0,rx:u,ry:u,opacity:p,"stroke-width":null!==v?v:0,stroke:null!==y?y:"none","stroke-dasharray":C}),k.node.setAttribute("fill",h),k}},{key:"drawPolygon",value:function(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#e1e1e1",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"none";return this.w.globals.dom.Paper.polygon(r).attr({fill:l,stroke:i,"stroke-width":o})}},{key:"drawCircle",value:function(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;r<0&&(r=0);var o=this.w.globals.dom.Paper.circle(2*r);return null!==i&&o.attr(i),o}},{key:"drawPath",value:function(r){var i=r.d,o=void 0===i?"":i,l=r.stroke,u=void 0===l?"#a8a8a8":l,h=r.strokeWidth,p=void 0===h?1:h,v=r.fill,y=r.fillOpacity,C=void 0===y?1:y,k=r.strokeOpacity,S=void 0===k?1:k,R=r.classes,N=r.strokeLinecap,B=void 0===N?null:N,U=r.strokeDashArray,j=void 0===U?0:U,K=this.w;return null===B&&(B=K.config.stroke.lineCap),(o.indexOf("undefined")>-1||o.indexOf("NaN")>-1)&&(o="M 0 ".concat(K.globals.gridHeight)),K.globals.dom.Paper.path(o).attr({fill:v,"fill-opacity":C,stroke:u,"stroke-opacity":S,"stroke-linecap":B,"stroke-width":p,"stroke-dasharray":j,class:R})}},{key:"group",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=this.w.globals.dom.Paper.group();return null!==r&&i.attr(r),i}},{key:"move",value:function(r,i){return["M",r,i].join(" ")}},{key:"line",value:function(r,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=null;return null===o?l=[" L",r,i].join(" "):"H"===o?l=[" H",r].join(" "):"V"===o&&(l=[" V",i].join(" ")),l}},{key:"curve",value:function(r,i,o,l,u,h){return["C",r,i,o,l,u,h].join(" ")}},{key:"quadraticCurve",value:function(r,i,o,l){return["Q",r,i,o,l].join(" ")}},{key:"arc",value:function(r,i,o,l,u,h,p){var v="A";return arguments.length>7&&void 0!==arguments[7]&&arguments[7]&&(v="a"),[v,r,i,o,l,u,h,p].join(" ")}},{key:"renderPaths",value:function(r){var i,o=r.j,l=r.realIndex,u=r.pathFrom,h=r.pathTo,p=r.stroke,v=r.strokeWidth,y=r.strokeLinecap,C=r.fill,k=r.animationDelay,S=r.initialSpeed,R=r.dataChangeSpeed,N=r.className,B=r.shouldClipToGrid,U=void 0===B||B,j=r.bindEventsOnPaths,K=void 0===j||j,x=r.drawShadow,I=void 0===x||x,W=this.w,q=new On(this.ctx),J=new hi(this.ctx),ne=this.w.config.chart.animations.enabled,ve=ne&&this.w.config.chart.animations.dynamicAnimation.enabled,ge=!!(ne&&!W.globals.resized||ve&&W.globals.dataChanged&&W.globals.shouldAnimate);ge?i=u:(i=h,W.globals.animationEnded=!0);var qe,Le=W.config.stroke.dashArray;qe=Array.isArray(Le)?Le[l]:W.config.stroke.dashArray;var Pe=this.drawPath({d:i,stroke:p,strokeWidth:v,fill:C,fillOpacity:1,classes:N,strokeLinecap:y,strokeDashArray:qe});Pe.attr("index",l),U&&Pe.attr({"clip-path":"url(#gridRectMask".concat(W.globals.cuid,")")}),"none"!==W.config.states.normal.filter.type?q.getDefaultFilter(Pe,l):W.config.chart.dropShadow.enabled&&I&&q.dropShadow(Pe,W.config.chart.dropShadow,l),K&&(Pe.node.addEventListener("mouseenter",this.pathMouseEnter.bind(this,Pe)),Pe.node.addEventListener("mouseleave",this.pathMouseLeave.bind(this,Pe)),Pe.node.addEventListener("mousedown",this.pathMouseDown.bind(this,Pe))),Pe.attr({pathTo:h,pathFrom:u});var lt={el:Pe,j:o,realIndex:l,pathFrom:u,pathTo:h,fill:C,strokeWidth:v,delay:k};return!ne||W.globals.resized||W.globals.dataChanged?!W.globals.resized&&W.globals.dataChanged||J.showDelayedElements():J.animatePathsGradually(Ze(Ze({},lt),{},{speed:S})),W.globals.dataChanged&&ve&&ge&&J.animatePathsGradually(Ze(Ze({},lt),{},{speed:R})),Pe}},{key:"drawPattern",value:function(r,i,o){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#a8a8a8",u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return this.w.globals.dom.Paper.pattern(i,o,function(h){"horizontalLines"===r?h.line(0,0,o,0).stroke({color:l,width:u+1}):"verticalLines"===r?h.line(0,0,0,i).stroke({color:l,width:u+1}):"slantedLines"===r?h.line(0,0,i,o).stroke({color:l,width:u}):"squares"===r?h.rect(i,o).fill("none").stroke({color:l,width:u}):"circles"===r&&h.circle(i).fill("none").stroke({color:l,width:u})})}},{key:"drawGradient",value:function(r,i,o,l,u){var h,p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,v=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,y=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,C=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,k=this.w;i.length<9&&0===i.indexOf("#")&&(i=pe.hexToRgba(i,l)),o.length<9&&0===o.indexOf("#")&&(o=pe.hexToRgba(o,u));var S=0,R=1,N=1,B=null;null!==v&&(S=void 0!==v[0]?v[0]/100:0,R=void 0!==v[1]?v[1]/100:1,N=void 0!==v[2]?v[2]/100:1,B=void 0!==v[3]?v[3]/100:null);var U=!("donut"!==k.config.chart.type&&"pie"!==k.config.chart.type&&"polarArea"!==k.config.chart.type&&"bubble"!==k.config.chart.type);return h=k.globals.dom.Paper.gradient(U?"radial":"linear",null===y||0===y.length?function(x){x.at(S,i,l),x.at(R,o,u),x.at(N,o,u),null!==B&&x.at(B,i,l)}:function(x){(Array.isArray(y[C])?y[C]:y).forEach(function(I){x.at(I.offset/100,I.color,I.opacity)})}),U?h.attr("bubble"!==k.config.chart.type?{gradientUnits:"userSpaceOnUse",cx:k.globals.gridWidth/2,cy:k.globals.gridHeight/2,r:p}:{cx:.5,cy:.5,r:.8,fx:.2,fy:.2}):"vertical"===r?h.from(0,0).to(0,1):"diagonal"===r?h.from(0,0).to(1,1):"horizontal"===r?h.from(0,1).to(1,1):"diagonal2"===r&&h.from(1,0).to(0,1),h}},{key:"getTextBasedOnMaxWidth",value:function(r){var i=r.text,o=r.maxWidth,h=this.getTextRects(i,r.fontSize,r.fontFamily),v=Math.floor(o/(h.width/i.length));return o<h.width?i.slice(0,v-3)+"...":i}},{key:"drawText",value:function(r){var i=this,o=r.x,l=r.y,u=r.text,h=r.textAnchor,p=r.fontSize,v=r.fontFamily,y=r.fontWeight,C=r.foreColor,k=r.opacity,S=r.maxWidth,R=r.cssClass,N=void 0===R?"":R,B=r.isPlainText,U=void 0===B||B,j=r.dominantBaseline,K=void 0===j?"auto":j,x=this.w;void 0===u&&(u="");var I=u;h||(h="start"),C&&C.length||(C=x.config.chart.foreColor),y=y||"regular";var W,q={maxWidth:S,fontSize:p=p||"11px",fontFamily:v=v||x.config.chart.fontFamily};return Array.isArray(u)?W=x.globals.dom.Paper.text(function(J){for(var ne=0;ne<u.length;ne++)I=u[ne],S&&(I=i.getTextBasedOnMaxWidth(Ze({text:u[ne]},q))),0===ne?J.tspan(I):J.tspan(I).newLine()}):(S&&(I=this.getTextBasedOnMaxWidth(Ze({text:u},q))),W=U?x.globals.dom.Paper.plain(u):x.globals.dom.Paper.text(function(J){return J.tspan(I)})),W.attr({x:o,y:l,"text-anchor":h,"dominant-baseline":K,"font-size":p,"font-family":v,"font-weight":y,fill:C,class:"apexcharts-text "+N}),W.node.style.fontFamily=v,W.node.style.opacity=k,W}},{key:"createGroupWithAttributes",value:function(r,i,o,l){var u=this.group();return o.forEach(function(h){return u.add(h)}),u.attr({class:l.class?l.class:"",cy:i,cx:r}),u}},{key:"drawPlus",value:function(r,i,o,l){var u=o/2,h=this.drawLine(r,i-u,r,i+u,l.pointStrokeColor,l.pointStrokeDashArray,l.pointStrokeWidth,l.pointStrokeLineCap),p=this.drawLine(r-u,i,r+u,i,l.pointStrokeColor,l.pointStrokeDashArray,l.pointStrokeWidth,l.pointStrokeLineCap);return this.createGroupWithAttributes(r,i,[h,p],l)}},{key:"drawX",value:function(r,i,o,l){var u=o/2,h=this.drawLine(r-u,i-u,r+u,i+u,l.pointStrokeColor,l.pointStrokeDashArray,l.pointStrokeWidth,l.pointStrokeLineCap),p=this.drawLine(r-u,i+u,r+u,i-u,l.pointStrokeColor,l.pointStrokeDashArray,l.pointStrokeWidth,l.pointStrokeLineCap);return this.createGroupWithAttributes(r,i,[h,p],l)}},{key:"drawMarker",value:function(r,i,o){r=r||0;var l=o.pSize||0,u=null;if("X"===o?.shape||"x"===o?.shape)u=this.drawX(r,i,l,o);else if("plus"===o?.shape||"+"===o?.shape)u=this.drawPlus(r,i,l,o);else if("square"===o.shape||"rect"===o.shape){var h=void 0===o.pRadius?l/2:o.pRadius;null!==i&&l||(l=0,h=0);var p=1.2*l+h,v=this.drawRect(p,p,p,p,h);v.attr({x:r-p/2,y:i-p/2,cx:r,cy:i,class:o.class?o.class:"",fill:o.pointFillColor,"fill-opacity":o.pointFillOpacity?o.pointFillOpacity:1,stroke:o.pointStrokeColor,"stroke-width":o.pointStrokeWidth?o.pointStrokeWidth:0,"stroke-opacity":o.pointStrokeOpacity?o.pointStrokeOpacity:1}),u=v}else"circle"!==o.shape&&o.shape||(pe.isNumber(i)||(l=0,i=0),u=this.drawCircle(l,{cx:r,cy:i,class:o.class?o.class:"",stroke:o.pointStrokeColor,fill:o.pointFillColor,"fill-opacity":o.pointFillOpacity?o.pointFillOpacity:1,"stroke-width":o.pointStrokeWidth?o.pointStrokeWidth:0,"stroke-opacity":o.pointStrokeOpacity?o.pointStrokeOpacity:1}));return u}},{key:"pathMouseEnter",value:function(r,i){var o=this.w,l=new On(this.ctx),u=parseInt(r.node.getAttribute("index"),10),h=parseInt(r.node.getAttribute("j"),10);if("function"==typeof o.config.chart.events.dataPointMouseEnter&&o.config.chart.events.dataPointMouseEnter(i,this.ctx,{seriesIndex:u,dataPointIndex:h,w:o}),this.ctx.events.fireEvent("dataPointMouseEnter",[i,this.ctx,{seriesIndex:u,dataPointIndex:h,w:o}]),("none"===o.config.states.active.filter.type||"true"!==r.node.getAttribute("selected"))&&"none"!==o.config.states.hover.filter.type&&!o.globals.isTouchDevice){var p=o.config.states.hover.filter;l.applyFilter(r,u,p.type,p.value)}}},{key:"pathMouseLeave",value:function(r,i){var o=this.w,l=new On(this.ctx),u=parseInt(r.node.getAttribute("index"),10),h=parseInt(r.node.getAttribute("j"),10);"function"==typeof o.config.chart.events.dataPointMouseLeave&&o.config.chart.events.dataPointMouseLeave(i,this.ctx,{seriesIndex:u,dataPointIndex:h,w:o}),this.ctx.events.fireEvent("dataPointMouseLeave",[i,this.ctx,{seriesIndex:u,dataPointIndex:h,w:o}]),"none"!==o.config.states.active.filter.type&&"true"===r.node.getAttribute("selected")||"none"!==o.config.states.hover.filter.type&&l.getDefaultFilter(r,u)}},{key:"pathMouseDown",value:function(r,i){var o=this.w,l=new On(this.ctx),u=parseInt(r.node.getAttribute("index"),10),h=parseInt(r.node.getAttribute("j"),10),p="false";if("true"===r.node.getAttribute("selected")){if(r.node.setAttribute("selected","false"),o.globals.selectedDataPoints[u].indexOf(h)>-1){var v=o.globals.selectedDataPoints[u].indexOf(h);o.globals.selectedDataPoints[u].splice(v,1)}}else{if(!o.config.states.active.allowMultipleDataPointsSelection&&o.globals.selectedDataPoints.length>0){o.globals.selectedDataPoints=[];var y=o.globals.dom.Paper.select(".apexcharts-series path").members,C=o.globals.dom.Paper.select(".apexcharts-series circle, .apexcharts-series rect").members,k=function(N){Array.prototype.forEach.call(N,function(B){B.node.setAttribute("selected","false"),l.getDefaultFilter(B,u)})};k(y),k(C)}r.node.setAttribute("selected","true"),p="true",void 0===o.globals.selectedDataPoints[u]&&(o.globals.selectedDataPoints[u]=[]),o.globals.selectedDataPoints[u].push(h)}if("true"===p){var S=o.config.states.active.filter;if("none"!==S)l.applyFilter(r,u,S.type,S.value);else if("none"!==o.config.states.hover.filter&&!o.globals.isTouchDevice){var R=o.config.states.hover.filter;l.applyFilter(r,u,R.type,R.value)}}else"none"!==o.config.states.active.filter.type&&("none"===o.config.states.hover.filter.type||o.globals.isTouchDevice?l.getDefaultFilter(r,u):l.applyFilter(r,u,(R=o.config.states.hover.filter).type,R.value));"function"==typeof o.config.chart.events.dataPointSelection&&o.config.chart.events.dataPointSelection(i,this.ctx,{selectedDataPoints:o.globals.selectedDataPoints,seriesIndex:u,dataPointIndex:h,w:o}),i&&this.ctx.events.fireEvent("dataPointSelection",[i,this.ctx,{selectedDataPoints:o.globals.selectedDataPoints,seriesIndex:u,dataPointIndex:h,w:o}])}},{key:"rotateAroundCenter",value:function(r){var i={};return r&&"function"==typeof r.getBBox&&(i=r.getBBox()),{x:i.x+i.width/2,y:i.y+i.height/2}}},{key:"getTextRects",value:function(r,i,o,l){var u=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],h=this.w,p=this.drawText({x:-200,y:-200,text:r,textAnchor:"start",fontSize:i,fontFamily:o,foreColor:"#fff",opacity:0});l&&p.attr("transform",l),h.globals.dom.Paper.add(p);var v=p.bbox();return u||(v=p.node.getBoundingClientRect()),p.remove(),{width:v.width,height:v.height}}},{key:"placeTextWithEllipsis",value:function(r,i,o){if("function"==typeof r.getComputedTextLength&&(r.textContent=i,i.length>0&&r.getComputedTextLength()>=o/1.1)){for(var l=i.length-3;l>0;l-=3)if(r.getSubStringLength(0,l)<=o/1.1)return void(r.textContent=i.substring(0,l)+"...");r.textContent="."}}}],[{key:"setAttrs",value:function(r,i){for(var o in i)i.hasOwnProperty(o)&&r.setAttribute(o,i[o])}}]),P}(),yn=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w}return me(P,[{key:"getStackedSeriesTotals",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=this.w,o=[];if(0===i.globals.series.length)return o;for(var l=0;l<i.globals.series[i.globals.maxValsInArrayIndex].length;l++){for(var u=0,h=0;h<i.globals.series.length;h++)void 0!==i.globals.series[h][l]&&-1===r.indexOf(h)&&(u+=i.globals.series[h][l]);o.push(u)}return o}},{key:"getSeriesTotalByIndex",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null===r?this.w.config.series.reduce(function(i,o){return i+o},0):this.w.globals.series[r].reduce(function(i,o){return i+o},0)}},{key:"getStackedSeriesTotalsByGroups",value:function(){var r=this,i=this.w,o=[];return i.globals.seriesGroups.forEach(function(l){var u=[];i.config.series.forEach(function(p,v){l.indexOf(i.globals.seriesNames[v])>-1&&u.push(v)});var h=i.globals.series.map(function(p,v){return-1===u.indexOf(v)?v:-1}).filter(function(p){return-1!==p});o.push(r.getStackedSeriesTotals(h))}),o}},{key:"setSeriesYAxisMappings",value:function(){var r=this.w.globals,i=this.w.config,o=[],l=[],u=[],h=r.series.length>i.yaxis.length||i.yaxis.some(function(k){return Array.isArray(k.seriesName)});i.series.forEach(function(k,S){u.push(S),l.push(null)}),i.yaxis.forEach(function(k,S){o[S]=[]});var p=[];i.yaxis.forEach(function(k,S){var R=!1;if(k.seriesName){var N=[];Array.isArray(k.seriesName)?N=k.seriesName:N.push(k.seriesName),N.forEach(function(B){i.series.forEach(function(U,j){if(U.name===B){var K=j;S===j||h?!h||u.indexOf(j)>-1?o[S].push([S,j]):console.warn("Series '"+U.name+"' referenced more than once in what looks like the new style. That is, when using either seriesName: [], or when there are more series than yaxes."):(o[j].push([j,S]),K=S),R=!0,-1!==(K=u.indexOf(K))&&u.splice(K,1)}})})}R||p.push(S)}),o=o.map(function(k,S){var R=[];return k.forEach(function(N){l[N[1]]=N[0],R.push(N[1])}),R});for(var v=i.yaxis.length-1,y=0;y<p.length&&(o[v=p[y]]=[],u);y++){var C=u[0];u.shift(),o[v].push(C),l[C]=v}u.forEach(function(k){o[v].push(k),l[k]=v}),r.seriesYAxisMap=o.map(function(k){return k}),r.seriesYAxisReverseMap=l.map(function(k){return k}),r.seriesYAxisMap.forEach(function(k,S){k.forEach(function(R){i.series[R]&&void 0===i.series[R].group&&(i.series[R].group="apexcharts-axis-".concat(S.toString()))})})}},{key:"isSeriesNull",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return 0===(null===r?this.w.config.series.filter(function(i){return null!==i}):this.w.config.series[r].data.filter(function(i){return null!==i})).length}},{key:"seriesHaveSameValues",value:function(r){return this.w.globals.series[r].every(function(i,o,l){return i===l[0]})}},{key:"getCategoryLabels",value:function(r){var i=this.w,o=r.slice();return i.config.xaxis.convertedCatToNumeric&&(o=r.map(function(l,u){return i.config.xaxis.labels.formatter(l-i.globals.minX+1)})),o}},{key:"getLargestSeries",value:function(){var r=this.w;r.globals.maxValsInArrayIndex=r.globals.series.map(function(i){return i.length}).indexOf(Math.max.apply(Math,r.globals.series.map(function(i){return i.length})))}},{key:"getLargestMarkerSize",value:function(){var r=this.w,i=0;return r.globals.markers.size.forEach(function(o){i=Math.max(i,o)}),r.config.markers.discrete&&r.config.markers.discrete.length&&r.config.markers.discrete.forEach(function(o){i=Math.max(i,o.size)}),i>0&&(i+=r.config.markers.hover.sizeOffset+1),r.globals.markers.largestSize=i,i}},{key:"getSeriesTotals",value:function(){var r=this.w;r.globals.seriesTotals=r.globals.series.map(function(i,o){var l=0;if(Array.isArray(i))for(var u=0;u<i.length;u++)l+=i[u];else l+=i;return l})}},{key:"getSeriesTotalsXRange",value:function(r,i){var o=this.w;return o.globals.series.map(function(l,u){for(var h=0,p=0;p<l.length;p++)o.globals.seriesX[u][p]>r&&o.globals.seriesX[u][p]<i&&(h+=l[p]);return h})}},{key:"getPercentSeries",value:function(){var r=this.w;r.globals.seriesPercent=r.globals.series.map(function(i,o){var l=[];if(Array.isArray(i))for(var u=0;u<i.length;u++){var h=r.globals.stackedSeriesTotals[u],p=0;h&&(p=100*i[u]/h),l.push(p)}else{var v=100*i/r.globals.seriesTotals.reduce(function(y,C){return y+C},0);l.push(v)}return l})}},{key:"getCalculatedRatios",value:function(){var r,i,o,l=this,u=this.w,h=u.globals,p=[],v=0,y=[],C=.1,k=0;if(h.yRange=[],h.isMultipleYAxis)for(var S=0;S<h.minYArr.length;S++)h.yRange.push(Math.abs(h.minYArr[S]-h.maxYArr[S])),y.push(0);else h.yRange.push(Math.abs(h.minY-h.maxY));h.xRange=Math.abs(h.maxX-h.minX),h.zRange=Math.abs(h.maxZ-h.minZ);for(var R=0;R<h.yRange.length;R++)p.push(h.yRange[R]/h.gridHeight);if(i=h.xRange/h.gridWidth,r=h.yRange/h.gridWidth,o=h.xRange/h.gridHeight,(v=h.zRange/h.gridHeight*16)||(v=1),h.minY!==Number.MIN_VALUE&&0!==Math.abs(h.minY)&&(h.hasNegs=!0),u.globals.seriesYAxisReverseMap.length>0){var N=function(U,j){var K=u.config.yaxis[u.globals.seriesYAxisReverseMap[j]],x=U<0?-1:1;return U=Math.abs(U),K.logarithmic&&(U=l.getBaseLog(K.logBase,U)),-x*U/p[j]};if(h.isMultipleYAxis){y=[];for(var B=0;B<p.length;B++)y.push(N(h.minYArr[B],B))}else(y=[]).push(N(h.minY,0)),h.minY!==Number.MIN_VALUE&&0!==Math.abs(h.minY)&&(C=-h.minY/r,k=h.minX/i)}else(y=[]).push(0),C=0,k=0;return{yRatio:p,invertedYRatio:r,zRatio:v,xRatio:i,invertedXRatio:o,baseLineInvertedY:C,baseLineY:y,baseLineX:k}}},{key:"getLogSeries",value:function(r){var i=this,o=this.w;return o.globals.seriesLog=r.map(function(l,u){var h=o.globals.seriesYAxisReverseMap[u];return o.config.yaxis[h]&&o.config.yaxis[h].logarithmic?l.map(function(p){return null===p?null:i.getLogVal(o.config.yaxis[h].logBase,p,u)}):l}),o.globals.invalidLogScale?r:o.globals.seriesLog}},{key:"getBaseLog",value:function(r,i){return Math.log(i)/Math.log(r)}},{key:"getLogVal",value:function(r,i,o){if(i<=0)return 0;var l=this.w,u=0===l.globals.minYArr[o]?-1:this.getBaseLog(r,l.globals.minYArr[o]),h=(0===l.globals.maxYArr[o]?0:this.getBaseLog(r,l.globals.maxYArr[o]))-u;return i<1?i/h:(this.getBaseLog(r,i)-u)/h}},{key:"getLogYRatios",value:function(r){var i=this,o=this.w,l=this.w.globals;return l.yLogRatio=r.slice(),l.logYRange=l.yRange.map(function(u,h){var p=o.globals.seriesYAxisReverseMap[h];if(o.config.yaxis[p]&&i.w.config.yaxis[p].logarithmic){var v,y=-Number.MAX_VALUE,C=Number.MIN_VALUE;return l.seriesLog.forEach(function(k,S){k.forEach(function(R){o.config.yaxis[S]&&o.config.yaxis[S].logarithmic&&(y=Math.max(R,y),C=Math.min(R,C))})}),v=Math.pow(l.yRange[h],Math.abs(C-y)/l.yRange[h]),l.yLogRatio[h]=v/l.gridHeight,v}}),l.invalidLogScale?r.slice():l.yLogRatio}},{key:"drawSeriesByGroup",value:function(r,i,o,l){var u=this.w,h=[];return r.series.length>0&&i.forEach(function(p){var v=[],y=[];r.i.forEach(function(C,k){u.config.series[C].group===p&&(v.push(r.series[k]),y.push(C))}),v.length>0&&h.push(l.draw(v,o,y))}),h}}],[{key:"checkComboSeries",value:function(r,i){var o=!1,l=0,u=0;return void 0===i&&(i="line"),r.length&&void 0!==r[0].type&&r.forEach(function(h){"bar"!==h.type&&"column"!==h.type&&"candlestick"!==h.type&&"boxPlot"!==h.type||l++,void 0!==h.type&&h.type!==i&&u++}),u>0&&(o=!0),{comboBarCount:l,comboCharts:o}}},{key:"extendArrayProps",value:function(r,i,o){var l,u,h,p,v,y;return null!==(l=i)&&void 0!==l&&l.yaxis&&(i=r.extendYAxis(i,o)),null!==(u=i)&&void 0!==u&&u.annotations&&(i.annotations.yaxis&&(i=r.extendYAxisAnnotations(i)),null!==(h=i)&&void 0!==h&&null!==(p=h.annotations)&&void 0!==p&&p.xaxis&&(i=r.extendXAxisAnnotations(i)),null!==(v=i)&&void 0!==v&&null!==(y=v.annotations)&&void 0!==y&&y.points&&(i=r.extendPointAnnotations(i))),i}}]),P}(),ue=function(){function P(r){F(this,P),this.w=r.w,this.annoCtx=r}return me(P,[{key:"setOrientations",value:function(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("vertical"===r.label.orientation){var u=this.w.globals.dom.baseEl.querySelector(".apexcharts-xaxis-annotations .apexcharts-xaxis-annotation-label[rel='".concat(null!==i?i:0,"']"));if(null!==u){var h=u.getBoundingClientRect();u.setAttribute("x",parseFloat(u.getAttribute("x"))-h.height+4),u.setAttribute("y","top"===r.label.position?parseFloat(u.getAttribute("y"))+h.width:parseFloat(u.getAttribute("y"))-h.width);var p=this.annoCtx.graphics.rotateAroundCenter(u),y=p.y;u.setAttribute("transform","rotate(-90 ".concat(p.x," ").concat(y,")"))}}}},{key:"addBackgroundToAnno",value:function(r,i){var o=this.w;if(!r||void 0===i.label.text||void 0!==i.label.text&&!String(i.label.text).trim())return null;var l=o.globals.dom.baseEl.querySelector(".apexcharts-grid").getBoundingClientRect(),u=r.getBoundingClientRect(),h=i.label.style.padding.left,p=i.label.style.padding.right,v=i.label.style.padding.top,y=i.label.style.padding.bottom;"vertical"===i.label.orientation&&(v=i.label.style.padding.left,y=i.label.style.padding.right,h=i.label.style.padding.top,p=i.label.style.padding.bottom);var S=this.annoCtx.graphics.drawRect(u.left-l.left-h-o.globals.barPadForNumericAxis,u.top-l.top-v,u.width+h+p,u.height+v+y,i.label.borderRadius,i.label.style.background,1,i.label.borderWidth,i.label.borderColor,0);return i.id&&S.node.classList.add(i.id),S}},{key:"annotationsBackground",value:function(){var r=this,i=this.w,o=function(l,u,h){var p=i.globals.dom.baseEl.querySelector(".apexcharts-".concat(h,"-annotations .apexcharts-").concat(h,"-annotation-label[rel='").concat(u,"']"));if(p){var v=p.parentNode,y=r.addBackgroundToAnno(p,l);y&&(v.insertBefore(y.node,p),l.label.mouseEnter&&y.node.addEventListener("mouseenter",l.label.mouseEnter.bind(r,l)),l.label.mouseLeave&&y.node.addEventListener("mouseleave",l.label.mouseLeave.bind(r,l)),l.label.click&&y.node.addEventListener("click",l.label.click.bind(r,l)))}};i.config.annotations.xaxis.map(function(l,u){o(l,u,"xaxis")}),i.config.annotations.yaxis.map(function(l,u){o(l,u,"yaxis")}),i.config.annotations.points.map(function(l,u){o(l,u,"point")})}},{key:"getY1Y2",value:function(r,i){var o,l="y1"===r?i.y:i.y2,u=!1,h=this.w;if(this.annoCtx.invertAxis){var p=h.globals.labels;h.config.xaxis.convertedCatToNumeric&&(p=h.globals.categoryLabels);var v=p.indexOf(l),y=h.globals.dom.baseEl.querySelector(".apexcharts-yaxis-texts-g text:nth-child("+(v+1)+")");o=y?parseFloat(y.getAttribute("y")):(h.globals.gridHeight/p.length-1)*(v+1)-h.globals.barHeight,void 0!==i.seriesIndex&&h.globals.barHeight&&(o=o-h.globals.barHeight/2*(h.globals.series.length-1)+h.globals.barHeight*i.seriesIndex)}else{var C,k=h.globals.seriesYAxisMap[i.yAxisIndex][0];(C=h.config.yaxis[i.yAxisIndex].logarithmic?(l=new yn(this.annoCtx.ctx).getLogVal(h.config.yaxis[i.yAxisIndex].logBase,l,k))/h.globals.yLogRatio[k]:(l-h.globals.minYArr[k])/(h.globals.yRange[k]/h.globals.gridHeight))>h.globals.gridHeight?(C=h.globals.gridHeight,u=!0):C<0&&(C=0,u=!0),o=h.globals.gridHeight-C,!i.marker||null!=i.y||(o=0),h.config.yaxis[i.yAxisIndex]&&h.config.yaxis[i.yAxisIndex].reversed&&(o=C)}return"string"==typeof l&&l.indexOf("px")>-1&&(o=parseFloat(l)),{yP:o,clipped:u}}},{key:"getX1X2",value:function(r,i){var o,l="x1"===r?i.x:i.x2,u=this.w,v=this.annoCtx.invertAxis?u.globals.yRange[0]:u.globals.xRange,y=!1;return o=this.annoCtx.inversedReversedAxis?((this.annoCtx.invertAxis?u.globals.maxY:u.globals.maxX)-l)/(v/u.globals.gridWidth):(l-(this.annoCtx.invertAxis?u.globals.minY:u.globals.minX))/(v/u.globals.gridWidth),"category"!==u.config.xaxis.type&&!u.config.xaxis.convertedCatToNumeric||this.annoCtx.invertAxis||u.globals.dataFormatXNumeric||u.config.chart.sparkline.enabled||(o=this.getStringX(l)),"string"==typeof l&&l.indexOf("px")>-1&&(o=parseFloat(l)),null==l&&i.marker&&(o=u.globals.gridWidth),void 0!==i.seriesIndex&&u.globals.barWidth&&!this.annoCtx.invertAxis&&(o=o-u.globals.barWidth/2*(u.globals.series.length-1)+u.globals.barWidth*i.seriesIndex),o>u.globals.gridWidth?(o=u.globals.gridWidth,y=!0):o<0&&(o=0,y=!0),{x:o,clipped:y}}},{key:"getStringX",value:function(r){var i=this.w,o=r;i.config.xaxis.convertedCatToNumeric&&i.globals.categoryLabels.length&&(r=i.globals.categoryLabels.indexOf(r)+1);var l=i.globals.labels.indexOf(r),u=i.globals.dom.baseEl.querySelector(".apexcharts-xaxis-texts-g text:nth-child("+(l+1)+")");return u&&(o=parseFloat(u.getAttribute("x"))),o}}]),P}(),z=function(){function P(r){F(this,P),this.w=r.w,this.annoCtx=r,this.invertAxis=this.annoCtx.invertAxis,this.helpers=new ue(this.annoCtx)}return me(P,[{key:"addXaxisAnnotation",value:function(r,i,o){var l,u=this.w,h=this.helpers.getX1X2("x1",r),p=h.x,v=h.clipped,y=!0,C=r.label.text,k=r.strokeDashArray;if(pe.isNumber(p)){if(null==r.x2){if(!v){var S=this.annoCtx.graphics.drawLine(p+r.offsetX,0+r.offsetY,p+r.offsetX,u.globals.gridHeight+r.offsetY,r.borderColor,k,r.borderWidth);i.appendChild(S.node),r.id&&S.node.classList.add(r.id)}}else{var R=this.helpers.getX1X2("x2",r);if(l=R.x,y=R.clipped,!v||!y){if(l<p){var N=p;p=l,l=N}var B=this.annoCtx.graphics.drawRect(p+r.offsetX,0+r.offsetY,l-p,u.globals.gridHeight+r.offsetY,0,r.fillColor,r.opacity,1,r.borderColor,k);B.node.classList.add("apexcharts-annotation-rect"),B.attr("clip-path","url(#gridRectMask".concat(u.globals.cuid,")")),i.appendChild(B.node),r.id&&B.node.classList.add(r.id)}}if(!v||!y){var U=this.annoCtx.graphics.getTextRects(C,parseFloat(r.label.style.fontSize)),K=this.annoCtx.graphics.drawText({x:p+r.label.offsetX,y:("top"===r.label.position?4:"center"===r.label.position?u.globals.gridHeight/2+("vertical"===r.label.orientation?U.width/2:0):u.globals.gridHeight)+r.label.offsetY-("vertical"===r.label.orientation?"top"===r.label.position?U.width/2-12:-U.width/2:0),text:C,textAnchor:r.label.textAnchor,fontSize:r.label.style.fontSize,fontFamily:r.label.style.fontFamily,fontWeight:r.label.style.fontWeight,foreColor:r.label.style.color,cssClass:"apexcharts-xaxis-annotation-label ".concat(r.label.style.cssClass," ").concat(r.id?r.id:"")});K.attr({rel:o}),i.appendChild(K.node),this.annoCtx.helpers.setOrientations(r,o)}}}},{key:"drawXAxisAnnotations",value:function(){var r=this,i=this.w,o=this.annoCtx.graphics.group({class:"apexcharts-xaxis-annotations"});return i.config.annotations.xaxis.map(function(l,u){r.addXaxisAnnotation(l,o.node,u)}),o}}]),P}(),Mn=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w,this.months31=[1,3,5,7,8,10,12],this.months30=[2,4,6,9,11],this.daysCntOfYear=[0,31,59,90,120,151,181,212,243,273,304,334]}return me(P,[{key:"isValidDate",value:function(r){return"number"!=typeof r&&!isNaN(this.parseDate(r))}},{key:"getTimeStamp",value:function(r){return Date.parse(r)?this.w.config.xaxis.labels.datetimeUTC?new Date(new Date(r).toISOString().substr(0,25)).getTime():new Date(r).getTime():r}},{key:"getDate",value:function(r){return this.w.config.xaxis.labels.datetimeUTC?new Date(new Date(r).toUTCString()):new Date(r)}},{key:"parseDate",value:function(r){var i=Date.parse(r);if(!isNaN(i))return this.getTimeStamp(r);var o=Date.parse(r.replace(/-/g,"/").replace(/[a-z]+/gi," "));return this.getTimeStamp(o)}},{key:"parseDateWithTimezone",value:function(r){return Date.parse(r.replace(/-/g,"/").replace(/[a-z]+/gi," "))}},{key:"formatDate",value:function(r,i){var o=this.w.globals.locale,l=this.w.config.xaxis.labels.datetimeUTC,u=["\0"].concat(gt(o.months)),h=["\x01"].concat(gt(o.shortMonths)),p=["\x02"].concat(gt(o.days)),v=["\x03"].concat(gt(o.shortDays));function y(ne,ve){var ge=ne+"";for(ve=ve||2;ge.length<ve;)ge="0"+ge;return ge}var C=l?r.getUTCFullYear():r.getFullYear();i=(i=(i=i.replace(/(^|[^\\])yyyy+/g,"$1"+C)).replace(/(^|[^\\])yy/g,"$1"+C.toString().substr(2,2))).replace(/(^|[^\\])y/g,"$1"+C);var k=(l?r.getUTCMonth():r.getMonth())+1;i=(i=(i=(i=i.replace(/(^|[^\\])MMMM+/g,"$1"+u[0])).replace(/(^|[^\\])MMM/g,"$1"+h[0])).replace(/(^|[^\\])MM/g,"$1"+y(k))).replace(/(^|[^\\])M/g,"$1"+k);var S=l?r.getUTCDate():r.getDate();i=(i=(i=(i=i.replace(/(^|[^\\])dddd+/g,"$1"+p[0])).replace(/(^|[^\\])ddd/g,"$1"+v[0])).replace(/(^|[^\\])dd/g,"$1"+y(S))).replace(/(^|[^\\])d/g,"$1"+S);var R=l?r.getUTCHours():r.getHours(),N=R>12?R-12:0===R?12:R;i=(i=(i=(i=i.replace(/(^|[^\\])HH+/g,"$1"+y(R))).replace(/(^|[^\\])H/g,"$1"+R)).replace(/(^|[^\\])hh+/g,"$1"+y(N))).replace(/(^|[^\\])h/g,"$1"+N);var B=l?r.getUTCMinutes():r.getMinutes();i=(i=i.replace(/(^|[^\\])mm+/g,"$1"+y(B))).replace(/(^|[^\\])m/g,"$1"+B);var U=l?r.getUTCSeconds():r.getSeconds();i=(i=i.replace(/(^|[^\\])ss+/g,"$1"+y(U))).replace(/(^|[^\\])s/g,"$1"+U);var j=l?r.getUTCMilliseconds():r.getMilliseconds();i=i.replace(/(^|[^\\])fff+/g,"$1"+y(j,3)),j=Math.round(j/10),i=i.replace(/(^|[^\\])ff/g,"$1"+y(j)),j=Math.round(j/10);var K=R<12?"AM":"PM";i=(i=(i=i.replace(/(^|[^\\])f/g,"$1"+j)).replace(/(^|[^\\])TT+/g,"$1"+K)).replace(/(^|[^\\])T/g,"$1"+K.charAt(0));var x=K.toLowerCase();i=(i=i.replace(/(^|[^\\])tt+/g,"$1"+x)).replace(/(^|[^\\])t/g,"$1"+x.charAt(0));var I=-r.getTimezoneOffset(),W=l||!I?"Z":I>0?"+":"-";if(!l){var q=(I=Math.abs(I))%60;W+=y(Math.floor(I/60))+":"+y(q)}i=i.replace(/(^|[^\\])K/g,"$1"+W);var J=(l?r.getUTCDay():r.getDay())+1;return(i=(i=(i=(i=i.replace(new RegExp(p[0],"g"),p[J])).replace(new RegExp(v[0],"g"),v[J])).replace(new RegExp(u[0],"g"),u[k])).replace(new RegExp(h[0],"g"),h[k])).replace(/\\(.)/g,"$1")}},{key:"getTimeUnitsfromTimestamp",value:function(r,i,o){var l=this.w;void 0!==l.config.xaxis.min&&(r=l.config.xaxis.min),void 0!==l.config.xaxis.max&&(i=l.config.xaxis.max);var u=this.getDate(r),h=this.getDate(i),p=this.formatDate(u,"yyyy MM dd HH mm ss fff").split(" "),v=this.formatDate(h,"yyyy MM dd HH mm ss fff").split(" ");return{minMillisecond:parseInt(p[6],10),maxMillisecond:parseInt(v[6],10),minSecond:parseInt(p[5],10),maxSecond:parseInt(v[5],10),minMinute:parseInt(p[4],10),maxMinute:parseInt(v[4],10),minHour:parseInt(p[3],10),maxHour:parseInt(v[3],10),minDate:parseInt(p[2],10),maxDate:parseInt(v[2],10),minMonth:parseInt(p[1],10)-1,maxMonth:parseInt(v[1],10)-1,minYear:parseInt(p[0],10),maxYear:parseInt(v[0],10)}}},{key:"isLeapYear",value:function(r){return r%4==0&&r%100!=0||r%400==0}},{key:"calculcateLastDaysOfMonth",value:function(r,i,o){return this.determineDaysOfMonths(r,i)-o}},{key:"determineDaysOfYear",value:function(r){var i=365;return this.isLeapYear(r)&&(i=366),i}},{key:"determineRemainingDaysOfYear",value:function(r,i,o){var l=this.daysCntOfYear[i]+o;return i>1&&this.isLeapYear()&&l++,l}},{key:"determineDaysOfMonths",value:function(r,i){var o=30;switch(r=pe.monthMod(r),!0){case this.months30.indexOf(r)>-1:2===r&&(o=this.isLeapYear(i)?29:28);break;case this.months31.indexOf(r)>-1:default:o=31}return o}}]),P}(),Qt=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w,this.tooltipKeyFormat="dd MMM"}return me(P,[{key:"xLabelFormat",value:function(r,i,o,l){var u=this.w;if("datetime"===u.config.xaxis.type&&void 0===u.config.xaxis.labels.formatter&&void 0===u.config.tooltip.x.formatter){var h=new Mn(this.ctx);return h.formatDate(h.getDate(i),u.config.tooltip.x.format)}return r(i,o,l)}},{key:"defaultGeneralFormatter",value:function(r){return Array.isArray(r)?r.map(function(i){return i}):r}},{key:"defaultYFormatter",value:function(r,i,o){var l=this.w;if(pe.isNumber(r))if(0!==l.globals.yValueDecimal)r=r.toFixed(void 0!==i.decimalsInFloat?i.decimalsInFloat:l.globals.yValueDecimal);else{var u=r.toFixed(0);r=r==u?u:r.toFixed(1)}return r}},{key:"setLabelFormatters",value:function(){var r=this,i=this.w;return i.globals.xaxisTooltipFormatter=function(o){return r.defaultGeneralFormatter(o)},i.globals.ttKeyFormatter=function(o){return r.defaultGeneralFormatter(o)},i.globals.ttZFormatter=function(o){return o},i.globals.legendFormatter=function(o){return r.defaultGeneralFormatter(o)},i.globals.xLabelFormatter=void 0!==i.config.xaxis.labels.formatter?i.config.xaxis.labels.formatter:function(o){if(pe.isNumber(o)){if(!i.config.xaxis.convertedCatToNumeric&&"numeric"===i.config.xaxis.type){if(pe.isNumber(i.config.xaxis.decimalsInFloat))return o.toFixed(i.config.xaxis.decimalsInFloat);var l=i.globals.maxX-i.globals.minX;return o.toFixed(l>0&&l<100?1:0)}return o.toFixed(i.globals.isBarHorizontal&&i.globals.maxY-i.globals.minYArr<4?1:0)}return o},i.globals.ttKeyFormatter="function"==typeof i.config.tooltip.x.formatter?i.config.tooltip.x.formatter:i.globals.xLabelFormatter,"function"==typeof i.config.xaxis.tooltip.formatter&&(i.globals.xaxisTooltipFormatter=i.config.xaxis.tooltip.formatter),(Array.isArray(i.config.tooltip.y)||void 0!==i.config.tooltip.y.formatter)&&(i.globals.ttVal=i.config.tooltip.y),void 0!==i.config.tooltip.z.formatter&&(i.globals.ttZFormatter=i.config.tooltip.z.formatter),void 0!==i.config.legend.formatter&&(i.globals.legendFormatter=i.config.legend.formatter),i.config.yaxis.forEach(function(o,l){i.globals.yLabelFormatters[l]=void 0!==o.labels.formatter?o.labels.formatter:function(u){return i.globals.xyCharts?Array.isArray(u)?u.map(function(h){return r.defaultYFormatter(h,o,l)}):r.defaultYFormatter(u,o,l):u}}),i.globals}},{key:"heatmapLabelFormatters",value:function(){var r=this.w;if("heatmap"===r.config.chart.type){r.globals.yAxisScale[0].result=r.globals.seriesNames.slice();var i=r.globals.seriesNames.reduce(function(o,l){return o.length>l.length?o:l},0);r.globals.yAxisScale[0].niceMax=i,r.globals.yAxisScale[0].niceMin=i}}}]),P}(),mt=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w}return me(P,[{key:"getLabel",value:function(r,i,o,l){var U,j,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"12px",p=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],v=this.w,y=void 0===r[l]?"":r[l],C=y,k=v.globals.xLabelFormatter,S=v.config.xaxis.labels.formatter,R=!1,N=new Qt(this.ctx);p&&(C=N.xLabelFormat(k,y,y,{i:l,dateFormatter:new Mn(this.ctx).formatDate,w:v}),void 0!==S&&(C=S(y,r[l],{i:l,dateFormatter:new Mn(this.ctx).formatDate,w:v}))),i.length>0?(U=i[l].unit,j=null,i.forEach(function(W){"month"===W.unit?j="year":"day"===W.unit?j="month":"hour"===W.unit?j="day":"minute"===W.unit&&(j="hour")}),R=j===U,o=i[l].position,C=i[l].value):"datetime"===v.config.xaxis.type&&void 0===S&&(C=""),void 0===C&&(C=""),C=Array.isArray(C)?C:C.toString();var x,K=new Ke(this.ctx);x=v.globals.rotateXLabels&&p?K.getTextRects(C,parseInt(h,10),null,"rotate(".concat(v.config.xaxis.labels.rotate," 0 0)"),!1):K.getTextRects(C,parseInt(h,10));var I=!v.config.xaxis.labels.showDuplicates&&this.ctx.timeScale;return!Array.isArray(C)&&("NaN"===String(C)||u.indexOf(C)>=0&&I)&&(C=""),{x:o,text:C,textRect:x,isBold:R}}},{key:"checkLabelBasedOnTickamount",value:function(r,i,o){var l=this.w,u=l.config.xaxis.tickAmount;return"dataPoints"===u&&(u=Math.round(l.globals.gridWidth/120)),u>o||r%Math.round(o/(u+1))==0||(i.text=""),i}},{key:"checkForOverflowingLabels",value:function(r,i,o,l,u){var h=this.w;if(0===r&&h.globals.skipFirstTimelinelabel&&(i.text=""),r===o-1&&h.globals.skipLastTimelinelabel&&(i.text=""),h.config.xaxis.labels.hideOverlappingLabels&&l.length>0){var p=u[u.length-1];i.x<p.textRect.width/(h.globals.rotateXLabels?Math.abs(h.config.xaxis.labels.rotate)/12:1.01)+p.x&&(i.text="")}return i}},{key:"checkForReversedLabels",value:function(r,i){var o=this.w;return o.config.yaxis[r]&&o.config.yaxis[r].reversed&&i.reverse(),i}},{key:"yAxisAllSeriesCollapsed",value:function(r){var i=this.w.globals;return!i.seriesYAxisMap[r].some(function(o){return-1===i.collapsedSeriesIndices.indexOf(o)})}},{key:"translateYAxisIndex",value:function(r){var i=this.w,o=i.globals,l=i.config.yaxis;return o.series.length>l.length||l.some(function(u){return Array.isArray(u.seriesName)})?r:o.seriesYAxisReverseMap[r]}},{key:"isYAxisHidden",value:function(r){var i=this.w,o=i.config.yaxis[r];if(!o.show||this.yAxisAllSeriesCollapsed(r))return!0;if(!o.showForNullSeries){var l=i.globals.seriesYAxisMap[r],u=new yn(this.ctx);return l.every(function(h){return u.isSeriesNull(h)})}return!1}},{key:"getYAxisForeColor",value:function(r,i){var o=this.w;return Array.isArray(r)&&o.globals.yAxisScale[i]&&this.ctx.theme.pushExtraColors(r,o.globals.yAxisScale[i].result.length,!1),r}},{key:"drawYAxisTicks",value:function(r,i,o,l,u,h,p){var v=this.w,y=new Ke(this.ctx),C=v.globals.translateY+v.config.yaxis[u].labels.offsetY;if(v.globals.isBarHorizontal?C=0:"heatmap"===v.config.chart.type&&(C+=h/2),l.show&&i>0){!0===v.config.yaxis[u].opposite&&(r+=l.width);for(var k=i;k>=0;k--){var S=y.drawLine(r+o.offsetX-l.width+l.offsetX,C+l.offsetY,r+o.offsetX+l.offsetX,C+l.offsetY,l.color);p.add(S),C+=h}}}}]),P}(),or=function(){function P(r){F(this,P),this.w=r.w,this.annoCtx=r,this.helpers=new ue(this.annoCtx),this.axesUtils=new mt(this.annoCtx)}return me(P,[{key:"addYaxisAnnotation",value:function(r,i,o){var l,u=this.w,h=r.strokeDashArray,p=this.helpers.getY1Y2("y1",r),v=p.yP,y=p.clipped,k=!1,S=r.label.text;if(null==r.y2){if(!y){k=!0;var R=this.annoCtx.graphics.drawLine(0+r.offsetX,v+r.offsetY,this._getYAxisAnnotationWidth(r),v+r.offsetY,r.borderColor,h,r.borderWidth);i.appendChild(R.node),r.id&&R.node.classList.add(r.id)}}else{if((l=(p=this.helpers.getY1Y2("y2",r)).yP)>v){var N=v;v=l,l=N}if(!y||!p.clipped){k=!0;var B=this.annoCtx.graphics.drawRect(0+r.offsetX,l+r.offsetY,this._getYAxisAnnotationWidth(r),v-l,0,r.fillColor,r.opacity,1,r.borderColor,h);B.node.classList.add("apexcharts-annotation-rect"),B.attr("clip-path","url(#gridRectMask".concat(u.globals.cuid,")")),i.appendChild(B.node),r.id&&B.node.classList.add(r.id)}}if(k){var j=this.annoCtx.graphics.drawText({x:("right"===r.label.position?u.globals.gridWidth:"center"===r.label.position?u.globals.gridWidth/2:0)+r.label.offsetX,y:(l??v)+r.label.offsetY-3,text:S,textAnchor:r.label.textAnchor,fontSize:r.label.style.fontSize,fontFamily:r.label.style.fontFamily,fontWeight:r.label.style.fontWeight,foreColor:r.label.style.color,cssClass:"apexcharts-yaxis-annotation-label ".concat(r.label.style.cssClass," ").concat(r.id?r.id:"")});j.attr({rel:o}),i.appendChild(j.node)}}},{key:"_getYAxisAnnotationWidth",value:function(r){var i=this.w;return(r.width.indexOf("%")>-1?i.globals.gridWidth*parseInt(r.width,10)/100:parseInt(r.width,10))+r.offsetX}},{key:"drawYAxisAnnotations",value:function(){var r=this,i=this.w,o=this.annoCtx.graphics.group({class:"apexcharts-yaxis-annotations"});return i.config.annotations.yaxis.forEach(function(l,u){l.yAxisIndex=r.axesUtils.translateYAxisIndex(l.yAxisIndex),r.axesUtils.isYAxisHidden(l.yAxisIndex)&&r.axesUtils.yAxisAllSeriesCollapsed(l.yAxisIndex)||r.addYaxisAnnotation(l,o.node,u)}),o}}]),P}(),Qn=function(){function P(r){F(this,P),this.w=r.w,this.annoCtx=r,this.helpers=new ue(this.annoCtx)}return me(P,[{key:"addPointAnnotation",value:function(r,i,o){if(!(this.w.globals.collapsedSeriesIndices.indexOf(r.seriesIndex)>-1)){var l=this.helpers.getX1X2("x1",r),u=l.x,h=l.clipped,p=(l=this.helpers.getY1Y2("y1",r)).yP,v=l.clipped;if(pe.isNumber(u)&&!v&&!h){var y={pSize:r.marker.size,pointStrokeWidth:r.marker.strokeWidth,pointFillColor:r.marker.fillColor,pointStrokeColor:r.marker.strokeColor,shape:r.marker.shape,pRadius:r.marker.radius,class:"apexcharts-point-annotation-marker ".concat(r.marker.cssClass," ").concat(r.id?r.id:"")},C=this.annoCtx.graphics.drawMarker(u+r.marker.offsetX,p+r.marker.offsetY,y);i.appendChild(C.node);var k=r.label.text?r.label.text:"",S=this.annoCtx.graphics.drawText({x:u+r.label.offsetX,y:p+r.label.offsetY-r.marker.size-parseFloat(r.label.style.fontSize)/1.6,text:k,textAnchor:r.label.textAnchor,fontSize:r.label.style.fontSize,fontFamily:r.label.style.fontFamily,fontWeight:r.label.style.fontWeight,foreColor:r.label.style.color,cssClass:"apexcharts-point-annotation-label ".concat(r.label.style.cssClass," ").concat(r.id?r.id:"")});if(S.attr({rel:o}),i.appendChild(S.node),r.customSVG.SVG){var R=this.annoCtx.graphics.group({class:"apexcharts-point-annotations-custom-svg "+r.customSVG.cssClass});R.attr({transform:"translate(".concat(u+r.customSVG.offsetX,", ").concat(p+r.customSVG.offsetY,")")}),R.node.innerHTML=r.customSVG.SVG,i.appendChild(R.node)}if(r.image.path){var N=r.image.width?r.image.width:20,B=r.image.height?r.image.height:20;C=this.annoCtx.addImage({x:u+r.image.offsetX-N/2,y:p+r.image.offsetY-B/2,width:N,height:B,path:r.image.path,appendTo:".apexcharts-point-annotations"})}r.mouseEnter&&C.node.addEventListener("mouseenter",r.mouseEnter.bind(this,r)),r.mouseLeave&&C.node.addEventListener("mouseleave",r.mouseLeave.bind(this,r)),r.click&&C.node.addEventListener("click",r.click.bind(this,r))}}}},{key:"drawPointAnnotations",value:function(){var r=this,i=this.w,o=this.annoCtx.graphics.group({class:"apexcharts-point-annotations"});return i.config.annotations.points.map(function(l,u){r.addPointAnnotation(l,o.node,u)}),o}}]),P}(),Cn={name:"en",options:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],toolbar:{exportToSVG:"Download SVG",exportToPNG:"Download PNG",exportToCSV:"Download CSV",menu:"Menu",selection:"Selection",selectionZoom:"Selection Zoom",zoomIn:"Zoom In",zoomOut:"Zoom Out",pan:"Panning",reset:"Reset Zoom"}}},Lr=function(){function P(){F(this,P),this.yAxis={show:!0,showAlways:!1,showForNullSeries:!0,seriesName:void 0,opposite:!1,reversed:!1,logarithmic:!1,logBase:10,tickAmount:void 0,stepSize:void 0,forceNiceScale:!1,max:void 0,min:void 0,floating:!1,decimalsInFloat:void 0,labels:{show:!0,minWidth:0,maxWidth:160,offsetX:0,offsetY:0,align:void 0,rotate:0,padding:20,style:{colors:[],fontSize:"11px",fontWeight:400,fontFamily:void 0,cssClass:""},formatter:void 0},axisBorder:{show:!1,color:"#e0e0e0",width:1,offsetX:0,offsetY:0},axisTicks:{show:!1,color:"#e0e0e0",width:6,offsetX:0,offsetY:0},title:{text:void 0,rotate:-90,offsetY:0,offsetX:0,style:{color:void 0,fontSize:"11px",fontWeight:900,fontFamily:void 0,cssClass:""}},tooltip:{enabled:!1,offsetX:0},crosshairs:{show:!0,position:"front",stroke:{color:"#b6b6b6",width:1,dashArray:0}}},this.pointAnnotation={id:void 0,x:0,y:null,yAxisIndex:0,seriesIndex:void 0,mouseEnter:void 0,mouseLeave:void 0,click:void 0,marker:{size:4,fillColor:"#fff",strokeWidth:2,strokeColor:"#333",shape:"circle",offsetX:0,offsetY:0,radius:2,cssClass:""},label:{borderColor:"#c2c2c2",borderWidth:1,borderRadius:2,text:void 0,textAnchor:"middle",offsetX:0,offsetY:0,mouseEnter:void 0,mouseLeave:void 0,click:void 0,style:{background:"#fff",color:void 0,fontSize:"11px",fontFamily:void 0,fontWeight:400,cssClass:"",padding:{left:5,right:5,top:2,bottom:2}}},customSVG:{SVG:void 0,cssClass:void 0,offsetX:0,offsetY:0},image:{path:void 0,width:20,height:20,offsetX:0,offsetY:0}},this.yAxisAnnotation={id:void 0,y:0,y2:null,strokeDashArray:1,fillColor:"#c2c2c2",borderColor:"#c2c2c2",borderWidth:1,opacity:.3,offsetX:0,offsetY:0,width:"100%",yAxisIndex:0,label:{borderColor:"#c2c2c2",borderWidth:1,borderRadius:2,text:void 0,textAnchor:"end",position:"right",offsetX:0,offsetY:-3,mouseEnter:void 0,mouseLeave:void 0,click:void 0,style:{background:"#fff",color:void 0,fontSize:"11px",fontFamily:void 0,fontWeight:400,cssClass:"",padding:{left:5,right:5,top:2,bottom:2}}}},this.xAxisAnnotation={id:void 0,x:0,x2:null,strokeDashArray:1,fillColor:"#c2c2c2",borderColor:"#c2c2c2",borderWidth:1,opacity:.3,offsetX:0,offsetY:0,label:{borderColor:"#c2c2c2",borderWidth:1,borderRadius:2,text:void 0,textAnchor:"middle",orientation:"vertical",position:"top",offsetX:0,offsetY:0,mouseEnter:void 0,mouseLeave:void 0,click:void 0,style:{background:"#fff",color:void 0,fontSize:"11px",fontFamily:void 0,fontWeight:400,cssClass:"",padding:{left:5,right:5,top:2,bottom:2}}}},this.text={x:0,y:0,text:"",textAnchor:"start",foreColor:void 0,fontSize:"13px",fontFamily:void 0,fontWeight:400,appendTo:".apexcharts-annotations",backgroundColor:"transparent",borderColor:"#c2c2c2",borderRadius:0,borderWidth:0,paddingLeft:4,paddingRight:4,paddingTop:2,paddingBottom:2}}return me(P,[{key:"init",value:function(){return{annotations:{yaxis:[this.yAxisAnnotation],xaxis:[this.xAxisAnnotation],points:[this.pointAnnotation],texts:[],images:[],shapes:[]},chart:{animations:{enabled:!0,easing:"easeinout",speed:800,animateGradually:{delay:150,enabled:!0},dynamicAnimation:{enabled:!0,speed:350}},background:"transparent",locales:[Cn],defaultLocale:"en",dropShadow:{enabled:!1,enabledOnSeries:void 0,top:2,left:2,blur:4,color:"#000",opacity:.35},events:{animationEnd:void 0,beforeMount:void 0,mounted:void 0,updated:void 0,click:void 0,mouseMove:void 0,mouseLeave:void 0,xAxisLabelClick:void 0,legendClick:void 0,markerClick:void 0,selection:void 0,dataPointSelection:void 0,dataPointMouseEnter:void 0,dataPointMouseLeave:void 0,beforeZoom:void 0,beforeResetZoom:void 0,zoomed:void 0,scrolled:void 0,brushScrolled:void 0},foreColor:"#373d3f",fontFamily:"Helvetica, Arial, sans-serif",height:"auto",parentHeightOffset:15,redrawOnParentResize:!0,redrawOnWindowResize:!0,id:void 0,group:void 0,nonce:void 0,offsetX:0,offsetY:0,selection:{enabled:!1,type:"x",fill:{color:"#24292e",opacity:.1},stroke:{width:1,color:"#24292e",opacity:.4,dashArray:3},xaxis:{min:void 0,max:void 0},yaxis:{min:void 0,max:void 0}},sparkline:{enabled:!1},brush:{enabled:!1,autoScaleYaxis:!0,target:void 0,targets:void 0},stacked:!1,stackOnlyBar:!0,stackType:"normal",toolbar:{show:!0,offsetX:0,offsetY:0,tools:{download:!0,selection:!0,zoom:!0,zoomin:!0,zoomout:!0,pan:!0,reset:!0,customIcons:[]},export:{csv:{filename:void 0,columnDelimiter:",",headerCategory:"category",headerValue:"value",dateFormatter:function(r){return new Date(r).toDateString()}},png:{filename:void 0},svg:{filename:void 0}},autoSelected:"zoom"},type:"line",width:"100%",zoom:{enabled:!0,type:"x",autoScaleYaxis:!1,zoomedArea:{fill:{color:"#90CAF9",opacity:.4},stroke:{color:"#0D47A1",opacity:.4,width:1}}}},plotOptions:{line:{isSlopeChart:!1},area:{fillTo:"origin"},bar:{horizontal:!1,columnWidth:"70%",barHeight:"70%",distributed:!1,borderRadius:0,borderRadiusApplication:"around",borderRadiusWhenStacked:"last",rangeBarOverlap:!0,rangeBarGroupRows:!1,hideZeroBarsWhenGrouped:!1,isDumbbell:!1,dumbbellColors:void 0,isFunnel:!1,isFunnel3d:!0,colors:{ranges:[],backgroundBarColors:[],backgroundBarOpacity:1,backgroundBarRadius:0},dataLabels:{position:"top",maxItems:100,hideOverflowingLabels:!0,orientation:"horizontal",total:{enabled:!1,formatter:void 0,offsetX:0,offsetY:0,style:{color:"#373d3f",fontSize:"12px",fontFamily:void 0,fontWeight:600}}}},bubble:{zScaling:!0,minBubbleRadius:void 0,maxBubbleRadius:void 0},candlestick:{colors:{upward:"#00B746",downward:"#EF403C"},wick:{useFillColor:!0}},boxPlot:{colors:{upper:"#00E396",lower:"#008FFB"}},heatmap:{radius:2,enableShades:!0,shadeIntensity:.5,reverseNegativeShade:!1,distributed:!1,useFillColorAsStroke:!1,colorScale:{inverse:!1,ranges:[],min:void 0,max:void 0}},treemap:{enableShades:!0,shadeIntensity:.5,distributed:!1,reverseNegativeShade:!1,useFillColorAsStroke:!1,borderRadius:4,dataLabels:{format:"scale"},colorScale:{inverse:!1,ranges:[],min:void 0,max:void 0}},radialBar:{inverseOrder:!1,startAngle:0,endAngle:360,offsetX:0,offsetY:0,hollow:{margin:5,size:"50%",background:"transparent",image:void 0,imageWidth:150,imageHeight:150,imageOffsetX:0,imageOffsetY:0,imageClipped:!0,position:"front",dropShadow:{enabled:!1,top:0,left:0,blur:3,color:"#000",opacity:.5}},track:{show:!0,startAngle:void 0,endAngle:void 0,background:"#f2f2f2",strokeWidth:"97%",opacity:1,margin:5,dropShadow:{enabled:!1,top:0,left:0,blur:3,color:"#000",opacity:.5}},dataLabels:{show:!0,name:{show:!0,fontSize:"16px",fontFamily:void 0,fontWeight:600,color:void 0,offsetY:0,formatter:function(r){return r}},value:{show:!0,fontSize:"14px",fontFamily:void 0,fontWeight:400,color:void 0,offsetY:16,formatter:function(r){return r+"%"}},total:{show:!1,label:"Total",fontSize:"16px",fontWeight:600,fontFamily:void 0,color:void 0,formatter:function(r){return r.globals.seriesTotals.reduce(function(i,o){return i+o},0)/r.globals.series.length+"%"}}},barLabels:{enabled:!1,margin:5,useSeriesColors:!0,fontFamily:void 0,fontWeight:600,fontSize:"16px",formatter:function(r){return r},onClick:void 0}},pie:{customScale:1,offsetX:0,offsetY:0,startAngle:0,endAngle:360,expandOnClick:!0,dataLabels:{offset:0,minAngleToShowLabel:10},donut:{size:"65%",background:"transparent",labels:{show:!1,name:{show:!0,fontSize:"16px",fontFamily:void 0,fontWeight:600,color:void 0,offsetY:-10,formatter:function(r){return r}},value:{show:!0,fontSize:"20px",fontFamily:void 0,fontWeight:400,color:void 0,offsetY:10,formatter:function(r){return r}},total:{show:!1,showAlways:!1,label:"Total",fontSize:"16px",fontWeight:400,fontFamily:void 0,color:void 0,formatter:function(r){return r.globals.seriesTotals.reduce(function(i,o){return i+o},0)}}}}},polarArea:{rings:{strokeWidth:1,strokeColor:"#e8e8e8"},spokes:{strokeWidth:1,connectorColors:"#e8e8e8"}},radar:{size:void 0,offsetX:0,offsetY:0,polygons:{strokeWidth:1,strokeColors:"#e8e8e8",connectorColors:"#e8e8e8",fill:{colors:void 0}}}},colors:void 0,dataLabels:{enabled:!0,enabledOnSeries:void 0,formatter:function(r){return null!==r?r:""},textAnchor:"middle",distributed:!1,offsetX:0,offsetY:0,style:{fontSize:"12px",fontFamily:void 0,fontWeight:600,colors:void 0},background:{enabled:!0,foreColor:"#fff",borderRadius:2,padding:4,opacity:.9,borderWidth:1,borderColor:"#fff",dropShadow:{enabled:!1,top:1,left:1,blur:1,color:"#000",opacity:.45}},dropShadow:{enabled:!1,top:1,left:1,blur:1,color:"#000",opacity:.45}},fill:{type:"solid",colors:void 0,opacity:.85,gradient:{shade:"dark",type:"horizontal",shadeIntensity:.5,gradientToColors:void 0,inverseColors:!0,opacityFrom:1,opacityTo:1,stops:[0,50,100],colorStops:[]},image:{src:[],width:void 0,height:void 0},pattern:{style:"squares",width:6,height:6,strokeWidth:2}},forecastDataPoints:{count:0,fillOpacity:.5,strokeWidth:void 0,dashArray:4},grid:{show:!0,borderColor:"#e0e0e0",strokeDashArray:0,position:"back",xaxis:{lines:{show:!1}},yaxis:{lines:{show:!0}},row:{colors:void 0,opacity:.5},column:{colors:void 0,opacity:.5},padding:{top:0,right:10,bottom:0,left:12}},labels:[],legend:{show:!0,showForSingleSeries:!1,showForNullSeries:!0,showForZeroSeries:!0,floating:!1,position:"bottom",horizontalAlign:"center",inverseOrder:!1,fontSize:"12px",fontFamily:void 0,fontWeight:400,width:void 0,height:void 0,formatter:void 0,tooltipHoverFormatter:void 0,offsetX:-20,offsetY:4,customLegendItems:[],labels:{colors:void 0,useSeriesColors:!1},markers:{width:12,height:12,strokeWidth:0,fillColors:void 0,strokeColor:"#fff",radius:12,customHTML:void 0,offsetX:0,offsetY:0,onClick:void 0},itemMargin:{horizontal:5,vertical:2},onItemClick:{toggleDataSeries:!0},onItemHover:{highlightDataSeries:!0}},markers:{discrete:[],size:0,colors:void 0,strokeColors:"#fff",strokeWidth:2,strokeOpacity:.9,strokeDashArray:0,fillOpacity:1,shape:"circle",width:8,height:8,radius:2,offsetX:0,offsetY:0,onClick:void 0,onDblClick:void 0,showNullDataPoints:!0,hover:{size:void 0,sizeOffset:3}},noData:{text:void 0,align:"center",verticalAlign:"middle",offsetX:0,offsetY:0,style:{color:void 0,fontSize:"14px",fontFamily:void 0}},responsive:[],series:void 0,states:{normal:{filter:{type:"none",value:0}},hover:{filter:{type:"lighten",value:.1}},active:{allowMultipleDataPointsSelection:!1,filter:{type:"darken",value:.5}}},title:{text:void 0,align:"left",margin:5,offsetX:0,offsetY:0,floating:!1,style:{fontSize:"14px",fontWeight:900,fontFamily:void 0,color:void 0}},subtitle:{text:void 0,align:"left",margin:5,offsetX:0,offsetY:30,floating:!1,style:{fontSize:"12px",fontWeight:400,fontFamily:void 0,color:void 0}},stroke:{show:!0,curve:"smooth",lineCap:"butt",width:2,colors:void 0,dashArray:0,fill:{type:"solid",colors:void 0,opacity:.85,gradient:{shade:"dark",type:"horizontal",shadeIntensity:.5,gradientToColors:void 0,inverseColors:!0,opacityFrom:1,opacityTo:1,stops:[0,50,100],colorStops:[]}}},tooltip:{enabled:!0,enabledOnSeries:void 0,shared:!0,hideEmptySeries:!1,followCursor:!1,intersect:!1,inverseOrder:!1,custom:void 0,fillSeriesColor:!1,theme:"light",cssClass:"",style:{fontSize:"12px",fontFamily:void 0},onDatasetHover:{highlightDataSeries:!1},x:{show:!0,format:"dd MMM",formatter:void 0},y:{formatter:void 0,title:{formatter:function(r){return r?r+": ":""}}},z:{formatter:void 0,title:"Size: "},marker:{show:!0,fillColors:void 0},items:{display:"flex"},fixed:{enabled:!1,position:"topRight",offsetX:0,offsetY:0}},xaxis:{type:"category",categories:[],convertedCatToNumeric:!1,offsetX:0,offsetY:0,overwriteCategories:void 0,labels:{show:!0,rotate:-45,rotateAlways:!1,hideOverlappingLabels:!0,trim:!1,minHeight:void 0,maxHeight:120,showDuplicates:!0,style:{colors:[],fontSize:"12px",fontWeight:400,fontFamily:void 0,cssClass:""},offsetX:0,offsetY:0,format:void 0,formatter:void 0,datetimeUTC:!0,datetimeFormatter:{year:"yyyy",month:"MMM 'yy",day:"dd MMM",hour:"HH:mm",minute:"HH:mm:ss",second:"HH:mm:ss"}},group:{groups:[],style:{colors:[],fontSize:"12px",fontWeight:400,fontFamily:void 0,cssClass:""}},axisBorder:{show:!0,color:"#e0e0e0",width:"100%",height:1,offsetX:0,offsetY:0},axisTicks:{show:!0,color:"#e0e0e0",height:6,offsetX:0,offsetY:0},stepSize:void 0,tickAmount:void 0,tickPlacement:"on",min:void 0,max:void 0,range:void 0,floating:!1,decimalsInFloat:void 0,position:"bottom",title:{text:void 0,offsetX:0,offsetY:0,style:{color:void 0,fontSize:"12px",fontWeight:900,fontFamily:void 0,cssClass:""}},crosshairs:{show:!0,width:1,position:"back",opacity:.9,stroke:{color:"#b6b6b6",width:1,dashArray:3},fill:{type:"solid",color:"#B1B9C4",gradient:{colorFrom:"#D8E3F0",colorTo:"#BED1E6",stops:[0,100],opacityFrom:.4,opacityTo:.5}},dropShadow:{enabled:!1,left:0,top:0,blur:1,opacity:.4}},tooltip:{enabled:!0,offsetY:0,formatter:void 0,style:{fontSize:"12px",fontFamily:void 0}}},yaxis:this.yAxis,theme:{mode:"light",palette:"palette1",monochrome:{enabled:!1,color:"#008FFB",shadeTo:"light",shadeIntensity:.65}}}}}]),P}(),ji=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w,this.graphics=new Ke(this.ctx),this.w.globals.isBarHorizontal&&(this.invertAxis=!0),this.helpers=new ue(this),this.xAxisAnnotations=new z(this),this.yAxisAnnotations=new or(this),this.pointsAnnotations=new Qn(this),this.w.globals.isBarHorizontal&&this.w.config.yaxis[0].reversed&&(this.inversedReversedAxis=!0),this.xDivision=this.w.globals.gridWidth/this.w.globals.dataPoints}return me(P,[{key:"drawAxesAnnotations",value:function(){var r=this.w;if(r.globals.axisCharts){for(var i=this.yAxisAnnotations.drawYAxisAnnotations(),o=this.xAxisAnnotations.drawXAxisAnnotations(),l=this.pointsAnnotations.drawPointAnnotations(),u=r.config.chart.animations.enabled,h=[i,o,l],p=[o.node,i.node,l.node],v=0;v<3;v++)r.globals.dom.elGraphical.add(h[v]),!u||r.globals.resized||r.globals.dataChanged||"scatter"!==r.config.chart.type&&"bubble"!==r.config.chart.type&&r.globals.dataPoints>1&&p[v].classList.add("apexcharts-element-hidden"),r.globals.delayedElements.push({el:p[v],index:0});this.helpers.annotationsBackground()}}},{key:"drawImageAnnos",value:function(){var r=this;this.w.config.annotations.images.map(function(i,o){r.addImage(i,o)})}},{key:"drawTextAnnos",value:function(){var r=this;this.w.config.annotations.texts.map(function(i,o){r.addText(i,o)})}},{key:"addXaxisAnnotation",value:function(r,i,o){this.xAxisAnnotations.addXaxisAnnotation(r,i,o)}},{key:"addYaxisAnnotation",value:function(r,i,o){this.yAxisAnnotations.addYaxisAnnotation(r,i,o)}},{key:"addPointAnnotation",value:function(r,i,o){this.pointsAnnotations.addPointAnnotation(r,i,o)}},{key:"addText",value:function(r,i){var u=r.text,S=r.backgroundColor,R=r.borderWidth,N=r.strokeDashArray,B=r.borderRadius,U=r.borderColor,j=r.appendTo,K=void 0===j?".apexcharts-svg":j,x=r.paddingLeft,I=void 0===x?4:x,W=r.paddingRight,q=void 0===W?4:W,J=r.paddingBottom,ne=void 0===J?2:J,ve=r.paddingTop,ge=void 0===ve?2:ve,Le=this.w,qe=this.graphics.drawText({x:r.x,y:r.y,text:u,textAnchor:r.textAnchor||"start",fontSize:r.fontSize||"12px",fontWeight:r.fontWeight||"regular",fontFamily:r.fontFamily||Le.config.chart.fontFamily,foreColor:r.foreColor||Le.config.chart.foreColor,cssClass:r.cssClass}),Pe=Le.globals.dom.baseEl.querySelector(K);Pe&&Pe.appendChild(qe.node);var Ue=qe.bbox();if(u){var lt=this.graphics.drawRect(Ue.x-I,Ue.y-ge,Ue.width+I+q,Ue.height+ne+ge,B,S||"transparent",1,R,U,N);Pe.insertBefore(lt.node,qe.node)}}},{key:"addImage",value:function(r,i){var o=this.w,u=r.x,h=void 0===u?0:u,p=r.y,v=void 0===p?0:p,y=r.width,C=void 0===y?20:y,k=r.height,S=void 0===k?20:k,R=r.appendTo,N=void 0===R?".apexcharts-svg":R,B=o.globals.dom.Paper.image(r.path);B.size(C,S).move(h,v);var U=o.globals.dom.baseEl.querySelector(N);return U&&U.appendChild(B.node),B}},{key:"addXaxisAnnotationExternal",value:function(r,i,o){return this.addAnnotationExternal({params:r,pushToMemory:i,context:o,type:"xaxis",contextMethod:o.addXaxisAnnotation}),o}},{key:"addYaxisAnnotationExternal",value:function(r,i,o){return this.addAnnotationExternal({params:r,pushToMemory:i,context:o,type:"yaxis",contextMethod:o.addYaxisAnnotation}),o}},{key:"addPointAnnotationExternal",value:function(r,i,o){return void 0===this.invertAxis&&(this.invertAxis=o.w.globals.isBarHorizontal),this.addAnnotationExternal({params:r,pushToMemory:i,context:o,type:"point",contextMethod:o.addPointAnnotation}),o}},{key:"addAnnotationExternal",value:function(r){var i=r.params,o=r.pushToMemory,l=r.context,u=r.type,h=r.contextMethod,p=l,v=p.w,y=v.globals.dom.baseEl.querySelector(".apexcharts-".concat(u,"-annotations")),C=y.childNodes.length+1,k=new Lr,S=Object.assign({},"xaxis"===u?k.xAxisAnnotation:"yaxis"===u?k.yAxisAnnotation:k.pointAnnotation),R=pe.extend(S,i);switch(u){case"xaxis":this.addXaxisAnnotation(R,y,C);break;case"yaxis":this.addYaxisAnnotation(R,y,C);break;case"point":this.addPointAnnotation(R,y,C)}var N=v.globals.dom.baseEl.querySelector(".apexcharts-".concat(u,"-annotations .apexcharts-").concat(u,"-annotation-label[rel='").concat(C,"']")),B=this.helpers.addBackgroundToAnno(N,R);return B&&y.insertBefore(B.node,N),o&&v.globals.memory.methodsToExec.push({context:p,id:R.id?R.id:pe.randomId(),method:h,label:"addAnnotation",params:i}),l}},{key:"clearAnnotations",value:function(r){var i=r.w,o=i.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxis-annotations, .apexcharts-xaxis-annotations, .apexcharts-point-annotations");i.globals.memory.methodsToExec.map(function(l,u){"addText"!==l.label&&"addAnnotation"!==l.label||i.globals.memory.methodsToExec.splice(u,1)}),o=pe.listToArray(o),Array.prototype.forEach.call(o,function(l){for(;l.firstChild;)l.removeChild(l.firstChild)})}},{key:"removeAnnotation",value:function(r,i){var o=r.w,l=o.globals.dom.baseEl.querySelectorAll(".".concat(i));l&&(o.globals.memory.methodsToExec.map(function(u,h){u.id===i&&o.globals.memory.methodsToExec.splice(h,1)}),Array.prototype.forEach.call(l,function(u){u.parentElement.removeChild(u)}))}}]),P}(),sa=function(P){var r,i=P.isTimeline,o=P.ctx,l=P.seriesIndex,u=P.dataPointIndex,h=P.y1,p=P.y2,v=P.w,y=v.globals.seriesRangeStart[l][u],C=v.globals.seriesRangeEnd[l][u],k=v.globals.labels[u],S=v.config.series[l].name?v.config.series[l].name:"",R=v.globals.ttKeyFormatter,N=v.config.tooltip.y.title.formatter,B={w:v,seriesIndex:l,dataPointIndex:u,start:y,end:C};"function"==typeof N&&(S=N(S,B)),null!==(r=v.config.series[l].data[u])&&void 0!==r&&r.x&&(k=v.config.series[l].data[u].x),i||"datetime"===v.config.xaxis.type&&(k=new Qt(o).xLabelFormat(v.globals.ttKeyFormatter,k,k,{i:void 0,dateFormatter:new Mn(o).formatDate,w:v})),"function"==typeof R&&(k=R(k,B)),Number.isFinite(h)&&Number.isFinite(p)&&(y=h,C=p);var U="",j="",K=v.globals.colors[l];if(void 0===v.config.tooltip.x.formatter)if("datetime"===v.config.xaxis.type){var x=new Mn(o);U=x.formatDate(x.getDate(y),v.config.tooltip.x.format),j=x.formatDate(x.getDate(C),v.config.tooltip.x.format)}else U=y,j=C;else U=v.config.tooltip.x.formatter(y),j=v.config.tooltip.x.formatter(C);return{start:y,end:C,startVal:U,endVal:j,ylabel:k,color:K,seriesName:S}},ri=function(P){var r=P.color,i=P.seriesName,o=P.ylabel,l=P.start,u=P.end,h=P.seriesIndex,p=P.dataPointIndex,v=P.ctx.tooltip.tooltipLabels.getFormatters(h);l=v.yLbFormatter(l),u=v.yLbFormatter(u);var y=v.yLbFormatter(P.w.globals.series[h][p]),C='<span class="value start-value">\n  '.concat(l,'\n  </span> <span class="separator">-</span> <span class="value end-value">\n  ').concat(u,"\n  </span>");return'<div class="apexcharts-tooltip-rangebar"><div> <span class="series-name" style="color: '+r+'">'+(i||"")+'</span></div><div> <span class="category">'+o+": </span> "+(P.w.globals.comboCharts?"rangeArea"===P.w.config.series[h].type||"rangeBar"===P.w.config.series[h].type?C:"<span>".concat(y,"</span>"):C)+" </div></div>"},Nn=function(){function P(r){F(this,P),this.opts=r}return me(P,[{key:"hideYAxis",value:function(){this.opts.yaxis[0].show=!1,this.opts.yaxis[0].title.text="",this.opts.yaxis[0].axisBorder.show=!1,this.opts.yaxis[0].axisTicks.show=!1,this.opts.yaxis[0].floating=!0}},{key:"line",value:function(){return{chart:{animations:{easing:"swing"}},dataLabels:{enabled:!1},stroke:{width:5,curve:"straight"},markers:{size:0,hover:{sizeOffset:6}},xaxis:{crosshairs:{width:1}}}}},{key:"sparkline",value:function(r){return this.hideYAxis(),pe.extend(r,{grid:{show:!1,padding:{left:0,right:0,top:0,bottom:0}},legend:{show:!1},xaxis:{labels:{show:!1},tooltip:{enabled:!1},axisBorder:{show:!1},axisTicks:{show:!1}},chart:{toolbar:{show:!1},zoom:{enabled:!1}},dataLabels:{enabled:!1}})}},{key:"slope",value:function(){return this.hideYAxis(),{chart:{toolbar:{show:!1},zoom:{enabled:!1}},dataLabels:{enabled:!0,formatter:function(r,i){return null!==r?i.w.config.series[i.seriesIndex].name+": "+r:""},background:{enabled:!1},offsetX:-5},grid:{xaxis:{lines:{show:!0}},yaxis:{lines:{show:!1}}},xaxis:{position:"top",labels:{style:{fontSize:14,fontWeight:900}},tooltip:{enabled:!1},crosshairs:{show:!1}},markers:{size:8,hover:{sizeOffset:1}},legend:{show:!1},tooltip:{shared:!1,intersect:!0,followCursor:!0},stroke:{width:5,curve:"straight"}}}},{key:"bar",value:function(){return{chart:{stacked:!1,animations:{easing:"swing"}},plotOptions:{bar:{dataLabels:{position:"center"}}},dataLabels:{style:{colors:["#fff"]},background:{enabled:!1}},stroke:{width:0,lineCap:"round"},fill:{opacity:.85},legend:{markers:{shape:"square",radius:2,size:8}},tooltip:{shared:!1,intersect:!0},xaxis:{tooltip:{enabled:!1},tickPlacement:"between",crosshairs:{width:"barWidth",position:"back",fill:{type:"gradient"},dropShadow:{enabled:!1},stroke:{width:0}}}}}},{key:"funnel",value:function(){return this.hideYAxis(),Ze(Ze({},this.bar()),{},{chart:{animations:{easing:"linear",speed:800,animateGradually:{enabled:!1}}},plotOptions:{bar:{horizontal:!0,borderRadiusApplication:"around",borderRadius:0,dataLabels:{position:"center"}}},grid:{show:!1,padding:{left:0,right:0}},xaxis:{labels:{show:!1},tooltip:{enabled:!1},axisBorder:{show:!1},axisTicks:{show:!1}}})}},{key:"candlestick",value:function(){var r=this;return{stroke:{width:1,colors:["#333"]},fill:{opacity:1},dataLabels:{enabled:!1},tooltip:{shared:!0,custom:function(i){return r._getBoxTooltip(i.w,i.seriesIndex,i.dataPointIndex,["Open","High","","Low","Close"],"candlestick")}},states:{active:{filter:{type:"none"}}},xaxis:{crosshairs:{width:1}}}}},{key:"boxPlot",value:function(){var r=this;return{chart:{animations:{dynamicAnimation:{enabled:!1}}},stroke:{width:1,colors:["#24292e"]},dataLabels:{enabled:!1},tooltip:{shared:!0,custom:function(i){return r._getBoxTooltip(i.w,i.seriesIndex,i.dataPointIndex,["Minimum","Q1","Median","Q3","Maximum"],"boxPlot")}},markers:{size:5,strokeWidth:1,strokeColors:"#111"},xaxis:{crosshairs:{width:1}}}}},{key:"rangeBar",value:function(){return{chart:{animations:{animateGradually:!1}},stroke:{width:0,lineCap:"square"},plotOptions:{bar:{borderRadius:0,dataLabels:{position:"center"}}},dataLabels:{enabled:!1,formatter:function(r,i){var o=i.seriesIndex,l=i.dataPointIndex,u=i.w,h=function(){return u.globals.seriesRangeEnd[o][l]-u.globals.seriesRangeStart[o][l]};return u.globals.comboCharts?"rangeBar"===u.config.series[o].type||"rangeArea"===u.config.series[o].type?h():r:h()},background:{enabled:!1},style:{colors:["#fff"]}},markers:{size:10},tooltip:{shared:!1,followCursor:!0,custom:function(r){return r.w.config.plotOptions&&r.w.config.plotOptions.bar&&r.w.config.plotOptions.bar.horizontal?(l=(o=sa(Ze(Ze({},i=r),{},{isTimeline:!0}))).color,u=o.seriesName,h=o.ylabel,p=o.startVal,v=o.endVal,ri(Ze(Ze({},i),{},{color:l,seriesName:u,ylabel:h,start:p,end:v}))):function(i){var o=sa(i),l=o.color,u=o.seriesName,h=o.ylabel,p=o.start,v=o.end;return ri(Ze(Ze({},i),{},{color:l,seriesName:u,ylabel:h,start:p,end:v}))}(r);var i,o,l,u,h,p,v}},xaxis:{tickPlacement:"between",tooltip:{enabled:!1},crosshairs:{stroke:{width:0}}}}}},{key:"dumbbell",value:function(r){var i,o;return null!==(i=r.plotOptions.bar)&&void 0!==i&&i.barHeight||(r.plotOptions.bar.barHeight=2),null!==(o=r.plotOptions.bar)&&void 0!==o&&o.columnWidth||(r.plotOptions.bar.columnWidth=2),r}},{key:"area",value:function(){return{stroke:{width:4,fill:{type:"solid",gradient:{inverseColors:!1,shade:"light",type:"vertical",opacityFrom:.65,opacityTo:.5,stops:[0,100,100]}}},fill:{type:"gradient",gradient:{inverseColors:!1,shade:"light",type:"vertical",opacityFrom:.65,opacityTo:.5,stops:[0,100,100]}},markers:{size:0,hover:{sizeOffset:6}},tooltip:{followCursor:!1}}}},{key:"rangeArea",value:function(){return{stroke:{curve:"straight",width:0},fill:{type:"solid",opacity:.6},markers:{size:0},states:{hover:{filter:{type:"none"}},active:{filter:{type:"none"}}},tooltip:{intersect:!1,shared:!0,followCursor:!0,custom:function(r){return l=(o=sa(i=r)).color,u=o.seriesName,h=o.ylabel,p=o.start,v=o.end,ri(Ze(Ze({},i),{},{color:l,seriesName:u,ylabel:h,start:p,end:v}));var i,o,l,u,h,p,v}}}}},{key:"brush",value:function(r){return pe.extend(r,{chart:{toolbar:{autoSelected:"selection",show:!1},zoom:{enabled:!1}},dataLabels:{enabled:!1},stroke:{width:1},tooltip:{enabled:!1},xaxis:{tooltip:{enabled:!1}}})}},{key:"stacked100",value:function(r){r.dataLabels=r.dataLabels||{},r.dataLabels.formatter=r.dataLabels.formatter||void 0;var i=r.dataLabels.formatter;return r.yaxis.forEach(function(o,l){r.yaxis[l].min=0,r.yaxis[l].max=100}),"bar"===r.chart.type&&(r.dataLabels.formatter=i||function(o){return"number"==typeof o&&o?o.toFixed(0)+"%":o}),r}},{key:"stackedBars",value:function(){var r=this.bar();return Ze(Ze({},r),{},{plotOptions:Ze(Ze({},r.plotOptions),{},{bar:Ze(Ze({},r.plotOptions.bar),{},{borderRadiusApplication:"end",borderRadiusWhenStacked:"last"})})})}},{key:"convertCatToNumeric",value:function(r){return r.xaxis.convertedCatToNumeric=!0,r}},{key:"convertCatToNumericXaxis",value:function(r,i,o){r.xaxis.type="numeric",r.xaxis.labels=r.xaxis.labels||{},r.xaxis.labels.formatter=r.xaxis.labels.formatter||function(h){return pe.isNumber(h)?Math.floor(h):h};var l=r.xaxis.labels.formatter,u=r.xaxis.categories&&r.xaxis.categories.length?r.xaxis.categories:r.labels;return o&&o.length&&(u=o.map(function(h){return Array.isArray(h)?h:String(h)})),u&&u.length&&(r.xaxis.labels.formatter=function(h){return pe.isNumber(h)?l(u[Math.floor(h)-1]):l(h)}),r.xaxis.categories=[],r.labels=[],r.xaxis.tickAmount=r.xaxis.tickAmount||"dataPoints",r}},{key:"bubble",value:function(){return{dataLabels:{style:{colors:["#fff"]}},tooltip:{shared:!1,intersect:!0},xaxis:{crosshairs:{width:0}},fill:{type:"solid",gradient:{shade:"light",inverse:!0,shadeIntensity:.55,opacityFrom:.4,opacityTo:.8}}}}},{key:"scatter",value:function(){return{dataLabels:{enabled:!1},tooltip:{shared:!1,intersect:!0},markers:{size:6,strokeWidth:1,hover:{sizeOffset:2}}}}},{key:"heatmap",value:function(){return{chart:{stacked:!1},fill:{opacity:1},dataLabels:{style:{colors:["#fff"]}},stroke:{colors:["#fff"]},tooltip:{followCursor:!0,marker:{show:!1},x:{show:!1}},legend:{position:"top",markers:{shape:"square",size:10,offsetY:2}},grid:{padding:{right:20}}}}},{key:"treemap",value:function(){return{chart:{zoom:{enabled:!1}},dataLabels:{style:{fontSize:14,fontWeight:600,colors:["#fff"]}},stroke:{show:!0,width:2,colors:["#fff"]},legend:{show:!1},fill:{opacity:1,gradient:{stops:[0,100]}},tooltip:{followCursor:!0,x:{show:!1}},grid:{padding:{left:0,right:0}},xaxis:{crosshairs:{show:!1},tooltip:{enabled:!1}}}}},{key:"pie",value:function(){return{chart:{toolbar:{show:!1}},plotOptions:{pie:{donut:{labels:{show:!1}}}},dataLabels:{formatter:function(r){return r.toFixed(1)+"%"},style:{colors:["#fff"]},background:{enabled:!1},dropShadow:{enabled:!0}},stroke:{colors:["#fff"]},fill:{opacity:1,gradient:{shade:"light",stops:[0,100]}},tooltip:{theme:"dark",fillSeriesColor:!0},legend:{position:"right"}}}},{key:"donut",value:function(){return{chart:{toolbar:{show:!1}},dataLabels:{formatter:function(r){return r.toFixed(1)+"%"},style:{colors:["#fff"]},background:{enabled:!1},dropShadow:{enabled:!0}},stroke:{colors:["#fff"]},fill:{opacity:1,gradient:{shade:"light",shadeIntensity:.35,stops:[80,100],opacityFrom:1,opacityTo:1}},tooltip:{theme:"dark",fillSeriesColor:!0},legend:{position:"right"}}}},{key:"polarArea",value:function(){return{chart:{toolbar:{show:!1}},dataLabels:{formatter:function(r){return r.toFixed(1)+"%"},enabled:!1},stroke:{show:!0,width:2},fill:{opacity:.7},tooltip:{theme:"dark",fillSeriesColor:!0},legend:{position:"right"}}}},{key:"radar",value:function(){return this.opts.yaxis[0].labels.offsetY=this.opts.yaxis[0].labels.offsetY?this.opts.yaxis[0].labels.offsetY:6,{dataLabels:{enabled:!1,style:{fontSize:"11px"}},stroke:{width:2},markers:{size:3,strokeWidth:1,strokeOpacity:1},fill:{opacity:.2},tooltip:{shared:!1,intersect:!0,followCursor:!0},grid:{show:!1},xaxis:{labels:{formatter:function(r){return r},style:{colors:["#a8a8a8"],fontSize:"11px"}},tooltip:{enabled:!1},crosshairs:{show:!1}}}}},{key:"radialBar",value:function(){return{chart:{animations:{dynamicAnimation:{enabled:!0,speed:800}},toolbar:{show:!1}},fill:{gradient:{shade:"dark",shadeIntensity:.4,inverseColors:!1,type:"diagonal2",opacityFrom:1,opacityTo:1,stops:[70,98,100]}},legend:{show:!1,position:"right"},tooltip:{enabled:!1,fillSeriesColor:!0}}}},{key:"_getBoxTooltip",value:function(r,i,o,l,u){var h=r.globals.seriesCandleO[i][o],p=r.globals.seriesCandleH[i][o],v=r.globals.seriesCandleM[i][o],y=r.globals.seriesCandleL[i][o],C=r.globals.seriesCandleC[i][o];return r.config.series[i].type&&r.config.series[i].type!==u?'<div class="apexcharts-custom-tooltip">\n          '.concat(r.config.series[i].name?r.config.series[i].name:"series-"+(i+1),": <strong>").concat(r.globals.series[i][o],"</strong>\n        </div>"):'<div class="apexcharts-tooltip-box apexcharts-tooltip-'.concat(r.config.chart.type,'">')+"<div>".concat(l[0],': <span class="value">')+h+"</span></div>"+"<div>".concat(l[1],': <span class="value">')+p+"</span></div>"+(v?"<div>".concat(l[2],': <span class="value">')+v+"</span></div>":"")+"<div>".concat(l[3],': <span class="value">')+y+"</span></div>"+"<div>".concat(l[4],': <span class="value">')+C+"</span></div></div>"}}]),P}(),Je=function(){function P(r){F(this,P),this.opts=r}return me(P,[{key:"init",value:function(r){var i=r.responsiveOverride,o=this.opts,l=new Lr,u=new Nn(o);this.chartType=o.chart.type,o=this.extendYAxis(o),o=this.extendAnnotations(o);var h=l.init(),p={};if(o&&"object"===ut(o)){var v,y,C,k,S,R,N,B,U,j,K={};K=-1!==["line","area","bar","candlestick","boxPlot","rangeBar","rangeArea","bubble","scatter","heatmap","treemap","pie","polarArea","donut","radar","radialBar"].indexOf(o.chart.type)?u[o.chart.type]():u.line(),null!==(v=o.plotOptions)&&void 0!==v&&null!==(y=v.bar)&&void 0!==y&&y.isFunnel&&(K=u.funnel()),o.chart.stacked&&"bar"===o.chart.type&&(K=u.stackedBars()),null!==(C=o.chart.brush)&&void 0!==C&&C.enabled&&(K=u.brush(K)),null!==(k=o.plotOptions)&&void 0!==k&&null!==(S=k.line)&&void 0!==S&&S.isSlopeChart&&(K=u.slope()),o.chart.stacked&&"100%"===o.chart.stackType&&(o=u.stacked100(o)),null!==(R=o.plotOptions)&&void 0!==R&&null!==(N=R.bar)&&void 0!==N&&N.isDumbbell&&(o=u.dumbbell(o)),this.checkForDarkTheme(window.Apex),this.checkForDarkTheme(o),o.xaxis=o.xaxis||window.Apex.xaxis||{},i||(o.xaxis.convertedCatToNumeric=!1),(null!==(B=(o=this.checkForCatToNumericXAxis(this.chartType,K,o)).chart.sparkline)&&void 0!==B&&B.enabled||null!==(U=window.Apex.chart)&&void 0!==U&&null!==(j=U.sparkline)&&void 0!==j&&j.enabled)&&(K=u.sparkline(K)),p=pe.extend(h,K)}var x=pe.extend(p,window.Apex);return h=pe.extend(x,o),this.handleUserInputErrors(h)}},{key:"checkForCatToNumericXAxis",value:function(r,i,o){var l,u,h=new Nn(o);return("bar"===r||"boxPlot"===r)&&(null===(l=o.plotOptions)||void 0===l||null===(u=l.bar)||void 0===u?void 0:u.horizontal)||"pie"===r||"polarArea"===r||"donut"===r||"radar"===r||"radialBar"===r||"heatmap"===r||!("datetime"!==o.xaxis.type&&"numeric"!==o.xaxis.type)||"between"===(o.xaxis.tickPlacement?o.xaxis.tickPlacement:i.xaxis&&i.xaxis.tickPlacement)||(o=h.convertCatToNumeric(o)),o}},{key:"extendYAxis",value:function(r,i){var o=new Lr;(void 0===r.yaxis||!r.yaxis||Array.isArray(r.yaxis)&&0===r.yaxis.length)&&(r.yaxis={}),r.yaxis.constructor!==Array&&window.Apex.yaxis&&window.Apex.yaxis.constructor!==Array&&(r.yaxis=pe.extend(r.yaxis,window.Apex.yaxis)),r.yaxis=r.yaxis.constructor!==Array?[pe.extend(o.yAxis,r.yaxis)]:pe.extendArray(r.yaxis,o.yAxis);var l=!1;r.yaxis.forEach(function(h){h.logarithmic&&(l=!0)});var u=r.series;return i&&!u&&(u=i.config.series),l&&u.length!==r.yaxis.length&&u.length&&(r.yaxis=u.map(function(h,p){if(h.name||(u[p].name="series-".concat(p+1)),r.yaxis[p])return r.yaxis[p].seriesName=u[p].name,r.yaxis[p];var v=pe.extend(o.yAxis,r.yaxis[0]);return v.show=!1,v})),l&&u.length>1&&u.length!==r.yaxis.length&&console.warn("A multi-series logarithmic chart should have equal number of series and y-axes"),r}},{key:"extendAnnotations",value:function(r){return void 0===r.annotations&&(r.annotations={},r.annotations.yaxis=[],r.annotations.xaxis=[],r.annotations.points=[]),r=this.extendYAxisAnnotations(r),r=this.extendXAxisAnnotations(r),this.extendPointAnnotations(r)}},{key:"extendYAxisAnnotations",value:function(r){var i=new Lr;return r.annotations.yaxis=pe.extendArray(void 0!==r.annotations.yaxis?r.annotations.yaxis:[],i.yAxisAnnotation),r}},{key:"extendXAxisAnnotations",value:function(r){var i=new Lr;return r.annotations.xaxis=pe.extendArray(void 0!==r.annotations.xaxis?r.annotations.xaxis:[],i.xAxisAnnotation),r}},{key:"extendPointAnnotations",value:function(r){var i=new Lr;return r.annotations.points=pe.extendArray(void 0!==r.annotations.points?r.annotations.points:[],i.pointAnnotation),r}},{key:"checkForDarkTheme",value:function(r){r.theme&&"dark"===r.theme.mode&&(r.tooltip||(r.tooltip={}),"light"!==r.tooltip.theme&&(r.tooltip.theme="dark"),r.chart.foreColor||(r.chart.foreColor="#f6f7f8"),r.chart.background||(r.chart.background="#424242"),r.theme.palette||(r.theme.palette="palette4"))}},{key:"handleUserInputErrors",value:function(r){var i=r;if(i.tooltip.shared&&i.tooltip.intersect)throw new Error("tooltip.shared cannot be enabled when tooltip.intersect is true. Turn off any other option by setting it to false.");if("bar"===i.chart.type&&i.plotOptions.bar.horizontal){if(i.yaxis.length>1)throw new Error("Multiple Y Axis for bars are not supported. Switch to column chart by setting plotOptions.bar.horizontal=false");i.yaxis[0].reversed&&(i.yaxis[0].opposite=!0),i.xaxis.tooltip.enabled=!1,i.yaxis[0].tooltip.enabled=!1,i.chart.zoom.enabled=!1}return"bar"!==i.chart.type&&"rangeBar"!==i.chart.type||i.tooltip.shared&&"barWidth"===i.xaxis.crosshairs.width&&i.series.length>1&&(i.xaxis.crosshairs.width="tickWidth"),"candlestick"!==i.chart.type&&"boxPlot"!==i.chart.type||i.yaxis[0].reversed&&(console.warn("Reversed y-axis in ".concat(i.chart.type," chart is not supported.")),i.yaxis[0].reversed=!1),i}}]),P}(),Ai=function(){function P(){F(this,P)}return me(P,[{key:"initGlobalVars",value:function(r){r.series=[],r.seriesCandleO=[],r.seriesCandleH=[],r.seriesCandleM=[],r.seriesCandleL=[],r.seriesCandleC=[],r.seriesRangeStart=[],r.seriesRangeEnd=[],r.seriesRange=[],r.seriesPercent=[],r.seriesGoals=[],r.seriesX=[],r.seriesZ=[],r.seriesNames=[],r.seriesTotals=[],r.seriesLog=[],r.seriesColors=[],r.stackedSeriesTotals=[],r.seriesXvalues=[],r.seriesYvalues=[],r.labels=[],r.hasXaxisGroups=!1,r.groups=[],r.barGroups=[],r.lineGroups=[],r.areaGroups=[],r.hasSeriesGroups=!1,r.seriesGroups=[],r.categoryLabels=[],r.timescaleLabels=[],r.noLabelsProvided=!1,r.resizeTimer=null,r.selectionResizeTimer=null,r.delayedElements=[],r.pointsArray=[],r.dataLabelsRects=[],r.isXNumeric=!1,r.skipLastTimelinelabel=!1,r.skipFirstTimelinelabel=!1,r.isDataXYZ=!1,r.isMultiLineX=!1,r.isMultipleYAxis=!1,r.maxY=-Number.MAX_VALUE,r.minY=Number.MIN_VALUE,r.minYArr=[],r.maxYArr=[],r.maxX=-Number.MAX_VALUE,r.minX=Number.MAX_VALUE,r.initialMaxX=-Number.MAX_VALUE,r.initialMinX=Number.MAX_VALUE,r.maxDate=0,r.minDate=Number.MAX_VALUE,r.minZ=Number.MAX_VALUE,r.maxZ=-Number.MAX_VALUE,r.minXDiff=Number.MAX_VALUE,r.yAxisScale=[],r.xAxisScale=null,r.xAxisTicksPositions=[],r.yLabelsCoords=[],r.yTitleCoords=[],r.barPadForNumericAxis=0,r.padHorizontal=0,r.xRange=0,r.yRange=[],r.zRange=0,r.dataPoints=0,r.xTickAmount=0,r.multiAxisTickAmount=0}},{key:"globalVars",value:function(r){return{chartID:null,cuid:null,events:{beforeMount:[],mounted:[],updated:[],clicked:[],selection:[],dataPointSelection:[],zoomed:[],scrolled:[]},colors:[],clientX:null,clientY:null,fill:{colors:[]},stroke:{colors:[]},dataLabels:{style:{colors:[]}},radarPolygons:{fill:{colors:[]}},markers:{colors:[],size:r.markers.size,largestSize:0},animationEnded:!1,isTouchDevice:"ontouchstart"in window||navigator.msMaxTouchPoints,isDirty:!1,isExecCalled:!1,initialConfig:null,initialSeries:[],lastXAxis:[],lastYAxis:[],columnSeries:null,labels:[],timescaleLabels:[],noLabelsProvided:!1,allSeriesCollapsed:!1,collapsedSeries:[],collapsedSeriesIndices:[],ancillaryCollapsedSeries:[],ancillaryCollapsedSeriesIndices:[],risingSeries:[],dataFormatXNumeric:!1,capturedSeriesIndex:-1,capturedDataPointIndex:-1,selectedDataPoints:[],goldenPadding:35,invalidLogScale:!1,ignoreYAxisIndexes:[],maxValsInArrayIndex:0,radialSize:0,selection:void 0,zoomEnabled:"zoom"===r.chart.toolbar.autoSelected&&r.chart.toolbar.tools.zoom&&r.chart.zoom.enabled,panEnabled:"pan"===r.chart.toolbar.autoSelected&&r.chart.toolbar.tools.pan,selectionEnabled:"selection"===r.chart.toolbar.autoSelected&&r.chart.toolbar.tools.selection,yaxis:null,mousedown:!1,lastClientPosition:{},visibleXRange:void 0,yValueDecimal:0,total:0,SVGNS:"http://www.w3.org/2000/svg",svgWidth:0,svgHeight:0,noData:!1,locale:{},dom:{},memory:{methodsToExec:[]},shouldAnimate:!0,skipLastTimelinelabel:!1,skipFirstTimelinelabel:!1,delayedElements:[],axisCharts:!0,isDataXYZ:!1,isSlopeChart:r.plotOptions.line.isSlopeChart,resized:!1,resizeTimer:null,comboCharts:!1,dataChanged:!1,previousPaths:[],allSeriesHasEqualX:!0,pointsArray:[],dataLabelsRects:[],lastDrawnDataLabelsIndexes:[],hasNullValues:!1,easing:null,zoomed:!1,gridWidth:0,gridHeight:0,rotateXLabels:!1,defaultLabels:!1,xLabelFormatter:void 0,yLabelFormatters:[],xaxisTooltipFormatter:void 0,ttKeyFormatter:void 0,ttVal:void 0,ttZFormatter:void 0,LINE_HEIGHT_RATIO:1.618,xAxisLabelsHeight:0,xAxisGroupLabelsHeight:0,xAxisLabelsWidth:0,yAxisLabelsWidth:0,scaleX:1,scaleY:1,translateX:0,translateY:0,translateYAxisX:[],yAxisWidths:[],translateXAxisY:0,translateXAxisX:0,tooltip:null,niceScaleAllowedMagMsd:[[1,1,2,5,5,5,10,10,10,10,10],[1,1,2,5,5,5,10,10,10,10,10]],niceScaleDefaultTicks:[1,2,4,4,6,6,6,6,6,6,6,6,6,6,6,6,6,6,12,12,12,12,12,12,12,12,12,24],seriesYAxisMap:[],seriesYAxisReverseMap:[]}}},{key:"init",value:function(r){var i=this.globalVars(r);return this.initGlobalVars(i),i.initialConfig=pe.extend({},r),i.initialSeries=pe.clone(r.series),i.lastXAxis=pe.clone(i.initialConfig.xaxis),i.lastYAxis=pe.clone(i.initialConfig.yaxis),i}}]),P}(),la=function(){function P(r){F(this,P),this.opts=r}return me(P,[{key:"init",value:function(){var r=new Je(this.opts).init({responsiveOverride:!1});return{config:r,globals:(new Ai).init(r)}}}]),P}(),Fr=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w,this.opts=null,this.seriesIndex=0}return me(P,[{key:"clippedImgArea",value:function(r){var i=this.w,o=i.config,l=parseInt(i.globals.gridWidth,10),u=parseInt(i.globals.gridHeight,10),h=l>u?l:u,p=r.image,v=0,y=0;void 0===r.width&&void 0===r.height?void 0!==o.fill.image.width&&void 0!==o.fill.image.height?(v=o.fill.image.width+1,y=o.fill.image.height):(v=h+1,y=h):(v=r.width,y=r.height);var C=document.createElementNS(i.globals.SVGNS,"pattern");Ke.setAttrs(C,{id:r.patternID,patternUnits:r.patternUnits?r.patternUnits:"userSpaceOnUse",width:v+"px",height:y+"px"});var k=document.createElementNS(i.globals.SVGNS,"image");C.appendChild(k),k.setAttributeNS(window.SVG.xlink,"href",p),Ke.setAttrs(k,{x:0,y:0,preserveAspectRatio:"none",width:v+"px",height:y+"px"}),k.style.opacity=r.opacity,i.globals.dom.elDefs.node.appendChild(C)}},{key:"getSeriesIndex",value:function(r){var i=this.w,o=i.config.chart.type;return this.seriesIndex=("bar"===o||"rangeBar"===o)&&i.config.plotOptions.bar.distributed||"heatmap"===o||"treemap"===o?r.seriesNumber:r.seriesNumber%i.globals.series.length,this.seriesIndex}},{key:"fillPath",value:function(r){var i=this.w;this.opts=r;var o,l,u,h=this.w.config;this.seriesIndex=this.getSeriesIndex(r);var p=this.getFillColors()[this.seriesIndex];void 0!==i.globals.seriesColors[this.seriesIndex]&&(p=i.globals.seriesColors[this.seriesIndex]),"function"==typeof p&&(p=p({seriesIndex:this.seriesIndex,dataPointIndex:r.dataPointIndex,value:r.value,w:i}));var v=r.fillType?r.fillType:this.getFillType(this.seriesIndex),y=Array.isArray(h.fill.opacity)?h.fill.opacity[this.seriesIndex]:h.fill.opacity;r.color&&(p=r.color),p||(p="#fff",console.warn("undefined color - ApexCharts"));var C=p;if(-1===p.indexOf("rgb")?p.length<9&&(C=pe.hexToRgba(p,y)):p.indexOf("rgba")>-1&&(y=pe.getOpacityFromRGBA(p)),r.opacity&&(y=r.opacity),"pattern"===v&&(l=this.handlePatternFill({fillConfig:r.fillConfig,patternFill:l,fillColor:p,fillOpacity:y,defaultColor:C})),"gradient"===v&&(u=this.handleGradientFill({fillConfig:r.fillConfig,fillColor:p,fillOpacity:y,i:this.seriesIndex})),"image"===v){var k=h.fill.image.src,S=r.patternID?r.patternID:"";this.clippedImgArea({opacity:y,image:Array.isArray(k)?r.seriesNumber<k.length?k[r.seriesNumber]:k[0]:k,width:r.width?r.width:void 0,height:r.height?r.height:void 0,patternUnits:r.patternUnits,patternID:"pattern".concat(i.globals.cuid).concat(r.seriesNumber+1).concat(S)}),o="url(#pattern".concat(i.globals.cuid).concat(r.seriesNumber+1).concat(S,")")}else o="gradient"===v?u:"pattern"===v?l:C;return r.solid&&(o=C),o}},{key:"getFillType",value:function(r){var i=this.w;return Array.isArray(i.config.fill.type)?i.config.fill.type[r]:i.config.fill.type}},{key:"getFillColors",value:function(){var r=this.w,i=r.config,o=this.opts,l=[];return r.globals.comboCharts?"line"===r.config.series[this.seriesIndex].type?Array.isArray(r.globals.stroke.colors)?l=r.globals.stroke.colors:l.push(r.globals.stroke.colors):Array.isArray(r.globals.fill.colors)?l=r.globals.fill.colors:l.push(r.globals.fill.colors):"line"===i.chart.type?Array.isArray(r.globals.stroke.colors)?l=r.globals.stroke.colors:l.push(r.globals.stroke.colors):Array.isArray(r.globals.fill.colors)?l=r.globals.fill.colors:l.push(r.globals.fill.colors),void 0!==o.fillColors&&(l=[],Array.isArray(o.fillColors)?l=o.fillColors.slice():l.push(o.fillColors)),l}},{key:"handlePatternFill",value:function(r){var i=r.fillConfig,l=r.fillColor,u=r.fillOpacity,h=r.defaultColor,p=this.w.config.fill;i&&(p=i);var v=this.opts,y=new Ke(this.ctx),C=Array.isArray(p.pattern.strokeWidth)?p.pattern.strokeWidth[this.seriesIndex]:p.pattern.strokeWidth,k=l;return Array.isArray(p.pattern.style)?void 0!==p.pattern.style[v.seriesNumber]?y.drawPattern(p.pattern.style[v.seriesNumber],p.pattern.width,p.pattern.height,k,C,u):h:y.drawPattern(p.pattern.style,p.pattern.width,p.pattern.height,k,C,u)}},{key:"handleGradientFill",value:function(r){var i=r.fillColor,o=r.fillOpacity,l=r.fillConfig,u=r.i,h=this.w.config.fill;l&&(h=Ze(Ze({},h),l));var p,v=this.opts,y=new Ke(this.ctx),C=new pe,k=h.gradient.type,S=i,R=void 0===h.gradient.opacityFrom?o:Array.isArray(h.gradient.opacityFrom)?h.gradient.opacityFrom[u]:h.gradient.opacityFrom;S.indexOf("rgba")>-1&&(R=pe.getOpacityFromRGBA(S));var N=void 0===h.gradient.opacityTo?o:Array.isArray(h.gradient.opacityTo)?h.gradient.opacityTo[u]:h.gradient.opacityTo;if(void 0===h.gradient.gradientToColors||0===h.gradient.gradientToColors.length)p=C.shadeColor("dark"===h.gradient.shade?-1*parseFloat(h.gradient.shadeIntensity):parseFloat(h.gradient.shadeIntensity),i.indexOf("rgb")>-1?pe.rgb2hex(i):i);else if(h.gradient.gradientToColors[v.seriesNumber]){var B=h.gradient.gradientToColors[v.seriesNumber];p=B,B.indexOf("rgba")>-1&&(N=pe.getOpacityFromRGBA(B))}else p=i;if(h.gradient.gradientFrom&&(S=h.gradient.gradientFrom),h.gradient.gradientTo&&(p=h.gradient.gradientTo),h.gradient.inverseColors){var U=S;S=p,p=U}return S.indexOf("rgb")>-1&&(S=pe.rgb2hex(S)),p.indexOf("rgb")>-1&&(p=pe.rgb2hex(p)),y.drawGradient(k,S,p,R,N,v.size,h.gradient.stops,h.gradient.colorStops,u)}}]),P}(),Rr=function(){function P(r,i){F(this,P),this.ctx=r,this.w=r.w}return me(P,[{key:"setGlobalMarkerSize",value:function(){var r=this.w;if(r.globals.markers.size=Array.isArray(r.config.markers.size)?r.config.markers.size:[r.config.markers.size],r.globals.markers.size.length>0){if(r.globals.markers.size.length<r.globals.series.length+1)for(var i=0;i<=r.globals.series.length;i++)void 0===r.globals.markers.size[i]&&r.globals.markers.size.push(r.globals.markers.size[0])}else r.globals.markers.size=r.config.series.map(function(o){return r.config.markers.size})}},{key:"plotChartMarkers",value:function(r,i,o,l){var u,h=arguments.length>4&&void 0!==arguments[4]&&arguments[4],p=this.w,v=i,y=r,C=null,k=new Ke(this.ctx),S=p.config.markers.discrete&&p.config.markers.discrete.length;if((p.globals.markers.size[i]>0||h||S)&&(C=k.group({class:h||S?"":"apexcharts-series-markers"})).attr("clip-path","url(#gridRectMarkerMask".concat(p.globals.cuid,")")),Array.isArray(y.x))for(var R=0;R<y.x.length;R++){var N=o;1===o&&0===R&&(N=0),1===o&&1===R&&(N=1);var B="apexcharts-marker";if("line"!==p.config.chart.type&&"area"!==p.config.chart.type||p.globals.comboCharts||p.config.tooltip.intersect||(B+=" no-pointer-events"),(Array.isArray(p.config.markers.size)?p.globals.markers.size[i]>0:p.config.markers.size>0)||h||S){pe.isNumber(y.y[R])?B+=" w".concat(pe.randomId()):B="apexcharts-nullpoint";var U=this.getMarkerConfig({cssClass:B,seriesIndex:i,dataPointIndex:N});p.config.series[v].data[N]&&(p.config.series[v].data[N].fillColor&&(U.pointFillColor=p.config.series[v].data[N].fillColor),p.config.series[v].data[N].strokeColor&&(U.pointStrokeColor=p.config.series[v].data[N].strokeColor)),l&&(U.pSize=l),(y.x[R]<-p.globals.markers.largestSize||y.x[R]>p.globals.gridWidth+p.globals.markers.largestSize||y.y[R]<-p.globals.markers.largestSize||y.y[R]>p.globals.gridHeight+p.globals.markers.largestSize)&&(U.pSize=0),(u=k.drawMarker(y.x[R],y.y[R],U)).attr("rel",N),u.attr("j",N),u.attr("index",i),u.node.setAttribute("default-marker-size",U.pSize),new On(this.ctx).setSelectionFilter(u,i,N),this.addEvents(u),C&&C.add(u)}else void 0===p.globals.pointsArray[i]&&(p.globals.pointsArray[i]=[]),p.globals.pointsArray[i].push([y.x[R],y.y[R]])}return C}},{key:"getMarkerConfig",value:function(r){var i=r.cssClass,o=r.seriesIndex,l=r.dataPointIndex,u=void 0===l?null:l,h=r.finishRadius,p=void 0===h?null:h,v=this.w,y=this.getMarkerStyle(o),C=v.globals.markers.size[o],k=v.config.markers;return null!==u&&k.discrete.length&&k.discrete.map(function(S){S.seriesIndex===o&&S.dataPointIndex===u&&(y.pointStrokeColor=S.strokeColor,y.pointFillColor=S.fillColor,C=S.size,y.pointShape=S.shape)}),{pSize:null===p?C:p,pRadius:k.radius,width:Array.isArray(k.width)?k.width[o]:k.width,height:Array.isArray(k.height)?k.height[o]:k.height,pointStrokeWidth:Array.isArray(k.strokeWidth)?k.strokeWidth[o]:k.strokeWidth,pointStrokeColor:y.pointStrokeColor,pointFillColor:y.pointFillColor,shape:y.pointShape||(Array.isArray(k.shape)?k.shape[o]:k.shape),class:i,pointStrokeOpacity:Array.isArray(k.strokeOpacity)?k.strokeOpacity[o]:k.strokeOpacity,pointStrokeDashArray:Array.isArray(k.strokeDashArray)?k.strokeDashArray[o]:k.strokeDashArray,pointFillOpacity:Array.isArray(k.fillOpacity)?k.fillOpacity[o]:k.fillOpacity,seriesIndex:o}}},{key:"addEvents",value:function(r){var i=this.w,o=new Ke(this.ctx);r.node.addEventListener("mouseenter",o.pathMouseEnter.bind(this.ctx,r)),r.node.addEventListener("mouseleave",o.pathMouseLeave.bind(this.ctx,r)),r.node.addEventListener("mousedown",o.pathMouseDown.bind(this.ctx,r)),r.node.addEventListener("click",i.config.markers.onClick),r.node.addEventListener("dblclick",i.config.markers.onDblClick),r.node.addEventListener("touchstart",o.pathMouseDown.bind(this.ctx,r),{passive:!0})}},{key:"getMarkerStyle",value:function(r){var i=this.w,o=i.globals.markers.colors,l=i.config.markers.strokeColor||i.config.markers.strokeColors;return{pointStrokeColor:Array.isArray(l)?l[r]:l,pointFillColor:Array.isArray(o)?o[r]:o}}}]),P}(),Ui=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w,this.initialAnim=this.w.config.chart.animations.enabled,this.dynamicAnim=this.initialAnim&&this.w.config.chart.animations.dynamicAnimation.enabled}return me(P,[{key:"draw",value:function(r,i,o){var l=this.w,u=new Ke(this.ctx),h=o.realIndex,p=o.pointsPos,v=o.zRatio,y=o.elParent,C=u.group({class:"apexcharts-series-markers apexcharts-series-".concat(l.config.chart.type)});if(C.attr("clip-path","url(#gridRectMarkerMask".concat(l.globals.cuid,")")),Array.isArray(p.x))for(var k=0;k<p.x.length;k++){var S=i+1,R=!0;0===i&&0===k&&(S=0),0===i&&1===k&&(S=1);var N=0,B=l.globals.markers.size[h];if(v!==1/0){var U=l.config.plotOptions.bubble;B=l.globals.seriesZ[h][S],U.zScaling&&(B/=v),U.minBubbleRadius&&B<U.minBubbleRadius&&(B=U.minBubbleRadius),U.maxBubbleRadius&&B>U.maxBubbleRadius&&(B=U.maxBubbleRadius)}l.config.chart.animations.enabled||(N=B);var K=p.y[k];if(N=N||0,null!==K&&void 0!==l.globals.series[h][S]||(R=!1),R){var x=this.drawPoint(p.x[k],K,N,B,h,S,i);C.add(x)}y.add(C)}}},{key:"drawPoint",value:function(r,i,o,l,u,h,p){var v=this.w,y=u,C=new hi(this.ctx),k=new On(this.ctx),S=new Fr(this.ctx),R=new Rr(this.ctx),N=new Ke(this.ctx),B=R.getMarkerConfig({cssClass:"apexcharts-marker",seriesIndex:y,dataPointIndex:h,finishRadius:"bubble"===v.config.chart.type||v.globals.comboCharts&&v.config.series[u]&&"bubble"===v.config.series[u].type?l:null});l=B.pSize;var U,j=S.fillPath({seriesNumber:u,dataPointIndex:h,color:B.pointFillColor,patternUnits:"objectBoundingBox",value:v.globals.series[u][p]});if("circle"===B.shape?U=N.drawCircle(o):"square"!==B.shape&&"rect"!==B.shape||(U=N.drawRect(0,0,B.width-B.pointStrokeWidth/2,B.height-B.pointStrokeWidth/2,B.pRadius)),v.config.series[y].data[h]&&v.config.series[y].data[h].fillColor&&(j=v.config.series[y].data[h].fillColor),U.attr({x:r-B.width/2-B.pointStrokeWidth/2,y:i-B.height/2-B.pointStrokeWidth/2,cx:r,cy:i,fill:j,"fill-opacity":B.pointFillOpacity,stroke:B.pointStrokeColor,r:l,"stroke-width":B.pointStrokeWidth,"stroke-dasharray":B.pointStrokeDashArray,"stroke-opacity":B.pointStrokeOpacity}),v.config.chart.dropShadow.enabled&&k.dropShadow(U,v.config.chart.dropShadow,u),!this.initialAnim||v.globals.dataChanged||v.globals.resized?v.globals.animationEnded=!0:C.animateMarker(U,0,"circle"===B.shape?l:{width:B.width,height:B.height},v.config.chart.animations.speed,v.globals.easing,function(){window.setTimeout(function(){C.animationCompleted(U)},100)}),v.globals.dataChanged&&"circle"===B.shape)if(this.dynamicAnim){var I,W,q,J,ne=v.config.chart.animations.dynamicAnimation.speed;null!=(J=v.globals.previousPaths[u]&&v.globals.previousPaths[u][p])&&(I=J.x,W=J.y,q=void 0!==J.r?J.r:l);for(var ve=0;ve<v.globals.collapsedSeries.length;ve++)v.globals.collapsedSeries[ve].index===u&&(ne=1,l=0);0===r&&0===i&&(l=0),C.animateCircle(U,{cx:I,cy:W,r:q},{cx:r,cy:i,r:l},ne,v.globals.easing)}else U.attr({r:l});return U.attr({rel:h,j:h,index:u,"default-marker-size":l}),k.setSelectionFilter(U,u,h),R.addEvents(U),U.node.classList.add("apexcharts-marker"),U}},{key:"centerTextInBubble",value:function(r){return{y:r+=parseInt(this.w.config.dataLabels.style.fontSize,10)/4}}}]),P}(),wn=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w}return me(P,[{key:"dataLabelsCorrection",value:function(r,i,o,l,u,h,p){var v=this.w,y=!1,C=new Ke(this.ctx).getTextRects(o,p),k=C.width,S=C.height;if(i<0&&(i=0),i>v.globals.gridHeight+S&&(i=v.globals.gridHeight+S/2),void 0===v.globals.dataLabelsRects[l]&&(v.globals.dataLabelsRects[l]=[]),v.globals.dataLabelsRects[l].push({x:r,y:i,width:k,height:S}),void 0!==v.globals.dataLabelsRects[l][v.globals.dataLabelsRects[l].length-2]){var B=v.globals.dataLabelsRects[l][void 0!==v.globals.lastDrawnDataLabelsIndexes[l]?v.globals.lastDrawnDataLabelsIndexes[l][v.globals.lastDrawnDataLabelsIndexes[l].length-1]:0];(r>B.x+B.width||i>B.y+B.height||i+S<B.y||r+k<B.x)&&(y=!0)}return(0===u||h)&&(y=!0),{x:r,y:i,textRects:C,drawnextLabel:y}}},{key:"drawDataLabel",value:function(r){var i=this,o=r.type,l=r.pos,u=r.i,h=r.j,p=r.isRangeStart,v=r.strokeWidth,y=void 0===v?2:v,C=this.w,k=new Ke(this.ctx),S=C.config.dataLabels,R=0,N=0,B=h,U=null;if(-1!==C.globals.collapsedSeriesIndices.indexOf(u)||!S.enabled||!Array.isArray(l.x))return U;U=k.group({class:"apexcharts-data-labels"});for(var j=0;j<l.x.length;j++)if(R=l.x[j]+S.offsetX,N=l.y[j]+S.offsetY+y,!isNaN(R)){1===h&&0===j&&(B=0),1===h&&1===j&&(B=1);var K=C.globals.series[u][B];"rangeArea"===o&&(K=p?C.globals.seriesRangeStart[u][B]:C.globals.seriesRangeEnd[u][B]);var x="",I=function(q){return C.config.dataLabels.formatter(q,{ctx:i.ctx,seriesIndex:u,dataPointIndex:B,w:C})};"bubble"===C.config.chart.type?(x=I(K=C.globals.seriesZ[u][B]),N=l.y[j],N=new Ui(this.ctx).centerTextInBubble(N,u,B).y):void 0!==K&&(x=I(K));var W=C.config.dataLabels.textAnchor;C.globals.isSlopeChart&&(W=0===B?"end":B===C.config.series[u].data.length-1?"start":"middle"),this.plotDataLabelsText({x:R,y:N,text:x,i:u,j:B,parent:U,offsetCorrection:!0,dataLabelsConfig:C.config.dataLabels,textAnchor:W})}return U}},{key:"plotDataLabelsText",value:function(r){var i=this.w,o=new Ke(this.ctx),l=r.x,u=r.y,h=r.i,p=r.j,v=r.text,y=r.textAnchor,C=r.fontSize,k=r.parent,S=r.dataLabelsConfig,R=r.color,N=r.alwaysDrawDataLabel,B=r.offsetCorrection,U=r.className,j=null;if(Array.isArray(i.config.dataLabels.enabledOnSeries)&&i.config.dataLabels.enabledOnSeries.indexOf(h)<0)return j;var K={x:l,y:u,drawnextLabel:!0,textRects:null};B&&(K=this.dataLabelsCorrection(l,u,v,h,p,N,parseInt(S.style.fontSize,10))),i.globals.zoomed||(l=K.x,u=K.y),K.textRects&&(l<-20-K.textRects.width||l>i.globals.gridWidth+K.textRects.width+30)&&(v="");var x=i.globals.dataLabels.style.colors[h];(("bar"===i.config.chart.type||"rangeBar"===i.config.chart.type)&&i.config.plotOptions.bar.distributed||i.config.dataLabels.distributed)&&(x=i.globals.dataLabels.style.colors[p]),"function"==typeof x&&(x=x({series:i.globals.series,seriesIndex:h,dataPointIndex:p,w:i})),R&&(x=R);var I=S.offsetX,W=S.offsetY;if("bar"!==i.config.chart.type&&"rangeBar"!==i.config.chart.type||(I=0,W=0),i.globals.isSlopeChart&&(0!==p&&(I=-2*S.offsetX+5),0!==p&&p!==i.config.series[h].data.length-1&&(I=0)),K.drawnextLabel){if((j=o.drawText({width:100,height:parseInt(S.style.fontSize,10),x:l+I,y:u+W,foreColor:x,textAnchor:y||S.textAnchor,text:v,fontSize:C||S.style.fontSize,fontFamily:S.style.fontFamily,fontWeight:S.style.fontWeight||"normal"})).attr({class:U||"apexcharts-datalabel",cx:l,cy:u}),S.dropShadow.enabled){var q=S.dropShadow;new On(this.ctx).dropShadow(j,q)}k.add(j),void 0===i.globals.lastDrawnDataLabelsIndexes[h]&&(i.globals.lastDrawnDataLabelsIndexes[h]=[]),i.globals.lastDrawnDataLabelsIndexes[h].push(p)}return j}},{key:"addBackgroundToDataLabel",value:function(r,i){var o=this.w,l=o.config.dataLabels.background,u=l.padding,h=l.padding/2,p=i.width,v=i.height,y=new Ke(this.ctx).drawRect(i.x-u,i.y-h/2,p+2*u,v+h,l.borderRadius,"transparent"===o.config.chart.background?"#fff":o.config.chart.background,l.opacity,l.borderWidth,l.borderColor);return l.dropShadow.enabled&&new On(this.ctx).dropShadow(y,l.dropShadow),y}},{key:"dataLabelsBackground",value:function(){var r=this.w;if("bubble"!==r.config.chart.type)for(var i=r.globals.dom.baseEl.querySelectorAll(".apexcharts-datalabels text"),o=0;o<i.length;o++){var l=i[o],u=l.getBBox(),h=null;if(u.width&&u.height&&(h=this.addBackgroundToDataLabel(l,u)),h){l.parentNode.insertBefore(h.node,l);var p=l.getAttribute("fill");!r.config.chart.animations.enabled||r.globals.resized||r.globals.dataChanged?h.attr({fill:p}):h.animate().attr({fill:p}),l.setAttribute("fill",r.config.dataLabels.background.foreColor)}}}},{key:"bringForward",value:function(){for(var r=this.w,i=r.globals.dom.baseEl.querySelectorAll(".apexcharts-datalabels"),o=r.globals.dom.baseEl.querySelector(".apexcharts-plot-series:last-child"),l=0;l<i.length;l++)o&&o.insertBefore(i[l],o.nextSibling)}}]),P}(),Dr=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w,this.legendInactiveClass="legend-mouseover-inactive"}return me(P,[{key:"getAllSeriesEls",value:function(){return this.w.globals.dom.baseEl.getElementsByClassName("apexcharts-series")}},{key:"getSeriesByName",value:function(r){return this.w.globals.dom.baseEl.querySelector(".apexcharts-inner .apexcharts-series[seriesName='".concat(pe.escapeString(r),"']"))}},{key:"isSeriesHidden",value:function(r){var i=this.getSeriesByName(r),o=parseInt(i.getAttribute("data:realIndex"),10);return{isHidden:i.classList.contains("apexcharts-series-collapsed"),realIndex:o}}},{key:"addCollapsedClassToSeries",value:function(r,i){var o=this.w;function l(u){for(var h=0;h<u.length;h++)u[h].index===i&&r.node.classList.add("apexcharts-series-collapsed")}l(o.globals.collapsedSeries),l(o.globals.ancillaryCollapsedSeries)}},{key:"toggleSeries",value:function(r){var i=this.isSeriesHidden(r);return this.ctx.legend.legendHelpers.toggleDataSeries(i.realIndex,i.isHidden),i.isHidden}},{key:"showSeries",value:function(r){var i=this.isSeriesHidden(r);i.isHidden&&this.ctx.legend.legendHelpers.toggleDataSeries(i.realIndex,!0)}},{key:"hideSeries",value:function(r){var i=this.isSeriesHidden(r);i.isHidden||this.ctx.legend.legendHelpers.toggleDataSeries(i.realIndex,!1)}},{key:"resetSeries",value:function(){var r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],l=this.w,u=pe.clone(l.globals.initialSeries);l.globals.previousPaths=[],o?(l.globals.collapsedSeries=[],l.globals.ancillaryCollapsedSeries=[],l.globals.collapsedSeriesIndices=[],l.globals.ancillaryCollapsedSeriesIndices=[]):u=this.emptyCollapsedSeries(u),l.config.series=u,r&&(i&&(l.globals.zoomed=!1,this.ctx.updateHelpers.revertDefaultAxisMinMax()),this.ctx.updateHelpers._updateSeries(u,l.config.chart.animations.dynamicAnimation.enabled))}},{key:"emptyCollapsedSeries",value:function(r){for(var i=this.w,o=0;o<r.length;o++)i.globals.collapsedSeriesIndices.indexOf(o)>-1&&(r[o].data=[]);return r}},{key:"toggleSeriesOnHover",value:function(r,i){var o=this.w;i||(i=r.target);var l=o.globals.dom.baseEl.querySelectorAll(".apexcharts-series, .apexcharts-datalabels, .apexcharts-yaxis");if("mousemove"===r.type){var u=parseInt(i.getAttribute("rel"),10)-1,h=null,p=null,v=null;o.globals.axisCharts||"radialBar"===o.config.chart.type?o.globals.axisCharts?(h=o.globals.dom.baseEl.querySelector(".apexcharts-series[data\\:realIndex='".concat(u,"']")),p=o.globals.dom.baseEl.querySelector(".apexcharts-datalabels[data\\:realIndex='".concat(u,"']")),v=o.globals.dom.baseEl.querySelector(".apexcharts-yaxis[rel='".concat(o.globals.seriesYAxisReverseMap[u],"']"))):h=o.globals.dom.baseEl.querySelector(".apexcharts-series[rel='".concat(u+1,"']")):h=o.globals.dom.baseEl.querySelector(".apexcharts-series[rel='".concat(u+1,"'] path"));for(var C=0;C<l.length;C++)l[C].classList.add(this.legendInactiveClass);null!==h&&(o.globals.axisCharts||h.parentNode.classList.remove(this.legendInactiveClass),h.classList.remove(this.legendInactiveClass),null!==p&&p.classList.remove(this.legendInactiveClass),null!==v&&v.classList.remove(this.legendInactiveClass))}else if("mouseout"===r.type)for(var k=0;k<l.length;k++)l[k].classList.remove(this.legendInactiveClass)}},{key:"highlightRangeInSeries",value:function(r,i){var o=this,l=this.w,u=l.globals.dom.baseEl.getElementsByClassName("apexcharts-heatmap-rect"),h=function(v){for(var y=0;y<u.length;y++)u[y].classList[v](o.legendInactiveClass)};if("mousemove"===r.type){var p=parseInt(i.getAttribute("rel"),10)-1;h("add"),function(v){for(var y=0;y<u.length;y++){var C=parseInt(u[y].getAttribute("val"),10);C>=v.from&&C<=v.to&&u[y].classList.remove(o.legendInactiveClass)}}(l.config.plotOptions.heatmap.colorScale.ranges[p])}else"mouseout"===r.type&&h("remove")}},{key:"getActiveConfigSeriesIndex",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"asc",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=this.w,l=0;if(o.config.series.length>1)for(var u=o.config.series.map(function(p,v){return p.data&&p.data.length>0&&-1===o.globals.collapsedSeriesIndices.indexOf(v)&&(!o.globals.comboCharts||0===i.length||i.length&&i.indexOf(o.config.series[v].type)>-1)?v:-1}),h="asc"===r?0:u.length-1;"asc"===r?h<u.length:h>=0;"asc"===r?h++:h--)if(-1!==u[h]){l=u[h];break}return l}},{key:"getBarSeriesIndices",value:function(){return this.w.globals.comboCharts?this.w.config.series.map(function(r,i){return"bar"===r.type||"column"===r.type?i:-1}).filter(function(r){return-1!==r}):this.w.config.series.map(function(r,i){return i})}},{key:"getPreviousPaths",value:function(){var r=this.w;function i(h,p,v){for(var y=h[p].childNodes,C={type:v,paths:[],realIndex:h[p].getAttribute("data:realIndex")},k=0;k<y.length;k++)if(y[k].hasAttribute("pathTo")){var S=y[k].getAttribute("pathTo");C.paths.push({d:S})}r.globals.previousPaths.push(C)}r.globals.previousPaths=[],["line","area","bar","rangebar","rangeArea","candlestick","radar"].forEach(function(h){for(var v=r.globals.dom.baseEl.querySelectorAll(".apexcharts-".concat(h,"-series .apexcharts-series")),y=0;y<v.length;y++)i(v,y,h)}),this.handlePrevBubbleScatterPaths("bubble"),this.handlePrevBubbleScatterPaths("scatter");var o=r.globals.dom.baseEl.querySelectorAll(".apexcharts-".concat(r.config.chart.type," .apexcharts-series"));if(o.length>0)for(var l=function(h){for(var p=r.globals.dom.baseEl.querySelectorAll(".apexcharts-".concat(r.config.chart.type," .apexcharts-series[data\\:realIndex='").concat(h,"'] rect")),v=[],y=function(k){var S=function(N){return p[k].getAttribute(N)},R={x:parseFloat(S("x")),y:parseFloat(S("y")),width:parseFloat(S("width")),height:parseFloat(S("height"))};v.push({rect:R,color:p[k].getAttribute("color")})},C=0;C<p.length;C++)y(C);r.globals.previousPaths.push(v)},u=0;u<o.length;u++)l(u);r.globals.axisCharts||(r.globals.previousPaths=r.globals.series)}},{key:"handlePrevBubbleScatterPaths",value:function(r){var i=this.w,o=i.globals.dom.baseEl.querySelectorAll(".apexcharts-".concat(r,"-series .apexcharts-series"));if(o.length>0)for(var l=0;l<o.length;l++){for(var u=i.globals.dom.baseEl.querySelectorAll(".apexcharts-".concat(r,"-series .apexcharts-series[data\\:realIndex='").concat(l,"'] circle")),h=[],p=0;p<u.length;p++)h.push({x:u[p].getAttribute("cx"),y:u[p].getAttribute("cy"),r:u[p].getAttribute("r")});i.globals.previousPaths.push(h)}}},{key:"clearPreviousPaths",value:function(){var r=this.w;r.globals.previousPaths=[],r.globals.allSeriesCollapsed=!1}},{key:"handleNoData",value:function(){var r=this.w,i=r.config.noData,o=new Ke(this.ctx),l=r.globals.svgWidth/2,u=r.globals.svgHeight/2,h="middle";if(r.globals.noData=!0,r.globals.animationEnded=!0,"left"===i.align?(l=10,h="start"):"right"===i.align&&(l=r.globals.svgWidth-10,h="end"),"top"===i.verticalAlign?u=50:"bottom"===i.verticalAlign&&(u=r.globals.svgHeight-50),l+=i.offsetX,u=u+parseInt(i.style.fontSize,10)+2+i.offsetY,void 0!==i.text&&""!==i.text){var p=o.drawText({x:l,y:u,text:i.text,textAnchor:h,fontSize:i.style.fontSize,fontFamily:i.style.fontFamily,foreColor:i.style.color,opacity:1,class:"apexcharts-text-nodata"});r.globals.dom.Paper.add(p)}}},{key:"setNullSeriesToZeroValues",value:function(r){for(var i=this.w,o=0;o<r.length;o++)if(0===r[o].length)for(var l=0;l<r[i.globals.maxValsInArrayIndex].length;l++)r[o].push(0);return r}},{key:"hasAllSeriesEqualX",value:function(){for(var r=!0,i=this.w,o=this.filteredSeriesX(),l=0;l<o.length-1;l++)if(o[l][0]!==o[l+1][0]){r=!1;break}return i.globals.allSeriesHasEqualX=r,r}},{key:"filteredSeriesX",value:function(){return this.w.globals.seriesX.map(function(i){return i.length>0?i:[]})}}]),P}(),Ot=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w,this.twoDSeries=[],this.threeDSeries=[],this.twoDSeriesX=[],this.seriesGoals=[],this.coreUtils=new yn(this.ctx)}return me(P,[{key:"isMultiFormat",value:function(){return this.isFormatXY()||this.isFormat2DArray()}},{key:"isFormatXY",value:function(){var r=this.w.config.series.slice(),i=new Dr(this.ctx);if(this.activeSeriesIndex=i.getActiveConfigSeriesIndex(),void 0!==r[this.activeSeriesIndex].data&&r[this.activeSeriesIndex].data.length>0&&null!==r[this.activeSeriesIndex].data[0]&&void 0!==r[this.activeSeriesIndex].data[0].x&&null!==r[this.activeSeriesIndex].data[0])return!0}},{key:"isFormat2DArray",value:function(){var r=this.w.config.series.slice(),i=new Dr(this.ctx);if(this.activeSeriesIndex=i.getActiveConfigSeriesIndex(),void 0!==r[this.activeSeriesIndex].data&&r[this.activeSeriesIndex].data.length>0&&null!=r[this.activeSeriesIndex].data[0]&&r[this.activeSeriesIndex].data[0].constructor===Array)return!0}},{key:"handleFormat2DArray",value:function(r,i){for(var o=this.w.config,l=this.w.globals,u="boxPlot"===o.chart.type||"boxPlot"===o.series[i].type,h=0;h<r[i].data.length;h++)if(void 0!==r[i].data[h][1]&&(Array.isArray(r[i].data[h][1])&&4===r[i].data[h][1].length&&!u?this.twoDSeries.push(pe.parseNumber(r[i].data[h][1][3])):this.twoDSeries.push(pe.parseNumber(r[i].data[h].length>=5?r[i].data[h][4]:r[i].data[h][1])),l.dataFormatXNumeric=!0),"datetime"===o.xaxis.type){var p=new Date(r[i].data[h][0]);p=new Date(p).getTime(),this.twoDSeriesX.push(p)}else this.twoDSeriesX.push(r[i].data[h][0]);for(var v=0;v<r[i].data.length;v++)void 0!==r[i].data[v][2]&&(this.threeDSeries.push(r[i].data[v][2]),l.isDataXYZ=!0)}},{key:"handleFormatXY",value:function(r,i){var o=this.w.config,l=this.w.globals,u=new Mn(this.ctx),h=i;l.collapsedSeriesIndices.indexOf(i)>-1&&(h=this.activeSeriesIndex);for(var p=0;p<r[i].data.length;p++)void 0!==r[i].data[p].y&&(Array.isArray(r[i].data[p].y)?this.twoDSeries.push(pe.parseNumber(r[i].data[p].y[r[i].data[p].y.length-1])):this.twoDSeries.push(pe.parseNumber(r[i].data[p].y))),void 0!==r[i].data[p].goals&&Array.isArray(r[i].data[p].goals)?(void 0===this.seriesGoals[i]&&(this.seriesGoals[i]=[]),this.seriesGoals[i].push(r[i].data[p].goals)):(void 0===this.seriesGoals[i]&&(this.seriesGoals[i]=[]),this.seriesGoals[i].push(null));for(var v=0;v<r[h].data.length;v++){var y="string"==typeof r[h].data[v].x,C=Array.isArray(r[h].data[v].x),k=!C&&!!u.isValidDate(r[h].data[v].x);y||k?y||o.xaxis.convertedCatToNumeric?"datetime"!==o.xaxis.type||l.isBarHorizontal&&l.isRangeData?(this.fallbackToCategory=!0,this.twoDSeriesX.push(r[h].data[v].x),isNaN(r[h].data[v].x)||"category"===this.w.config.xaxis.type||"string"==typeof r[h].data[v].x||(l.isXNumeric=!0)):this.twoDSeriesX.push(u.parseDate(r[h].data[v].x)):"datetime"===o.xaxis.type?this.twoDSeriesX.push(u.parseDate(r[h].data[v].x.toString())):(l.dataFormatXNumeric=!0,l.isXNumeric=!0,this.twoDSeriesX.push(parseFloat(r[h].data[v].x))):C?(this.fallbackToCategory=!0,this.twoDSeriesX.push(r[h].data[v].x)):(l.isXNumeric=!0,l.dataFormatXNumeric=!0,this.twoDSeriesX.push(r[h].data[v].x))}if(r[i].data[0]&&void 0!==r[i].data[0].z){for(var R=0;R<r[i].data.length;R++)this.threeDSeries.push(r[i].data[R].z);l.isDataXYZ=!0}}},{key:"handleRangeData",value:function(r,i){var o=this.w.globals,l={};return this.isFormat2DArray()?l=this.handleRangeDataFormat("array",r,i):this.isFormatXY()&&(l=this.handleRangeDataFormat("xy",r,i)),o.seriesRangeStart.push(void 0===l.start?[]:l.start),o.seriesRangeEnd.push(void 0===l.end?[]:l.end),o.seriesRange.push(l.rangeUniques),o.seriesRange.forEach(function(u,h){u&&u.forEach(function(p,v){p.y.forEach(function(y,C){for(var k=0;k<p.y.length;k++)C!==k&&y.y1<=p.y[k].y2&&p.y[k].y1<=y.y2&&(p.overlaps.indexOf(y.rangeName)<0&&p.overlaps.push(y.rangeName),p.overlaps.indexOf(p.y[k].rangeName)<0&&p.overlaps.push(p.y[k].rangeName))})})}),l}},{key:"handleCandleStickBoxData",value:function(r,i){var o=this.w.globals,l={};return this.isFormat2DArray()?l=this.handleCandleStickBoxDataFormat("array",r,i):this.isFormatXY()&&(l=this.handleCandleStickBoxDataFormat("xy",r,i)),o.seriesCandleO[i]=l.o,o.seriesCandleH[i]=l.h,o.seriesCandleM[i]=l.m,o.seriesCandleL[i]=l.l,o.seriesCandleC[i]=l.c,l}},{key:"handleRangeDataFormat",value:function(r,i,o){var l=[],u=[],h=i[o].data.filter(function(C,k,S){return k===S.findIndex(function(R){return R.x===C.x})}).map(function(C,k){return{x:C.x,overlaps:[],y:[]}});if("array"===r)for(var p=0;p<i[o].data.length;p++)Array.isArray(i[o].data[p])?(l.push(i[o].data[p][1][0]),u.push(i[o].data[p][1][1])):(l.push(i[o].data[p]),u.push(i[o].data[p]));else if("xy"===r)for(var v=function(C){var k=Array.isArray(i[o].data[C].y),S=pe.randomId(),R=i[o].data[C].x,N={y1:k?i[o].data[C].y[0]:i[o].data[C].y,y2:k?i[o].data[C].y[1]:i[o].data[C].y,rangeName:S};i[o].data[C].rangeName=S;var B=h.findIndex(function(U){return U.x===R});h[B].y.push(N),l.push(N.y1),u.push(N.y2)},y=0;y<i[o].data.length;y++)v(y);return{start:l,end:u,rangeUniques:h}}},{key:"handleCandleStickBoxDataFormat",value:function(r,i,o){var l=this.w,u="boxPlot"===l.config.chart.type||"boxPlot"===l.config.series[o].type,h=[],p=[],v=[],y=[],C=[];if("array"===r)if(u&&6===i[o].data[0].length||!u&&5===i[o].data[0].length)for(var k=0;k<i[o].data.length;k++)h.push(i[o].data[k][1]),p.push(i[o].data[k][2]),u?(v.push(i[o].data[k][3]),y.push(i[o].data[k][4]),C.push(i[o].data[k][5])):(y.push(i[o].data[k][3]),C.push(i[o].data[k][4]));else for(var S=0;S<i[o].data.length;S++)Array.isArray(i[o].data[S][1])&&(h.push(i[o].data[S][1][0]),p.push(i[o].data[S][1][1]),u?(v.push(i[o].data[S][1][2]),y.push(i[o].data[S][1][3]),C.push(i[o].data[S][1][4])):(y.push(i[o].data[S][1][2]),C.push(i[o].data[S][1][3])));else if("xy"===r)for(var R=0;R<i[o].data.length;R++)Array.isArray(i[o].data[R].y)&&(h.push(i[o].data[R].y[0]),p.push(i[o].data[R].y[1]),u?(v.push(i[o].data[R].y[2]),y.push(i[o].data[R].y[3]),C.push(i[o].data[R].y[4])):(y.push(i[o].data[R].y[2]),C.push(i[o].data[R].y[3])));return{o:h,h:p,m:v,l:y,c:C}}},{key:"parseDataAxisCharts",value:function(r){var i=this,l=this.w.config,u=this.w.globals,h=new Mn(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.ctx),p=l.labels.length>0?l.labels.slice():l.xaxis.categories.slice();u.isRangeBar="rangeBar"===l.chart.type&&u.isBarHorizontal,u.hasXaxisGroups="category"===l.xaxis.type&&l.xaxis.group.groups.length>0,u.hasXaxisGroups&&(u.groups=l.xaxis.group.groups),r.forEach(function(R,N){u.seriesNames.push(void 0!==R.name?R.name:"series-"+parseInt(N+1,10))}),this.coreUtils.setSeriesYAxisMappings();var v=[],y=gt(new Set(l.series.map(function(R){return R.group})));l.series.forEach(function(R,N){var B=y.indexOf(R.group);v[B]||(v[B]=[]),v[B].push(u.seriesNames[N])}),u.seriesGroups=v;for(var C=function(){for(var R=0;R<p.length;R++)if("string"==typeof p[R]){if(!h.isValidDate(p[R]))throw new Error("You have provided invalid Date format. Please provide a valid JavaScript Date");i.twoDSeriesX.push(h.parseDate(p[R]))}else i.twoDSeriesX.push(p[R])},k=0;k<r.length;k++){if(this.twoDSeries=[],this.twoDSeriesX=[],this.threeDSeries=[],void 0===r[k].data)return void console.error("It is a possibility that you may have not included 'data' property in series.");if("rangeBar"!==l.chart.type&&"rangeArea"!==l.chart.type&&"rangeBar"!==r[k].type&&"rangeArea"!==r[k].type||(u.isRangeData=!0,"rangeBar"!==l.chart.type&&"rangeArea"!==l.chart.type||this.handleRangeData(r,k)),this.isMultiFormat())this.isFormat2DArray()?this.handleFormat2DArray(r,k):this.isFormatXY()&&this.handleFormatXY(r,k),"candlestick"!==l.chart.type&&"candlestick"!==r[k].type&&"boxPlot"!==l.chart.type&&"boxPlot"!==r[k].type||this.handleCandleStickBoxData(r,k),u.series.push(this.twoDSeries),u.labels.push(this.twoDSeriesX),u.seriesX.push(this.twoDSeriesX),u.seriesGoals=this.seriesGoals,k!==this.activeSeriesIndex||this.fallbackToCategory||(u.isXNumeric=!0);else{"datetime"===l.xaxis.type?(u.isXNumeric=!0,C(),u.seriesX.push(this.twoDSeriesX)):"numeric"===l.xaxis.type&&(u.isXNumeric=!0,p.length>0&&(this.twoDSeriesX=p,u.seriesX.push(this.twoDSeriesX))),u.labels.push(this.twoDSeriesX);var S=r[k].data.map(function(R){return pe.parseNumber(R)});u.series.push(S)}u.seriesZ.push(this.threeDSeries),u.seriesColors.push(void 0!==r[k].color?r[k].color:void 0)}return this.w}},{key:"parseDataNonAxisCharts",value:function(r){var i=this.w.globals,o=this.w.config;i.series=r.slice(),i.seriesNames=o.labels.slice();for(var l=0;l<i.series.length;l++)void 0===i.seriesNames[l]&&i.seriesNames.push("series-"+(l+1));return this.w}},{key:"handleExternalLabelsData",value:function(r){var i=this.w.config,o=this.w.globals;i.xaxis.categories.length>0?o.labels=i.xaxis.categories:i.labels.length>0?o.labels=i.labels.slice():this.fallbackToCategory?(o.labels=o.labels[0],o.seriesRange.length&&(o.seriesRange.map(function(l){l.forEach(function(u){o.labels.indexOf(u.x)<0&&u.x&&o.labels.push(u.x)})}),o.labels=Array.from(new Set(o.labels.map(JSON.stringify)),JSON.parse)),i.xaxis.convertedCatToNumeric&&(new Nn(i).convertCatToNumericXaxis(i,this.ctx,o.seriesX[0]),this._generateExternalLabels(r))):this._generateExternalLabels(r)}},{key:"_generateExternalLabels",value:function(r){var i=this.w.globals,o=this.w.config,l=[];if(i.axisCharts){if(i.series.length>0)if(this.isFormatXY())for(var u=o.series.map(function(k,S){return k.data.filter(function(R,N,B){return B.findIndex(function(U){return U.x===R.x})===N})}),h=u.reduce(function(k,S,R,N){return N[k].length>S.length?k:R},0),p=0;p<u[h].length;p++)l.push(p+1);else for(var v=0;v<i.series[i.maxValsInArrayIndex].length;v++)l.push(v+1);i.seriesX=[];for(var y=0;y<r.length;y++)i.seriesX.push(l);this.w.globals.isBarHorizontal||(i.isXNumeric=!0)}if(0===l.length){l=i.axisCharts?[]:i.series.map(function(k,S){return S+1});for(var C=0;C<r.length;C++)i.seriesX.push(l)}i.labels=l,o.xaxis.convertedCatToNumeric&&(i.categoryLabels=l.map(function(k){return o.xaxis.labels.formatter(k)})),i.noLabelsProvided=!0}},{key:"parseData",value:function(r){var i=this.w,o=i.config,l=i.globals;if(this.excludeCollapsedSeriesInYAxis(),this.fallbackToCategory=!1,this.ctx.core.resetGlobals(),this.ctx.core.isMultipleY(),l.axisCharts?(this.parseDataAxisCharts(r),this.coreUtils.getLargestSeries()):this.parseDataNonAxisCharts(r),o.chart.stacked){var u=new Dr(this.ctx);l.series=u.setNullSeriesToZeroValues(l.series)}this.coreUtils.getSeriesTotals(),l.axisCharts&&(l.stackedSeriesTotals=this.coreUtils.getStackedSeriesTotals(),l.stackedSeriesTotalsByGroups=this.coreUtils.getStackedSeriesTotalsByGroups()),this.coreUtils.getPercentSeries(),l.dataFormatXNumeric||l.isXNumeric&&("numeric"!==o.xaxis.type||0!==o.labels.length||0!==o.xaxis.categories.length)||this.handleExternalLabelsData(r);for(var h=this.coreUtils.getCategoryLabels(l.labels),p=0;p<h.length;p++)if(Array.isArray(h[p])){l.isMultiLineX=!0;break}}},{key:"excludeCollapsedSeriesInYAxis",value:function(){var r=this.w,i=[];r.globals.seriesYAxisMap.forEach(function(o,l){var u=0;o.forEach(function(h){-1!==r.globals.collapsedSeriesIndices.indexOf(h)&&u++}),u>0&&u==o.length&&i.push(l)}),r.globals.ignoreYAxisIndexes=i.map(function(o){return o})}}]),P}(),Or=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w}return me(P,[{key:"scaleSvgNode",value:function(r,i){var o=parseFloat(r.getAttributeNS(null,"width")),l=parseFloat(r.getAttributeNS(null,"height"));r.setAttributeNS(null,"width",o*i),r.setAttributeNS(null,"height",l*i),r.setAttributeNS(null,"viewBox","0 0 "+o+" "+l)}},{key:"fixSvgStringForIe11",value:function(r){if(!pe.isIE11())return r.replace(/&nbsp;/g,"&#160;");var i=0,o=r.replace(/xmlns="http:\/\/www.w3.org\/2000\/svg"/g,function(l){return 2==++i?'xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.dev"':l});return(o=o.replace(/xmlns:NS\d+=""/g,"")).replace(/NS\d+:(\w+:\w+=")/g,"$1")}},{key:"getSvgString",value:function(r){null==r&&(r=1);var i=this.w.globals.dom.Paper.svg();if(1!==r){var o=this.w.globals.dom.Paper.node.cloneNode(!0);this.scaleSvgNode(o,r),i=(new XMLSerializer).serializeToString(o)}return this.fixSvgStringForIe11(i)}},{key:"cleanup",value:function(){var r=this.w,i=r.globals.dom.baseEl.getElementsByClassName("apexcharts-xcrosshairs"),o=r.globals.dom.baseEl.getElementsByClassName("apexcharts-ycrosshairs"),l=r.globals.dom.baseEl.querySelectorAll(".apexcharts-zoom-rect, .apexcharts-selection-rect");Array.prototype.forEach.call(l,function(u){u.setAttribute("width",0)}),i&&i[0]&&(i[0].setAttribute("x",-500),i[0].setAttribute("x1",-500),i[0].setAttribute("x2",-500)),o&&o[0]&&(o[0].setAttribute("y",-100),o[0].setAttribute("y1",-100),o[0].setAttribute("y2",-100))}},{key:"svgUrl",value:function(){this.cleanup();var r=this.getSvgString(),i=new Blob([r],{type:"image/svg+xml;charset=utf-8"});return URL.createObjectURL(i)}},{key:"dataURI",value:function(r){var i=this;return new Promise(function(o){var l=i.w,u=r?r.scale||r.width/l.globals.svgWidth:1;i.cleanup();var h=document.createElement("canvas");h.width=l.globals.svgWidth*u,h.height=parseInt(l.globals.dom.elWrap.style.height,10)*u;var p="transparent"===l.config.chart.background?"#fff":l.config.chart.background,v=h.getContext("2d");v.fillStyle=p,v.fillRect(0,0,h.width*u,h.height*u);var y=i.getSvgString(u);if(window.canvg&&pe.isIE11()){var C=window.canvg.Canvg.fromString(v,y,{ignoreClear:!0,ignoreDimensions:!0});C.start();var k=h.msToBlob();C.stop(),o({blob:k})}else{var S="data:image/svg+xml,"+encodeURIComponent(y),R=new Image;R.crossOrigin="anonymous",R.onload=function(){if(v.drawImage(R,0,0),h.msToBlob){var N=h.msToBlob();o({blob:N})}else{var B=h.toDataURL("image/png");o({imgURI:B})}},R.src=S}})}},{key:"exportToSVG",value:function(){this.triggerDownload(this.svgUrl(),this.w.config.chart.toolbar.export.svg.filename,".svg")}},{key:"exportToPng",value:function(){var r=this;this.dataURI().then(function(i){var o=i.imgURI,l=i.blob;l?navigator.msSaveOrOpenBlob(l,r.w.globals.chartID+".png"):r.triggerDownload(o,r.w.config.chart.toolbar.export.png.filename,".png")})}},{key:"exportToCSV",value:function(r){var i=this,o=r.series,l=r.fileName,u=r.columnDelimiter,h=void 0===u?",":u,p=r.lineDelimiter,v=void 0===p?"\n":p,y=this.w;o||(o=y.config.series);var C,k,S=[],R=[],N="",B=y.globals.series.map(function(q,J){return-1===y.globals.collapsedSeriesIndices.indexOf(J)?q:[]}),U=function(q){return"datetime"===y.config.xaxis.type&&String(q).length>=10},j=Math.max.apply(Math,gt(o.map(function(q){return q.data?q.data.length:0}))),K=new Ot(this.ctx),x=new mt(this.ctx),I=function(q){var J="";if(y.globals.axisCharts){if("category"===y.config.xaxis.type||y.config.xaxis.convertedCatToNumeric)if(y.globals.isBarHorizontal){var ne=y.globals.yLabelFormatters[0],ve=new Dr(i.ctx).getActiveConfigSeriesIndex();J=ne(y.globals.labels[q],{seriesIndex:ve,dataPointIndex:q,w:y})}else J=x.getLabel(y.globals.labels,y.globals.timescaleLabels,0,q).text;"datetime"===y.config.xaxis.type&&(y.config.xaxis.categories.length?J=y.config.xaxis.categories[q]:y.config.labels.length&&(J=y.config.labels[q]))}else J=y.config.labels[q];return null===J?"nullvalue":(Array.isArray(J)&&(J=J.join(" ")),pe.isNumber(J)?J:J.split(h).join(""))};S.push(y.config.chart.toolbar.export.csv.headerCategory),"boxPlot"===y.config.chart.type?(S.push("minimum"),S.push("q1"),S.push("median"),S.push("q3"),S.push("maximum")):"candlestick"===y.config.chart.type?(S.push("open"),S.push("high"),S.push("low"),S.push("close")):"rangeBar"===y.config.chart.type?(S.push("minimum"),S.push("maximum")):o.map(function(q,J){var ne=(q.name?q.name:"series-".concat(J))+"";y.globals.axisCharts&&S.push(ne.split(h).join("")?ne.split(h).join(""):"series-".concat(J))}),y.globals.axisCharts||(S.push(y.config.chart.toolbar.export.csv.headerValue),R.push(S.join(h))),y.globals.allSeriesHasEqualX||!y.globals.axisCharts||y.config.xaxis.categories.length||y.config.labels.length?o.map(function(q,J){y.globals.axisCharts?function(q,J){if(S.length&&0===J&&R.push(S.join(h)),q.data){q.data=q.data.length&&q.data||gt(Array(j)).map(function(){return""});for(var ne=0;ne<q.data.length;ne++){S=[];var ve=I(ne);if("nullvalue"!==ve){if(ve||(K.isFormatXY()?ve=o[J].data[ne].x:K.isFormat2DArray()&&(ve=o[J].data[ne]?o[J].data[ne][0]:"")),0===J){S.push(U(ve)?y.config.chart.toolbar.export.csv.dateFormatter(ve):pe.isNumber(ve)?ve:ve.split(h).join(""));for(var ge=0;ge<y.globals.series.length;ge++){var Le;K.isFormatXY()?S.push(null===(Le=o[ge].data[ne])||void 0===Le?void 0:Le.y):S.push(B[ge][ne])}}("candlestick"===y.config.chart.type||q.type&&"candlestick"===q.type)&&(S.pop(),S.push(y.globals.seriesCandleO[J][ne]),S.push(y.globals.seriesCandleH[J][ne]),S.push(y.globals.seriesCandleL[J][ne]),S.push(y.globals.seriesCandleC[J][ne])),("boxPlot"===y.config.chart.type||q.type&&"boxPlot"===q.type)&&(S.pop(),S.push(y.globals.seriesCandleO[J][ne]),S.push(y.globals.seriesCandleH[J][ne]),S.push(y.globals.seriesCandleM[J][ne]),S.push(y.globals.seriesCandleL[J][ne]),S.push(y.globals.seriesCandleC[J][ne])),"rangeBar"===y.config.chart.type&&(S.pop(),S.push(y.globals.seriesRangeStart[J][ne]),S.push(y.globals.seriesRangeEnd[J][ne])),S.length&&R.push(S.join(h))}}}}(q,J):((S=[]).push(y.globals.labels[J].split(h).join("")),S.push(B[J]),R.push(S.join(h)))}):(C=new Set,k={},o.forEach(function(q,J){q?.data.forEach(function(ne){var ve,ge;if(K.isFormatXY())ve=ne.x,ge=ne.y;else{if(!K.isFormat2DArray())return;ve=ne[0],ge=ne[1]}k[ve]||(k[ve]=Array(o.length).fill("")),k[ve][J]=ge,C.add(ve)})}),S.length&&R.push(S.join(h)),Array.from(C).sort().forEach(function(q){R.push([U(q)&&"datetime"===y.config.xaxis.type?y.config.chart.toolbar.export.csv.dateFormatter(q):pe.isNumber(q)?q:q.split(h).join(""),k[q].join(h)])})),N+=R.join(v),this.triggerDownload("data:text/csv; charset=utf-8,"+encodeURIComponent("\ufeff"+N),l||y.config.chart.toolbar.export.csv.filename,".csv")}},{key:"triggerDownload",value:function(r,i,o){var l=document.createElement("a");l.href=r,l.download=(i||this.w.globals.chartID)+o,document.body.appendChild(l),l.click(),document.body.removeChild(l)}}]),P}(),Pr=function(){function P(r,i){F(this,P),this.ctx=r,this.elgrid=i,this.w=r.w;var o=this.w;this.axesUtils=new mt(r),this.xaxisLabels=o.globals.labels.slice(),o.globals.timescaleLabels.length>0&&!o.globals.isBarHorizontal&&(this.xaxisLabels=o.globals.timescaleLabels.slice()),o.config.xaxis.overwriteCategories&&(this.xaxisLabels=o.config.xaxis.overwriteCategories),this.drawnLabels=[],this.drawnLabelsRects=[],this.offY="top"===o.config.xaxis.position?0:o.globals.gridHeight,this.offY=this.offY+o.config.xaxis.axisBorder.offsetY,this.isCategoryBarHorizontal="bar"===o.config.chart.type&&o.config.plotOptions.bar.horizontal,this.xaxisFontSize=o.config.xaxis.labels.style.fontSize,this.xaxisFontFamily=o.config.xaxis.labels.style.fontFamily,this.xaxisForeColors=o.config.xaxis.labels.style.colors,this.xaxisBorderWidth=o.config.xaxis.axisBorder.width,this.isCategoryBarHorizontal&&(this.xaxisBorderWidth=o.config.yaxis[0].axisBorder.width.toString()),this.xaxisBorderWidth=this.xaxisBorderWidth.indexOf("%")>-1?o.globals.gridWidth*parseInt(this.xaxisBorderWidth,10)/100:parseInt(this.xaxisBorderWidth,10),this.xaxisBorderHeight=o.config.xaxis.axisBorder.height,this.yaxis=o.config.yaxis[0]}return me(P,[{key:"drawXaxis",value:function(){var r=this.w,i=new Ke(this.ctx),o=i.group({class:"apexcharts-xaxis",transform:"translate(".concat(r.config.xaxis.offsetX,", ").concat(r.config.xaxis.offsetY,")")}),l=i.group({class:"apexcharts-xaxis-texts-g",transform:"translate(".concat(r.globals.translateXAxisX,", ").concat(r.globals.translateXAxisY,")")});o.add(l);for(var u=[],h=0;h<this.xaxisLabels.length;h++)u.push(this.xaxisLabels[h]);if(this.drawXAxisLabelAndGroup(!0,i,l,u,r.globals.isXNumeric,function(N,B){return B}),r.globals.hasXaxisGroups){var p=r.globals.groups;u=[];for(var v=0;v<p.length;v++)u.push(p[v].title);var y={};r.config.xaxis.group.style&&(y.xaxisFontSize=r.config.xaxis.group.style.fontSize,y.xaxisFontFamily=r.config.xaxis.group.style.fontFamily,y.xaxisForeColors=r.config.xaxis.group.style.colors,y.fontWeight=r.config.xaxis.group.style.fontWeight,y.cssClass=r.config.xaxis.group.style.cssClass),this.drawXAxisLabelAndGroup(!1,i,l,u,!1,function(N,B){return p[N].cols*B},y)}if(void 0!==r.config.xaxis.title.text){var C=i.group({class:"apexcharts-xaxis-title"}),k=i.drawText({x:r.globals.gridWidth/2+r.config.xaxis.title.offsetX,y:this.offY+parseFloat(this.xaxisFontSize)+("bottom"===r.config.xaxis.position?r.globals.xAxisLabelsHeight:-r.globals.xAxisLabelsHeight-10)+r.config.xaxis.title.offsetY,text:r.config.xaxis.title.text,textAnchor:"middle",fontSize:r.config.xaxis.title.style.fontSize,fontFamily:r.config.xaxis.title.style.fontFamily,fontWeight:r.config.xaxis.title.style.fontWeight,foreColor:r.config.xaxis.title.style.color,cssClass:"apexcharts-xaxis-title-text "+r.config.xaxis.title.style.cssClass});C.add(k),o.add(C)}if(r.config.xaxis.axisBorder.show){var S=r.globals.barPadForNumericAxis,R=i.drawLine(r.globals.padHorizontal+r.config.xaxis.axisBorder.offsetX-S,this.offY,this.xaxisBorderWidth+S,this.offY,r.config.xaxis.axisBorder.color,0,this.xaxisBorderHeight);this.elgrid&&this.elgrid.elGridBorders&&r.config.grid.show?this.elgrid.elGridBorders.add(R):o.add(R)}return o}},{key:"drawXAxisLabelAndGroup",value:function(r,i,o,l,u,h){var p,v=this,y=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},C=[],k=[],S=this.w,R=y.xaxisFontSize||this.xaxisFontSize,N=y.xaxisFontFamily||this.xaxisFontFamily,B=y.xaxisForeColors||this.xaxisForeColors,U=y.fontWeight||S.config.xaxis.labels.style.fontWeight,j=y.cssClass||S.config.xaxis.labels.style.cssClass,K=S.globals.padHorizontal,x=l.length,I="category"===S.config.xaxis.type?S.globals.dataPoints:x;0===I&&x>I&&(I=x),u?(p=S.globals.gridWidth/Math.min(I>1?I-1:I,x-1),K=K+h(0,p)/2+S.config.xaxis.labels.offsetX):K=K+h(0,p=S.globals.gridWidth/I)+S.config.xaxis.labels.offsetX;for(var q=function(ne){var ve=K-h(ne,p)/2+S.config.xaxis.labels.offsetX;0===ne&&1===x&&p/2===K&&1===I&&(ve=S.globals.gridWidth/2);var ge=v.axesUtils.getLabel(l,S.globals.timescaleLabels,ve,ne,C,R,r),Le=28;if(S.globals.rotateXLabels&&r&&(Le=22),S.config.xaxis.title.text&&"top"===S.config.xaxis.position&&(Le+=parseFloat(S.config.xaxis.title.style.fontSize)+2),r||(Le=Le+parseFloat(R)+(S.globals.xAxisLabelsHeight-S.globals.xAxisGroupLabelsHeight)+(S.globals.rotateXLabels?10:0)),ge=void 0!==S.config.xaxis.tickAmount&&"dataPoints"!==S.config.xaxis.tickAmount&&"datetime"!==S.config.xaxis.type?v.axesUtils.checkLabelBasedOnTickamount(ne,ge,x):v.axesUtils.checkForOverflowingLabels(ne,ge,x,C,k),S.config.xaxis.labels.show){var qe=i.drawText({x:ge.x,y:v.offY+S.config.xaxis.labels.offsetY+Le-("top"===S.config.xaxis.position?S.globals.xAxisHeight+S.config.xaxis.axisTicks.height-2:0),text:ge.text,textAnchor:"middle",fontWeight:ge.isBold?600:U,fontSize:R,fontFamily:N,foreColor:Array.isArray(B)?r&&S.config.xaxis.convertedCatToNumeric?B[S.globals.minX+ne-1]:B[ne]:B,isPlainText:!1,cssClass:(r?"apexcharts-xaxis-label ":"apexcharts-xaxis-group-label ")+j});if(o.add(qe),qe.on("click",function(Ue){if("function"==typeof S.config.chart.events.xAxisLabelClick){var lt=Object.assign({},S,{labelIndex:ne});S.config.chart.events.xAxisLabelClick(Ue,v.ctx,lt)}}),r){var Pe=document.createElementNS(S.globals.SVGNS,"title");Pe.textContent=Array.isArray(ge.text)?ge.text.join(" "):ge.text,qe.node.appendChild(Pe),""!==ge.text&&(C.push(ge.text),k.push(ge))}}ne<x-1&&(K+=h(ne+1,p))},J=0;J<=x-1;J++)q(J)}},{key:"drawXaxisInversed",value:function(r){var i,o,l=this,u=this.w,h=new Ke(this.ctx),p=u.config.yaxis[0].opposite?u.globals.translateYAxisX[r]:0,v=h.group({class:"apexcharts-yaxis apexcharts-xaxis-inversed",rel:r}),y=h.group({class:"apexcharts-yaxis-texts-g apexcharts-xaxis-inversed-texts-g",transform:"translate("+p+", 0)"});v.add(y);var C=[];if(u.config.yaxis[r].show)for(var k=0;k<this.xaxisLabels.length;k++)C.push(this.xaxisLabels[k]);o=-(i=u.globals.gridHeight/C.length)/2.2;var S=u.globals.yLabelFormatters[0],R=u.config.yaxis[0].labels;if(R.show)for(var N=function(W){var q=void 0===C[W]?"":C[W];q=S(q,{seriesIndex:r,dataPointIndex:W,w:u});var J=l.axesUtils.getYAxisForeColor(R.style.colors,r),ne=0;Array.isArray(q)&&(ne=q.length/2*parseInt(R.style.fontSize,10));var ve=R.offsetX-15,ge="end";l.yaxis.opposite&&(ge="start"),"left"===u.config.yaxis[0].labels.align?(ve=R.offsetX,ge="start"):"center"===u.config.yaxis[0].labels.align?(ve=R.offsetX,ge="middle"):"right"===u.config.yaxis[0].labels.align&&(ge="end");var Le=h.drawText({x:ve,y:o+i+R.offsetY-ne,text:q,textAnchor:ge,foreColor:Array.isArray(J)?J[W]:J,fontSize:R.style.fontSize,fontFamily:R.style.fontFamily,fontWeight:R.style.fontWeight,isPlainText:!1,cssClass:"apexcharts-yaxis-label "+R.style.cssClass,maxWidth:R.maxWidth});y.add(Le),Le.on("click",function(Ue){if("function"==typeof u.config.chart.events.xAxisLabelClick){var lt=Object.assign({},u,{labelIndex:W});u.config.chart.events.xAxisLabelClick(Ue,l.ctx,lt)}});var qe=document.createElementNS(u.globals.SVGNS,"title");if(qe.textContent=Array.isArray(q)?q.join(" "):q,Le.node.appendChild(qe),0!==u.config.yaxis[r].labels.rotate){var Pe=h.rotateAroundCenter(Le.node);Le.node.setAttribute("transform","rotate(".concat(u.config.yaxis[r].labels.rotate," 0 ").concat(Pe.y,")"))}o+=i},B=0;B<=C.length-1;B++)N(B);if(void 0!==u.config.yaxis[0].title.text){var U=h.group({class:"apexcharts-yaxis-title apexcharts-xaxis-title-inversed",transform:"translate("+p+", 0)"}),j=h.drawText({x:u.config.yaxis[0].title.offsetX,y:u.globals.gridHeight/2+u.config.yaxis[0].title.offsetY,text:u.config.yaxis[0].title.text,textAnchor:"middle",foreColor:u.config.yaxis[0].title.style.color,fontSize:u.config.yaxis[0].title.style.fontSize,fontWeight:u.config.yaxis[0].title.style.fontWeight,fontFamily:u.config.yaxis[0].title.style.fontFamily,cssClass:"apexcharts-yaxis-title-text "+u.config.yaxis[0].title.style.cssClass});U.add(j),v.add(U)}var K=0;this.isCategoryBarHorizontal&&u.config.yaxis[0].opposite&&(K=u.globals.gridWidth);var x=u.config.xaxis.axisBorder;if(x.show){var I=h.drawLine(u.globals.padHorizontal+x.offsetX+K,1+x.offsetY,u.globals.padHorizontal+x.offsetX+K,u.globals.gridHeight+x.offsetY,x.color,0);this.elgrid&&this.elgrid.elGridBorders&&u.config.grid.show?this.elgrid.elGridBorders.add(I):v.add(I)}return u.config.yaxis[0].axisTicks.show&&this.axesUtils.drawYAxisTicks(K,C.length,u.config.yaxis[0].axisBorder,u.config.yaxis[0].axisTicks,0,i,v),v}},{key:"drawXaxisTicks",value:function(r,i,o){var l=this.w,u=r;if(!(r<0||r-2>l.globals.gridWidth)){var h=this.offY+l.config.xaxis.axisTicks.offsetY;if(i=i+h+l.config.xaxis.axisTicks.height,"top"===l.config.xaxis.position&&(i=h-l.config.xaxis.axisTicks.height),l.config.xaxis.axisTicks.show){var p=new Ke(this.ctx).drawLine(r+l.config.xaxis.axisTicks.offsetX,h+l.config.xaxis.offsetY,u+l.config.xaxis.axisTicks.offsetX,i+l.config.xaxis.offsetY,l.config.xaxis.axisTicks.color);o.add(p),p.node.classList.add("apexcharts-xaxis-tick")}}}},{key:"getXAxisTicksPositions",value:function(){var r=this.w,i=[],o=this.xaxisLabels.length,l=r.globals.padHorizontal;if(r.globals.timescaleLabels.length>0)for(var u=0;u<o;u++)i.push(l=this.xaxisLabels[u].position);else for(var h=o,p=0;p<h;p++){var v=h;r.globals.isXNumeric&&"bar"!==r.config.chart.type&&(v-=1),i.push(l+=r.globals.gridWidth/v)}return i}},{key:"xAxisLabelCorrections",value:function(){var r=this.w,i=new Ke(this.ctx),o=r.globals.dom.baseEl.querySelector(".apexcharts-xaxis-texts-g"),l=r.globals.dom.baseEl.querySelectorAll(".apexcharts-xaxis-texts-g text:not(.apexcharts-xaxis-group-label)"),u=r.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxis-inversed text"),h=r.globals.dom.baseEl.querySelectorAll(".apexcharts-xaxis-inversed-texts-g text tspan");if(r.globals.rotateXLabels||r.config.xaxis.labels.rotateAlways)for(var p=0;p<l.length;p++){var v=i.rotateAroundCenter(l[p]);v.y=v.y-1,v.x=v.x+1,l[p].setAttribute("transform","rotate(".concat(r.config.xaxis.labels.rotate," ").concat(v.x," ").concat(v.y,")")),l[p].setAttribute("text-anchor","end"),o.setAttribute("transform","translate(0, ".concat(-10,")")),r.config.xaxis.labels.trim&&Array.prototype.forEach.call(l[p].childNodes,function(R){i.placeTextWithEllipsis(R,R.textContent,r.globals.xAxisLabelsHeight-("bottom"===r.config.legend.position?20:10))})}else!function(){for(var R=r.globals.gridWidth/(r.globals.labels.length+1),N=0;N<l.length;N++)r.config.xaxis.labels.trim&&"datetime"!==r.config.xaxis.type&&Array.prototype.forEach.call(l[N].childNodes,function(U){i.placeTextWithEllipsis(U,U.textContent,R)})}();if(u.length>0){var C=u[u.length-1].getBBox(),k=u[0].getBBox();C.x<-20&&u[u.length-1].parentNode.removeChild(u[u.length-1]),k.x+k.width>r.globals.gridWidth&&!r.globals.isBarHorizontal&&u[0].parentNode.removeChild(u[0]);for(var S=0;S<h.length;S++)i.placeTextWithEllipsis(h[S],h[S].textContent,r.config.yaxis[0].labels.maxWidth-(r.config.yaxis[0].title.text?2*parseFloat(r.config.yaxis[0].title.style.fontSize):0)-15)}}}]),P}(),qi=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w;var i=this.w;this.xaxisLabels=i.globals.labels.slice(),this.axesUtils=new mt(r),this.isRangeBar=i.globals.seriesRange.length&&i.globals.isBarHorizontal,i.globals.timescaleLabels.length>0&&(this.xaxisLabels=i.globals.timescaleLabels.slice())}return me(P,[{key:"drawGridArea",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=this.w,o=new Ke(this.ctx);null===r&&(r=o.group({class:"apexcharts-grid"}));var l=o.drawLine(i.globals.padHorizontal,1,i.globals.padHorizontal,i.globals.gridHeight,"transparent"),u=o.drawLine(i.globals.padHorizontal,i.globals.gridHeight,i.globals.gridWidth,i.globals.gridHeight,"transparent");return r.add(u),r.add(l),r}},{key:"drawGrid",value:function(){var r=null;return this.w.globals.axisCharts&&(r=this.renderGrid(),this.drawGridArea(r.el)),r}},{key:"createGridMask",value:function(){var r=this.w,i=r.globals,o=new Ke(this.ctx),l=Array.isArray(r.config.stroke.width)?0:r.config.stroke.width;if(Array.isArray(r.config.stroke.width)){var u=0;r.config.stroke.width.forEach(function(k){u=Math.max(u,k)}),l=u}i.dom.elGridRectMask=document.createElementNS(i.SVGNS,"clipPath"),i.dom.elGridRectMask.setAttribute("id","gridRectMask".concat(i.cuid)),i.dom.elGridRectMarkerMask=document.createElementNS(i.SVGNS,"clipPath"),i.dom.elGridRectMarkerMask.setAttribute("id","gridRectMarkerMask".concat(i.cuid)),i.dom.elForecastMask=document.createElementNS(i.SVGNS,"clipPath"),i.dom.elForecastMask.setAttribute("id","forecastMask".concat(i.cuid)),i.dom.elNonForecastMask=document.createElementNS(i.SVGNS,"clipPath"),i.dom.elNonForecastMask.setAttribute("id","nonForecastMask".concat(i.cuid));var h=r.config.chart.type,p=0,v=0;("bar"===h||"rangeBar"===h||"candlestick"===h||"boxPlot"===h||r.globals.comboBarCount>0)&&r.globals.isXNumeric&&!r.globals.isBarHorizontal&&(v=r.config.grid.padding.right,i.barPadForNumericAxis>(p=r.config.grid.padding.left)&&(p=i.barPadForNumericAxis,v=i.barPadForNumericAxis)),i.dom.elGridRect=o.drawRect(-l/2-p-2,-l/2-2,i.gridWidth+l+v+p+4,i.gridHeight+l+4,0,"#fff");var y=r.globals.markers.largestSize+1;i.dom.elGridRectMarker=o.drawRect(2*-y,2*-y,i.gridWidth+4*y,i.gridHeight+4*y,0,"#fff"),i.dom.elGridRectMask.appendChild(i.dom.elGridRect.node),i.dom.elGridRectMarkerMask.appendChild(i.dom.elGridRectMarker.node);var C=i.dom.baseEl.querySelector("defs");C.appendChild(i.dom.elGridRectMask),C.appendChild(i.dom.elForecastMask),C.appendChild(i.dom.elNonForecastMask),C.appendChild(i.dom.elGridRectMarkerMask)}},{key:"_drawGridLines",value:function(r){var i=r.i,o=r.x1,p=r.xCount,y=this.w;if(!(0===i&&y.globals.skipFirstTimelinelabel||i===p-1&&y.globals.skipLastTimelinelabel&&!y.config.xaxis.labels.formatter||"radar"===y.config.chart.type)){y.config.grid.xaxis.lines.show&&this._drawGridLine({i,x1:o,y1:r.y1,x2:r.x2,y2:r.y2,xCount:p,parent:r.parent});var C=0;if(y.globals.hasXaxisGroups&&"between"===y.config.xaxis.tickPlacement){var k=y.globals.groups;if(k){for(var S=0,R=0;S<i&&R<k.length;R++)S+=k[R].cols;S===i&&(C=.6*y.globals.xAxisLabelsHeight)}}new Pr(this.ctx).drawXaxisTicks(o,C,y.globals.dom.elGraphical)}}},{key:"_drawGridLine",value:function(r){var i=r.i,o=r.x1,l=r.y1,u=r.x2,h=r.y2,p=r.xCount,v=r.parent,y=this.w,C=!1,k=v.node.classList.contains("apexcharts-gridlines-horizontal"),S=y.config.grid.strokeDashArray,R=y.globals.barPadForNumericAxis;(0===l&&0===h||0===o&&0===u)&&(C=!0),l===y.globals.gridHeight&&h===y.globals.gridHeight&&(C=!0),!y.globals.isBarHorizontal||0!==i&&i!==p-1||(C=!0);var N=new Ke(this).drawLine(o-(k?R:0),l,u+(k?R:0),h,y.config.grid.borderColor,S);N.node.classList.add("apexcharts-gridline"),C&&y.config.grid.show?this.elGridBorders.add(N):v.add(N)}},{key:"_drawGridBandRect",value:function(r){var i=r.c,o=r.x1,l=r.y1,u=r.x2,h=r.y2,p=r.type,v=this.w,y=new Ke(this.ctx),C=v.globals.barPadForNumericAxis;if("column"!==p||"datetime"!==v.config.xaxis.type){var S=y.drawRect(o-("row"===p?C:0),l,u+("row"===p?2*C:0),h,0,v.config.grid[p].colors[i],v.config.grid[p].opacity);this.elg.add(S),S.attr("clip-path","url(#gridRectMask".concat(v.globals.cuid,")")),S.node.classList.add("apexcharts-grid-".concat(p))}}},{key:"_drawXYLines",value:function(r){var i=this,o=r.xCount,l=r.tickAmount,u=this.w;if(u.config.grid.xaxis.lines.show||u.config.xaxis.axisTicks.show){var h,p=u.globals.padHorizontal,v=u.globals.gridHeight;u.globals.timescaleLabels.length?function(N){for(var B=N.xC,j=N.y1,x=N.y2,I=0;I<B;I++)i._drawGridLines({i:I,x1:i.xaxisLabels[I].position,y1:j,x2:i.xaxisLabels[I].position,y2:x,xCount:o,parent:i.elgridLinesV})}({xC:o,x1:p,y1:0,x2:h,y2:v}):(u.globals.isXNumeric&&(o=u.globals.xAxisScale.result.length),function(N){for(var B=N.xC,U=N.x1,j=N.y1,K=N.x2,x=N.y2,I=0;I<B+(u.globals.isXNumeric?0:1);I++)0===I&&1===B&&1===u.globals.dataPoints&&(K=U=u.globals.gridWidth/2),i._drawGridLines({i:I,x1:U,y1:j,x2:K,y2:x,xCount:o,parent:i.elgridLinesV}),K=U+=u.globals.gridWidth/(u.globals.isXNumeric?B-1:B)}({xC:o,x1:p,y1:0,x2:h,y2:v}))}if(u.config.grid.yaxis.lines.show){var y=0,C=0,k=u.globals.gridWidth,S=l+1;this.isRangeBar&&(S=u.globals.labels.length);for(var R=0;R<S+(this.isRangeBar?1:0);R++)this._drawGridLine({i:R,xCount:S+(this.isRangeBar?1:0),x1:0,y1:y,x2:k,y2:C,parent:this.elgridLinesH}),C=y+=u.globals.gridHeight/(this.isRangeBar?S:l)}}},{key:"_drawInvertedXYLines",value:function(r){var i=r.xCount,o=this.w;if(o.config.grid.xaxis.lines.show||o.config.xaxis.axisTicks.show)for(var l,u=o.globals.padHorizontal,h=o.globals.gridHeight,p=0;p<i+1;p++)o.config.grid.xaxis.lines.show&&this._drawGridLine({i:p,xCount:i+1,x1:u,y1:0,x2:l,y2:h,parent:this.elgridLinesV}),new Pr(this.ctx).drawXaxisTicks(u,0,o.globals.dom.elGraphical),l=u+=o.globals.gridWidth/i;if(o.config.grid.yaxis.lines.show)for(var v=0,y=0,C=o.globals.gridWidth,k=0;k<o.globals.dataPoints+1;k++)this._drawGridLine({i:k,xCount:o.globals.dataPoints+1,x1:0,y1:v,x2:C,y2:y,parent:this.elgridLinesH}),y=v+=o.globals.gridHeight/o.globals.dataPoints}},{key:"renderGrid",value:function(){var r=this.w,i=r.globals,o=new Ke(this.ctx);this.elg=o.group({class:"apexcharts-grid"}),this.elgridLinesH=o.group({class:"apexcharts-gridlines-horizontal"}),this.elgridLinesV=o.group({class:"apexcharts-gridlines-vertical"}),this.elGridBorders=o.group({class:"apexcharts-grid-borders"}),this.elg.add(this.elgridLinesH),this.elg.add(this.elgridLinesV),r.config.grid.show||(this.elgridLinesV.hide(),this.elgridLinesH.hide(),this.elGridBorders.hide());for(var l=0;l<i.seriesYAxisMap.length&&-1!==i.ignoreYAxisIndexes.indexOf(l);)l++;l===i.seriesYAxisMap.length&&(l=0);var u,p,v,y,h=i.yAxisScale[l].result.length-1;return!i.isBarHorizontal||this.isRangeBar?(u=this.xaxisLabels.length,this.isRangeBar&&(h=i.labels.length,r.config.xaxis.tickAmount&&r.config.xaxis.labels.formatter&&(u=r.config.xaxis.tickAmount),(null===(p=i.yAxisScale)||void 0===p||null===(v=p[l])||void 0===v||null===(y=v.result)||void 0===y?void 0:y.length)>0&&"datetime"!==r.config.xaxis.type&&(u=i.yAxisScale[l].result.length-1)),this._drawXYLines({xCount:u,tickAmount:h})):this._drawInvertedXYLines({xCount:u=h,tickAmount:h=i.xTickAmount}),this.drawGridBands(u,h),{el:this.elg,elGridBorders:this.elGridBorders,xAxisTickWidth:i.gridWidth/u}}},{key:"drawGridBands",value:function(r,i){var o=this.w;if(void 0!==o.config.grid.row.colors&&o.config.grid.row.colors.length>0)for(var l=0,u=o.globals.gridHeight/i,h=o.globals.gridWidth,p=0,v=0;p<i;p++,v++)v>=o.config.grid.row.colors.length&&(v=0),this._drawGridBandRect({c:v,x1:0,y1:l,x2:h,y2:u,type:"row"}),l+=o.globals.gridHeight/i;if(void 0!==o.config.grid.column.colors&&o.config.grid.column.colors.length>0)for(var y=o.globals.isBarHorizontal||"on"!==o.config.xaxis.tickPlacement||"category"!==o.config.xaxis.type&&!o.config.xaxis.convertedCatToNumeric?r:r-1,C=o.globals.padHorizontal,k=o.globals.padHorizontal+o.globals.gridWidth/y,S=o.globals.gridHeight,R=0,N=0;R<r;R++,N++)N>=o.config.grid.column.colors.length&&(N=0),this._drawGridBandRect({c:N,x1:C,y1:0,x2:k,y2:S,type:"column"}),C+=o.globals.gridWidth/y}}]),P}(),Si=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w}return me(P,[{key:"niceScale",value:function(r,i){var o,l,u,h,p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,v=1e-11,y=this.w,C=y.globals;C.isBarHorizontal?(o=y.config.xaxis,l=Math.max((C.svgWidth-100)/25,2)):(o=y.config.yaxis[p],l=Math.max((C.svgHeight-100)/15,2)),u=null!=o.min,h=void 0!==o.max&&null!==o.min;var k=null!=o.stepSize,S=null!=o.tickAmount,R=S?o.tickAmount:o.forceNiceScale?C.niceScaleDefaultTicks[Math.min(Math.round(l/2),C.niceScaleDefaultTicks.length-1)]:10;if(C.isMultipleYAxis&&!S&&C.multiAxisTickAmount>0&&(R=C.multiAxisTickAmount,S=!0),R="dataPoints"===R?C.dataPoints-1:Math.abs(Math.round(R)),(r===Number.MIN_VALUE&&0===i||!pe.isNumber(r)&&!pe.isNumber(i)||r===Number.MIN_VALUE&&i===-Number.MAX_VALUE)&&(r=pe.isNumber(o.min)?o.min:0,i=pe.isNumber(o.max)?o.max:r+R,C.allSeriesCollapsed=!1),r>i){console.warn("axis.min cannot be greater than axis.max: swapping min and max");var N=i;i=r,r=N}else r===i&&(r=0===r?0:r-1,i=0===i?2:i+1);var B=[];R<1&&(R=1);var U=R,j=Math.abs(i-r);o.forceNiceScale&&(!u&&r>0&&r/j<.15&&(r=0,u=!0),!h&&i<0&&-i/j<.15&&(i=0,h=!0),j=Math.abs(i-r));var K=j/U,x=K,I=Math.floor(Math.log10(x)),W=Math.pow(10,I),q=Math.ceil(x/W);if(K=x=(q=C.niceScaleAllowedMagMsd[0===C.yValueDecimal?0:1][q])*W,C.isBarHorizontal&&o.stepSize&&"datetime"!==o.type?(K=o.stepSize,k=!0):k&&(K=o.stepSize),k&&o.forceNiceScale){var J=Math.floor(Math.log10(K));K*=Math.pow(10,I-J)}if(u&&h){var ne=j/U;if(S)if(k)if(0!=pe.mod(j,K)){var ve=pe.getGCD(K,ne);K=ne/ve<10?ve:ne}else 0==pe.mod(K,ne)?K=ne:(ne=K,S=!1);else K=ne;else if(k)0==pe.mod(j,K)?ne=K:K=ne;else if(0==pe.mod(j,K))ne=K;else{ne=j/(U=Math.ceil(j/K));var ge=pe.getGCD(j,K);j/ge<l&&(ne=ge),K=ne}U=Math.round(j/K)}else{if(u||h){if(h)if(S)r=i-K*U;else{var Le=r;r=K*Math.floor(r/K),Math.abs(i-r)/pe.getGCD(j,K)>l&&(r=i-K*R,r+=K*Math.floor((Le-r)/K))}else if(u)if(S)i=r+K*U;else{var qe=i;i=K*Math.ceil(i/K),Math.abs(i-r)/pe.getGCD(j,K)>l&&(i=r+K*R,i+=K*Math.ceil((qe-i)/K))}}else if(S){var Pe=K/(i-r>i?1:2),Ue=Pe*Math.floor(r/Pe);Math.abs(Ue-r)<=Pe/2?i=(r=Ue)+K*U:r=(i=Pe*Math.ceil(i/Pe))-K*U}else r=K*Math.floor(r/K),i=K*Math.ceil(i/K);j=Math.abs(i-r),K=pe.getGCD(j,K),U=Math.round(j/K)}if(S||u||h||(U=Math.ceil((j-v)/(K+v)))>16&&pe.getPrimeFactors(U).length<2&&U++,!S&&o.forceNiceScale&&0===C.yValueDecimal&&U>j&&(U=j,K=Math.round(j/U)),U>l&&(!S&&!k||o.forceNiceScale)){var lt=pe.getPrimeFactors(U),ft=lt.length-1,At=U;e:for(var St=0;St<ft;St++)for(var Gt=0;Gt<=ft-St;Gt++){for(var Lt=Math.min(Gt+St,ft),$t=At,zn=1,En=Gt;En<=Lt;En++)zn*=lt[En];if(($t/=zn)<l){At=$t;break e}}K=At===U?j:j/At,U=Math.round(j/K)}C.isMultipleYAxis&&0==C.multiAxisTickAmount&&C.ignoreYAxisIndexes.indexOf(p)<0&&(C.multiAxisTickAmount=U);var _n=r-K,sr=K*v;do{B.push(pe.stripNumber(_n+=K,7))}while(i-_n>sr);return{result:B,niceMin:B[0],niceMax:B[B.length-1]}}},{key:"linearScale",value:function(r,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,h=Math.abs(i-r);"dataPoints"===(o=this._adjustTicksForSmallRange(o,l,h))&&(o=this.w.globals.dataPoints-1),u||(u=h/o),o===Number.MAX_VALUE&&(o=5,u=1);for(var p=[],v=r;o>=0;)p.push(v),v+=u,o-=1;return{result:p,niceMin:p[0],niceMax:p[p.length-1]}}},{key:"logarithmicScaleNice",value:function(r,i,o){i<=0&&(i=Math.max(r,o)),r<=0&&(r=Math.min(i,o));for(var l=[],u=Math.ceil(Math.log(i)/Math.log(o)+1),h=Math.floor(Math.log(r)/Math.log(o));h<u;h++)l.push(Math.pow(o,h));return{result:l,niceMin:l[0],niceMax:l[l.length-1]}}},{key:"logarithmicScale",value:function(r,i,o){i<=0&&(i=Math.max(r,o)),r<=0&&(r=Math.min(i,o));for(var l=[],u=Math.log(i)/Math.log(o),h=Math.log(r)/Math.log(o),p=u-h,v=Math.round(p),y=p/v,C=0,k=h;C<v;C++,k+=y)l.push(Math.pow(o,k));return l.push(Math.pow(o,u)),{result:l,niceMin:r,niceMax:i}}},{key:"_adjustTicksForSmallRange",value:function(r,i,o){var l=r;if(void 0!==i&&this.w.config.yaxis[i].labels.formatter&&void 0===this.w.config.yaxis[i].tickAmount){var u=Number(this.w.config.yaxis[i].labels.formatter(1));pe.isNumber(u)&&0===this.w.globals.yValueDecimal&&(l=Math.ceil(o))}return l<r?l:r}},{key:"setYScaleForIndex",value:function(r,i,o){var l=this.w.globals,u=this.w.config,h=l.isBarHorizontal?u.xaxis:u.yaxis[r];void 0===l.yAxisScale[r]&&(l.yAxisScale[r]=[]);var p=Math.abs(o-i);h.logarithmic&&p<=5&&(l.invalidLogScale=!0),h.logarithmic&&p>5?(l.allSeriesCollapsed=!1,l.yAxisScale[r]=h.forceNiceScale?this.logarithmicScaleNice(i,o,h.logBase):this.logarithmicScale(i,o,h.logBase)):o!==-Number.MAX_VALUE&&pe.isNumber(o)&&i!==Number.MAX_VALUE&&pe.isNumber(i)?(l.allSeriesCollapsed=!1,l.yAxisScale[r]=this.niceScale(i,o,r)):l.yAxisScale[r]=this.niceScale(Number.MIN_VALUE,0,r)}},{key:"setXScale",value:function(r,i){var o=this.w,l=o.globals,u=Math.abs(i-r);return l.xAxisScale=i!==-Number.MAX_VALUE&&pe.isNumber(i)?this.linearScale(r,i,o.config.xaxis.tickAmount?o.config.xaxis.tickAmount:u<10&&u>1?u+1:10,0,o.config.xaxis.stepSize):this.linearScale(0,10,10),l.xAxisScale}},{key:"setSeriesYAxisMappings",value:function(){var r=this.w.globals,i=this.w.config,o=[],l=[],u=[],h=r.series.length>i.yaxis.length||i.yaxis.some(function(k){return Array.isArray(k.seriesName)});i.series.forEach(function(k,S){u.push(S),l.push(null)}),i.yaxis.forEach(function(k,S){o[S]=[]});var p=[];i.yaxis.forEach(function(k,S){var R=!1;if(k.seriesName){var N=[];Array.isArray(k.seriesName)?N=k.seriesName:N.push(k.seriesName),N.forEach(function(B){i.series.forEach(function(U,j){if(U.name===B){var K=j;S===j||h?!h||u.indexOf(j)>-1?o[S].push([S,j]):console.warn("Series '"+U.name+"' referenced more than once in what looks like the new style. That is, when using either seriesName: [], or when there are more series than yaxes."):(o[j].push([j,S]),K=S),R=!0,-1!==(K=u.indexOf(K))&&u.splice(K,1)}})})}R||p.push(S)}),o=o.map(function(k,S){var R=[];return k.forEach(function(N){l[N[1]]=N[0],R.push(N[1])}),R});for(var v=i.yaxis.length-1,y=0;y<p.length&&(o[v=p[y]]=[],u);y++){var C=u[0];u.shift(),o[v].push(C),l[C]=v}u.forEach(function(k){o[v].push(k),l[k]=v}),r.seriesYAxisMap=o.map(function(k){return k}),r.seriesYAxisReverseMap=l.map(function(k){return k})}},{key:"scaleMultipleYAxes",value:function(){var r=this,i=this.w.config,o=this.w.globals;this.setSeriesYAxisMappings();var l=o.seriesYAxisMap,u=o.minYArr,h=o.maxYArr;o.allSeriesCollapsed=!0,o.barGroups=[],l.forEach(function(p,v){var y=[];p.forEach(function(C){var k=i.series[C].group;y.indexOf(k)<0&&y.push(k)}),p.length>0?function(){var C,k,S=Number.MAX_VALUE,R=-Number.MAX_VALUE,N=S,B=R;if(i.chart.stacked)!function(){var K=o.seriesX[p[0]],x=[],I=[],W=[];y.forEach(function(){x.push(K.map(function(){return Number.MIN_VALUE})),I.push(K.map(function(){return Number.MIN_VALUE})),W.push(K.map(function(){return Number.MIN_VALUE}))});for(var q=function(ne){!C&&i.series[p[ne]].type&&(C=i.series[p[ne]].type);var ve=p[ne];k=i.series[ve].group?i.series[ve].group:"axis-".concat(v),!(o.collapsedSeriesIndices.indexOf(ve)<0&&o.ancillaryCollapsedSeriesIndices.indexOf(ve)<0)||(o.allSeriesCollapsed=!1,y.forEach(function(ge,Le){if(i.series[ve].group===ge)for(var qe=0;qe<o.series[ve].length;qe++){var Pe=o.series[ve][qe];Pe>=0?I[Le][qe]+=Pe:W[Le][qe]+=Pe,x[Le][qe]+=Pe,N=Math.min(N,Pe),B=Math.max(B,Pe)}})),"bar"!==C&&"column"!==C||o.barGroups.push(k)},J=0;J<p.length;J++)q(J);C||(C=i.chart.type),"bar"===C||"column"===C?y.forEach(function(ne,ve){S=Math.min(S,Math.min.apply(null,W[ve])),R=Math.max(R,Math.max.apply(null,I[ve]))}):(y.forEach(function(ne,ve){N=Math.min(N,Math.min.apply(null,x[ve])),B=Math.max(B,Math.max.apply(null,x[ve]))}),S=N,R=B),S===Number.MIN_VALUE&&R===Number.MIN_VALUE&&(R=-Number.MAX_VALUE)}();else for(var U=0;U<p.length;U++){var j=p[U];S=Math.min(S,u[j]),R=Math.max(R,h[j]),!(o.collapsedSeriesIndices.indexOf(j)<0&&o.ancillaryCollapsedSeriesIndices.indexOf(j)<0)||(o.allSeriesCollapsed=!1)}void 0!==i.yaxis[v].min&&(S="function"==typeof i.yaxis[v].min?i.yaxis[v].min(S):i.yaxis[v].min),void 0!==i.yaxis[v].max&&(R="function"==typeof i.yaxis[v].max?i.yaxis[v].max(R):i.yaxis[v].max),o.barGroups=o.barGroups.filter(function(K,x,I){return I.indexOf(K)===x}),r.setYScaleForIndex(v,S,R),p.forEach(function(K){u[K]=o.yAxisScale[v].niceMin,h[K]=o.yAxisScale[v].niceMax})}():r.setYScaleForIndex(v,0,-Number.MAX_VALUE)})}}]),P}(),Br=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w,this.scales=new Si(r)}return me(P,[{key:"init",value:function(){this.setYRange(),this.setXRange(),this.setZRange()}},{key:"getMinYMaxY",value:function(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-Number.MAX_VALUE,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=this.w.config,h=this.w.globals,p=-Number.MAX_VALUE,v=Number.MIN_VALUE;null===l&&(l=r+1);var y=0,C=0,k=void 0;if(h.seriesX.length>=l){var S,R;y=0,C=(k=gt(new Set((S=[]).concat.apply(S,gt(h.seriesX.slice(r,l)))))).length-1;var N=null===(R=h.brushSource)||void 0===R?void 0:R.w.config.chart.brush;if(u.chart.zoom.enabled&&u.chart.zoom.autoScaleYaxis||null!=N&&N.enabled&&null!=N&&N.autoScaleYaxis){if(u.xaxis.min)for(y=0;y<C&&k[y]<u.xaxis.min;y++);if(u.xaxis.max)for(;C>y&&k[C]>u.xaxis.max;C--);}}var B=h.series,U=B,j=B;"candlestick"===u.chart.type?(U=h.seriesCandleL,j=h.seriesCandleH):"boxPlot"===u.chart.type?(U=h.seriesCandleO,j=h.seriesCandleC):h.isRangeData&&(U=h.seriesRangeStart,j=h.seriesRangeEnd);for(var K=r;K<l;K++){h.dataPoints=Math.max(h.dataPoints,B[K].length);var x=u.series[K].type;h.categoryLabels.length&&(h.dataPoints=h.categoryLabels.filter(function(q){return void 0!==q}).length),h.labels.length&&"datetime"!==u.xaxis.type&&0!==h.series.reduce(function(q,J){return q+J.length},0)&&(h.dataPoints=Math.max(h.dataPoints,h.labels.length)),k||(y=0,C=h.series[K].length);for(var I=y;I<=C&&I<h.series[K].length;I++){var W=B[K][I];if(null!==W&&pe.isNumber(W)){switch(void 0!==j[K][I]&&(p=Math.max(p,j[K][I]),i=Math.min(i,j[K][I])),void 0!==U[K][I]&&(i=Math.min(i,U[K][I]),o=Math.max(o,U[K][I])),x){case"candlestick":void 0!==h.seriesCandleC[K][I]&&(p=Math.max(p,h.seriesCandleH[K][I]),i=Math.min(i,h.seriesCandleL[K][I]));break;case"boxPlot":void 0!==h.seriesCandleC[K][I]&&(p=Math.max(p,h.seriesCandleC[K][I]),i=Math.min(i,h.seriesCandleO[K][I]))}x&&"candlestick"!==x&&"boxPlot"!==x&&"rangeArea"!==x&&"rangeBar"!==x&&(p=Math.max(p,h.series[K][I]),i=Math.min(i,h.series[K][I])),o=p,h.seriesGoals[K]&&h.seriesGoals[K][I]&&Array.isArray(h.seriesGoals[K][I])&&h.seriesGoals[K][I].forEach(function(q){v!==Number.MIN_VALUE&&(v=Math.min(v,q.value),i=v),p=Math.max(p,q.value),o=p}),pe.isFloat(W)&&(W=pe.noExponents(W),h.yValueDecimal=Math.max(h.yValueDecimal,W.toString().split(".")[1].length)),v>U[K][I]&&U[K][I]<0&&(v=U[K][I])}else h.hasNullValues=!0}"bar"!==x&&"column"!==x||(v<0&&p<0&&(p=0,o=Math.max(o,0)),v===Number.MIN_VALUE&&(v=0,i=Math.min(i,0)))}return"rangeBar"===u.chart.type&&h.seriesRangeStart.length&&h.isBarHorizontal&&(v=i),"bar"===u.chart.type&&(v<0&&p<0&&(p=0),v===Number.MIN_VALUE&&(v=0)),{minY:v,maxY:p,lowestY:i,highestY:o}}},{key:"setYRange",value:function(){var r=this.w.globals,i=this.w.config;r.maxY=-Number.MAX_VALUE,r.minY=Number.MIN_VALUE;var o,l=Number.MAX_VALUE;if(r.isMultipleYAxis){l=Number.MAX_VALUE;for(var u=0;u<r.series.length;u++)o=this.getMinYMaxY(u),r.minYArr[u]=o.lowestY,r.maxYArr[u]=o.highestY,l=Math.min(l,o.lowestY)}return o=this.getMinYMaxY(0,l,null,r.series.length),"bar"===i.chart.type?(r.minY=o.minY,r.maxY=o.maxY):(r.minY=o.lowestY,r.maxY=o.highestY),l=o.lowestY,i.chart.stacked&&this._setStackedMinMax(),"line"===i.chart.type||"area"===i.chart.type||"scatter"===i.chart.type||"candlestick"===i.chart.type||"boxPlot"===i.chart.type||"rangeBar"===i.chart.type&&!r.isBarHorizontal?r.minY===Number.MIN_VALUE&&l!==-Number.MAX_VALUE&&l!==r.maxY&&(r.minY=l):r.minY=o.minY,i.yaxis.forEach(function(h,p){void 0!==h.max&&("number"==typeof h.max?r.maxYArr[p]=h.max:"function"==typeof h.max&&(r.maxYArr[p]=h.max(r.isMultipleYAxis?r.maxYArr[p]:r.maxY)),r.maxY=r.maxYArr[p]),void 0!==h.min&&("number"==typeof h.min?r.minYArr[p]=h.min:"function"==typeof h.min&&(r.minYArr[p]=h.min(r.isMultipleYAxis?r.minYArr[p]===Number.MIN_VALUE?0:r.minYArr[p]:r.minY)),r.minY=r.minYArr[p])}),r.isBarHorizontal&&["min","max"].forEach(function(h){void 0!==i.xaxis[h]&&"number"==typeof i.xaxis[h]&&("min"===h?r.minY=i.xaxis[h]:r.maxY=i.xaxis[h])}),r.isMultipleYAxis?(this.scales.scaleMultipleYAxes(),r.minY=l):(this.scales.setYScaleForIndex(0,r.minY,r.maxY),r.minY=r.yAxisScale[0].niceMin,r.maxY=r.yAxisScale[0].niceMax,r.minYArr[0]=r.minY,r.maxYArr[0]=r.maxY),r.barGroups=[],r.lineGroups=[],r.areaGroups=[],i.series.forEach(function(h){switch(h.type||i.chart.type){case"bar":case"column":r.barGroups.push(h.group);break;case"line":r.lineGroups.push(h.group);break;case"area":r.areaGroups.push(h.group)}}),r.barGroups=r.barGroups.filter(function(h,p,v){return v.indexOf(h)===p}),r.lineGroups=r.lineGroups.filter(function(h,p,v){return v.indexOf(h)===p}),r.areaGroups=r.areaGroups.filter(function(h,p,v){return v.indexOf(h)===p}),{minY:r.minY,maxY:r.maxY,minYArr:r.minYArr,maxYArr:r.maxYArr,yAxisScale:r.yAxisScale}}},{key:"setXRange",value:function(){var r=this.w.globals,i=this.w.config,o="numeric"===i.xaxis.type||"datetime"===i.xaxis.type||"category"===i.xaxis.type&&!r.noLabelsProvided||r.noLabelsProvided||r.isXNumeric;if(r.isXNumeric&&function(){for(var p=0;p<r.series.length;p++)if(r.labels[p])for(var v=0;v<r.labels[p].length;v++)null!==r.labels[p][v]&&pe.isNumber(r.labels[p][v])&&(r.maxX=Math.max(r.maxX,r.labels[p][v]),r.initialMaxX=Math.max(r.maxX,r.labels[p][v]),r.minX=Math.min(r.minX,r.labels[p][v]),r.initialMinX=Math.min(r.minX,r.labels[p][v]))}(),r.noLabelsProvided&&0===i.xaxis.categories.length&&(r.maxX=r.labels[r.labels.length-1],r.initialMaxX=r.labels[r.labels.length-1],r.minX=1,r.initialMinX=1),r.isXNumeric||r.noLabelsProvided||r.dataFormatXNumeric){var l;if(void 0===i.xaxis.tickAmount?(l=Math.round(r.svgWidth/150),"numeric"===i.xaxis.type&&r.dataPoints<30&&(l=r.dataPoints-1),l>r.dataPoints&&0!==r.dataPoints&&(l=r.dataPoints-1)):"dataPoints"===i.xaxis.tickAmount?(r.series.length>1&&(l=r.series[r.maxValsInArrayIndex].length-1),r.isXNumeric&&(l=r.maxX-r.minX-1)):l=i.xaxis.tickAmount,r.xTickAmount=l,void 0!==i.xaxis.max&&"number"==typeof i.xaxis.max&&(r.maxX=i.xaxis.max),void 0!==i.xaxis.min&&"number"==typeof i.xaxis.min&&(r.minX=i.xaxis.min),void 0!==i.xaxis.range&&(r.minX=r.maxX-i.xaxis.range),r.minX!==Number.MAX_VALUE&&r.maxX!==-Number.MAX_VALUE)if(i.xaxis.convertedCatToNumeric&&!r.dataFormatXNumeric){for(var u=[],h=r.minX-1;h<r.maxX;h++)u.push(h+1);r.xAxisScale={result:u,niceMin:u[0],niceMax:u[u.length-1]}}else r.xAxisScale=this.scales.setXScale(r.minX,r.maxX);else r.xAxisScale=this.scales.linearScale(0,l,l,0,i.xaxis.stepSize),r.noLabelsProvided&&r.labels.length>0&&(r.xAxisScale=this.scales.linearScale(1,r.labels.length,l-1,0,i.xaxis.stepSize),r.seriesX=r.labels.slice());o&&(r.labels=r.xAxisScale.result.slice())}return r.isBarHorizontal&&r.labels.length&&(r.xTickAmount=r.labels.length),this._handleSingleDataPoint(),this._getMinXDiff(),{minX:r.minX,maxX:r.maxX}}},{key:"setZRange",value:function(){var r=this.w.globals;if(r.isDataXYZ)for(var i=0;i<r.series.length;i++)if(void 0!==r.seriesZ[i])for(var o=0;o<r.seriesZ[i].length;o++)null!==r.seriesZ[i][o]&&pe.isNumber(r.seriesZ[i][o])&&(r.maxZ=Math.max(r.maxZ,r.seriesZ[i][o]),r.minZ=Math.min(r.minZ,r.seriesZ[i][o]))}},{key:"_handleSingleDataPoint",value:function(){var r=this.w.globals,i=this.w.config;if(r.minX===r.maxX){var o=new Mn(this.ctx);if("datetime"===i.xaxis.type){var l=o.getDate(r.minX);i.xaxis.labels.datetimeUTC?l.setUTCDate(l.getUTCDate()-2):l.setDate(l.getDate()-2),r.minX=new Date(l).getTime();var u=o.getDate(r.maxX);i.xaxis.labels.datetimeUTC?u.setUTCDate(u.getUTCDate()+2):u.setDate(u.getDate()+2),r.maxX=new Date(u).getTime()}else("numeric"===i.xaxis.type||"category"===i.xaxis.type&&!r.noLabelsProvided)&&(r.minX=r.minX-2,r.initialMinX=r.minX,r.maxX=r.maxX+2,r.initialMaxX=r.maxX)}}},{key:"_getMinXDiff",value:function(){var r=this.w.globals;r.isXNumeric&&r.seriesX.forEach(function(i,o){1===i.length&&i.push(r.seriesX[r.maxValsInArrayIndex][r.seriesX[r.maxValsInArrayIndex].length-1]);var l=i.slice();l.sort(function(u,h){return u-h}),l.forEach(function(u,h){if(h>0){var p=u-l[h-1];p>0&&(r.minXDiff=Math.min(p,r.minXDiff))}}),1!==r.dataPoints&&r.minXDiff!==Number.MAX_VALUE||(r.minXDiff=.5)})}},{key:"_setStackedMinMax",value:function(){var r=this,i=this.w.globals;if(i.series.length){var o=i.seriesGroups;o.length||(o=[this.w.globals.seriesNames.map(function(h){return h})]);var l={},u={};o.forEach(function(h){l[h]=[],u[h]=[],r.w.config.series.map(function(p,v){return h.indexOf(i.seriesNames[v])>-1?v:null}).filter(function(p){return null!==p}).forEach(function(p){for(var v=0;v<i.series[i.maxValsInArrayIndex].length;v++){var y,C,k,S;void 0===l[h][v]&&(l[h][v]=0,u[h][v]=0),(r.w.config.chart.stacked&&!i.comboCharts||r.w.config.chart.stacked&&i.comboCharts&&(!r.w.config.chart.stackOnlyBar||"bar"===(null===(y=r.w.config.series)||void 0===y||null===(C=y[p])||void 0===C?void 0:C.type)||"column"===(null===(k=r.w.config.series)||void 0===k||null===(S=k[p])||void 0===S?void 0:S.type)))&&null!==i.series[p][v]&&pe.isNumber(i.series[p][v])&&(i.series[p][v]>0?l[h][v]+=parseFloat(i.series[p][v])+1e-4:u[h][v]+=parseFloat(i.series[p][v]))}})}),Object.entries(l).forEach(function(h){var p=ar(h,1)[0];l[p].forEach(function(v,y){i.maxY=Math.max(i.maxY,l[p][y]),i.minY=Math.min(i.minY,u[p][y])})})}}}]),P}(),ca=function(){function P(r,i){F(this,P),this.ctx=r,this.elgrid=i,this.w=r.w;var o=this.w;this.xaxisFontSize=o.config.xaxis.labels.style.fontSize,this.axisFontFamily=o.config.xaxis.labels.style.fontFamily,this.xaxisForeColors=o.config.xaxis.labels.style.colors,this.isCategoryBarHorizontal="bar"===o.config.chart.type&&o.config.plotOptions.bar.horizontal,this.xAxisoffX=0,"bottom"===o.config.xaxis.position&&(this.xAxisoffX=o.globals.gridHeight),this.drawnLabels=[],this.axesUtils=new mt(r)}return me(P,[{key:"drawYaxis",value:function(r){var i=this,o=this.w,l=new Ke(this.ctx),u=o.config.yaxis[r].labels.style,h=u.fontSize,p=u.fontFamily,v=u.fontWeight,y=l.group({class:"apexcharts-yaxis",rel:r,transform:"translate("+o.globals.translateYAxisX[r]+", 0)"});if(this.axesUtils.isYAxisHidden(r))return y;var C=l.group({class:"apexcharts-yaxis-texts-g"});y.add(C);var k=o.globals.yAxisScale[r].result.length-1,S=o.globals.gridHeight/k,R=o.globals.yLabelFormatters[r],N=o.globals.yAxisScale[r].result.slice();N=this.axesUtils.checkForReversedLabels(r,N);var B="";if(o.config.yaxis[r].labels.show){var U=o.globals.translateY+o.config.yaxis[r].labels.offsetY;o.globals.isBarHorizontal?U=0:"heatmap"===o.config.chart.type&&(U-=S/2),U+=parseInt(o.config.yaxis[r].labels.style.fontSize,10)/3;for(var j=function(ve){var ge=N[ve];ge=R(ge,ve,o);var Le=o.config.yaxis[r].labels.padding;o.config.yaxis[r].opposite&&0!==o.config.yaxis.length&&(Le*=-1);var qe="end";o.config.yaxis[r].opposite&&(qe="start"),"left"===o.config.yaxis[r].labels.align?qe="start":"center"===o.config.yaxis[r].labels.align?qe="middle":"right"===o.config.yaxis[r].labels.align&&(qe="end");var Pe=i.axesUtils.getYAxisForeColor(u.colors,r),Ue=l.drawText({x:Le,y:U,text:ge,textAnchor:qe,fontSize:h,fontFamily:p,fontWeight:v,maxWidth:o.config.yaxis[r].labels.maxWidth,foreColor:Array.isArray(Pe)?Pe[ve]:Pe,isPlainText:!1,cssClass:"apexcharts-yaxis-label "+u.cssClass});ve===k&&(B=Ue),C.add(Ue);var lt=document.createElementNS(o.globals.SVGNS,"title");if(lt.textContent=Array.isArray(ge)?ge.join(" "):ge,Ue.node.appendChild(lt),0!==o.config.yaxis[r].labels.rotate){var ft=l.rotateAroundCenter(B.node),At=l.rotateAroundCenter(Ue.node);Ue.node.setAttribute("transform","rotate(".concat(o.config.yaxis[r].labels.rotate," ").concat(ft.x," ").concat(At.y,")"))}U+=S},K=k;K>=0;K--)j(K)}if(void 0!==o.config.yaxis[r].title.text){var x=l.group({class:"apexcharts-yaxis-title"}),I=0;o.config.yaxis[r].opposite&&(I=o.globals.translateYAxisX[r]);var W=l.drawText({x:I,y:o.globals.gridHeight/2+o.globals.translateY+o.config.yaxis[r].title.offsetY,text:o.config.yaxis[r].title.text,textAnchor:"end",foreColor:o.config.yaxis[r].title.style.color,fontSize:o.config.yaxis[r].title.style.fontSize,fontWeight:o.config.yaxis[r].title.style.fontWeight,fontFamily:o.config.yaxis[r].title.style.fontFamily,cssClass:"apexcharts-yaxis-title-text "+o.config.yaxis[r].title.style.cssClass});x.add(W),y.add(x)}var q=o.config.yaxis[r].axisBorder,J=31+q.offsetX;if(o.config.yaxis[r].opposite&&(J=-31-q.offsetX),q.show){var ne=l.drawLine(J,o.globals.translateY+q.offsetY-2,J,o.globals.gridHeight+o.globals.translateY+q.offsetY+2,q.color,0,q.width);y.add(ne)}return o.config.yaxis[r].axisTicks.show&&this.axesUtils.drawYAxisTicks(J,k,q,o.config.yaxis[r].axisTicks,r,S,y),y}},{key:"drawYaxisInversed",value:function(r){var i=this.w,o=new Ke(this.ctx),l=o.group({class:"apexcharts-xaxis apexcharts-yaxis-inversed"}),u=o.group({class:"apexcharts-xaxis-texts-g",transform:"translate(".concat(i.globals.translateXAxisX,", ").concat(i.globals.translateXAxisY,")")});l.add(u);var h=i.globals.yAxisScale[r].result.length-1,p=i.globals.gridWidth/h+.1,v=p+i.config.xaxis.labels.offsetX,y=i.globals.xLabelFormatter,C=i.globals.yAxisScale[r].result.slice(),k=i.globals.timescaleLabels;k.length>0&&(this.xaxisLabels=k.slice(),h=(C=k.slice()).length),C=this.axesUtils.checkForReversedLabels(r,C);var S=k.length;if(i.config.xaxis.labels.show)for(var R=S?0:h;S?R<S:R>=0;S?R++:R--){var N=C[R];N=y(N,R,i);var B=i.globals.gridWidth+i.globals.padHorizontal-(v-p+i.config.xaxis.labels.offsetX);if(k.length){var U=this.axesUtils.getLabel(C,k,B,R,this.drawnLabels,this.xaxisFontSize);B=U.x,N=U.text,this.drawnLabels.push(U.text),0===R&&i.globals.skipFirstTimelinelabel&&(N=""),R===C.length-1&&i.globals.skipLastTimelinelabel&&(N="")}var j=o.drawText({x:B,y:this.xAxisoffX+i.config.xaxis.labels.offsetY+30-("top"===i.config.xaxis.position?i.globals.xAxisHeight+i.config.xaxis.axisTicks.height-2:0),text:N,textAnchor:"middle",foreColor:Array.isArray(this.xaxisForeColors)?this.xaxisForeColors[r]:this.xaxisForeColors,fontSize:this.xaxisFontSize,fontFamily:this.xaxisFontFamily,fontWeight:i.config.xaxis.labels.style.fontWeight,isPlainText:!1,cssClass:"apexcharts-xaxis-label "+i.config.xaxis.labels.style.cssClass});u.add(j),j.tspan(N);var K=document.createElementNS(i.globals.SVGNS,"title");K.textContent=N,j.node.appendChild(K),v+=p}return this.inversedYAxisTitleText(l),this.inversedYAxisBorder(l),l}},{key:"inversedYAxisBorder",value:function(r){var i=this.w,o=new Ke(this.ctx),l=i.config.xaxis.axisBorder;if(l.show){var u=0;"bar"===i.config.chart.type&&i.globals.isXNumeric&&(u-=15);var h=o.drawLine(i.globals.padHorizontal+u+l.offsetX,this.xAxisoffX,i.globals.gridWidth,this.xAxisoffX,l.color,0,l.height);this.elgrid&&this.elgrid.elGridBorders&&i.config.grid.show?this.elgrid.elGridBorders.add(h):r.add(h)}}},{key:"inversedYAxisTitleText",value:function(r){var i=this.w,o=new Ke(this.ctx);if(void 0!==i.config.xaxis.title.text){var l=o.group({class:"apexcharts-xaxis-title apexcharts-yaxis-title-inversed"}),u=o.drawText({x:i.globals.gridWidth/2+i.config.xaxis.title.offsetX,y:this.xAxisoffX+parseFloat(this.xaxisFontSize)+parseFloat(i.config.xaxis.title.style.fontSize)+i.config.xaxis.title.offsetY+20,text:i.config.xaxis.title.text,textAnchor:"middle",fontSize:i.config.xaxis.title.style.fontSize,fontFamily:i.config.xaxis.title.style.fontFamily,fontWeight:i.config.xaxis.title.style.fontWeight,foreColor:i.config.xaxis.title.style.color,cssClass:"apexcharts-xaxis-title-text "+i.config.xaxis.title.style.cssClass});l.add(u),r.add(l)}}},{key:"yAxisTitleRotate",value:function(r,i){var o=this.w,l=new Ke(this.ctx),u={width:0,height:0},h={width:0,height:0},p=o.globals.dom.baseEl.querySelector(" .apexcharts-yaxis[rel='".concat(r,"'] .apexcharts-yaxis-texts-g"));null!==p&&(u=p.getBoundingClientRect());var v=o.globals.dom.baseEl.querySelector(".apexcharts-yaxis[rel='".concat(r,"'] .apexcharts-yaxis-title text"));if(null!==v&&(h=v.getBoundingClientRect()),null!==v){var y=this.xPaddingForYAxisTitle(r,u,h,i);v.setAttribute("x",y.xPos-(i?10:0))}if(null!==v){var C=l.rotateAroundCenter(v);v.setAttribute("transform","rotate(".concat(i?-1*o.config.yaxis[r].title.rotate:o.config.yaxis[r].title.rotate," ").concat(C.x," ").concat(C.y,")"))}}},{key:"xPaddingForYAxisTitle",value:function(r,i,o,l){var u=this.w,h=0,p=0,v=10;return void 0===u.config.yaxis[r].title.text||r<0?{xPos:p,padd:0}:(l?(p=i.width+u.config.yaxis[r].title.offsetX+o.width/2+v/2,0===(h+=1)&&(p-=v/2)):(p=-1*i.width+u.config.yaxis[r].title.offsetX+v/2+o.width/2,u.globals.isBarHorizontal&&(p=-1*i.width-u.config.yaxis[r].title.offsetX-(v=25))),{xPos:p,padd:v})}},{key:"setYAxisXPosition",value:function(r,i){var o=this.w,l=0,u=0,h=18,p=1;o.config.yaxis.length>1&&(this.multipleYs=!0),o.config.yaxis.map(function(v,y){var C=o.globals.ignoreYAxisIndexes.indexOf(y)>-1||!v.show||v.floating||0===r[y].width,k=r[y].width+i[y].width;v.opposite?o.globals.isBarHorizontal?o.globals.translateYAxisX[y]=(u=o.globals.gridWidth+o.globals.translateX-1)-v.labels.offsetX:(u=o.globals.gridWidth+o.globals.translateX+p,C||(p=p+k+20),o.globals.translateYAxisX[y]=u-v.labels.offsetX+20):(l=o.globals.translateX-h,C||(h=h+k+20),o.globals.translateYAxisX[y]=l+v.labels.offsetX)})}},{key:"setYAxisTextAlignments",value:function(){var r=this.w,i=r.globals.dom.baseEl.getElementsByClassName("apexcharts-yaxis");(i=pe.listToArray(i)).forEach(function(o,l){var u=r.config.yaxis[l];if(u&&!u.floating&&void 0!==u.labels.align){var h=r.globals.dom.baseEl.querySelector(".apexcharts-yaxis[rel='".concat(l,"'] .apexcharts-yaxis-texts-g")),p=r.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxis[rel='".concat(l,"'] .apexcharts-yaxis-label"));p=pe.listToArray(p);var v=h.getBoundingClientRect();"left"===u.labels.align?(p.forEach(function(y,C){y.setAttribute("text-anchor","start")}),u.opposite||h.setAttribute("transform","translate(-".concat(v.width,", 0)"))):"center"===u.labels.align?(p.forEach(function(y,C){y.setAttribute("text-anchor","middle")}),h.setAttribute("transform","translate(".concat(v.width/2*(u.opposite?1:-1),", 0)"))):"right"===u.labels.align&&(p.forEach(function(y,C){y.setAttribute("text-anchor","end")}),u.opposite&&h.setAttribute("transform","translate(".concat(v.width,", 0)")))}})}}]),P}(),yr=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w,this.documentEvent=pe.bind(this.documentEvent,this)}return me(P,[{key:"addEventListener",value:function(r,i){var o=this.w;o.globals.events.hasOwnProperty(r)?o.globals.events[r].push(i):o.globals.events[r]=[i]}},{key:"removeEventListener",value:function(r,i){var o=this.w;if(o.globals.events.hasOwnProperty(r)){var l=o.globals.events[r].indexOf(i);-1!==l&&o.globals.events[r].splice(l,1)}}},{key:"fireEvent",value:function(r,i){var o=this.w;if(o.globals.events.hasOwnProperty(r)){i&&i.length||(i=[]);for(var l=o.globals.events[r],u=l.length,h=0;h<u;h++)l[h].apply(null,i)}}},{key:"setupEventHandlers",value:function(){var r=this,i=this.w,o=this.ctx,l=i.globals.dom.baseEl.querySelector(i.globals.chartClass);this.ctx.eventList.forEach(function(u){l.addEventListener(u,function(h){var p=Object.assign({},i,{seriesIndex:i.globals.axisCharts?i.globals.capturedSeriesIndex:0,dataPointIndex:i.globals.capturedDataPointIndex});"mousemove"===h.type||"touchmove"===h.type?"function"==typeof i.config.chart.events.mouseMove&&i.config.chart.events.mouseMove(h,o,p):"mouseleave"===h.type||"touchleave"===h.type?"function"==typeof i.config.chart.events.mouseLeave&&i.config.chart.events.mouseLeave(h,o,p):("mouseup"===h.type&&1===h.which||"touchend"===h.type)&&("function"==typeof i.config.chart.events.click&&i.config.chart.events.click(h,o,p),o.ctx.events.fireEvent("click",[h,o,p]))},{capture:!1,passive:!0})}),this.ctx.eventList.forEach(function(u){i.globals.dom.baseEl.addEventListener(u,r.documentEvent,{passive:!0})}),this.ctx.core.setupBrushHandler()}},{key:"documentEvent",value:function(r){var i=this.w,o=r.target.className;if("click"===r.type){var l=i.globals.dom.baseEl.querySelector(".apexcharts-menu");l&&l.classList.contains("apexcharts-menu-open")&&"apexcharts-menu-icon"!==o&&l.classList.remove("apexcharts-menu-open")}i.globals.clientX="touchmove"===r.type?r.touches[0].clientX:r.clientX,i.globals.clientY="touchmove"===r.type?r.touches[0].clientY:r.clientY}}]),P}(),di=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w}return me(P,[{key:"setCurrentLocaleValues",value:function(r){var i=this.w.config.chart.locales;window.Apex.chart&&window.Apex.chart.locales&&window.Apex.chart.locales.length>0&&(i=this.w.config.chart.locales.concat(window.Apex.chart.locales));var o=i.filter(function(u){return u.name===r})[0];if(!o)throw new Error("Wrong locale name provided. Please make sure you set the correct locale name in options");var l=pe.extend(Cn,o);this.w.globals.locale=l.options}}]),P}(),fi=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w}return me(P,[{key:"drawAxis",value:function(r,i){var o,l,u=this,h=this.w.globals,p=this.w.config,v=new Pr(this.ctx,i),y=new ca(this.ctx,i);h.axisCharts&&"radar"!==r&&(h.isBarHorizontal?(l=y.drawYaxisInversed(0),o=v.drawXaxisInversed(0),h.dom.elGraphical.add(o),h.dom.elGraphical.add(l)):(o=v.drawXaxis(),h.dom.elGraphical.add(o),p.yaxis.map(function(C,k){if(-1===h.ignoreYAxisIndexes.indexOf(k)&&(l=y.drawYaxis(k),h.dom.Paper.add(l),"back"===u.w.config.grid.position)){var S=h.dom.Paper.children()[1];S.remove(),h.dom.Paper.add(S)}})))}}]),P}(),Da=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w}return me(P,[{key:"drawXCrosshairs",value:function(){var r=this.w,i=new Ke(this.ctx),o=new On(this.ctx),l=r.config.xaxis.crosshairs.fill.gradient,u=r.config.xaxis.crosshairs.dropShadow,S=u.enabled,R=u.left,N=u.top,B=u.blur,U=u.color,j=u.opacity,K=r.config.xaxis.crosshairs.fill.color;if(r.config.xaxis.crosshairs.show){"gradient"===r.config.xaxis.crosshairs.fill.type&&(K=i.drawGradient("vertical",l.colorFrom,l.colorTo,l.opacityFrom,l.opacityTo,null,l.stops,null));var x=i.drawRect();1===r.config.xaxis.crosshairs.width&&(x=i.drawLine());var I=r.globals.gridHeight;(!pe.isNumber(I)||I<0)&&(I=0);var W=r.config.xaxis.crosshairs.width;(!pe.isNumber(W)||W<0)&&(W=0),x.attr({class:"apexcharts-xcrosshairs",x:0,y:0,y2:I,width:W,height:I,fill:K,filter:"none","fill-opacity":r.config.xaxis.crosshairs.opacity,stroke:r.config.xaxis.crosshairs.stroke.color,"stroke-width":r.config.xaxis.crosshairs.stroke.width,"stroke-dasharray":r.config.xaxis.crosshairs.stroke.dashArray}),S&&(x=o.dropShadow(x,{left:R,top:N,blur:B,color:U,opacity:j})),r.globals.dom.elGraphical.add(x)}}},{key:"drawYCrosshairs",value:function(){var r=this.w,i=new Ke(this.ctx),o=r.config.yaxis[0].crosshairs,l=r.globals.barPadForNumericAxis;if(r.config.yaxis[0].crosshairs.show){var u=i.drawLine(-l,0,r.globals.gridWidth+l,0,o.stroke.color,o.stroke.dashArray,o.stroke.width);u.attr({class:"apexcharts-ycrosshairs"}),r.globals.dom.elGraphical.add(u)}var h=i.drawLine(-l,0,r.globals.gridWidth+l,0,o.stroke.color,0,0);h.attr({class:"apexcharts-ycrosshairs-hidden"}),r.globals.dom.elGraphical.add(h)}}]),P}(),wa=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w}return me(P,[{key:"checkResponsiveConfig",value:function(r){var i=this,o=this.w,l=o.config;if(0!==l.responsive.length){var u=l.responsive.slice();u.sort(function(y,C){return y.breakpoint>C.breakpoint?1:C.breakpoint>y.breakpoint?-1:0}).reverse();var h=new Je({}),p=function(){var y=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},k=window.innerWidth>0?window.innerWidth:screen.width;if(k>u[0].breakpoint){var S=pe.clone(o.globals.initialConfig);S.series=pe.clone(o.config.series);var R=yn.extendArrayProps(h,S,o);y=pe.extend(R,y),y=pe.extend(o.config,y),i.overrideResponsiveOptions(y)}else for(var N=0;N<u.length;N++)k<u[N].breakpoint&&(y=yn.extendArrayProps(h,u[N].options,o),y=pe.extend(o.config,y),i.overrideResponsiveOptions(y))};if(r){var v=yn.extendArrayProps(h,r,o);v=pe.extend(o.config,v),p(v=pe.extend(v,r))}else p({})}}},{key:"overrideResponsiveOptions",value:function(r){var i=new Je(r).init({responsiveOverride:!0});this.w.config=i}}]),P}(),pi=function(){function P(r){F(this,P),this.ctx=r,this.colors=[],this.w=r.w;var i=this.w;this.isColorFn=!1,this.isHeatmapDistributed="treemap"===i.config.chart.type&&i.config.plotOptions.treemap.distributed||"heatmap"===i.config.chart.type&&i.config.plotOptions.heatmap.distributed,this.isBarDistributed=i.config.plotOptions.bar.distributed&&("bar"===i.config.chart.type||"rangeBar"===i.config.chart.type)}return me(P,[{key:"init",value:function(){this.setDefaultColors()}},{key:"setDefaultColors",value:function(){var r,i=this,o=this.w,l=new pe;if(o.globals.dom.elWrap.classList.add("apexcharts-theme-".concat(o.config.theme.mode)),void 0===o.config.colors||0===(null===(r=o.config.colors)||void 0===r?void 0:r.length)?o.globals.colors=this.predefined():(o.globals.colors=o.config.colors,Array.isArray(o.config.colors)&&o.config.colors.length>0&&"function"==typeof o.config.colors[0]&&(o.globals.colors=o.config.series.map(function(N,B){var U=o.config.colors[B];return U||(U=o.config.colors[0]),"function"==typeof U?(i.isColorFn=!0,U({value:o.globals.axisCharts?o.globals.series[B][0]?o.globals.series[B][0]:0:o.globals.series[B],seriesIndex:B,dataPointIndex:B,w:o})):U}))),o.globals.seriesColors.map(function(N,B){N&&(o.globals.colors[B]=N)}),o.config.theme.monochrome.enabled){var u=[],h=o.globals.series.length;(this.isBarDistributed||this.isHeatmapDistributed)&&(h=o.globals.series[0].length*o.globals.series.length);for(var p=o.config.theme.monochrome.color,v=1/(h/o.config.theme.monochrome.shadeIntensity),y=o.config.theme.monochrome.shadeTo,C=0,k=0;k<h;k++){var S=void 0;"dark"===y?(S=l.shadeColor(-1*C,p),C+=v):(S=l.shadeColor(C,p),C+=v),u.push(S)}o.globals.colors=u.slice()}var R=o.globals.colors.slice();this.pushExtraColors(o.globals.colors),["fill","stroke"].forEach(function(N){o.globals[N].colors=void 0===o.config[N].colors?i.isColorFn?o.config.colors:R:o.config[N].colors.slice(),i.pushExtraColors(o.globals[N].colors)}),o.globals.dataLabels.style.colors=void 0===o.config.dataLabels.style.colors?R:o.config.dataLabels.style.colors.slice(),this.pushExtraColors(o.globals.dataLabels.style.colors,50),o.globals.radarPolygons.fill.colors=void 0===o.config.plotOptions.radar.polygons.fill.colors?["dark"===o.config.theme.mode?"#424242":"none"]:o.config.plotOptions.radar.polygons.fill.colors.slice(),this.pushExtraColors(o.globals.radarPolygons.fill.colors,20),o.globals.markers.colors=void 0===o.config.markers.colors?R:o.config.markers.colors.slice(),this.pushExtraColors(o.globals.markers.colors)}},{key:"pushExtraColors",value:function(r,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=this.w,u=i||l.globals.series.length;if(null===o&&(o=this.isBarDistributed||this.isHeatmapDistributed||"heatmap"===l.config.chart.type&&l.config.plotOptions.heatmap.colorScale.inverse),o&&l.globals.series.length&&(u=l.globals.series[l.globals.maxValsInArrayIndex].length*l.globals.series.length),r.length<u)for(var h=u-r.length,p=0;p<h;p++)r.push(r[p])}},{key:"updateThemeOptions",value:function(r){r.chart=r.chart||{},r.tooltip=r.tooltip||{};var i=r.theme.mode,o="dark"===i?"#424242":"light"===i?"#fff":r.chart.background||"#fff",l="dark"===i?"palette4":"light"===i?"palette1":r.theme.palette||"palette1",u="dark"===i?"#f6f7f8":"light"===i?"#373d3f":r.chart.foreColor||"#373d3f";return r.tooltip.theme=i||"light",r.chart.foreColor=u,r.chart.background=o,r.theme.palette=l,r}},{key:"predefined",value:function(){switch(this.w.config.theme.palette){case"palette1":default:this.colors=["#008FFB","#00E396","#FEB019","#FF4560","#775DD0"];break;case"palette2":this.colors=["#3f51b5","#03a9f4","#4caf50","#f9ce1d","#FF9800"];break;case"palette3":this.colors=["#33b2df","#546E7A","#d4526e","#13d8aa","#A5978B"];break;case"palette4":this.colors=["#4ecdc4","#c7f464","#81D4FA","#fd6a6a","#546E7A"];break;case"palette5":this.colors=["#2b908f","#f9a3a4","#90ee7e","#fa4443","#69d2e7"];break;case"palette6":this.colors=["#449DD1","#F86624","#EA3546","#662E9B","#C5D86D"];break;case"palette7":this.colors=["#D7263D","#1B998B","#2E294E","#F46036","#E2C044"];break;case"palette8":this.colors=["#662E9B","#F86624","#F9C80E","#EA3546","#43BCCD"];break;case"palette9":this.colors=["#5C4742","#A5978B","#8D5B4C","#5A2A27","#C4BBAF"];break;case"palette10":this.colors=["#A300D6","#7D02EB","#5653FE","#2983FF","#00B1F2"]}return this.colors}}]),P}(),ii=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w}return me(P,[{key:"draw",value:function(){this.drawTitleSubtitle("title"),this.drawTitleSubtitle("subtitle")}},{key:"drawTitleSubtitle",value:function(r){var i=this.w,o="title"===r?i.config.title:i.config.subtitle,l=i.globals.svgWidth/2,u=o.offsetY,h="middle";if("left"===o.align?(l=10,h="start"):"right"===o.align&&(l=i.globals.svgWidth-10,h="end"),l+=o.offsetX,u=u+parseInt(o.style.fontSize,10)+o.margin/2,void 0!==o.text){var p=new Ke(this.ctx).drawText({x:l,y:u,text:o.text,textAnchor:h,fontSize:o.style.fontSize,fontFamily:o.style.fontFamily,fontWeight:o.style.fontWeight,foreColor:o.style.color,opacity:1});p.node.setAttribute("class","apexcharts-".concat(r,"-text")),i.globals.dom.Paper.add(p)}}}]),P}(),Ca=function(){function P(r){F(this,P),this.w=r.w,this.dCtx=r}return me(P,[{key:"getTitleSubtitleCoords",value:function(r){var i=this.w,o=0,l=0,u="title"===r?i.config.title.floating:i.config.subtitle.floating,h=i.globals.dom.baseEl.querySelector(".apexcharts-".concat(r,"-text"));if(null!==h&&!u){var p=h.getBoundingClientRect();o=p.width,l=i.globals.axisCharts?p.height+5:p.height}return{width:o,height:l}}},{key:"getLegendsRect",value:function(){var r=this.w,i=r.globals.dom.elLegendWrap;r.config.legend.height||"top"!==r.config.legend.position&&"bottom"!==r.config.legend.position||(i.style.maxHeight=r.globals.svgHeight/2+"px");var o=Object.assign({},pe.getBoundingClientRect(i));return this.dCtx.lgRect=null!==i&&!r.config.legend.floating&&r.config.legend.show?{x:o.x,y:o.y,height:o.height,width:0===o.height?0:o.width}:{x:0,y:0,height:0,width:0},"left"!==r.config.legend.position&&"right"!==r.config.legend.position||1.5*this.dCtx.lgRect.width>r.globals.svgWidth&&(this.dCtx.lgRect.width=r.globals.svgWidth/1.5),this.dCtx.lgRect}},{key:"getDatalabelsRect",value:function(){var r=this,i=this.w,o=[];i.config.series.forEach(function(v,y){v.data.forEach(function(C,k){l=i.config.dataLabels.formatter(i.globals.series[y][k],{ctx:r.dCtx.ctx,seriesIndex:y,dataPointIndex:k,w:i}),o.push(l)})});var l=pe.getLargestStringFromArr(o),u=new Ke(this.dCtx.ctx),h=i.config.dataLabels.style,p=u.getTextRects(l,parseInt(h.fontSize),h.fontFamily);return{width:1.05*p.width,height:p.height}}},{key:"getLargestStringFromMultiArr",value:function(r,i){var o=r;if(this.w.globals.isMultiLineX){var l=i.map(function(h,p){return Array.isArray(h)?h.length:1}),u=Math.max.apply(Math,gt(l));o=i[l.indexOf(u)]}return o}}]),P}(),Pi=function(){function P(r){F(this,P),this.w=r.w,this.dCtx=r}return me(P,[{key:"getxAxisLabelsCoords",value:function(){var r,i=this.w,o=i.globals.labels.slice();if(i.config.xaxis.convertedCatToNumeric&&0===o.length&&(o=i.globals.categoryLabels),i.globals.timescaleLabels.length>0){var l=this.getxAxisTimeScaleLabelsCoords();r={width:l.width,height:l.height},i.globals.rotateXLabels=!1}else{this.dCtx.lgWidthForSideLegends="left"!==i.config.legend.position&&"right"!==i.config.legend.position||i.config.legend.floating?0:this.dCtx.lgRect.width;var u=i.globals.xLabelFormatter,h=pe.getLargestStringFromArr(o),p=this.dCtx.dimHelpers.getLargestStringFromMultiArr(h,o);i.globals.isBarHorizontal&&(p=h=i.globals.yAxisScale[0].result.reduce(function(N,B){return N.length>B.length?N:B},0));var v=new Qt(this.dCtx.ctx),y=h;h=v.xLabelFormat(u,h,y,{i:void 0,dateFormatter:new Mn(this.dCtx.ctx).formatDate,w:i}),p=v.xLabelFormat(u,p,y,{i:void 0,dateFormatter:new Mn(this.dCtx.ctx).formatDate,w:i}),(i.config.xaxis.convertedCatToNumeric&&void 0===h||""===String(h).trim())&&(p=h="1");var C=new Ke(this.dCtx.ctx),k=C.getTextRects(h,i.config.xaxis.labels.style.fontSize),S=k;if(h!==p&&(S=C.getTextRects(p,i.config.xaxis.labels.style.fontSize)),(r={width:k.width>=S.width?k.width:S.width,height:k.height>=S.height?k.height:S.height}).width*o.length>i.globals.svgWidth-this.dCtx.lgWidthForSideLegends-this.dCtx.yAxisWidth-this.dCtx.gridPad.left-this.dCtx.gridPad.right&&0!==i.config.xaxis.labels.rotate||i.config.xaxis.labels.rotateAlways){if(!i.globals.isBarHorizontal){i.globals.rotateXLabels=!0;var R=function(N){return C.getTextRects(N,i.config.xaxis.labels.style.fontSize,i.config.xaxis.labels.style.fontFamily,"rotate(".concat(i.config.xaxis.labels.rotate," 0 0)"),!1)};k=R(h),h!==p&&(S=R(p)),r.height=(k.height>S.height?k.height:S.height)/1.5,r.width=k.width>S.width?k.width:S.width}}else i.globals.rotateXLabels=!1}return i.config.xaxis.labels.show||(r={width:0,height:0}),{width:r.width,height:r.height}}},{key:"getxAxisGroupLabelsCoords",value:function(){var r,i=this.w;if(!i.globals.hasXaxisGroups)return{width:0,height:0};var o,l=(null===(r=i.config.xaxis.group.style)||void 0===r?void 0:r.fontSize)||i.config.xaxis.labels.style.fontSize,u=i.globals.groups.map(function(k){return k.title}),h=pe.getLargestStringFromArr(u),p=this.dCtx.dimHelpers.getLargestStringFromMultiArr(h,u),v=new Ke(this.dCtx.ctx),y=v.getTextRects(h,l),C=y;return h!==p&&(C=v.getTextRects(p,l)),o={width:y.width>=C.width?y.width:C.width,height:y.height>=C.height?y.height:C.height},i.config.xaxis.labels.show||(o={width:0,height:0}),{width:o.width,height:o.height}}},{key:"getxAxisTitleCoords",value:function(){var r=this.w,i=0,o=0;if(void 0!==r.config.xaxis.title.text){var l=new Ke(this.dCtx.ctx).getTextRects(r.config.xaxis.title.text,r.config.xaxis.title.style.fontSize);i=l.width,o=l.height}return{width:i,height:o}}},{key:"getxAxisTimeScaleLabelsCoords",value:function(){var r,i=this.w;this.dCtx.timescaleLabels=i.globals.timescaleLabels.slice();var o=this.dCtx.timescaleLabels.map(function(u){return u.value}),l=o.reduce(function(u,h){return void 0===u?(console.error("You have possibly supplied invalid Date format. Please supply a valid JavaScript Date"),0):u.length>h.length?u:h},0);return 1.05*(r=new Ke(this.dCtx.ctx).getTextRects(l,i.config.xaxis.labels.style.fontSize)).width*o.length>i.globals.gridWidth&&0!==i.config.xaxis.labels.rotate&&(i.globals.overlappingXLabels=!0),r}},{key:"additionalPaddingXLabels",value:function(r){var i=this,o=this.w,l=o.globals,u=o.config,h=u.xaxis.type,p=r.width;l.skipLastTimelinelabel=!1,l.skipFirstTimelinelabel=!1;var v=o.config.yaxis[0].opposite&&o.globals.isBarHorizontal;u.yaxis.forEach(function(C,k){v?(i.dCtx.gridPad.left<p&&(i.dCtx.xPadLeft=p/2+1),i.dCtx.xPadRight=p/2+1):function(C,k){u.yaxis.length>1&&-1!==l.collapsedSeriesIndices.indexOf(k)||function(S){if(i.dCtx.timescaleLabels&&i.dCtx.timescaleLabels.length){var B=i.dCtx.timescaleLabels[0].position-p/1.75+i.dCtx.yAxisWidthLeft;i.dCtx.timescaleLabels[i.dCtx.timescaleLabels.length-1].position+p/1.75-i.dCtx.yAxisWidthRight>l.svgWidth-l.translateX-("right"===o.config.legend.position&&i.dCtx.lgRect.width>0?i.dCtx.lgRect.width:0)&&(l.skipLastTimelinelabel=!0),B<-(S.show&&!S.floating||"bar"!==u.chart.type&&"candlestick"!==u.chart.type&&"rangeBar"!==u.chart.type&&"boxPlot"!==u.chart.type?10:p/1.75)&&(l.skipFirstTimelinelabel=!0)}else"datetime"===h?i.dCtx.gridPad.right<p&&!l.rotateXLabels&&(l.skipLastTimelinelabel=!0):"datetime"!==h&&i.dCtx.gridPad.right<p/2-i.dCtx.yAxisWidthRight&&!l.rotateXLabels&&!o.config.xaxis.labels.trim&&("between"!==o.config.xaxis.tickPlacement||o.globals.isBarHorizontal)&&(i.dCtx.xPadRight=p/2+1)}(C)}(C,k)})}}]),P}(),Tt=function(){function P(r){F(this,P),this.w=r.w,this.dCtx=r}return me(P,[{key:"getyAxisLabelsCoords",value:function(){var r=this,i=this.w,o=[],l=10,u=new mt(this.dCtx.ctx);return i.config.yaxis.map(function(h,p){var v={seriesIndex:p,dataPointIndex:-1,w:i},y=i.globals.yAxisScale[p],C=0;if(!u.isYAxisHidden(p)&&h.labels.show&&void 0!==h.labels.minWidth&&(C=h.labels.minWidth),!u.isYAxisHidden(p)&&h.labels.show&&y.result.length){var k=i.globals.yLabelFormatters[p],R=y.result.reduce(function(I,W){var q,J;return(null===(q=String(k(I,v)))||void 0===q?void 0:q.length)>(null===(J=String(k(W,v)))||void 0===J?void 0:J.length)?I:W},y.niceMin===Number.MIN_VALUE?0:y.niceMin),N=R=k(R,v);if(void 0!==R&&0!==R.length||(R=y.niceMax),i.globals.isBarHorizontal){l=0;var B=i.globals.labels.slice();R=pe.getLargestStringFromArr(B),R=k(R,{seriesIndex:p,dataPointIndex:-1,w:i}),N=r.dCtx.dimHelpers.getLargestStringFromMultiArr(R,B)}var U=new Ke(r.dCtx.ctx),j="rotate(".concat(h.labels.rotate," 0 0)"),K=U.getTextRects(R,h.labels.style.fontSize,h.labels.style.fontFamily,j,!1),x=K;R!==N&&(x=U.getTextRects(N,h.labels.style.fontSize,h.labels.style.fontFamily,j,!1)),o.push({width:(C>x.width||C>K.width?C:x.width>K.width?x.width:K.width)+l,height:x.height>K.height?x.height:K.height})}else o.push({width:0,height:0})}),o}},{key:"getyAxisTitleCoords",value:function(){var r=this,o=[];return this.w.config.yaxis.map(function(l,u){if(l.show&&void 0!==l.title.text){var h=new Ke(r.dCtx.ctx),p="rotate(".concat(l.title.rotate," 0 0)"),v=h.getTextRects(l.title.text,l.title.style.fontSize,l.title.style.fontFamily,p,!1);o.push({width:v.width,height:v.height})}else o.push({width:0,height:0})}),o}},{key:"getTotalYAxisWidth",value:function(){var r=this.w,i=0,o=0,l=0,u=r.globals.yAxisScale.length>1?10:0,h=new mt(this.dCtx.ctx),p=function(v,y){var C=r.config.yaxis[y].floating,k=0;v.width>0&&!C?(k=v.width+u,r.globals.ignoreYAxisIndexes.indexOf(y)>-1&&(k=k-v.width-u)):k=C||h.isYAxisHidden(y)?0:5,r.config.yaxis[y].opposite?l+=k:o+=k,i+=k};return r.globals.yLabelsCoords.map(function(v,y){p(v,y)}),r.globals.yTitleCoords.map(function(v,y){p(v,y)}),r.globals.isBarHorizontal&&!r.config.yaxis[0].floating&&(i=r.globals.yLabelsCoords[0].width+r.globals.yTitleCoords[0].width+15),this.dCtx.yAxisWidthLeft=o,this.dCtx.yAxisWidthRight=l,i}}]),P}(),nr=function(){function P(r){F(this,P),this.w=r.w,this.dCtx=r}return me(P,[{key:"gridPadForColumnsInNumericAxis",value:function(r){var i=this.w,o=i.config,l=i.globals;if(l.noData||l.collapsedSeries.length+l.ancillaryCollapsedSeries.length===o.series.length)return 0;var u=function(R){return"bar"===R||"rangeBar"===R||"candlestick"===R||"boxPlot"===R},h=o.chart.type,p=0,v=u(h)?o.series.length:1;l.comboBarCount>0&&(v=l.comboBarCount),l.collapsedSeries.forEach(function(R){u(R.type)&&(v-=1)}),o.chart.stacked&&(v=1);var k,S,y=u(h)||l.comboBarCount>0,C=Math.abs(l.initialMaxX-l.initialMinX);return y&&l.isXNumeric&&!l.isBarHorizontal&&v>0&&0!==C&&(C<=3&&(C=l.dataPoints),k=C/r,l.minXDiff&&l.minXDiff/k>0&&(S=l.minXDiff/k),S>r/2&&(S/=2),(p=S*parseInt(o.plotOptions.bar.columnWidth,10)/100)<1&&(p=1),l.barPadForNumericAxis=p),p}},{key:"gridPadFortitleSubtitle",value:function(){var r=this,i=this.w,o=i.globals,l=this.dCtx.isSparkline||!i.globals.axisCharts?0:10;["title","subtitle"].forEach(function(p){l+=void 0!==i.config[p].text?i.config[p].margin:r.dCtx.isSparkline||!i.globals.axisCharts?0:5}),!i.config.legend.show||"bottom"!==i.config.legend.position||i.config.legend.floating||i.globals.axisCharts||(l+=10);var u=this.dCtx.dimHelpers.getTitleSubtitleCoords("title"),h=this.dCtx.dimHelpers.getTitleSubtitleCoords("subtitle");o.gridHeight=o.gridHeight-u.height-h.height-l,o.translateY=o.translateY+u.height+h.height+l}},{key:"setGridXPosForDualYAxis",value:function(r,i){var o=this.w,l=new mt(this.dCtx.ctx);o.config.yaxis.map(function(u,h){-1!==o.globals.ignoreYAxisIndexes.indexOf(h)||u.floating||l.isYAxisHidden(h)||(u.opposite&&(o.globals.translateX=o.globals.translateX-(i[h].width+r[h].width)-parseInt(o.config.yaxis[h].labels.style.fontSize,10)/1.2-12),o.globals.translateX<2&&(o.globals.translateX=2))})}}]),P}(),Pa=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w,this.lgRect={},this.yAxisWidth=0,this.yAxisWidthLeft=0,this.yAxisWidthRight=0,this.xAxisHeight=0,this.isSparkline=this.w.config.chart.sparkline.enabled,this.dimHelpers=new Ca(this),this.dimYAxis=new Tt(this),this.dimXAxis=new Pi(this),this.dimGrid=new nr(this),this.lgWidthForSideLegends=0,this.gridPad=this.w.config.grid.padding,this.xPadRight=0,this.xPadLeft=0}return me(P,[{key:"plotCoords",value:function(){var r=this,i=this.w,o=i.globals;this.lgRect=this.dimHelpers.getLegendsRect(),this.datalabelsCoords={width:0,height:0};var l=Array.isArray(i.config.stroke.width)?Math.max.apply(Math,gt(i.config.stroke.width)):i.config.stroke.width;this.isSparkline&&((i.config.markers.discrete.length>0||i.config.markers.size>0)&&Object.entries(this.gridPad).forEach(function(h){var p=ar(h,2);r.gridPad[p[0]]=Math.max(p[1],r.w.globals.markers.largestSize/1.5)}),this.gridPad.top=Math.max(l/2,this.gridPad.top),this.gridPad.bottom=Math.max(l/2,this.gridPad.bottom)),o.axisCharts?this.setDimensionsForAxisCharts():this.setDimensionsForNonAxisCharts(),this.dimGrid.gridPadFortitleSubtitle(),o.gridHeight=o.gridHeight-this.gridPad.top-this.gridPad.bottom,o.gridWidth=o.gridWidth-this.gridPad.left-this.gridPad.right-this.xPadRight-this.xPadLeft;var u=this.dimGrid.gridPadForColumnsInNumericAxis(o.gridWidth);o.gridWidth=o.gridWidth-2*u,o.translateX=o.translateX+this.gridPad.left+this.xPadLeft+(u>0?u:0),o.translateY=o.translateY+this.gridPad.top}},{key:"setDimensionsForAxisCharts",value:function(){var r=this,i=this.w,o=i.globals,l=this.dimYAxis.getyAxisLabelsCoords(),u=this.dimYAxis.getyAxisTitleCoords();o.isSlopeChart&&(this.datalabelsCoords=this.dimHelpers.getDatalabelsRect()),i.globals.yLabelsCoords=[],i.globals.yTitleCoords=[],i.config.yaxis.map(function(R,N){i.globals.yLabelsCoords.push({width:l[N].width,index:N}),i.globals.yTitleCoords.push({width:u[N].width,index:N})}),this.yAxisWidth=this.dimYAxis.getTotalYAxisWidth();var h=this.dimXAxis.getxAxisLabelsCoords(),p=this.dimXAxis.getxAxisGroupLabelsCoords(),v=this.dimXAxis.getxAxisTitleCoords();this.conditionalChecksForAxisCoords(h,v,p),o.translateXAxisY=i.globals.rotateXLabels?this.xAxisHeight/8:-4,o.translateXAxisX=i.globals.rotateXLabels&&i.globals.isXNumeric&&i.config.xaxis.labels.rotate<=-45?-this.xAxisWidth/4:0,i.globals.isBarHorizontal&&(o.rotateXLabels=!1,o.translateXAxisY=parseInt(i.config.xaxis.labels.style.fontSize,10)/1.5*-1),o.translateXAxisY=o.translateXAxisY+i.config.xaxis.labels.offsetY,o.translateXAxisX=o.translateXAxisX+i.config.xaxis.labels.offsetX;var y=this.yAxisWidth,C=this.xAxisHeight;o.xAxisLabelsHeight=this.xAxisHeight-v.height,o.xAxisGroupLabelsHeight=o.xAxisLabelsHeight-h.height,o.xAxisLabelsWidth=this.xAxisWidth,o.xAxisHeight=this.xAxisHeight;var k=10;("radar"===i.config.chart.type||this.isSparkline)&&(y=0,C=o.goldenPadding),this.isSparkline&&(this.lgRect={height:0,width:0}),(this.isSparkline||"treemap"===i.config.chart.type)&&(y=0,C=0,k=0),this.isSparkline||this.dimXAxis.additionalPaddingXLabels(h);var S=function(){o.translateX=y+r.datalabelsCoords.width,o.gridHeight=o.svgHeight-r.lgRect.height-C-(r.isSparkline||"treemap"===i.config.chart.type?0:i.globals.rotateXLabels?10:15),o.gridWidth=o.svgWidth-y-2*r.datalabelsCoords.width};switch("top"===i.config.xaxis.position&&(k=o.xAxisHeight-i.config.xaxis.axisTicks.height-5),i.config.legend.position){case"bottom":o.translateY=k,S();break;case"top":o.translateY=this.lgRect.height+k,S();break;case"left":o.translateY=k,o.translateX=this.lgRect.width+y+this.datalabelsCoords.width,o.gridHeight=o.svgHeight-C-12,o.gridWidth=o.svgWidth-this.lgRect.width-y-2*this.datalabelsCoords.width;break;case"right":o.translateY=k,o.translateX=y+this.datalabelsCoords.width,o.gridHeight=o.svgHeight-C-12,o.gridWidth=o.svgWidth-this.lgRect.width-y-2*this.datalabelsCoords.width-5;break;default:throw new Error("Legend position not supported")}this.dimGrid.setGridXPosForDualYAxis(u,l),new ca(this.ctx).setYAxisXPosition(l,u)}},{key:"setDimensionsForNonAxisCharts",value:function(){var r=this.w,i=r.globals,o=r.config,l=0;r.config.legend.show&&!r.config.legend.floating&&(l=20);var u="pie"===o.chart.type||"polarArea"===o.chart.type||"donut"===o.chart.type?"pie":"radialBar",h=o.plotOptions[u].offsetY,p=o.plotOptions[u].offsetX;if(!o.legend.show||o.legend.floating)return i.gridHeight=i.svgHeight-o.grid.padding.left+o.grid.padding.right,i.gridWidth=Math.min(i.svgWidth,i.gridHeight),i.translateY=h,void(i.translateX=p+(i.svgWidth-i.gridWidth)/2);switch(o.legend.position){case"bottom":i.gridHeight=i.svgHeight-this.lgRect.height-i.goldenPadding,i.gridWidth=i.svgWidth,i.translateY=h-10,i.translateX=p+(i.svgWidth-i.gridWidth)/2;break;case"top":i.gridHeight=i.svgHeight-this.lgRect.height-i.goldenPadding,i.gridWidth=i.svgWidth,i.translateY=this.lgRect.height+h+10,i.translateX=p+(i.svgWidth-i.gridWidth)/2;break;case"left":i.gridWidth=i.svgWidth-this.lgRect.width-l,i.gridHeight="auto"!==o.chart.height?i.svgHeight:i.gridWidth,i.translateY=h,i.translateX=p+this.lgRect.width+l;break;case"right":i.gridWidth=i.svgWidth-this.lgRect.width-l-5,i.gridHeight="auto"!==o.chart.height?i.svgHeight:i.gridWidth,i.translateY=h,i.translateX=p+10;break;default:throw new Error("Legend position not supported")}}},{key:"conditionalChecksForAxisCoords",value:function(r,i,o){var l=this.w;this.xAxisHeight=(o.height+r.height+i.height)*(l.globals.isMultiLineX?1.2:l.globals.LINE_HEIGHT_RATIO)+(l.globals.hasXaxisGroups?2:1)*(l.globals.rotateXLabels?22:10)+(l.globals.rotateXLabels&&"bottom"===l.config.legend.position?10:0),this.xAxisWidth=r.width,this.xAxisHeight-i.height>l.config.xaxis.labels.maxHeight&&(this.xAxisHeight=l.config.xaxis.labels.maxHeight),l.config.xaxis.labels.minHeight&&this.xAxisHeight<l.config.xaxis.labels.minHeight&&(this.xAxisHeight=l.config.xaxis.labels.minHeight),l.config.xaxis.floating&&(this.xAxisHeight=0);var C=0,k=0;l.config.yaxis.forEach(function(S){C+=S.labels.minWidth,k+=S.labels.maxWidth}),this.yAxisWidth<C&&(this.yAxisWidth=C),this.yAxisWidth>k&&(this.yAxisWidth=k)}}]),P}(),Ma=function(){function P(r){F(this,P),this.w=r.w,this.lgCtx=r}return me(P,[{key:"getLegendStyles",value:function(){var r,i,o,l=document.createElement("style");l.setAttribute("type","text/css");var u=(null===(r=this.lgCtx.ctx)||void 0===r||null===(i=r.opts)||void 0===i||null===(o=i.chart)||void 0===o?void 0:o.nonce)||this.w.config.chart.nonce;u&&l.setAttribute("nonce",u);var h=document.createTextNode("\n      .apexcharts-legend {\n        display: flex;\n        overflow: auto;\n        padding: 0 10px;\n      }\n      .apexcharts-legend.apx-legend-position-bottom, .apexcharts-legend.apx-legend-position-top {\n        flex-wrap: wrap\n      }\n      .apexcharts-legend.apx-legend-position-right, .apexcharts-legend.apx-legend-position-left {\n        flex-direction: column;\n        bottom: 0;\n      }\n      .apexcharts-legend.apx-legend-position-bottom.apexcharts-align-left, .apexcharts-legend.apx-legend-position-top.apexcharts-align-left, .apexcharts-legend.apx-legend-position-right, .apexcharts-legend.apx-legend-position-left {\n        justify-content: flex-start;\n      }\n      .apexcharts-legend.apx-legend-position-bottom.apexcharts-align-center, .apexcharts-legend.apx-legend-position-top.apexcharts-align-center {\n        justify-content: center;\n      }\n      .apexcharts-legend.apx-legend-position-bottom.apexcharts-align-right, .apexcharts-legend.apx-legend-position-top.apexcharts-align-right {\n        justify-content: flex-end;\n      }\n      .apexcharts-legend-series {\n        cursor: pointer;\n        line-height: normal;\n      }\n      .apexcharts-legend.apx-legend-position-bottom .apexcharts-legend-series, .apexcharts-legend.apx-legend-position-top .apexcharts-legend-series{\n        display: flex;\n        align-items: center;\n      }\n      .apexcharts-legend-text {\n        position: relative;\n        font-size: 14px;\n      }\n      .apexcharts-legend-text *, .apexcharts-legend-marker * {\n        pointer-events: none;\n      }\n      .apexcharts-legend-marker {\n        position: relative;\n        display: inline-block;\n        cursor: pointer;\n        margin-right: 3px;\n        border-style: solid;\n      }\n\n      .apexcharts-legend.apexcharts-align-right .apexcharts-legend-series, .apexcharts-legend.apexcharts-align-left .apexcharts-legend-series{\n        display: inline-block;\n      }\n      .apexcharts-legend-series.apexcharts-no-click {\n        cursor: auto;\n      }\n      .apexcharts-legend .apexcharts-hidden-zero-series, .apexcharts-legend .apexcharts-hidden-null-series {\n        display: none !important;\n      }\n      .apexcharts-inactive-legend {\n        opacity: 0.45;\n      }");return l.appendChild(h),l}},{key:"getLegendBBox",value:function(){var r=this.w.globals.dom.baseEl.querySelector(".apexcharts-legend").getBoundingClientRect();return{clwh:r.height,clww:r.width}}},{key:"appendToForeignObject",value:function(){this.w.globals.dom.elLegendForeign.appendChild(this.getLegendStyles())}},{key:"toggleDataSeries",value:function(r,i){var o=this,l=this.w;if(l.globals.axisCharts||"radialBar"===l.config.chart.type){l.globals.resized=!0;var u=null,h=null;l.globals.risingSeries=[],l.globals.axisCharts?(u=l.globals.dom.baseEl.querySelector(".apexcharts-series[data\\:realIndex='".concat(r,"']")),h=parseInt(u.getAttribute("data:realIndex"),10)):(u=l.globals.dom.baseEl.querySelector(".apexcharts-series[rel='".concat(r+1,"']")),h=parseInt(u.getAttribute("rel"),10)-1),i?[{cs:l.globals.collapsedSeries,csi:l.globals.collapsedSeriesIndices},{cs:l.globals.ancillaryCollapsedSeries,csi:l.globals.ancillaryCollapsedSeriesIndices}].forEach(function(C){o.riseCollapsedSeries(C.cs,C.csi,h)}):this.hideSeries({seriesEl:u,realIndex:h})}else{var p=l.globals.dom.Paper.select(" .apexcharts-series[rel='".concat(r+1,"'] path")),v=l.config.chart.type;if("pie"===v||"polarArea"===v||"donut"===v){var y=l.config.plotOptions.pie.donut.labels;new Ke(this.lgCtx.ctx).pathMouseDown(p.members[0],null),this.lgCtx.ctx.pie.printDataLabelsInner(p.members[0].node,y)}p.fire("click")}}},{key:"hideSeries",value:function(r){var i=r.seriesEl,o=r.realIndex,l=this.w,u=l.globals,h=pe.clone(l.config.series);if(u.axisCharts){var p=l.config.yaxis[u.seriesYAxisReverseMap[o]];if(p&&p.show&&p.showAlways)u.ancillaryCollapsedSeriesIndices.indexOf(o)<0&&(u.ancillaryCollapsedSeries.push({index:o,data:h[o].data.slice(),type:i.parentNode.className.baseVal.split("-")[1]}),u.ancillaryCollapsedSeriesIndices.push(o));else if(u.collapsedSeriesIndices.indexOf(o)<0){u.collapsedSeries.push({index:o,data:h[o].data.slice(),type:i.parentNode.className.baseVal.split("-")[1]}),u.collapsedSeriesIndices.push(o);var v=u.risingSeries.indexOf(o);u.risingSeries.splice(v,1)}}else u.collapsedSeries.push({index:o,data:h[o]}),u.collapsedSeriesIndices.push(o);for(var y=i.childNodes,C=0;C<y.length;C++)y[C].classList.contains("apexcharts-series-markers-wrap")&&(y[C].classList.contains("apexcharts-hide")?y[C].classList.remove("apexcharts-hide"):y[C].classList.add("apexcharts-hide"));u.allSeriesCollapsed=u.collapsedSeries.length+u.ancillaryCollapsedSeries.length===l.config.series.length,h=this._getSeriesBasedOnCollapsedState(h),this.lgCtx.ctx.updateHelpers._updateSeries(h,l.config.chart.animations.dynamicAnimation.enabled)}},{key:"riseCollapsedSeries",value:function(r,i,o){var l=this.w,u=pe.clone(l.config.series);if(r.length>0){for(var h=0;h<r.length;h++)r[h].index===o&&(l.globals.axisCharts?(u[o].data=r[h].data.slice(),r.splice(h,1),i.splice(h,1),l.globals.risingSeries.push(o)):(u[o]=r[h].data,r.splice(h,1),i.splice(h,1),l.globals.risingSeries.push(o)));u=this._getSeriesBasedOnCollapsedState(u),this.lgCtx.ctx.updateHelpers._updateSeries(u,l.config.chart.animations.dynamicAnimation.enabled)}}},{key:"_getSeriesBasedOnCollapsedState",value:function(r){var i=this.w,o=0;return r.forEach(i.globals.axisCharts?function(l,u){i.globals.collapsedSeriesIndices.indexOf(u)<0&&i.globals.ancillaryCollapsedSeriesIndices.indexOf(u)<0||(r[u].data=[],o++)}:function(l,u){!i.globals.collapsedSeriesIndices.indexOf(u)<0&&(r[u]=0,o++)}),i.globals.allSeriesCollapsed=o===r.length,r}}]),P}(),Mi=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w,this.onLegendClick=this.onLegendClick.bind(this),this.onLegendHovered=this.onLegendHovered.bind(this),this.isBarsDistributed="bar"===this.w.config.chart.type&&this.w.config.plotOptions.bar.distributed&&1===this.w.config.series.length,this.legendHelpers=new Ma(this)}return me(P,[{key:"init",value:function(){var r=this.w,i=r.globals,o=r.config;if((o.legend.showForSingleSeries&&1===i.series.length||this.isBarsDistributed||i.series.length>1||!i.axisCharts)&&o.legend.show){for(;i.dom.elLegendWrap.firstChild;)i.dom.elLegendWrap.removeChild(i.dom.elLegendWrap.firstChild);this.drawLegends(),pe.isIE11()?document.getElementsByTagName("head")[0].appendChild(this.legendHelpers.getLegendStyles()):this.legendHelpers.appendToForeignObject(),"bottom"===o.legend.position||"top"===o.legend.position?this.legendAlignHorizontal():"right"!==o.legend.position&&"left"!==o.legend.position||this.legendAlignVertical()}}},{key:"drawLegends",value:function(){var r=this,i=this.w,o=i.config.legend.fontFamily,l=i.globals.seriesNames,u=i.globals.colors.slice();if("heatmap"===i.config.chart.type){var h=i.config.plotOptions.heatmap.colorScale.ranges;l=h.map(function(Pe){return Pe.name?Pe.name:Pe.from+" - "+Pe.to}),u=h.map(function(Pe){return Pe.color})}else this.isBarsDistributed&&(l=i.globals.labels.slice());i.config.legend.customLegendItems.length&&(l=i.config.legend.customLegendItems);for(var p=i.globals.legendFormatter,v=i.config.legend.inverseOrder,y=v?l.length-1:0;v?y>=0:y<=l.length-1;v?y--:y++){var C,k=p(l[y],{seriesIndex:y,w:i}),S=!1,R=!1;if(i.globals.collapsedSeries.length>0)for(var N=0;N<i.globals.collapsedSeries.length;N++)i.globals.collapsedSeries[N].index===y&&(S=!0);if(i.globals.ancillaryCollapsedSeriesIndices.length>0)for(var B=0;B<i.globals.ancillaryCollapsedSeriesIndices.length;B++)i.globals.ancillaryCollapsedSeriesIndices[B]===y&&(R=!0);var U=document.createElement("span");U.classList.add("apexcharts-legend-marker");var j=i.config.legend.markers.offsetX,K=i.config.legend.markers.offsetY,x=i.config.legend.markers.height,I=i.config.legend.markers.width,W=i.config.legend.markers.strokeWidth,q=i.config.legend.markers.strokeColor,J=i.config.legend.markers.radius,ne=U.style;ne.background=u[y],ne.color=u[y],ne.setProperty("background",u[y],"important"),i.config.legend.markers.fillColors&&i.config.legend.markers.fillColors[y]&&(ne.background=i.config.legend.markers.fillColors[y]),void 0!==i.globals.seriesColors[y]&&(ne.background=i.globals.seriesColors[y],ne.color=i.globals.seriesColors[y]),ne.height=Array.isArray(x)?parseFloat(x[y])+"px":parseFloat(x)+"px",ne.width=Array.isArray(I)?parseFloat(I[y])+"px":parseFloat(I)+"px",ne.left=(Array.isArray(j)?parseFloat(j[y]):parseFloat(j))+"px",ne.top=(Array.isArray(K)?parseFloat(K[y]):parseFloat(K))+"px",ne.borderWidth=Array.isArray(W)?W[y]:W,ne.borderColor=Array.isArray(q)?q[y]:q,ne.borderRadius=Array.isArray(J)?parseFloat(J[y])+"px":parseFloat(J)+"px",i.config.legend.markers.customHTML&&(Array.isArray(i.config.legend.markers.customHTML)?i.config.legend.markers.customHTML[y]&&(U.innerHTML=i.config.legend.markers.customHTML[y]()):U.innerHTML=i.config.legend.markers.customHTML()),Ke.setAttrs(U,{rel:y+1,"data:collapsed":S||R}),(S||R)&&U.classList.add("apexcharts-inactive-legend");var ve=document.createElement("div"),ge=document.createElement("span");ge.classList.add("apexcharts-legend-text"),ge.innerHTML=Array.isArray(k)?k.join(" "):k;var Le=i.config.legend.labels.useSeriesColors?i.globals.colors[y]:Array.isArray(i.config.legend.labels.colors)?null===(C=i.config.legend.labels.colors)||void 0===C?void 0:C[y]:i.config.legend.labels.colors;Le||(Le=i.config.chart.foreColor),ge.style.color=Le,ge.style.fontSize=parseFloat(i.config.legend.fontSize)+"px",ge.style.fontWeight=i.config.legend.fontWeight,ge.style.fontFamily=o||i.config.chart.fontFamily,Ke.setAttrs(ge,{rel:y+1,i:y,"data:default-text":encodeURIComponent(k),"data:collapsed":S||R}),ve.appendChild(U),ve.appendChild(ge);var qe=new yn(this.ctx);i.config.legend.showForZeroSeries||0===qe.getSeriesTotalByIndex(y)&&qe.seriesHaveSameValues(y)&&!qe.isSeriesNull(y)&&-1===i.globals.collapsedSeriesIndices.indexOf(y)&&-1===i.globals.ancillaryCollapsedSeriesIndices.indexOf(y)&&ve.classList.add("apexcharts-hidden-zero-series"),i.config.legend.showForNullSeries||qe.isSeriesNull(y)&&-1===i.globals.collapsedSeriesIndices.indexOf(y)&&-1===i.globals.ancillaryCollapsedSeriesIndices.indexOf(y)&&ve.classList.add("apexcharts-hidden-null-series"),i.globals.dom.elLegendWrap.appendChild(ve),i.globals.dom.elLegendWrap.classList.add("apexcharts-align-".concat(i.config.legend.horizontalAlign)),i.globals.dom.elLegendWrap.classList.add("apx-legend-position-"+i.config.legend.position),ve.classList.add("apexcharts-legend-series"),ve.style.margin="".concat(i.config.legend.itemMargin.vertical,"px ").concat(i.config.legend.itemMargin.horizontal,"px"),i.globals.dom.elLegendWrap.style.width=i.config.legend.width?i.config.legend.width+"px":"",i.globals.dom.elLegendWrap.style.height=i.config.legend.height?i.config.legend.height+"px":"",Ke.setAttrs(ve,{rel:y+1,seriesName:pe.escapeString(l[y]),"data:collapsed":S||R}),(S||R)&&ve.classList.add("apexcharts-inactive-legend"),i.config.legend.onItemClick.toggleDataSeries||ve.classList.add("apexcharts-no-click")}i.globals.dom.elWrap.addEventListener("click",r.onLegendClick,!0),i.config.legend.onItemHover.highlightDataSeries&&0===i.config.legend.customLegendItems.length&&(i.globals.dom.elWrap.addEventListener("mousemove",r.onLegendHovered,!0),i.globals.dom.elWrap.addEventListener("mouseout",r.onLegendHovered,!0))}},{key:"setLegendWrapXY",value:function(r,i){var o=this.w,l=o.globals.dom.elLegendWrap,u=l.getBoundingClientRect(),h=0,p=0;if("bottom"===o.config.legend.position)p+=o.globals.svgHeight-u.height/2;else if("top"===o.config.legend.position){var v=new Pa(this.ctx),y=v.dimHelpers.getTitleSubtitleCoords("title").height,C=v.dimHelpers.getTitleSubtitleCoords("subtitle").height;p=p+(y>0?y-10:0)+(C>0?C-10:0)}l.style.position="absolute",p=p+i+o.config.legend.offsetY,l.style.left=(h=h+r+o.config.legend.offsetX)+"px",l.style.top=p+"px","bottom"===o.config.legend.position?(l.style.top="auto",l.style.bottom=5-o.config.legend.offsetY+"px"):"right"===o.config.legend.position&&(l.style.left="auto",l.style.right=25+o.config.legend.offsetX+"px"),["width","height"].forEach(function(k){l.style[k]&&(l.style[k]=parseInt(o.config.legend[k],10)+"px")})}},{key:"legendAlignHorizontal",value:function(){var r=this.w;r.globals.dom.elLegendWrap.style.right=0;var i=this.legendHelpers.getLegendBBox(),o=new Pa(this.ctx),l=o.dimHelpers.getTitleSubtitleCoords("title"),u=o.dimHelpers.getTitleSubtitleCoords("subtitle"),h=0;"bottom"===r.config.legend.position?h=-i.clwh/1.8:"top"===r.config.legend.position&&(h=l.height+u.height+r.config.title.margin+r.config.subtitle.margin-10),this.setLegendWrapXY(20,h)}},{key:"legendAlignVertical",value:function(){var r=this.w,i=this.legendHelpers.getLegendBBox(),o=0;"left"===r.config.legend.position&&(o=20),"right"===r.config.legend.position&&(o=r.globals.svgWidth-i.clww-10),this.setLegendWrapXY(o,20)}},{key:"onLegendHovered",value:function(r){var i=this.w,o=r.target.classList.contains("apexcharts-legend-series")||r.target.classList.contains("apexcharts-legend-text")||r.target.classList.contains("apexcharts-legend-marker");if("heatmap"===i.config.chart.type||this.isBarsDistributed){if(o){var l=parseInt(r.target.getAttribute("rel"),10)-1;this.ctx.events.fireEvent("legendHover",[this.ctx,l,this.w]),new Dr(this.ctx).highlightRangeInSeries(r,r.target)}}else!r.target.classList.contains("apexcharts-inactive-legend")&&o&&new Dr(this.ctx).toggleSeriesOnHover(r,r.target)}},{key:"onLegendClick",value:function(r){var i=this.w;if(!i.config.legend.customLegendItems.length&&(r.target.classList.contains("apexcharts-legend-series")||r.target.classList.contains("apexcharts-legend-text")||r.target.classList.contains("apexcharts-legend-marker"))){var o=parseInt(r.target.getAttribute("rel"),10)-1,l="true"===r.target.getAttribute("data:collapsed"),u=this.w.config.chart.events.legendClick;"function"==typeof u&&u(this.ctx,o,this.w),this.ctx.events.fireEvent("legendClick",[this.ctx,o,this.w]);var h=this.w.config.legend.markers.onClick;"function"==typeof h&&r.target.classList.contains("apexcharts-legend-marker")&&(h(this.ctx,o,this.w),this.ctx.events.fireEvent("legendMarkerClick",[this.ctx,o,this.w])),"treemap"!==i.config.chart.type&&"heatmap"!==i.config.chart.type&&!this.isBarsDistributed&&i.config.legend.onItemClick.toggleDataSeries&&this.legendHelpers.toggleDataSeries(o,l)}}}]),P}(),$i=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w;var i=this.w;this.ev=this.w.config.chart.events,this.selectedClass="apexcharts-selected",this.localeValues=this.w.globals.locale.toolbar,this.minX=i.globals.minX,this.maxX=i.globals.maxX}return me(P,[{key:"createToolbar",value:function(){var r=this,i=this.w,o=function(){return document.createElement("div")},l=o();if(l.setAttribute("class","apexcharts-toolbar"),l.style.top=i.config.chart.toolbar.offsetY+"px",l.style.right=3-i.config.chart.toolbar.offsetX+"px",i.globals.dom.elWrap.appendChild(l),this.elZoom=o(),this.elZoomIn=o(),this.elZoomOut=o(),this.elPan=o(),this.elSelection=o(),this.elZoomReset=o(),this.elMenuIcon=o(),this.elMenu=o(),this.elCustomIcons=[],this.t=i.config.chart.toolbar.tools,Array.isArray(this.t.customIcons))for(var u=0;u<this.t.customIcons.length;u++)this.elCustomIcons.push(o());var h=[],p=function(k,S,R){var N=k.toLowerCase();r.t[N]&&i.config.chart.zoom.enabled&&h.push({el:S,icon:"string"==typeof r.t[N]?r.t[N]:R,title:r.localeValues[k],class:"apexcharts-".concat(N,"-icon")})};p("zoomIn",this.elZoomIn,'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n    <path d="M0 0h24v24H0z" fill="none"/>\n    <path d="M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>\n</svg>\n'),p("zoomOut",this.elZoomOut,'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n    <path d="M0 0h24v24H0z" fill="none"/>\n    <path d="M7 11v2h10v-2H7zm5-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>\n</svg>\n');var v=function(k){r.t[k]&&i.config.chart[k].enabled&&h.push({el:"zoom"===k?r.elZoom:r.elSelection,icon:"string"==typeof r.t[k]?r.t[k]:"zoom"===k?'<svg xmlns="http://www.w3.org/2000/svg" fill="#000000" height="24" viewBox="0 0 24 24" width="24">\n    <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>\n    <path d="M0 0h24v24H0V0z" fill="none"/>\n    <path d="M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"/>\n</svg>':'<svg fill="#6E8192" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n    <path d="M0 0h24v24H0z" fill="none"/>\n    <path d="M3 5h2V3c-1.1 0-2 .9-2 2zm0 8h2v-2H3v2zm4 8h2v-2H7v2zM3 9h2V7H3v2zm10-6h-2v2h2V3zm6 0v2h2c0-1.1-.9-2-2-2zM5 21v-2H3c0 1.1.9 2 2 2zm-2-4h2v-2H3v2zM9 3H7v2h2V3zm2 18h2v-2h-2v2zm8-8h2v-2h-2v2zm0 8c1.1 0 2-.9 2-2h-2v2zm0-12h2V7h-2v2zm0 8h2v-2h-2v2zm-4 4h2v-2h-2v2zm0-16h2V3h-2v2z"/>\n</svg>',title:r.localeValues["zoom"===k?"selectionZoom":"selection"],class:i.globals.isTouchDevice?"apexcharts-element-hidden":"apexcharts-".concat(k,"-icon")})};v("zoom"),v("selection"),this.t.pan&&i.config.chart.zoom.enabled&&h.push({el:this.elPan,icon:"string"==typeof this.t.pan?this.t.pan:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000" height="24" viewBox="0 0 24 24" width="24">\n    <defs>\n        <path d="M0 0h24v24H0z" id="a"/>\n    </defs>\n    <clipPath id="b">\n        <use overflow="visible" xlink:href="#a"/>\n    </clipPath>\n    <path clip-path="url(#b)" d="M23 5.5V20c0 2.2-1.8 4-4 4h-7.3c-1.08 0-2.1-.43-2.85-1.19L1 14.83s1.26-1.23 1.3-1.25c.22-.19.49-.29.79-.29.22 0 .42.06.6.16.04.01 4.31 2.46 4.31 2.46V4c0-.83.67-1.5 1.5-1.5S11 3.17 11 4v7h1V1.5c0-.83.67-1.5 1.5-1.5S15 .67 15 1.5V11h1V2.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5V11h1V5.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5z"/>\n</svg>',title:this.localeValues.pan,class:i.globals.isTouchDevice?"apexcharts-element-hidden":"apexcharts-pan-icon"}),p("reset",this.elZoomReset,'<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>\n    <path d="M0 0h24v24H0z" fill="none"/>\n</svg>'),this.t.download&&h.push({el:this.elMenuIcon,icon:"string"==typeof this.t.download?this.t.download:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>',title:this.localeValues.menu,class:"apexcharts-menu-icon"});for(var y=0;y<this.elCustomIcons.length;y++)h.push({el:this.elCustomIcons[y],icon:this.t.customIcons[y].icon,title:this.t.customIcons[y].title,index:this.t.customIcons[y].index,class:"apexcharts-toolbar-custom-icon "+this.t.customIcons[y].class});h.forEach(function(k,S){k.index&&pe.moveIndexInArray(h,S,k.index)});for(var C=0;C<h.length;C++)Ke.setAttrs(h[C].el,{class:h[C].class,title:h[C].title}),h[C].el.innerHTML=h[C].icon,l.appendChild(h[C].el);this._createHamburgerMenu(l),i.globals.zoomEnabled?this.elZoom.classList.add(this.selectedClass):i.globals.panEnabled?this.elPan.classList.add(this.selectedClass):i.globals.selectionEnabled&&this.elSelection.classList.add(this.selectedClass),this.addToolbarEventListeners()}},{key:"_createHamburgerMenu",value:function(r){this.elMenuItems=[],r.appendChild(this.elMenu),Ke.setAttrs(this.elMenu,{class:"apexcharts-menu"});for(var i=[{name:"exportSVG",title:this.localeValues.exportToSVG},{name:"exportPNG",title:this.localeValues.exportToPNG},{name:"exportCSV",title:this.localeValues.exportToCSV}],o=0;o<i.length;o++)this.elMenuItems.push(document.createElement("div")),this.elMenuItems[o].innerHTML=i[o].title,Ke.setAttrs(this.elMenuItems[o],{class:"apexcharts-menu-item ".concat(i[o].name),title:i[o].title}),this.elMenu.appendChild(this.elMenuItems[o])}},{key:"addToolbarEventListeners",value:function(){var r=this;this.elZoomReset.addEventListener("click",this.handleZoomReset.bind(this)),this.elSelection.addEventListener("click",this.toggleZoomSelection.bind(this,"selection")),this.elZoom.addEventListener("click",this.toggleZoomSelection.bind(this,"zoom")),this.elZoomIn.addEventListener("click",this.handleZoomIn.bind(this)),this.elZoomOut.addEventListener("click",this.handleZoomOut.bind(this)),this.elPan.addEventListener("click",this.togglePanning.bind(this)),this.elMenuIcon.addEventListener("click",this.toggleMenu.bind(this)),this.elMenuItems.forEach(function(o){o.classList.contains("exportSVG")?o.addEventListener("click",r.handleDownload.bind(r,"svg")):o.classList.contains("exportPNG")?o.addEventListener("click",r.handleDownload.bind(r,"png")):o.classList.contains("exportCSV")&&o.addEventListener("click",r.handleDownload.bind(r,"csv"))});for(var i=0;i<this.t.customIcons.length;i++)this.elCustomIcons[i].addEventListener("click",this.t.customIcons[i].click.bind(this,this.ctx,this.ctx.w))}},{key:"toggleZoomSelection",value:function(r){this.ctx.getSyncedCharts().forEach(function(i){i.ctx.toolbar.toggleOtherControls();var o="selection"===r?i.ctx.toolbar.elSelection:i.ctx.toolbar.elZoom,l="selection"===r?"selectionEnabled":"zoomEnabled";i.w.globals[l]=!i.w.globals[l],o.classList.contains(i.ctx.toolbar.selectedClass)?o.classList.remove(i.ctx.toolbar.selectedClass):o.classList.add(i.ctx.toolbar.selectedClass)})}},{key:"getToolbarIconsReference",value:function(){var r=this.w;this.elZoom||(this.elZoom=r.globals.dom.baseEl.querySelector(".apexcharts-zoom-icon")),this.elPan||(this.elPan=r.globals.dom.baseEl.querySelector(".apexcharts-pan-icon")),this.elSelection||(this.elSelection=r.globals.dom.baseEl.querySelector(".apexcharts-selection-icon"))}},{key:"enableZoomPanFromToolbar",value:function(r){this.toggleOtherControls(),"pan"===r?this.w.globals.panEnabled=!0:this.w.globals.zoomEnabled=!0;var i="pan"===r?this.elPan:this.elZoom,o="pan"===r?this.elZoom:this.elPan;i&&i.classList.add(this.selectedClass),o&&o.classList.remove(this.selectedClass)}},{key:"togglePanning",value:function(){this.ctx.getSyncedCharts().forEach(function(r){r.ctx.toolbar.toggleOtherControls(),r.w.globals.panEnabled=!r.w.globals.panEnabled,r.ctx.toolbar.elPan.classList.contains(r.ctx.toolbar.selectedClass)?r.ctx.toolbar.elPan.classList.remove(r.ctx.toolbar.selectedClass):r.ctx.toolbar.elPan.classList.add(r.ctx.toolbar.selectedClass)})}},{key:"toggleOtherControls",value:function(){var r=this,i=this.w;i.globals.panEnabled=!1,i.globals.zoomEnabled=!1,i.globals.selectionEnabled=!1,this.getToolbarIconsReference(),[this.elPan,this.elSelection,this.elZoom].forEach(function(o){o&&o.classList.remove(r.selectedClass)})}},{key:"handleZoomIn",value:function(){var r=this.w;r.globals.isRangeBar&&(this.minX=r.globals.minY,this.maxX=r.globals.maxY);var i=(this.minX+this.maxX)/2,u=this._getNewMinXMaxX((this.minX+i)/2,(this.maxX+i)/2);r.globals.disableZoomIn||this.zoomUpdateOptions(u.minX,u.maxX)}},{key:"handleZoomOut",value:function(){var r=this.w;if(r.globals.isRangeBar&&(this.minX=r.globals.minY,this.maxX=r.globals.maxY),!("datetime"===r.config.xaxis.type&&new Date(this.minX).getUTCFullYear()<1e3)){var i=(this.minX+this.maxX)/2,u=this._getNewMinXMaxX(this.minX-(i-this.minX),this.maxX-(i-this.maxX));r.globals.disableZoomOut||this.zoomUpdateOptions(u.minX,u.maxX)}}},{key:"_getNewMinXMaxX",value:function(r,i){var o=this.w.config.xaxis.convertedCatToNumeric;return{minX:o?Math.floor(r):r,maxX:o?Math.floor(i):i}}},{key:"zoomUpdateOptions",value:function(r,i){var o=this.w;if(void 0!==r||void 0!==i){if(!(o.config.xaxis.convertedCatToNumeric&&(r<1&&(r=1,i=o.globals.dataPoints),i-r<2))){var l={min:r,max:i},u=this.getBeforeZoomRange(l);u&&(l=u.xaxis);var h={xaxis:l},p=pe.clone(o.globals.initialConfig.yaxis);o.config.chart.group||(h.yaxis=p),this.w.globals.zoomed=!0,this.ctx.updateHelpers._updateOptions(h,!1,this.w.config.chart.animations.dynamicAnimation.enabled),this.zoomCallback(l,p)}}else this.handleZoomReset()}},{key:"zoomCallback",value:function(r,i){"function"==typeof this.ev.zoomed&&this.ev.zoomed(this.ctx,{xaxis:r,yaxis:i})}},{key:"getBeforeZoomRange",value:function(r,i){var o=null;return"function"==typeof this.ev.beforeZoom&&(o=this.ev.beforeZoom(this,{xaxis:r,yaxis:i})),o}},{key:"toggleMenu",value:function(){var r=this;window.setTimeout(function(){r.elMenu.classList.contains("apexcharts-menu-open")?r.elMenu.classList.remove("apexcharts-menu-open"):r.elMenu.classList.add("apexcharts-menu-open")},0)}},{key:"handleDownload",value:function(r){var i=this.w,o=new Or(this.ctx);switch(r){case"svg":o.exportToSVG(this.ctx);break;case"png":o.exportToPng(this.ctx);break;case"csv":o.exportToCSV({series:i.config.series,columnDelimiter:i.config.chart.toolbar.export.csv.columnDelimiter})}}},{key:"handleZoomReset",value:function(r){this.ctx.getSyncedCharts().forEach(function(i){var o=i.w;if(o.globals.lastXAxis.min=o.globals.initialConfig.xaxis.min,o.globals.lastXAxis.max=o.globals.initialConfig.xaxis.max,i.updateHelpers.revertDefaultAxisMinMax(),"function"==typeof o.config.chart.events.beforeResetZoom){var l=o.config.chart.events.beforeResetZoom(i,o);l&&i.updateHelpers.revertDefaultAxisMinMax(l)}"function"==typeof o.config.chart.events.zoomed&&i.ctx.toolbar.zoomCallback({min:o.config.xaxis.min,max:o.config.xaxis.max}),o.globals.zoomed=!1;var u=i.ctx.series.emptyCollapsedSeries(pe.clone(o.globals.initialSeries));i.updateHelpers._updateSeries(u,o.config.chart.animations.dynamicAnimation.enabled)})}},{key:"destroy",value:function(){this.elZoom=null,this.elZoomIn=null,this.elZoomOut=null,this.elPan=null,this.elSelection=null,this.elZoomReset=null,this.elMenuIcon=null}}]),P}(),Ni=function(P){_e(i,P);var r=dn(i);function i(o){var l;return F(this,i),(l=r.call(this,o)).ctx=o,l.w=o.w,l.dragged=!1,l.graphics=new Ke(l.ctx),l.eventList=["mousedown","mouseleave","mousemove","touchstart","touchmove","mouseup","touchend"],l.clientX=0,l.clientY=0,l.startX=0,l.endX=0,l.dragX=0,l.startY=0,l.endY=0,l.dragY=0,l.moveDirection="none",l}return me(i,[{key:"init",value:function(o){var l=this,u=o.xyRatios,h=this.w,p=this;this.xyRatios=u,this.zoomRect=this.graphics.drawRect(0,0,0,0),this.selectionRect=this.graphics.drawRect(0,0,0,0),this.gridRect=h.globals.dom.baseEl.querySelector(".apexcharts-grid"),this.zoomRect.node.classList.add("apexcharts-zoom-rect"),this.selectionRect.node.classList.add("apexcharts-selection-rect"),h.globals.dom.elGraphical.add(this.zoomRect),h.globals.dom.elGraphical.add(this.selectionRect),this.slDraggableRect="x"===h.config.chart.selection.type?this.selectionRect.draggable({minX:0,minY:0,maxX:h.globals.gridWidth,maxY:h.globals.gridHeight}).on("dragmove",this.selectionDragging.bind(this,"dragging")):"y"===h.config.chart.selection.type?this.selectionRect.draggable({minX:0,maxX:h.globals.gridWidth}).on("dragmove",this.selectionDragging.bind(this,"dragging")):this.selectionRect.draggable().on("dragmove",this.selectionDragging.bind(this,"dragging")),this.preselectedSelection(),this.hoverArea=h.globals.dom.baseEl.querySelector("".concat(h.globals.chartClass," .apexcharts-svg")),this.hoverArea.classList.add("apexcharts-zoomable"),this.eventList.forEach(function(v){l.hoverArea.addEventListener(v,p.svgMouseEvents.bind(p,u),{capture:!1,passive:!0})})}},{key:"destroy",value:function(){this.slDraggableRect&&(this.slDraggableRect.draggable(!1),this.slDraggableRect.off(),this.selectionRect.off()),this.selectionRect=null,this.zoomRect=null,this.gridRect=null}},{key:"svgMouseEvents",value:function(o,l){var u=this.w,h=this,p=this.ctx.toolbar,v=u.globals.zoomEnabled?u.config.chart.zoom.type:u.config.chart.selection.type,y=u.config.chart.toolbar.autoSelected;if(l.shiftKey?(this.shiftWasPressed=!0,p.enableZoomPanFromToolbar("pan"===y?"zoom":"pan")):this.shiftWasPressed&&(p.enableZoomPanFromToolbar(y),this.shiftWasPressed=!1),l.target){var C,k=l.target.classList;if(l.target.parentNode&&null!==l.target.parentNode&&(C=l.target.parentNode.classList),!(k.contains("apexcharts-selection-rect")||k.contains("apexcharts-legend-marker")||k.contains("apexcharts-legend-text")||C&&C.contains("apexcharts-toolbar"))){if(h.clientX="touchmove"===l.type||"touchstart"===l.type?l.touches[0].clientX:"touchend"===l.type?l.changedTouches[0].clientX:l.clientX,h.clientY="touchmove"===l.type||"touchstart"===l.type?l.touches[0].clientY:"touchend"===l.type?l.changedTouches[0].clientY:l.clientY,"mousedown"===l.type&&1===l.which){var S=h.gridRect.getBoundingClientRect();h.startX=h.clientX-S.left,h.startY=h.clientY-S.top,h.dragged=!1,h.w.globals.mousedown=!0}if(("mousemove"===l.type&&1===l.which||"touchmove"===l.type)&&(h.dragged=!0,u.globals.panEnabled?(u.globals.selection=null,h.w.globals.mousedown&&h.panDragging({context:h,zoomtype:v,xyRatios:o})):(h.w.globals.mousedown&&u.globals.zoomEnabled||h.w.globals.mousedown&&u.globals.selectionEnabled)&&(h.selection=h.selectionDrawing({context:h,zoomtype:v}))),"mouseup"===l.type||"touchend"===l.type||"mouseleave"===l.type){var R=h.gridRect.getBoundingClientRect();h.w.globals.mousedown&&(h.endX=h.clientX-R.left,h.endY=h.clientY-R.top,h.dragX=Math.abs(h.endX-h.startX),h.dragY=Math.abs(h.endY-h.startY),(u.globals.zoomEnabled||u.globals.selectionEnabled)&&h.selectionDrawn({context:h,zoomtype:v}),u.globals.panEnabled&&u.config.xaxis.convertedCatToNumeric&&h.delayedPanScrolled()),u.globals.zoomEnabled&&h.hideSelectionRect(this.selectionRect),h.dragged=!1,h.w.globals.mousedown=!1}this.makeSelectionRectDraggable()}}}},{key:"makeSelectionRectDraggable",value:function(){var o=this.w;if(this.selectionRect){var l=this.selectionRect.node.getBoundingClientRect();l.width>0&&l.height>0&&this.slDraggableRect.selectize({points:"l, r",pointSize:8,pointType:"rect"}).resize({constraint:{minX:0,minY:0,maxX:o.globals.gridWidth,maxY:o.globals.gridHeight}}).on("resizing",this.selectionDragging.bind(this,"resizing"))}}},{key:"preselectedSelection",value:function(){var o=this.w,l=this.xyRatios;if(!o.globals.zoomEnabled)if(null!=o.globals.selection)this.drawSelectionRect(o.globals.selection);else if(void 0!==o.config.chart.selection.xaxis.min&&void 0!==o.config.chart.selection.xaxis.max){var u=(o.config.chart.selection.xaxis.min-o.globals.minX)/l.xRatio,h=o.globals.gridWidth-(o.globals.maxX-o.config.chart.selection.xaxis.max)/l.xRatio-u;o.globals.isRangeBar&&(u=(o.config.chart.selection.xaxis.min-o.globals.yAxisScale[0].niceMin)/l.invertedYRatio,h=(o.config.chart.selection.xaxis.max-o.config.chart.selection.xaxis.min)/l.invertedYRatio),this.drawSelectionRect({x:u,y:0,width:h,height:o.globals.gridHeight,translateX:0,translateY:0,selectionEnabled:!0}),this.makeSelectionRectDraggable(),"function"==typeof o.config.chart.events.selection&&o.config.chart.events.selection(this.ctx,{xaxis:{min:o.config.chart.selection.xaxis.min,max:o.config.chart.selection.xaxis.max},yaxis:{}})}}},{key:"drawSelectionRect",value:function(o){var l=o.x,u=o.y,h=o.width,p=o.height,v=o.translateX,C=o.translateY,S=this.w,R=this.zoomRect,N=this.selectionRect;if(this.dragged||null!==S.globals.selection){var B={transform:"translate("+(void 0===v?0:v)+", "+(void 0===C?0:C)+")"};S.globals.zoomEnabled&&this.dragged&&(h<0&&(h=1),R.attr({x:l,y:u,width:h,height:p,fill:S.config.chart.zoom.zoomedArea.fill.color,"fill-opacity":S.config.chart.zoom.zoomedArea.fill.opacity,stroke:S.config.chart.zoom.zoomedArea.stroke.color,"stroke-width":S.config.chart.zoom.zoomedArea.stroke.width,"stroke-opacity":S.config.chart.zoom.zoomedArea.stroke.opacity}),Ke.setAttrs(R.node,B)),S.globals.selectionEnabled&&(N.attr({x:l,y:u,width:h>0?h:0,height:p>0?p:0,fill:S.config.chart.selection.fill.color,"fill-opacity":S.config.chart.selection.fill.opacity,stroke:S.config.chart.selection.stroke.color,"stroke-width":S.config.chart.selection.stroke.width,"stroke-dasharray":S.config.chart.selection.stroke.dashArray,"stroke-opacity":S.config.chart.selection.stroke.opacity}),Ke.setAttrs(N.node,B))}}},{key:"hideSelectionRect",value:function(o){o&&o.attr({x:0,y:0,width:0,height:0})}},{key:"selectionDrawing",value:function(o){var B,u=o.zoomtype,h=this.w,p=o.context,v=this.gridRect.getBoundingClientRect(),y=p.startX-1,C=p.startY,k=!1,S=!1,R=p.clientX-v.left-y,N=p.clientY-v.top-C;return Math.abs(R+y)>h.globals.gridWidth?R=h.globals.gridWidth-y:p.clientX-v.left<0&&(R=y),y>p.clientX-v.left&&(k=!0,R=Math.abs(R)),C>p.clientY-v.top&&(S=!0,N=Math.abs(N)),p.drawSelectionRect(B="x"===u?{x:k?y-R:y,y:0,width:R,height:h.globals.gridHeight}:"y"===u?{x:0,y:S?C-N:C,width:h.globals.gridWidth,height:N}:{x:k?y-R:y,y:S?C-N:C,width:R,height:N}),p.selectionDragging("resizing"),B}},{key:"selectionDragging",value:function(o,l){var u=this,h=this.w,p=this.xyRatios,v=this.selectionRect,y=0;"resizing"===o&&(y=30);var C=function(S){return parseFloat(v.node.getAttribute(S))},k={x:C("x"),y:C("y"),width:C("width"),height:C("height")};h.globals.selection=k,"function"==typeof h.config.chart.events.selection&&h.globals.selectionEnabled&&(clearTimeout(this.w.globals.selectionResizeTimer),this.w.globals.selectionResizeTimer=window.setTimeout(function(){var S,R,N,B,U=u.gridRect.getBoundingClientRect(),j=v.node.getBoundingClientRect();h.globals.isRangeBar?(S=h.globals.yAxisScale[0].niceMin+(j.left-U.left)*p.invertedYRatio,R=h.globals.yAxisScale[0].niceMin+(j.right-U.left)*p.invertedYRatio,N=0,B=1):(S=h.globals.xAxisScale.niceMin+(j.left-U.left)*p.xRatio,R=h.globals.xAxisScale.niceMin+(j.right-U.left)*p.xRatio,N=h.globals.yAxisScale[0].niceMin+(U.bottom-j.bottom)*p.yRatio[0],B=h.globals.yAxisScale[0].niceMax-(j.top-U.top)*p.yRatio[0]);var K={xaxis:{min:S,max:R},yaxis:{min:N,max:B}};h.config.chart.events.selection(u.ctx,K),h.config.chart.brush.enabled&&void 0!==h.config.chart.events.brushScrolled&&h.config.chart.events.brushScrolled(u.ctx,K)},y))}},{key:"selectionDrawn",value:function(o){var u=o.zoomtype,h=this.w,p=o.context,v=this.xyRatios,y=this.ctx.toolbar;if(p.startX>p.endX){var C=p.startX;p.startX=p.endX,p.endX=C}if(p.startY>p.endY){var k=p.startY;p.startY=p.endY,p.endY=k}var S=void 0,R=void 0;h.globals.isRangeBar?(S=h.globals.yAxisScale[0].niceMin+p.startX*v.invertedYRatio,R=h.globals.yAxisScale[0].niceMin+p.endX*v.invertedYRatio):(S=h.globals.xAxisScale.niceMin+p.startX*v.xRatio,R=h.globals.xAxisScale.niceMin+p.endX*v.xRatio);var N=[],B=[];if(h.config.yaxis.forEach(function(q,J){if(h.globals.seriesYAxisMap[J].length>0){var ne=h.globals.seriesYAxisMap[J][0];N.push(h.globals.yAxisScale[J].niceMax-v.yRatio[ne]*p.startY),B.push(h.globals.yAxisScale[J].niceMax-v.yRatio[ne]*p.endY)}}),p.dragged&&(p.dragX>10||p.dragY>10)&&S!==R)if(h.globals.zoomEnabled){var U=pe.clone(h.globals.initialConfig.yaxis),j=pe.clone(h.globals.initialConfig.xaxis);if(h.globals.zoomed=!0,h.config.xaxis.convertedCatToNumeric&&(S=Math.floor(S),R=Math.floor(R),S<1&&(S=1,R=h.globals.dataPoints),R-S<2&&(R=S+1)),"xy"!==u&&"x"!==u||(j={min:S,max:R}),"xy"!==u&&"y"!==u||U.forEach(function(q,J){U[J].min=B[J],U[J].max=N[J]}),y){var K=y.getBeforeZoomRange(j,U);K&&(j=K.xaxis?K.xaxis:j,U=K.yaxis?K.yaxis:U)}var x={xaxis:j};h.config.chart.group||(x.yaxis=U),p.ctx.updateHelpers._updateOptions(x,!1,p.w.config.chart.animations.dynamicAnimation.enabled),"function"==typeof h.config.chart.events.zoomed&&y.zoomCallback(j,U)}else if(h.globals.selectionEnabled){var I,W=null;I={min:S,max:R},"xy"!==u&&"y"!==u||(W=pe.clone(h.config.yaxis)).forEach(function(q,J){W[J].min=B[J],W[J].max=N[J]}),h.globals.selection=p.selection,"function"==typeof h.config.chart.events.selection&&h.config.chart.events.selection(p.ctx,{xaxis:I,yaxis:W})}}},{key:"panDragging",value:function(o){var u=this.w,h=o.context;if(void 0!==u.globals.lastClientPosition.x){var p=u.globals.lastClientPosition.x-h.clientX,v=u.globals.lastClientPosition.y-h.clientY;Math.abs(p)>Math.abs(v)&&p>0?this.moveDirection="left":Math.abs(p)>Math.abs(v)&&p<0?this.moveDirection="right":Math.abs(v)>Math.abs(p)&&v>0?this.moveDirection="up":Math.abs(v)>Math.abs(p)&&v<0&&(this.moveDirection="down")}u.globals.lastClientPosition={x:h.clientX,y:h.clientY},u.config.xaxis.convertedCatToNumeric||h.panScrolled(u.globals.isRangeBar?u.globals.minY:u.globals.minX,u.globals.isRangeBar?u.globals.maxY:u.globals.maxX)}},{key:"delayedPanScrolled",value:function(){var o=this.w,l=o.globals.minX,u=o.globals.maxX,h=(o.globals.maxX-o.globals.minX)/2;"left"===this.moveDirection?(l=o.globals.minX+h,u=o.globals.maxX+h):"right"===this.moveDirection&&(l=o.globals.minX-h,u=o.globals.maxX-h),l=Math.floor(l),u=Math.floor(u),this.updateScrolledChart({xaxis:{min:l,max:u}},l,u)}},{key:"panScrolled",value:function(o,l){var u=this.w,h=this.xyRatios,p=pe.clone(u.globals.initialConfig.yaxis),v=h.xRatio,y=u.globals.minX,C=u.globals.maxX;u.globals.isRangeBar&&(v=h.invertedYRatio,y=u.globals.minY,C=u.globals.maxY),"left"===this.moveDirection?(o=y+u.globals.gridWidth/15*v,l=C+u.globals.gridWidth/15*v):"right"===this.moveDirection&&(o=y-u.globals.gridWidth/15*v,l=C-u.globals.gridWidth/15*v),u.globals.isRangeBar||(o<u.globals.initialMinX||l>u.globals.initialMaxX)&&(o=y,l=C);var k={xaxis:{min:o,max:l}};u.config.chart.group||(k.yaxis=p),this.updateScrolledChart(k,o,l)}},{key:"updateScrolledChart",value:function(o,l,u){var h=this.w;this.ctx.updateHelpers._updateOptions(o,!1,!1),"function"==typeof h.config.chart.events.scrolled&&h.config.chart.events.scrolled(this.ctx,{xaxis:{min:l,max:u}})}}]),i}($i),ai=function(){function P(r){F(this,P),this.w=r.w,this.ttCtx=r,this.ctx=r.ctx}return me(P,[{key:"getNearestValues",value:function(r){var i=r.hoverArea,l=r.clientX,u=r.clientY,h=this.w,p=r.elGrid.getBoundingClientRect(),v=p.width,y=p.height,C=v/(h.globals.dataPoints-1),k=y/h.globals.dataPoints,S=this.hasBars();!h.globals.comboCharts&&!S||h.config.xaxis.convertedCatToNumeric||(C=v/h.globals.dataPoints);var R=l-p.left-h.globals.barPadForNumericAxis,N=u-p.top;R<0||N<0||R>v||N>y?(i.classList.remove("hovering-zoom"),i.classList.remove("hovering-pan")):h.globals.zoomEnabled?(i.classList.remove("hovering-pan"),i.classList.add("hovering-zoom")):h.globals.panEnabled&&(i.classList.remove("hovering-zoom"),i.classList.add("hovering-pan"));var B=Math.round(R/C),U=Math.floor(N/k);S&&!h.config.xaxis.convertedCatToNumeric&&(B=Math.ceil(R/C),B-=1);var j=null,K=null,x=h.globals.seriesXvalues.map(function(ne){return ne.filter(function(ve){return pe.isNumber(ve)})}),I=h.globals.seriesYvalues.map(function(ne){return ne.filter(function(ve){return pe.isNumber(ve)})});if(h.globals.isXNumeric){var W=this.ttCtx.getElGrid().getBoundingClientRect(),q=R*(W.width/v);j=(K=this.closestInMultiArray(q,N*(W.height/y),x,I)).index,B=K.j,null!==j&&(B=(K=this.closestInArray(q,x=h.globals.seriesXvalues[j])).index)}return h.globals.capturedSeriesIndex=null===j?-1:j,(!B||B<1)&&(B=0),h.globals.capturedDataPointIndex=h.globals.isBarHorizontal?U:B,{capturedSeries:j,j:h.globals.isBarHorizontal?U:B,hoverX:R,hoverY:N}}},{key:"closestInMultiArray",value:function(r,i,o,l){var h=0,p=null,v=-1;this.w.globals.series.length>1?h=this.getFirstActiveXArray(o):p=0;var C=Math.abs(r-o[h][0]);if(o.forEach(function(R){R.forEach(function(N,B){var U=Math.abs(r-N);U<=C&&(C=U,v=B)})}),-1!==v){var S=Math.abs(i-l[h][v]);p=h,l.forEach(function(R,N){var B=Math.abs(i-R[v]);B<=S&&(S=B,p=N)})}return{index:p,j:v}}},{key:"getFirstActiveXArray",value:function(r){for(var i=this.w,o=0,l=r.map(function(h,p){return h.length>0?p:-1}),u=0;u<l.length;u++)if(-1!==l[u]&&-1===i.globals.collapsedSeriesIndices.indexOf(u)&&-1===i.globals.ancillaryCollapsedSeriesIndices.indexOf(u)){o=l[u];break}return o}},{key:"closestInArray",value:function(r,i){for(var l=null,u=Math.abs(r-i[0]),h=0;h<i.length;h++){var p=Math.abs(r-i[h]);p<u&&(u=p,l=h)}return{index:l}}},{key:"isXoverlap",value:function(r){var i=[],o=this.w.globals.seriesX.filter(function(u){return void 0!==u[0]});if(o.length>0)for(var l=0;l<o.length-1;l++)void 0!==o[l][r]&&void 0!==o[l+1][r]&&o[l][r]!==o[l+1][r]&&i.push("unEqual");return 0===i.length}},{key:"isInitialSeriesSameLen",value:function(){for(var r=!0,i=this.w.globals.initialSeries,o=0;o<i.length-1;o++)if(i[o].data.length!==i[o+1].data.length){r=!1;break}return r}},{key:"getBarsHeight",value:function(r){return gt(r).reduce(function(i,o){return i+o.getBBox().height},0)}},{key:"getElMarkers",value:function(r){return this.w.globals.dom.baseEl.querySelectorAll("number"==typeof r?".apexcharts-series[data\\:realIndex='".concat(r,"'] .apexcharts-series-markers-wrap > *"):".apexcharts-series-markers-wrap > *")}},{key:"getAllMarkers",value:function(){var r=this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series-markers-wrap");(r=gt(r)).sort(function(o,l){var u=Number(o.getAttribute("data:realIndex")),h=Number(l.getAttribute("data:realIndex"));return h<u?1:h>u?-1:0});var i=[];return r.forEach(function(o){i.push(o.querySelector(".apexcharts-marker"))}),i}},{key:"hasMarkers",value:function(r){return this.getElMarkers(r).length>0}},{key:"getElBars",value:function(){return this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-bar-series,  .apexcharts-candlestick-series, .apexcharts-boxPlot-series, .apexcharts-rangebar-series")}},{key:"hasBars",value:function(){return this.getElBars().length>0}},{key:"getHoverMarkerSize",value:function(r){var i=this.w,o=i.config.markers.hover.size;return void 0===o&&(o=i.globals.markers.size[r]+i.config.markers.hover.sizeOffset),o}},{key:"toggleAllTooltipSeriesGroups",value:function(r){var i=this.w,o=this.ttCtx;0===o.allTooltipSeriesGroups.length&&(o.allTooltipSeriesGroups=i.globals.dom.baseEl.querySelectorAll(".apexcharts-tooltip-series-group"));for(var l=o.allTooltipSeriesGroups,u=0;u<l.length;u++)"enable"===r?(l[u].classList.add("apexcharts-active"),l[u].style.display=i.config.tooltip.items.display):(l[u].classList.remove("apexcharts-active"),l[u].style.display="none")}}]),P}(),Ur=function(){function P(r){F(this,P),this.w=r.w,this.ctx=r.ctx,this.ttCtx=r,this.tooltipUtil=new ai(r)}return me(P,[{key:"drawSeriesTexts",value:function(r){var i=r.shared,o=void 0===i||i,l=r.ttItems,u=r.i,h=void 0===u?0:u,p=r.j,v=void 0===p?null:p,k=r.e,S=this.w;void 0!==S.config.tooltip.custom?this.handleCustomTooltip({i:h,j:v,y1:r.y1,y2:r.y2,w:S}):this.toggleActiveInactiveSeries(o);var R=this.getValuesToPrint({i:h,j:v});this.printLabels({i:h,j:v,values:R,ttItems:l,shared:o,e:k});var N=this.ttCtx.getElTooltip();this.ttCtx.tooltipRect.ttWidth=N.getBoundingClientRect().width,this.ttCtx.tooltipRect.ttHeight=N.getBoundingClientRect().height}},{key:"printLabels",value:function(r){var i,o=this,l=r.i,u=r.j,h=r.values,p=r.ttItems,v=r.shared,y=r.e,C=this.w,k=[],S=function(W){return C.globals.seriesGoals[W]&&C.globals.seriesGoals[W][u]&&Array.isArray(C.globals.seriesGoals[W][u])},R=h.xVal,N=h.zVal,B=h.xAxisTTVal,U="",j=C.globals.colors[l];null!==u&&C.config.plotOptions.bar.distributed&&(j=C.globals.colors[u]);for(var K=function(W,q){var J=o.getFormatters(l);U=o.getSeriesName({fn:J.yLbTitleFormatter,index:l,seriesIndex:l,j:u}),"treemap"===C.config.chart.type&&(U=J.yLbTitleFormatter(String(C.config.series[l].data[u].x),{series:C.globals.series,seriesIndex:l,dataPointIndex:u,w:C}));var ne=C.config.tooltip.inverseOrder?q:W;if(C.globals.axisCharts){var ve=function(qe){var Pe,Ue,lt,ft;return C.globals.isRangeData?J.yLbFormatter(null===(Pe=C.globals.seriesRangeStart)||void 0===Pe||null===(Ue=Pe[qe])||void 0===Ue?void 0:Ue[u],{series:C.globals.seriesRangeStart,seriesIndex:qe,dataPointIndex:u,w:C})+" - "+J.yLbFormatter(null===(lt=C.globals.seriesRangeEnd)||void 0===lt||null===(ft=lt[qe])||void 0===ft?void 0:ft[u],{series:C.globals.seriesRangeEnd,seriesIndex:qe,dataPointIndex:u,w:C}):J.yLbFormatter(C.globals.series[qe][u],{series:C.globals.series,seriesIndex:qe,dataPointIndex:u,w:C})};if(v)J=o.getFormatters(ne),U=o.getSeriesName({fn:J.yLbTitleFormatter,index:ne,seriesIndex:l,j:u}),j=C.globals.colors[ne],i=ve(ne),S(ne)&&(k=C.globals.seriesGoals[ne][u].map(function(qe){return{attrs:qe,val:J.yLbFormatter(qe.value,{seriesIndex:ne,dataPointIndex:u,w:C})}}));else{var ge,Le=null==y||null===(ge=y.target)||void 0===ge?void 0:ge.getAttribute("fill");Le&&(j=-1!==Le.indexOf("url")?document.querySelector(Le.substr(4).slice(0,-1)).childNodes[0].getAttribute("stroke"):Le),i=ve(l),S(l)&&Array.isArray(C.globals.seriesGoals[l][u])&&(k=C.globals.seriesGoals[l][u].map(function(qe){return{attrs:qe,val:J.yLbFormatter(qe.value,{seriesIndex:l,dataPointIndex:u,w:C})}}))}}null===u&&(i=J.yLbFormatter(C.globals.series[l],Ze(Ze({},C),{},{seriesIndex:l,dataPointIndex:l}))),o.DOMHandling({i:l,t:ne,j:u,ttItems:p,values:{val:i,goalVals:k,xVal:R,xAxisTTVal:B,zVal:N},seriesName:U,shared:v,pColor:j})},x=0,I=C.globals.series.length-1;x<C.globals.series.length;x++,I--)K(x,I)}},{key:"getFormatters",value:function(r){var i,o=this.w,l=o.globals.yLabelFormatters[r];return void 0!==o.globals.ttVal?Array.isArray(o.globals.ttVal)?(l=o.globals.ttVal[r]&&o.globals.ttVal[r].formatter,i=o.globals.ttVal[r]&&o.globals.ttVal[r].title&&o.globals.ttVal[r].title.formatter):(l=o.globals.ttVal.formatter,"function"==typeof o.globals.ttVal.title.formatter&&(i=o.globals.ttVal.title.formatter)):i=o.config.tooltip.y.title.formatter,"function"!=typeof l&&(l=o.globals.yLabelFormatters[0]?o.globals.yLabelFormatters[0]:function(u){return u}),"function"!=typeof i&&(i=function(u){return u}),{yLbFormatter:l,yLbTitleFormatter:i}}},{key:"getSeriesName",value:function(r){var l=r.seriesIndex,u=r.j,h=this.w;return(0,r.fn)(String(h.globals.seriesNames[r.index]),{series:h.globals.series,seriesIndex:l,dataPointIndex:u,w:h})}},{key:"DOMHandling",value:function(r){var i=r.t,o=r.j,l=r.ttItems,u=r.values,h=r.seriesName,p=r.shared,v=r.pColor,y=this.w,C=this.ttCtx,k=u.val,S=u.goalVals,R=u.xVal,N=u.xAxisTTVal,B=u.zVal,U=null;U=l[i].children,y.config.tooltip.fillSeriesColor&&(l[i].style.backgroundColor=v,U[0].style.display="none"),C.showTooltipTitle&&(null===C.tooltipTitle&&(C.tooltipTitle=y.globals.dom.baseEl.querySelector(".apexcharts-tooltip-title")),C.tooltipTitle.innerHTML=R),C.isXAxisTooltipEnabled&&(C.xaxisTooltipText.innerHTML=""!==N?N:R);var j=l[i].querySelector(".apexcharts-tooltip-text-y-label");j&&(j.innerHTML=h||"");var K=l[i].querySelector(".apexcharts-tooltip-text-y-value");K&&(K.innerHTML=void 0!==k?k:""),U[0]&&U[0].classList.contains("apexcharts-tooltip-marker")&&(y.config.tooltip.marker.fillColors&&Array.isArray(y.config.tooltip.marker.fillColors)&&(v=y.config.tooltip.marker.fillColors[i]),U[0].style.backgroundColor=v),y.config.tooltip.marker.show||(U[0].style.display="none");var x=l[i].querySelector(".apexcharts-tooltip-text-goals-label"),I=l[i].querySelector(".apexcharts-tooltip-text-goals-value");if(S.length&&y.globals.seriesGoals[i]){var W=function(){var ne="<div >",ve="<div>";S.forEach(function(ge,Le){ne+=' <div style="display: flex"><span class="apexcharts-tooltip-marker" style="background-color: '.concat(ge.attrs.strokeColor,'; height: 3px; border-radius: 0; top: 5px;"></span> ').concat(ge.attrs.name,"</div>"),ve+="<div>".concat(ge.val,"</div>")}),x.innerHTML=ne+"</div>",I.innerHTML=ve+"</div>"};p?y.globals.seriesGoals[i][o]&&Array.isArray(y.globals.seriesGoals[i][o])?W():(x.innerHTML="",I.innerHTML=""):W()}else x.innerHTML="",I.innerHTML="";if(null!==B&&(l[i].querySelector(".apexcharts-tooltip-text-z-label").innerHTML=y.config.tooltip.z.title,l[i].querySelector(".apexcharts-tooltip-text-z-value").innerHTML=void 0!==B?B:""),p&&U[0]){if(y.config.tooltip.hideEmptySeries){var q=l[i].querySelector(".apexcharts-tooltip-marker"),J=l[i].querySelector(".apexcharts-tooltip-text");0==parseFloat(k)?(q.style.display="none",J.style.display="none"):(q.style.display="block",J.style.display="block")}U[0].parentNode.style.display=null==k||y.globals.ancillaryCollapsedSeriesIndices.indexOf(i)>-1||y.globals.collapsedSeriesIndices.indexOf(i)>-1?"none":y.config.tooltip.items.display}}},{key:"toggleActiveInactiveSeries",value:function(r){var i=this.w;if(r)this.tooltipUtil.toggleAllTooltipSeriesGroups("enable");else{this.tooltipUtil.toggleAllTooltipSeriesGroups("disable");var o=i.globals.dom.baseEl.querySelector(".apexcharts-tooltip-series-group");o&&(o.classList.add("apexcharts-active"),o.style.display=i.config.tooltip.items.display)}}},{key:"getValuesToPrint",value:function(r){var i=r.i,o=r.j,l=this.w,u=this.ctx.series.filteredSeriesX(),h="",p="",v=null,y=null,C={series:l.globals.series,seriesIndex:i,dataPointIndex:o,w:l},k=l.globals.ttZFormatter;null===o?y=l.globals.series[i]:l.globals.isXNumeric&&"treemap"!==l.config.chart.type?(h=u[i][o],0===u[i].length&&(h=u[this.tooltipUtil.getFirstActiveXArray(u)][o])):h=void 0!==l.globals.labels[o]?l.globals.labels[o]:"";var S=h;return h=l.globals.isXNumeric&&"datetime"===l.config.xaxis.type?new Qt(this.ctx).xLabelFormat(l.globals.ttKeyFormatter,S,S,{i:void 0,dateFormatter:new Mn(this.ctx).formatDate,w:this.w}):l.globals.isBarHorizontal?l.globals.yLabelFormatters[0](S,C):l.globals.xLabelFormatter(S,C),void 0!==l.config.tooltip.x.formatter&&(h=l.globals.ttKeyFormatter(S,C)),l.globals.seriesZ.length>0&&l.globals.seriesZ[i].length>0&&(v=k(l.globals.seriesZ[i][o],l)),p="function"==typeof l.config.xaxis.tooltip.formatter?l.globals.xaxisTooltipFormatter(S,C):h,{val:Array.isArray(y)?y.join(" "):y,xVal:Array.isArray(h)?h.join(" "):h,xAxisTTVal:Array.isArray(p)?p.join(" "):p,zVal:v}}},{key:"handleCustomTooltip",value:function(r){var i=r.i,o=r.j,l=r.y1,u=r.y2,h=r.w,p=this.ttCtx.getElTooltip(),v=h.config.tooltip.custom;Array.isArray(v)&&v[i]&&(v=v[i]),p.innerHTML=v({ctx:this.ctx,series:h.globals.series,seriesIndex:i,dataPointIndex:o,y1:l,y2:u,w:h})}}]),P}(),Ki=function(){function P(r){F(this,P),this.ttCtx=r,this.ctx=r.ctx,this.w=r.w}return me(P,[{key:"moveXCrosshairs",value:function(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=this.ttCtx,l=this.w,u=o.getElXCrosshairs(),h=r-o.xcrosshairsWidth/2,p=l.globals.labels.slice().length;if(null!==i&&(h=l.globals.gridWidth/p*i),null===u||l.globals.isBarHorizontal||(u.setAttribute("x",h),u.setAttribute("x1",h),u.setAttribute("x2",h),u.setAttribute("y2",l.globals.gridHeight),u.classList.add("apexcharts-active")),h<0&&(h=0),h>l.globals.gridWidth&&(h=l.globals.gridWidth),o.isXAxisTooltipEnabled){var v=h;"tickWidth"!==l.config.xaxis.crosshairs.width&&"barWidth"!==l.config.xaxis.crosshairs.width||(v=h+o.xcrosshairsWidth/2),this.moveXAxisTooltip(v)}}},{key:"moveYCrosshairs",value:function(r){var i=this.ttCtx;null!==i.ycrosshairs&&Ke.setAttrs(i.ycrosshairs,{y1:r,y2:r}),null!==i.ycrosshairsHidden&&Ke.setAttrs(i.ycrosshairsHidden,{y1:r,y2:r})}},{key:"moveXAxisTooltip",value:function(r){var i=this.w,o=this.ttCtx;if(null!==o.xaxisTooltip&&0!==o.xcrosshairsWidth){o.xaxisTooltip.classList.add("apexcharts-active");var u,l=o.xaxisOffY+i.config.xaxis.tooltip.offsetY+i.globals.translateY+1+i.config.xaxis.offsetY;r-=o.xaxisTooltip.getBoundingClientRect().width/2,isNaN(r)||(r+=i.globals.translateX,u=new Ke(this.ctx).getTextRects(o.xaxisTooltipText.innerHTML),o.xaxisTooltipText.style.minWidth=u.width+"px",o.xaxisTooltip.style.left=r+"px",o.xaxisTooltip.style.top=l+"px")}}},{key:"moveYAxisTooltip",value:function(r){var i=this.w,o=this.ttCtx;null===o.yaxisTTEls&&(o.yaxisTTEls=i.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxistooltip"));var l=parseInt(o.ycrosshairsHidden.getAttribute("y1"),10),u=i.globals.translateY+l,h=o.yaxisTTEls[r].getBoundingClientRect().height,p=i.globals.translateYAxisX[r]-2;i.config.yaxis[r].opposite&&(p-=26),u-=h/2,-1===i.globals.ignoreYAxisIndexes.indexOf(r)?(o.yaxisTTEls[r].classList.add("apexcharts-active"),o.yaxisTTEls[r].style.top=u+"px",o.yaxisTTEls[r].style.left=p+i.config.yaxis[r].tooltip.offsetX+"px"):o.yaxisTTEls[r].classList.remove("apexcharts-active")}},{key:"moveTooltip",value:function(r,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=this.w,u=this.ttCtx,h=u.getElTooltip(),p=u.tooltipRect,v=null!==o?parseFloat(o):1,y=parseFloat(r)+v+5,C=parseFloat(i)+v/2;if(y>l.globals.gridWidth/2&&(y=y-p.ttWidth-v-10),y>l.globals.gridWidth-p.ttWidth-10&&(y=l.globals.gridWidth-p.ttWidth),y<-20&&(y=-20),l.config.tooltip.followCursor){var k=u.getElGrid().getBoundingClientRect();(y=u.e.clientX-k.left)>l.globals.gridWidth/2&&(y-=u.tooltipRect.ttWidth),(C=u.e.clientY+l.globals.translateY-k.top)>l.globals.gridHeight/2&&(C-=u.tooltipRect.ttHeight)}else l.globals.isBarHorizontal||p.ttHeight/2+C>l.globals.gridHeight&&(C=l.globals.gridHeight-p.ttHeight+l.globals.translateY);isNaN(y)||(h.style.left=(y+=l.globals.translateX)+"px",h.style.top=C+"px")}},{key:"moveMarkers",value:function(r,i){var o=this.w,l=this.ttCtx;if(o.globals.markers.size[r]>0)for(var u=o.globals.dom.baseEl.querySelectorAll(" .apexcharts-series[data\\:realIndex='".concat(r,"'] .apexcharts-marker")),h=0;h<u.length;h++)parseInt(u[h].getAttribute("rel"),10)===i&&(l.marker.resetPointsSize(),l.marker.enlargeCurrentPoint(i,u[h]));else l.marker.resetPointsSize(),this.moveDynamicPointOnHover(i,r)}},{key:"moveDynamicPointOnHover",value:function(r,i){var o,l,u=this.w,h=this.ttCtx,p=u.globals.pointsArray,v=h.tooltipUtil.getHoverMarkerSize(i),y=u.config.series[i].type;if(!y||"column"!==y&&"candlestick"!==y&&"boxPlot"!==y){o=p[i][r][0],l=p[i][r][1]?p[i][r][1]:0;var C=u.globals.dom.baseEl.querySelector(".apexcharts-series[data\\:realIndex='".concat(i,"'] .apexcharts-series-markers circle"));C&&l<u.globals.gridHeight&&l>0&&(C.setAttribute("r",v),C.setAttribute("cx",o),C.setAttribute("cy",l)),this.moveXCrosshairs(o),h.fixedTooltip||this.moveTooltip(o,l,v)}}},{key:"moveDynamicPointsOnHover",value:function(r){var i,o=this.ttCtx,l=o.w,u=0,h=0,p=l.globals.pointsArray;i=new Dr(this.ctx).getActiveConfigSeriesIndex("asc",["line","area","scatter","bubble"]);var v=o.tooltipUtil.getHoverMarkerSize(i);p[i]&&(u=p[i][r][0],h=p[i][r][1]);var y=o.tooltipUtil.getAllMarkers();if(null!==y)for(var C=0;C<l.globals.series.length;C++){var k=p[C];if(l.globals.comboCharts&&void 0===k&&y.splice(C,0,null),k&&k.length){var S=p[C][r][1];y[C].setAttribute("cx",u),"rangeArea"!==l.config.chart.type||l.globals.comboCharts||(S-=Math.abs(S-p[C][r+l.globals.series[C].length][1])/2),null!==S&&!isNaN(S)&&S<l.globals.gridHeight+v&&S+v>0?(y[C]&&y[C].setAttribute("r",v),y[C]&&y[C].setAttribute("cy",S)):y[C]&&y[C].setAttribute("r",0)}}this.moveXCrosshairs(u),o.fixedTooltip||this.moveTooltip(u,h||l.globals.gridHeight,v)}},{key:"moveStickyTooltipOverBars",value:function(r,i){var o=this.w,l=this.ttCtx,u=o.globals.columnSeries?o.globals.columnSeries.length:o.globals.series.length,h=u>=2&&u%2==0?Math.floor(u/2):Math.floor(u/2)+1;o.globals.isBarHorizontal&&(h=new Dr(this.ctx).getActiveConfigSeriesIndex("desc")+1);var p=o.globals.dom.baseEl.querySelector(".apexcharts-bar-series .apexcharts-series[rel='".concat(h,"'] path[j='").concat(r,"'], .apexcharts-candlestick-series .apexcharts-series[rel='").concat(h,"'] path[j='").concat(r,"'], .apexcharts-boxPlot-series .apexcharts-series[rel='").concat(h,"'] path[j='").concat(r,"'], .apexcharts-rangebar-series .apexcharts-series[rel='").concat(h,"'] path[j='").concat(r,"']"));p||"number"!=typeof i||(p=o.globals.dom.baseEl.querySelector(".apexcharts-bar-series .apexcharts-series[data\\:realIndex='".concat(i,"'] path[j='").concat(r,"'],\n        .apexcharts-candlestick-series .apexcharts-series[data\\:realIndex='").concat(i,"'] path[j='").concat(r,"'],\n        .apexcharts-boxPlot-series .apexcharts-series[data\\:realIndex='").concat(i,"'] path[j='").concat(r,"'],\n        .apexcharts-rangebar-series .apexcharts-series[data\\:realIndex='").concat(i,"'] path[j='").concat(r,"']")));var v=p?parseFloat(p.getAttribute("cx")):0,y=p?parseFloat(p.getAttribute("cy")):0,C=p?parseFloat(p.getAttribute("barWidth")):0,k=l.getElGrid().getBoundingClientRect(),S=p&&(p.classList.contains("apexcharts-candlestick-area")||p.classList.contains("apexcharts-boxPlot-area"));o.globals.isXNumeric?(p&&!S&&(v-=u%2!=0?C/2:0),p&&S&&o.globals.comboCharts&&(v-=C/2)):o.globals.isBarHorizontal||(v=l.xAxisTicksPositions[r-1]+l.dataPointsDividedWidth/2,isNaN(v)&&(v=l.xAxisTicksPositions[r]-l.dataPointsDividedWidth/2)),o.globals.isBarHorizontal?y-=l.tooltipRect.ttHeight:o.config.tooltip.followCursor?y=l.e.clientY-k.top-l.tooltipRect.ttHeight/2:y+l.tooltipRect.ttHeight+15>o.globals.gridHeight&&(y=o.globals.gridHeight),o.globals.isBarHorizontal||this.moveXCrosshairs(v),l.fixedTooltip||this.moveTooltip(v,y||o.globals.gridHeight)}}]),P}(),Na=function(){function P(r){F(this,P),this.w=r.w,this.ttCtx=r,this.ctx=r.ctx,this.tooltipPosition=new Ki(r)}return me(P,[{key:"drawDynamicPoints",value:function(){var r=this.w,i=new Ke(this.ctx),o=new Rr(this.ctx),l=r.globals.dom.baseEl.querySelectorAll(".apexcharts-series");l=gt(l),r.config.chart.stacked&&l.sort(function(k,S){return parseFloat(k.getAttribute("data:realIndex"))-parseFloat(S.getAttribute("data:realIndex"))});for(var u=0;u<l.length;u++){var h=l[u].querySelector(".apexcharts-series-markers-wrap");if(null!==h){var p=void 0,v="apexcharts-marker w".concat((Math.random()+1).toString(36).substring(4));"line"!==r.config.chart.type&&"area"!==r.config.chart.type||r.globals.comboCharts||r.config.tooltip.intersect||(v+=" no-pointer-events");var y=o.getMarkerConfig({cssClass:v,seriesIndex:Number(h.getAttribute("data:realIndex"))});(p=i.drawMarker(0,0,y)).node.setAttribute("default-marker-size",0);var C=document.createElementNS(r.globals.SVGNS,"g");C.classList.add("apexcharts-series-markers"),C.appendChild(p.node),h.appendChild(C)}}}},{key:"enlargeCurrentPoint",value:function(r,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=this.w;"bubble"!==u.config.chart.type&&this.newPointSize(r,i);var h=i.getAttribute("cx"),p=i.getAttribute("cy");if(null!==o&&null!==l&&(h=o,p=l),this.tooltipPosition.moveXCrosshairs(h),!this.fixedTooltip){if("radar"===u.config.chart.type){var v=this.ttCtx.getElGrid().getBoundingClientRect();h=this.ttCtx.e.clientX-v.left}this.tooltipPosition.moveTooltip(h,p,u.config.markers.hover.size)}}},{key:"enlargePoints",value:function(r){for(var i=this.w,o=this,l=this.ttCtx,u=r,h=i.globals.dom.baseEl.querySelectorAll(".apexcharts-series:not(.apexcharts-series-collapsed) .apexcharts-marker"),p=i.config.markers.hover.size,v=0;v<h.length;v++){var y=h[v].getAttribute("rel"),C=h[v].getAttribute("index");if(void 0===p&&(p=i.globals.markers.size[C]+i.config.markers.hover.sizeOffset),u===parseInt(y,10)){o.newPointSize(u,h[v]);var k=h[v].getAttribute("cx"),S=h[v].getAttribute("cy");o.tooltipPosition.moveXCrosshairs(k),l.fixedTooltip||o.tooltipPosition.moveTooltip(k,S,p)}else o.oldPointSize(h[v])}}},{key:"newPointSize",value:function(r,i){var o=this.w,l=o.config.markers.hover.size,u=0===r?i.parentNode.firstChild:i.parentNode.lastChild;if("0"!==u.getAttribute("default-marker-size")){var h=parseInt(u.getAttribute("index"),10);void 0===l&&(l=o.globals.markers.size[h]+o.config.markers.hover.sizeOffset),l<0&&(l=0),u.setAttribute("r",l)}}},{key:"oldPointSize",value:function(r){var i=parseFloat(r.getAttribute("default-marker-size"));r.setAttribute("r",i)}},{key:"resetPointsSize",value:function(){for(var r=this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series:not(.apexcharts-series-collapsed) .apexcharts-marker"),i=0;i<r.length;i++){var o=parseFloat(r[i].getAttribute("default-marker-size"));pe.isNumber(o)&&o>=0?r[i].setAttribute("r",o):r[i].setAttribute("r",0)}}}]),P}(),Li=function(){function P(r){F(this,P),this.w=r.w;var i=this.w;this.ttCtx=r,this.isVerticalGroupedRangeBar=!i.globals.isBarHorizontal&&"rangeBar"===i.config.chart.type&&i.config.plotOptions.bar.rangeBarGroupRows}return me(P,[{key:"getAttr",value:function(r,i){return parseFloat(r.target.getAttribute(i))}},{key:"handleHeatTreeTooltip",value:function(r){var i=r.e,o=r.opt,l=r.x,u=r.y,p=this.ttCtx,v=this.w;if(i.target.classList.contains("apexcharts-".concat(r.type,"-rect"))){var y=this.getAttr(i,"i"),C=this.getAttr(i,"j"),k=this.getAttr(i,"cx"),S=this.getAttr(i,"cy"),R=this.getAttr(i,"width"),N=this.getAttr(i,"height");if(p.tooltipLabels.drawSeriesTexts({ttItems:o.ttItems,i:y,j:C,shared:!1,e:i}),v.globals.capturedSeriesIndex=y,v.globals.capturedDataPointIndex=C,l=k+p.tooltipRect.ttWidth/2+R,u=S+p.tooltipRect.ttHeight/2-N/2,p.tooltipPosition.moveXCrosshairs(k+R/2),l>v.globals.gridWidth/2&&(l=k-p.tooltipRect.ttWidth/2+R),p.w.config.tooltip.followCursor){var B=v.globals.dom.elWrap.getBoundingClientRect();l=v.globals.clientX-B.left-(l>v.globals.gridWidth/2?p.tooltipRect.ttWidth:0),u=v.globals.clientY-B.top-(u>v.globals.gridHeight/2?p.tooltipRect.ttHeight:0)}}return{x:l,y:u}}},{key:"handleMarkerTooltip",value:function(r){var i,o,l=r.e,u=r.opt,h=r.x,p=r.y,v=this.w,y=this.ttCtx;if(l.target.classList.contains("apexcharts-marker")){var C=parseInt(u.paths.getAttribute("cx"),10),k=parseInt(u.paths.getAttribute("cy"),10),S=parseFloat(u.paths.getAttribute("val"));if(o=parseInt(u.paths.getAttribute("rel"),10),i=parseInt(u.paths.parentNode.parentNode.parentNode.getAttribute("rel"),10)-1,y.intersect){var R=pe.findAncestor(u.paths,"apexcharts-series");R&&(i=parseInt(R.getAttribute("data:realIndex"),10))}if(y.tooltipLabels.drawSeriesTexts({ttItems:u.ttItems,i,j:o,shared:!y.showOnIntersect&&v.config.tooltip.shared,e:l}),"mouseup"===l.type&&y.markerClick(l,i,o),v.globals.capturedSeriesIndex=i,v.globals.capturedDataPointIndex=o,h=C,p=k+v.globals.translateY-1.4*y.tooltipRect.ttHeight,y.w.config.tooltip.followCursor){var N=y.getElGrid().getBoundingClientRect();p=y.e.clientY+v.globals.translateY-N.top}S<0&&(p=k),y.marker.enlargeCurrentPoint(o,u.paths,h,p)}return{x:h,y:p}}},{key:"handleBarTooltip",value:function(r){var i,o,l=r.e,u=r.opt,h=this.w,p=this.ttCtx,v=p.getElTooltip(),y=0,C=0,k=0,S=this.getBarTooltipXY({e:l,opt:u}),R=S.barHeight,N=S.j;h.globals.capturedSeriesIndex=i=S.i,h.globals.capturedDataPointIndex=N,h.globals.isBarHorizontal&&p.tooltipUtil.hasBars()||!h.config.tooltip.shared?(C=S.x,k=S.y,o=Array.isArray(h.config.stroke.width)?h.config.stroke.width[i]:h.config.stroke.width,y=C):h.globals.comboCharts||h.config.tooltip.shared||(y/=2),isNaN(k)&&(k=h.globals.svgHeight-p.tooltipRect.ttHeight);var B=parseInt(u.paths.parentNode.getAttribute("data:realIndex"),10),U=h.globals.isMultipleYAxis?h.config.yaxis[B]&&h.config.yaxis[B].reversed:h.config.yaxis[0].reversed;if(C+p.tooltipRect.ttWidth>h.globals.gridWidth&&!U?C-=p.tooltipRect.ttWidth:C<0&&(C=0),p.w.config.tooltip.followCursor){var j=p.getElGrid().getBoundingClientRect();k=p.e.clientY-j.top}null===p.tooltip&&(p.tooltip=h.globals.dom.baseEl.querySelector(".apexcharts-tooltip")),h.config.tooltip.shared||p.tooltipPosition.moveXCrosshairs(h.globals.comboBarCount>0?y+o/2:y),!p.fixedTooltip&&(!h.config.tooltip.shared||h.globals.isBarHorizontal&&p.tooltipUtil.hasBars())&&(U&&(C-=p.tooltipRect.ttWidth)<0&&(C=0),!U||h.globals.isBarHorizontal&&p.tooltipUtil.hasBars()||(k=k+R-2*(h.globals.series[i][N]<0?R:0)),k=k+h.globals.translateY-p.tooltipRect.ttHeight/2,v.style.left=C+h.globals.translateX+"px",v.style.top=k+"px")}},{key:"getBarTooltipXY",value:function(r){var i=this,o=r.e,l=r.opt,u=this.w,h=null,p=this.ttCtx,v=0,y=0,C=0,k=0,S=0,R=o.target.classList;if(R.contains("apexcharts-bar-area")||R.contains("apexcharts-candlestick-area")||R.contains("apexcharts-boxPlot-area")||R.contains("apexcharts-rangebar-area")){var N=o.target,B=N.getBoundingClientRect(),U=l.elGrid.getBoundingClientRect(),j=B.height;S=B.height;var K=B.width,x=parseInt(N.getAttribute("cx"),10),I=parseInt(N.getAttribute("cy"),10);k=parseFloat(N.getAttribute("barWidth"));var W="touchmove"===o.type?o.touches[0].clientX:o.clientX;h=parseInt(N.getAttribute("j"),10),v=parseInt(N.parentNode.getAttribute("rel"),10)-1;var q=N.getAttribute("data-range-y1"),J=N.getAttribute("data-range-y2");u.globals.comboCharts&&(v=parseInt(N.parentNode.getAttribute("data:realIndex"),10));var ne=function(ge){return u.globals.isXNumeric?x-K/2:i.isVerticalGroupedRangeBar?x+K/2:x-p.dataPointsDividedWidth+K/2},ve=function(){return I-p.dataPointsDividedHeight+j/2-p.tooltipRect.ttHeight/2};p.tooltipLabels.drawSeriesTexts({ttItems:l.ttItems,i:v,j:h,y1:q?parseInt(q,10):null,y2:J?parseInt(J,10):null,shared:!p.showOnIntersect&&u.config.tooltip.shared,e:o}),u.config.tooltip.followCursor?u.globals.isBarHorizontal?(y=W-U.left+15,C=ve()):(y=ne(),C=o.clientY-U.top-p.tooltipRect.ttHeight/2-15):u.globals.isBarHorizontal?((y=x)<p.xyRatios.baseLineInvertedY&&(y=x-p.tooltipRect.ttWidth),C=ve()):(y=ne(),C=I)}return{x:y,y:C,barHeight:S,barWidth:k,i:v,j:h}}}]),P}(),gi=function(){function P(r){F(this,P),this.w=r.w,this.ttCtx=r}return me(P,[{key:"drawXaxisTooltip",value:function(){var r=this.w,i=this.ttCtx,o="bottom"===r.config.xaxis.position;i.xaxisOffY=o?r.globals.gridHeight+1:-r.globals.xAxisHeight-r.config.xaxis.axisTicks.height+3;var l=o?"apexcharts-xaxistooltip apexcharts-xaxistooltip-bottom":"apexcharts-xaxistooltip apexcharts-xaxistooltip-top",u=r.globals.dom.elWrap;i.isXAxisTooltipEnabled&&null===r.globals.dom.baseEl.querySelector(".apexcharts-xaxistooltip")&&(i.xaxisTooltip=document.createElement("div"),i.xaxisTooltip.setAttribute("class",l+" apexcharts-theme-"+r.config.tooltip.theme),u.appendChild(i.xaxisTooltip),i.xaxisTooltipText=document.createElement("div"),i.xaxisTooltipText.classList.add("apexcharts-xaxistooltip-text"),i.xaxisTooltipText.style.fontFamily=r.config.xaxis.tooltip.style.fontFamily||r.config.chart.fontFamily,i.xaxisTooltipText.style.fontSize=r.config.xaxis.tooltip.style.fontSize,i.xaxisTooltip.appendChild(i.xaxisTooltipText))}},{key:"drawYaxisTooltip",value:function(){for(var r=this.w,i=this.ttCtx,o=0;o<r.config.yaxis.length;o++){var l=r.config.yaxis[o].opposite||r.config.yaxis[o].crosshairs.opposite;i.yaxisOffX=l?r.globals.gridWidth+1:1;var u="apexcharts-yaxistooltip apexcharts-yaxistooltip-".concat(o,l?" apexcharts-yaxistooltip-right":" apexcharts-yaxistooltip-left"),h=r.globals.dom.elWrap;null===r.globals.dom.baseEl.querySelector(".apexcharts-yaxistooltip apexcharts-yaxistooltip-".concat(o))&&(i.yaxisTooltip=document.createElement("div"),i.yaxisTooltip.setAttribute("class",u+" apexcharts-theme-"+r.config.tooltip.theme),h.appendChild(i.yaxisTooltip),0===o&&(i.yaxisTooltipText=[]),i.yaxisTooltipText[o]=document.createElement("div"),i.yaxisTooltipText[o].classList.add("apexcharts-yaxistooltip-text"),i.yaxisTooltip.appendChild(i.yaxisTooltipText[o]))}}},{key:"setXCrosshairWidth",value:function(){var r=this.w,i=this.ttCtx,o=i.getElXCrosshairs();if(i.xcrosshairsWidth=parseInt(r.config.xaxis.crosshairs.width,10),r.globals.comboCharts){var l=r.globals.dom.baseEl.querySelector(".apexcharts-bar-area");if(null!==l&&"barWidth"===r.config.xaxis.crosshairs.width){var u=parseFloat(l.getAttribute("barWidth"));i.xcrosshairsWidth=u}else"tickWidth"===r.config.xaxis.crosshairs.width&&(i.xcrosshairsWidth=r.globals.gridWidth/r.globals.labels.length)}else if("tickWidth"===r.config.xaxis.crosshairs.width)i.xcrosshairsWidth=r.globals.gridWidth/r.globals.labels.length;else if("barWidth"===r.config.xaxis.crosshairs.width){var v=r.globals.dom.baseEl.querySelector(".apexcharts-bar-area");if(null!==v){var y=parseFloat(v.getAttribute("barWidth"));i.xcrosshairsWidth=y}else i.xcrosshairsWidth=1}r.globals.isBarHorizontal&&(i.xcrosshairsWidth=0),null!==o&&i.xcrosshairsWidth>0&&o.setAttribute("width",i.xcrosshairsWidth)}},{key:"handleYCrosshair",value:function(){var r=this.w,i=this.ttCtx;i.ycrosshairs=r.globals.dom.baseEl.querySelector(".apexcharts-ycrosshairs"),i.ycrosshairsHidden=r.globals.dom.baseEl.querySelector(".apexcharts-ycrosshairs-hidden")}},{key:"drawYaxisTooltipText",value:function(r,i,o){var l=this.ttCtx,u=this.w,h=u.globals,p=h.seriesYAxisMap[r];if(l.yaxisTooltips[r]&&p.length>0){var v=h.yLabelFormatters[r],y=l.getElGrid().getBoundingClientRect(),C=p[0],k=0;o.yRatio.length>1&&(k=C);var S=(i-y.top)*o.yRatio[k],R=h.maxYArr[C]-h.minYArr[C],N=h.minYArr[C]+(R-S);u.config.yaxis[r].reversed&&(N=h.maxYArr[C]-(R-S)),l.tooltipPosition.moveYCrosshairs(i-y.top),l.yaxisTooltipText[r].innerHTML=v(N),l.tooltipPosition.moveYAxisTooltip(r)}}}]),P}(),Ve=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w;var i=this.w;this.tConfig=i.config.tooltip,this.tooltipUtil=new ai(this),this.tooltipLabels=new Ur(this),this.tooltipPosition=new Ki(this),this.marker=new Na(this),this.intersect=new Li(this),this.axesTooltip=new gi(this),this.showOnIntersect=this.tConfig.intersect,this.showTooltipTitle=this.tConfig.x.show,this.fixedTooltip=this.tConfig.fixed.enabled,this.xaxisTooltip=null,this.yaxisTTEls=null,this.isBarShared=!i.globals.isBarHorizontal&&this.tConfig.shared,this.lastHoverTime=Date.now()}return me(P,[{key:"getElTooltip",value:function(r){return r||(r=this),r.w.globals.dom.baseEl?r.w.globals.dom.baseEl.querySelector(".apexcharts-tooltip"):null}},{key:"getElXCrosshairs",value:function(){return this.w.globals.dom.baseEl.querySelector(".apexcharts-xcrosshairs")}},{key:"getElGrid",value:function(){return this.w.globals.dom.baseEl.querySelector(".apexcharts-grid")}},{key:"drawTooltip",value:function(r){var i=this.w;this.xyRatios=r,this.isXAxisTooltipEnabled=i.config.xaxis.tooltip.enabled&&i.globals.axisCharts,this.yaxisTooltips=i.config.yaxis.map(function(h,p){return!!(h.show&&h.tooltip.enabled&&i.globals.axisCharts)}),this.allTooltipSeriesGroups=[],i.globals.axisCharts||(this.showTooltipTitle=!1);var o=document.createElement("div");if(o.classList.add("apexcharts-tooltip"),i.config.tooltip.cssClass&&o.classList.add(i.config.tooltip.cssClass),o.classList.add("apexcharts-theme-".concat(this.tConfig.theme)),i.globals.dom.elWrap.appendChild(o),i.globals.axisCharts){this.axesTooltip.drawXaxisTooltip(),this.axesTooltip.drawYaxisTooltip(),this.axesTooltip.setXCrosshairWidth(),this.axesTooltip.handleYCrosshair();var l=new Pr(this.ctx);this.xAxisTicksPositions=l.getXAxisTicksPositions()}if(!i.globals.comboCharts&&!this.tConfig.intersect&&"rangeBar"!==i.config.chart.type||this.tConfig.shared||(this.showOnIntersect=!0),0!==i.config.markers.size&&0!==i.globals.markers.largestSize||this.marker.drawDynamicPoints(this),i.globals.collapsedSeries.length!==i.globals.series.length){this.dataPointsDividedHeight=i.globals.gridHeight/i.globals.dataPoints,this.dataPointsDividedWidth=i.globals.gridWidth/i.globals.dataPoints,this.showTooltipTitle&&(this.tooltipTitle=document.createElement("div"),this.tooltipTitle.classList.add("apexcharts-tooltip-title"),this.tooltipTitle.style.fontFamily=this.tConfig.style.fontFamily||i.config.chart.fontFamily,this.tooltipTitle.style.fontSize=this.tConfig.style.fontSize,o.appendChild(this.tooltipTitle));var u=i.globals.series.length;(i.globals.xyCharts||i.globals.comboCharts)&&this.tConfig.shared&&(u=this.showOnIntersect?1:i.globals.series.length),this.legendLabels=i.globals.dom.baseEl.querySelectorAll(".apexcharts-legend-text"),this.ttItems=this.createTTElements(u),this.addSVGEvents()}}},{key:"createTTElements",value:function(r){for(var i=this,o=this.w,l=[],u=this.getElTooltip(),h=function(v){var y=document.createElement("div");y.classList.add("apexcharts-tooltip-series-group"),y.style.order=o.config.tooltip.inverseOrder?r-v:v+1,i.tConfig.shared&&i.tConfig.enabledOnSeries&&Array.isArray(i.tConfig.enabledOnSeries)&&i.tConfig.enabledOnSeries.indexOf(v)<0&&y.classList.add("apexcharts-tooltip-series-group-hidden");var C=document.createElement("span");C.classList.add("apexcharts-tooltip-marker"),C.style.backgroundColor=o.globals.colors[v],y.appendChild(C);var k=document.createElement("div");k.classList.add("apexcharts-tooltip-text"),k.style.fontFamily=i.tConfig.style.fontFamily||o.config.chart.fontFamily,k.style.fontSize=i.tConfig.style.fontSize,["y","goals","z"].forEach(function(S){var R=document.createElement("div");R.classList.add("apexcharts-tooltip-".concat(S,"-group"));var N=document.createElement("span");N.classList.add("apexcharts-tooltip-text-".concat(S,"-label")),R.appendChild(N);var B=document.createElement("span");B.classList.add("apexcharts-tooltip-text-".concat(S,"-value")),R.appendChild(B),k.appendChild(R)}),y.appendChild(k),u.appendChild(y),l.push(y)},p=0;p<r;p++)h(p);return l}},{key:"addSVGEvents",value:function(){var r=this.w,i=r.config.chart.type,o=this.getElTooltip(),l=!("bar"!==i&&"candlestick"!==i&&"boxPlot"!==i&&"rangeBar"!==i),u="area"===i||"line"===i||"scatter"===i||"bubble"===i||"radar"===i,h=r.globals.dom.Paper.node,p=this.getElGrid();p&&(this.seriesBound=p.getBoundingClientRect());var v,y=[],C=[],k={hoverArea:h,elGrid:p,tooltipEl:o,tooltipY:y,tooltipX:C,ttItems:this.ttItems};if(r.globals.axisCharts&&(u?v=r.globals.dom.baseEl.querySelectorAll(".apexcharts-series[data\\:longestSeries='true'] .apexcharts-marker"):l?v=r.globals.dom.baseEl.querySelectorAll(".apexcharts-series .apexcharts-bar-area, .apexcharts-series .apexcharts-candlestick-area, .apexcharts-series .apexcharts-boxPlot-area, .apexcharts-series .apexcharts-rangebar-area"):"heatmap"!==i&&"treemap"!==i||(v=r.globals.dom.baseEl.querySelectorAll(".apexcharts-series .apexcharts-heatmap, .apexcharts-series .apexcharts-treemap")),v&&v.length))for(var S=0;S<v.length;S++)y.push(v[S].getAttribute("cy")),C.push(v[S].getAttribute("cx"));if(r.globals.xyCharts&&!this.showOnIntersect||r.globals.comboCharts&&!this.showOnIntersect||l&&this.tooltipUtil.hasBars()&&this.tConfig.shared)this.addPathsEventListeners([h],k);else if(l&&!r.globals.comboCharts||u&&this.showOnIntersect)this.addDatapointEventsListeners(k);else if(!r.globals.axisCharts||"heatmap"===i||"treemap"===i){var R=r.globals.dom.baseEl.querySelectorAll(".apexcharts-series");this.addPathsEventListeners(R,k)}if(this.showOnIntersect){var N=r.globals.dom.baseEl.querySelectorAll(".apexcharts-line-series .apexcharts-marker, .apexcharts-area-series .apexcharts-marker");N.length>0&&this.addPathsEventListeners(N,k),this.tooltipUtil.hasBars()&&!this.tConfig.shared&&this.addDatapointEventsListeners(k)}}},{key:"drawFixedTooltipRect",value:function(){var r=this.w,i=this.getElTooltip(),o=i.getBoundingClientRect(),l=o.width+10,u=o.height+10,h=this.tConfig.fixed.offsetX,p=this.tConfig.fixed.offsetY,v=this.tConfig.fixed.position.toLowerCase();return v.indexOf("right")>-1&&(h=h+r.globals.svgWidth-l+10),v.indexOf("bottom")>-1&&(p=p+r.globals.svgHeight-u-10),i.style.left=h+"px",i.style.top=p+"px",{x:h,y:p,ttWidth:l,ttHeight:u}}},{key:"addDatapointEventsListeners",value:function(r){var i=this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series-markers .apexcharts-marker, .apexcharts-bar-area, .apexcharts-candlestick-area, .apexcharts-boxPlot-area, .apexcharts-rangebar-area");this.addPathsEventListeners(i,r)}},{key:"addPathsEventListeners",value:function(r,i){for(var o=this,l=function(h){var p={paths:r[h],tooltipEl:i.tooltipEl,tooltipY:i.tooltipY,tooltipX:i.tooltipX,elGrid:i.elGrid,hoverArea:i.hoverArea,ttItems:i.ttItems};["mousemove","mouseup","touchmove","mouseout","touchend"].map(function(v){return r[h].addEventListener(v,o.onSeriesHover.bind(o,p),{capture:!1,passive:!0})})},u=0;u<r.length;u++)l(u)}},{key:"onSeriesHover",value:function(r,i){var o=this,l=Date.now()-this.lastHoverTime;l>=100?this.seriesHover(r,i):(clearTimeout(this.seriesHoverTimeout),this.seriesHoverTimeout=setTimeout(function(){o.seriesHover(r,i)},100-l))}},{key:"seriesHover",value:function(r,i){var o=this;this.lastHoverTime=Date.now();var l=[],u=this.w;u.config.chart.group&&(l=this.ctx.getGroupedCharts()),u.globals.axisCharts&&(u.globals.minX===-1/0&&u.globals.maxX===1/0||0===u.globals.dataPoints)||(l.length?l.forEach(function(h){var p=o.getElTooltip(h);h.w.globals.minX===o.w.globals.minX&&h.w.globals.maxX===o.w.globals.maxX&&h.w.globals.tooltip.seriesHoverByContext({chartCtx:h,ttCtx:h.w.globals.tooltip,opt:{paths:r.paths,tooltipEl:p,tooltipY:r.tooltipY,tooltipX:r.tooltipX,elGrid:r.elGrid,hoverArea:r.hoverArea,ttItems:h.w.globals.tooltip.ttItems},e:i})}):this.seriesHoverByContext({chartCtx:this.ctx,ttCtx:this.w.globals.tooltip,opt:r,e:i}))}},{key:"seriesHoverByContext",value:function(r){var i=r.chartCtx,o=r.ttCtx,l=r.opt,u=r.e,h=i.w,p=this.getElTooltip();p&&(o.tooltipRect={x:0,y:0,ttWidth:p.getBoundingClientRect().width,ttHeight:p.getBoundingClientRect().height},o.e=u,o.tooltipUtil.hasBars()&&!h.globals.comboCharts&&!o.isBarShared&&this.tConfig.onDatasetHover.highlightDataSeries&&new Dr(i).toggleSeriesOnHover(u,u.target.parentNode),o.fixedTooltip&&o.drawFixedTooltipRect(),h.globals.axisCharts?o.axisChartsTooltips({e:u,opt:l,tooltipRect:o.tooltipRect}):o.nonAxisChartsTooltips({e:u,opt:l,tooltipRect:o.tooltipRect}))}},{key:"axisChartsTooltips",value:function(r){var i,o,l=r.e,u=r.opt,h=this.w,p=u.elGrid.getBoundingClientRect(),v="touchmove"===l.type?l.touches[0].clientX:l.clientX,y="touchmove"===l.type?l.touches[0].clientY:l.clientY;if(this.clientY=y,this.clientX=v,h.globals.capturedSeriesIndex=-1,h.globals.capturedDataPointIndex=-1,y<p.top||y>p.top+p.height)this.handleMouseOut(u);else{if(Array.isArray(this.tConfig.enabledOnSeries)&&!h.config.tooltip.shared){var C=parseInt(u.paths.getAttribute("index"),10);if(this.tConfig.enabledOnSeries.indexOf(C)<0)return void this.handleMouseOut(u)}var k=this.getElTooltip(),S=this.getElXCrosshairs(),R=h.globals.xyCharts||"bar"===h.config.chart.type&&!h.globals.isBarHorizontal&&this.tooltipUtil.hasBars()&&this.tConfig.shared||h.globals.comboCharts&&this.tooltipUtil.hasBars();if("mousemove"===l.type||"touchmove"===l.type||"mouseup"===l.type){if(h.globals.collapsedSeries.length+h.globals.ancillaryCollapsedSeries.length===h.globals.series.length)return;null!==S&&S.classList.add("apexcharts-active");var N=this.yaxisTooltips.filter(function(j){return!0===j});if(null!==this.ycrosshairs&&N.length&&this.ycrosshairs.classList.add("apexcharts-active"),R&&!this.showOnIntersect)this.handleStickyTooltip(l,v,y,u);else if("heatmap"===h.config.chart.type||"treemap"===h.config.chart.type){var B=this.intersect.handleHeatTreeTooltip({e:l,opt:u,x:i,y:o,type:h.config.chart.type});o=B.y,k.style.left=(i=B.x)+"px",k.style.top=o+"px"}else this.tooltipUtil.hasBars()&&this.intersect.handleBarTooltip({e:l,opt:u}),this.tooltipUtil.hasMarkers()&&this.intersect.handleMarkerTooltip({e:l,opt:u,x:i,y:o});if(this.yaxisTooltips.length)for(var U=0;U<h.config.yaxis.length;U++)this.axesTooltip.drawYaxisTooltipText(U,y,this.xyRatios);u.tooltipEl.classList.add("apexcharts-active")}else"mouseout"!==l.type&&"touchend"!==l.type||this.handleMouseOut(u)}}},{key:"nonAxisChartsTooltips",value:function(r){var i=r.e,o=r.opt,l=r.tooltipRect,u=this.w,h=o.paths.getAttribute("rel"),p=this.getElTooltip(),v=u.globals.dom.elWrap.getBoundingClientRect();if("mousemove"===i.type||"touchmove"===i.type){p.classList.add("apexcharts-active"),this.tooltipLabels.drawSeriesTexts({ttItems:o.ttItems,i:parseInt(h,10)-1,shared:!1});var C=u.globals.clientY-v.top-l.ttHeight-10;if(p.style.left=u.globals.clientX-v.left-l.ttWidth/2+"px",p.style.top=C+"px",u.config.legend.tooltipHoverFormatter){var k=h-1,S=(0,u.config.legend.tooltipHoverFormatter)(this.legendLabels[k].getAttribute("data:default-text"),{seriesIndex:k,dataPointIndex:k,w:u});this.legendLabels[k].innerHTML=S}}else"mouseout"!==i.type&&"touchend"!==i.type||(p.classList.remove("apexcharts-active"),u.config.legend.tooltipHoverFormatter&&this.legendLabels.forEach(function(R){var N=R.getAttribute("data:default-text");R.innerHTML=decodeURIComponent(N)}))}},{key:"handleStickyTooltip",value:function(r,i,o,l){var u=this.w,h=this.tooltipUtil.getNearestValues({context:this,hoverArea:l.hoverArea,elGrid:l.elGrid,clientX:i,clientY:o}),p=h.j,v=h.capturedSeries;u.globals.collapsedSeriesIndices.includes(v)&&(v=null);var y=l.elGrid.getBoundingClientRect();if(h.hoverX<0||h.hoverX>y.width)this.handleMouseOut(l);else if(null!==v)this.handleStickyCapturedSeries(r,v,l,p);else if(this.tooltipUtil.isXoverlap(p)||u.globals.isBarHorizontal){var C=u.globals.series.findIndex(function(k,S){return!u.globals.collapsedSeriesIndices.includes(S)});this.create(r,this,C,p,l.ttItems)}}},{key:"handleStickyCapturedSeries",value:function(r,i,o,l){var u=this.w;if(this.tConfig.shared||null!==u.globals.series[i][l]){if(void 0!==u.globals.series[i][l])this.tConfig.shared&&this.tooltipUtil.isXoverlap(l)&&this.tooltipUtil.isInitialSeriesSameLen()?this.create(r,this,i,l,o.ttItems):this.create(r,this,i,l,o.ttItems,!1);else if(this.tooltipUtil.isXoverlap(l)){var h=u.globals.series.findIndex(function(p,v){return!u.globals.collapsedSeriesIndices.includes(v)});this.create(r,this,h,l,o.ttItems)}}else this.handleMouseOut(o)}},{key:"deactivateHoverFilter",value:function(){for(var r=this.w,i=new Ke(this.ctx),o=r.globals.dom.Paper.select(".apexcharts-bar-area"),l=0;l<o.length;l++)i.pathMouseLeave(o[l])}},{key:"handleMouseOut",value:function(r){var i=this.w,o=this.getElXCrosshairs();if(r.tooltipEl.classList.remove("apexcharts-active"),this.deactivateHoverFilter(),"bubble"!==i.config.chart.type&&this.marker.resetPointsSize(),null!==o&&o.classList.remove("apexcharts-active"),null!==this.ycrosshairs&&this.ycrosshairs.classList.remove("apexcharts-active"),this.isXAxisTooltipEnabled&&this.xaxisTooltip.classList.remove("apexcharts-active"),this.yaxisTooltips.length){null===this.yaxisTTEls&&(this.yaxisTTEls=i.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxistooltip"));for(var l=0;l<this.yaxisTTEls.length;l++)this.yaxisTTEls[l].classList.remove("apexcharts-active")}i.config.legend.tooltipHoverFormatter&&this.legendLabels.forEach(function(u){var h=u.getAttribute("data:default-text");u.innerHTML=decodeURIComponent(h)})}},{key:"markerClick",value:function(r,i,o){var l=this.w;"function"==typeof l.config.chart.events.markerClick&&l.config.chart.events.markerClick(r,this.ctx,{seriesIndex:i,dataPointIndex:o,w:l}),this.ctx.events.fireEvent("markerClick",[r,this.ctx,{seriesIndex:i,dataPointIndex:o,w:l}])}},{key:"create",value:function(r,i,o,l,u){var h,p,v,y,C,k,S,R,N,B,U,j,K,x,I,W,q=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,J=this.w,ne=i;"mouseup"===r.type&&this.markerClick(r,o,l),null===q&&(q=this.tConfig.shared);var ve=this.tooltipUtil.hasMarkers(o),ge=this.tooltipUtil.getElBars();if(J.config.legend.tooltipHoverFormatter){var Le=J.config.legend.tooltipHoverFormatter,qe=Array.from(this.legendLabels);qe.forEach(function(zn){var En=zn.getAttribute("data:default-text");zn.innerHTML=decodeURIComponent(En)});for(var Pe=0;Pe<qe.length;Pe++){var Ue=qe[Pe],lt=parseInt(Ue.getAttribute("i"),10),ft=decodeURIComponent(Ue.getAttribute("data:default-text")),At=Le(ft,{seriesIndex:q?lt:o,dataPointIndex:l,w:J});if(q)Ue.innerHTML=J.globals.collapsedSeriesIndices.indexOf(lt)<0?At:ft;else if(Ue.innerHTML=lt===o?At:ft,o===lt)break}}var St=Ze(Ze({ttItems:u,i:o,j:l},void 0!==(null===(h=J.globals.seriesRange)||void 0===h||null===(p=h[o])||void 0===p||null===(v=p[l])||void 0===v||null===(y=v.y[0])||void 0===y?void 0:y.y1)&&{y1:null===(C=J.globals.seriesRange)||void 0===C||null===(k=C[o])||void 0===k||null===(S=k[l])||void 0===S||null===(R=S.y[0])||void 0===R?void 0:R.y1}),void 0!==(null===(N=J.globals.seriesRange)||void 0===N||null===(B=N[o])||void 0===B||null===(U=B[l])||void 0===U||null===(j=U.y[0])||void 0===j?void 0:j.y2)&&{y2:null===(K=J.globals.seriesRange)||void 0===K||null===(x=K[o])||void 0===x||null===(I=x[l])||void 0===I||null===(W=I.y[0])||void 0===W?void 0:W.y2});if(q){if(ne.tooltipLabels.drawSeriesTexts(Ze(Ze({},St),{},{shared:!this.showOnIntersect&&this.tConfig.shared})),ve)J.globals.markers.largestSize>0?ne.marker.enlargePoints(l):ne.tooltipPosition.moveDynamicPointsOnHover(l);else if(this.tooltipUtil.hasBars()&&(this.barSeriesHeight=this.tooltipUtil.getBarsHeight(ge),this.barSeriesHeight>0)){var Gt=new Ke(this.ctx),Lt=J.globals.dom.Paper.select(".apexcharts-bar-area[j='".concat(l,"']"));this.deactivateHoverFilter(),this.tooltipPosition.moveStickyTooltipOverBars(l,o);for(var $t=0;$t<Lt.length;$t++)Gt.pathMouseEnter(Lt[$t])}}else ne.tooltipLabels.drawSeriesTexts(Ze({shared:!1},St)),this.tooltipUtil.hasBars()&&ne.tooltipPosition.moveStickyTooltipOverBars(l,o),ve&&ne.tooltipPosition.moveMarkers(o,l)}}]),P}(),ua=function(){function P(r){F(this,P),this.w=r.w,this.barCtx=r,this.totalFormatter=this.w.config.plotOptions.bar.dataLabels.total.formatter,this.totalFormatter||(this.totalFormatter=this.w.config.dataLabels.formatter)}return me(P,[{key:"handleBarDataLabels",value:function(r){var i,o,l=r.x,u=r.y,h=r.y1,p=r.y2,v=r.i,y=r.j,C=r.realIndex,k=r.columnGroupIndex,S=r.series,R=r.barHeight,N=r.barWidth,B=r.barXPosition,U=r.barYPosition,j=r.visibleSeries,K=r.renderedPath,x=this.w,I=new Ke(this.barCtx.ctx),W=Array.isArray(this.barCtx.strokeWidth)?this.barCtx.strokeWidth[C]:this.barCtx.strokeWidth;x.globals.isXNumeric&&!x.globals.isBarHorizontal?(i=l+parseFloat(N*(j+1)),o=u+parseFloat(R*(j+1))-W):(i=l+parseFloat(N*j),o=u+parseFloat(R*j));var q,ge,J=null,ne=l,ve=u,Le=x.config.dataLabels,qe=this.barCtx.barOptions.dataLabels,Pe=this.barCtx.barOptions.dataLabels.total;void 0!==U&&this.barCtx.isRangeBar&&(o=U,ve=U),void 0!==B&&this.barCtx.isVerticalGroupedRangeBar&&(i=B,ne=B);var Ue=Le.offsetX,lt=Le.offsetY,ft={width:0,height:0};x.config.dataLabels.enabled&&(ft=I.getTextRects(x.globals.yLabelFormatters[0](this.barCtx.series[v][y]),parseFloat(Le.style.fontSize)));var St={x:l,y:u,i:v,j:y,realIndex:C,columnGroupIndex:k,renderedPath:K,bcx:i,bcy:o,barHeight:R,barWidth:N,textRects:ft,strokeWidth:W,dataLabelsX:ne,dataLabelsY:ve,dataLabelsConfig:Le,barDataLabelsConfig:qe,barTotalDataLabelsConfig:Pe,offX:Ue,offY:lt};return ge=this.barCtx.isHorizontal?this.calculateBarsDataLabelsPosition(St):this.calculateColumnsDataLabelsPosition(St),K.attr({cy:ge.bcy,cx:ge.bcx,j:y,val:S[v][y],barHeight:R,barWidth:N}),q=this.drawCalculatedDataLabels({x:ge.dataLabelsX,y:ge.dataLabelsY,val:this.barCtx.isRangeBar?[h,p]:S[v][y],i:C,j:y,barWidth:N,barHeight:R,textRects:ft,dataLabelsConfig:Le}),x.config.chart.stacked&&Pe.enabled&&(J=this.drawTotalDataLabels({x:ge.totalDataLabelsX,y:ge.totalDataLabelsY,barWidth:N,barHeight:R,realIndex:C,textAnchor:ge.totalDataLabelsAnchor,val:this.getStackedTotalDataLabel({realIndex:C,j:y}),dataLabelsConfig:Le,barTotalDataLabelsConfig:Pe})),{dataLabels:q,totalDataLabels:J}}},{key:"getStackedTotalDataLabel",value:function(r){var i=r.realIndex,o=r.j,l=this.w,u=this.barCtx.stackedSeriesTotals[o];return this.totalFormatter&&(u=this.totalFormatter(u,Ze(Ze({},l),{},{seriesIndex:i,dataPointIndex:o,w:l}))),u}},{key:"calculateColumnsDataLabelsPosition",value:function(r){var i,o,l=this.w,u=r.i,h=r.j,p=r.realIndex,v=r.columnGroupIndex,y=r.y,C=r.bcx,k=r.barWidth,S=r.barHeight,R=r.textRects,N=r.dataLabelsX,B=r.dataLabelsY,U=r.dataLabelsConfig,j=r.barDataLabelsConfig,K=r.barTotalDataLabelsConfig,x=r.strokeWidth,I=r.offX,W=r.offY,q=C;S=Math.abs(S);var J="vertical"===l.config.plotOptions.bar.dataLabels.orientation,ne=this.barCtx.barHelpers.getZeroValueEncounters({i:u,j:h}).zeroEncounters;C=C-x/2+v*k,this.barCtx.isVerticalGroupedRangeBar?N+=k/2:(N=l.globals.isXNumeric?C-k/2+I:C-l.globals.gridWidth/l.globals.dataPoints+k/2+I,ne>0&&l.config.plotOptions.bar.hideZeroBarsWhenGrouped&&(N-=k*ne)),J&&(N=N+R.height/2-x/2-2);var ge=this.barCtx.series[u][h]<0,Le=y;switch(this.barCtx.isReversed&&(Le=y+(ge?S:-S),y-=S),j.position){case"center":B=J?ge?Le-S/2+W:Le+S/2-W:ge?Le-S/2+R.height/2+W:Le+S/2+R.height/2-W;break;case"bottom":B=J?ge?Le-S+W:Le+S-W:ge?Le-S+R.height+x+W:Le+S-R.height/2+x-W;break;case"top":B=J?ge?Le+W:Le-W:ge?Le-R.height/2-W:Le+R.height+W}if(this.barCtx.lastActiveBarSerieIndex===p&&K.enabled){var qe=new Ke(this.barCtx.ctx).getTextRects(this.getStackedTotalDataLabel({realIndex:p,j:h}),U.fontSize);i=ge?Le-qe.height/2-W-K.offsetY+18:Le+qe.height+W+K.offsetY-18,o=q+k*(l.globals.barGroups.length-.5)-(l.globals.isXNumeric?k:l.globals.gridWidth/l.globals.dataPoints)+K.offsetX}return l.config.chart.stacked||(B<0?B=0+x:B+R.height/3>l.globals.gridHeight&&(B=l.globals.gridHeight-x)),{bcx:C,bcy:y,dataLabelsX:N,dataLabelsY:B,totalDataLabelsX:o,totalDataLabelsY:i,totalDataLabelsAnchor:"middle"}}},{key:"calculateBarsDataLabelsPosition",value:function(r){var i=this.w,o=r.x,l=r.i,u=r.j,h=r.realIndex,p=r.columnGroupIndex,v=r.bcy,y=r.barHeight,C=r.barWidth,k=r.textRects,S=r.dataLabelsX,R=r.strokeWidth,N=r.dataLabelsConfig,B=r.barDataLabelsConfig,U=r.barTotalDataLabelsConfig,j=r.offX,K=r.offY,x=i.globals.gridHeight/i.globals.dataPoints;C=Math.abs(C);var I,W,q=(v+=p*y)-(this.barCtx.isRangeBar?0:x)+y/2+k.height/2+K-3,J="start",ne=this.barCtx.series[l][u]<0,ve=o;switch(this.barCtx.isReversed&&(ve=o+(ne?-C:C),o=i.globals.gridWidth-C,J=ne?"start":"end"),B.position){case"center":S=ne?ve+C/2-j:Math.max(k.width/2,ve-C/2)+j;break;case"bottom":S=ne?ve+C-R-Math.round(k.width/2)-j:ve-C+R+Math.round(k.width/2)+j;break;case"top":S=ne?ve-R+Math.round(k.width/2)-j:ve-R-Math.round(k.width/2)+j}if(this.barCtx.lastActiveBarSerieIndex===h&&U.enabled){var ge=new Ke(this.barCtx.ctx).getTextRects(this.getStackedTotalDataLabel({realIndex:h,j:u}),N.fontSize);ne?(I=ve-R-j-U.offsetX,J="end"):I=ve+j+U.offsetX+(this.barCtx.isReversed?-(C+R):R),W=q-k.height/2+ge.height/2+U.offsetY+R}return i.config.chart.stacked||(S<0?S=S+k.width+R:S+k.width/2>i.globals.gridWidth&&(S=i.globals.gridWidth-k.width-R)),{bcx:o,bcy:v,dataLabelsX:S,dataLabelsY:q,totalDataLabelsX:I,totalDataLabelsY:W,totalDataLabelsAnchor:J}}},{key:"drawCalculatedDataLabels",value:function(r){var i=r.x,o=r.y,l=r.val,u=r.i,h=r.j,p=r.textRects,v=r.barHeight,y=r.barWidth,C=r.dataLabelsConfig,k=this.w,S="rotate(0)";"vertical"===k.config.plotOptions.bar.dataLabels.orientation&&(S="rotate(-90, ".concat(i,", ").concat(o,")"));var R=new wn(this.barCtx.ctx),N=new Ke(this.barCtx.ctx),B=C.formatter,U=null,j=k.globals.collapsedSeriesIndices.indexOf(u)>-1;if(C.enabled&&!j){U=N.group({class:"apexcharts-data-labels",transform:S});var K="";void 0!==l&&(K=B(l,Ze(Ze({},k),{},{seriesIndex:u,dataPointIndex:h,w:k}))),!l&&k.config.plotOptions.bar.hideZeroBarsWhenGrouped&&(K="");var x=k.globals.series[u][h]<0,I=k.config.plotOptions.bar.dataLabels.position;"vertical"===k.config.plotOptions.bar.dataLabels.orientation&&("top"===I&&(C.textAnchor=x?"end":"start"),"center"===I&&(C.textAnchor="middle"),"bottom"===I&&(C.textAnchor=x?"end":"start")),this.barCtx.isRangeBar&&this.barCtx.barOptions.dataLabels.hideOverflowingLabels&&y<N.getTextRects(K,parseFloat(C.style.fontSize)).width&&(K=""),k.config.chart.stacked&&this.barCtx.barOptions.dataLabels.hideOverflowingLabels&&(this.barCtx.isHorizontal?p.width/1.6>Math.abs(y)&&(K=""):p.height/1.6>Math.abs(v)&&(K=""));var W=Ze({},C);this.barCtx.isHorizontal&&l<0&&("start"===C.textAnchor?W.textAnchor="end":"end"===C.textAnchor&&(W.textAnchor="start")),R.plotDataLabelsText({x:i,y:o,text:K,i:u,j:h,parent:U,dataLabelsConfig:W,alwaysDrawDataLabel:!0,offsetCorrection:!0})}return U}},{key:"drawTotalDataLabels",value:function(r){var i,o=r.x,l=r.y,u=r.val,h=r.barWidth,p=r.barHeight,v=r.realIndex,y=r.textAnchor,C=r.barTotalDataLabelsConfig,k=this.w,S=new Ke(this.barCtx.ctx);return C.enabled&&void 0!==o&&void 0!==l&&this.barCtx.lastActiveBarSerieIndex===v&&(i=S.drawText({x:o-(!k.globals.isBarHorizontal&&k.globals.barGroups.length?h*(k.globals.barGroups.length-1)/2:0),y:l-(k.globals.isBarHorizontal&&k.globals.barGroups.length?p*(k.globals.barGroups.length-1)/2:0),foreColor:C.style.color,text:u,textAnchor:y,fontFamily:C.style.fontFamily,fontSize:C.style.fontSize,fontWeight:C.style.fontWeight})),i}}]),P}(),Wr=function(){function P(r){F(this,P),this.w=r.w,this.barCtx=r}return me(P,[{key:"initVariables",value:function(r){var i=this.w;this.barCtx.series=r,this.barCtx.totalItems=0,this.barCtx.seriesLen=0,this.barCtx.visibleI=-1,this.barCtx.visibleItems=1;for(var o=0;o<r.length;o++)if(r[o].length>0&&(this.barCtx.seriesLen=this.barCtx.seriesLen+1,this.barCtx.totalItems+=r[o].length),i.globals.isXNumeric)for(var l=0;l<r[o].length;l++)i.globals.seriesX[o][l]>i.globals.minX&&i.globals.seriesX[o][l]<i.globals.maxX&&this.barCtx.visibleItems++;else this.barCtx.visibleItems=i.globals.dataPoints;0===this.barCtx.seriesLen&&(this.barCtx.seriesLen=1),this.barCtx.zeroSerieses=[],i.globals.comboCharts||this.checkZeroSeries({series:r})}},{key:"initialPositions",value:function(){var r,i,o,l,u,h,p,v,y=this.w,C=y.globals.dataPoints;this.barCtx.isRangeBar&&(C=y.globals.labels.length);var k=this.barCtx.seriesLen;if(y.config.plotOptions.bar.rangeBarGroupRows&&(k=1),this.barCtx.isHorizontal)u=(o=y.globals.gridHeight/C)/k,y.globals.isXNumeric&&(u=(o=y.globals.gridHeight/this.barCtx.totalItems)/this.barCtx.seriesLen),u=u*parseInt(this.barCtx.barOptions.barHeight,10)/100,-1===String(this.barCtx.barOptions.barHeight).indexOf("%")&&(u=parseInt(this.barCtx.barOptions.barHeight,10)),v=this.barCtx.baseLineInvertedY+y.globals.padHorizontal+(this.barCtx.isReversed?y.globals.gridWidth:0)-(this.barCtx.isReversed?2*this.barCtx.baseLineInvertedY:0),this.barCtx.isFunnel&&(v=y.globals.gridWidth/2),i=(o-u*this.barCtx.seriesLen)/2;else{if(l=y.globals.gridWidth/this.barCtx.visibleItems,y.config.xaxis.convertedCatToNumeric&&(l=y.globals.gridWidth/y.globals.dataPoints),h=l/k*parseInt(this.barCtx.barOptions.columnWidth,10)/100,y.globals.isXNumeric){var S=this.barCtx.xRatio;y.globals.minXDiff&&.5!==y.globals.minXDiff&&y.globals.minXDiff/S>0&&(l=y.globals.minXDiff/S),(h=l/k*parseInt(this.barCtx.barOptions.columnWidth,10)/100)<1&&(h=1)}-1===String(this.barCtx.barOptions.columnWidth).indexOf("%")&&(h=parseInt(this.barCtx.barOptions.columnWidth,10)),p=y.globals.gridHeight-this.barCtx.baseLineY[this.barCtx.translationsIndex]-(this.barCtx.isReversed?y.globals.gridHeight:0)+(this.barCtx.isReversed?2*this.barCtx.baseLineY[this.barCtx.translationsIndex]:0),r=y.globals.padHorizontal+(l-h*this.barCtx.seriesLen)/2}return y.globals.barHeight=u,y.globals.barWidth=h,{x:r,y:i,yDivision:o,xDivision:l,barHeight:u,barWidth:h,zeroH:p,zeroW:v}}},{key:"initializeStackedPrevVars",value:function(r){r.w.globals.seriesGroups.forEach(function(i){r[i]||(r[i]={}),r[i].prevY=[],r[i].prevX=[],r[i].prevYF=[],r[i].prevXF=[],r[i].prevYVal=[],r[i].prevXVal=[]})}},{key:"initializeStackedXYVars",value:function(r){r.w.globals.seriesGroups.forEach(function(i){r[i]||(r[i]={}),r[i].xArrj=[],r[i].xArrjF=[],r[i].xArrjVal=[],r[i].yArrj=[],r[i].yArrjF=[],r[i].yArrjVal=[]})}},{key:"getPathFillColor",value:function(r,i,o,l){var u,h,p,v,y=this.w,C=new Fr(this.barCtx.ctx),k=null,S=this.barCtx.barOptions.distributed?o:i;return this.barCtx.barOptions.colors.ranges.length>0&&this.barCtx.barOptions.colors.ranges.map(function(R){r[i][o]>=R.from&&r[i][o]<=R.to&&(k=R.color)}),y.config.series[i].data[o]&&y.config.series[i].data[o].fillColor&&(k=y.config.series[i].data[o].fillColor),C.fillPath({seriesNumber:this.barCtx.barOptions.distributed?S:l,dataPointIndex:o,color:k,value:r[i][o],fillConfig:null===(u=y.config.series[i].data[o])||void 0===u?void 0:u.fill,fillType:null!==(h=y.config.series[i].data[o])&&void 0!==h&&null!==(p=h.fill)&&void 0!==p&&p.type?null===(v=y.config.series[i].data[o])||void 0===v?void 0:v.fill.type:Array.isArray(y.config.fill.type)?y.config.fill.type[i]:y.config.fill.type})}},{key:"getStrokeWidth",value:function(r,i,o){var l=0,u=this.w;return this.barCtx.isNullValue=null==this.barCtx.series[r][i],u.config.stroke.show&&(this.barCtx.isNullValue||(l=Array.isArray(this.barCtx.strokeWidth)?this.barCtx.strokeWidth[o]:this.barCtx.strokeWidth)),l}},{key:"shouldApplyRadius",value:function(r){var i=this.w,o=!1;return i.config.plotOptions.bar.borderRadius>0&&(i.config.chart.stacked&&"last"===i.config.plotOptions.bar.borderRadiusWhenStacked?this.barCtx.lastActiveBarSerieIndex===r&&(o=!0):o=!0),o}},{key:"barBackground",value:function(r){var i=r.j,o=r.i,l=r.x1,u=r.x2,h=r.y1,p=r.y2,v=r.elSeries,y=this.w,C=new Ke(this.barCtx.ctx),k=new Dr(this.barCtx.ctx).getActiveConfigSeriesIndex();if(this.barCtx.barOptions.colors.backgroundBarColors.length>0&&k===o){i>=this.barCtx.barOptions.colors.backgroundBarColors.length&&(i%=this.barCtx.barOptions.colors.backgroundBarColors.length);var R=C.drawRect(void 0!==l?l:0,void 0!==h?h:0,void 0!==u?u:y.globals.gridWidth,void 0!==p?p:y.globals.gridHeight,this.barCtx.barOptions.colors.backgroundBarRadius,this.barCtx.barOptions.colors.backgroundBarColors[i],this.barCtx.barOptions.colors.backgroundBarOpacity);v.add(R),R.node.classList.add("apexcharts-backgroundBar")}}},{key:"getColumnPaths",value:function(r){var i,o=r.barWidth,l=r.barXPosition,u=r.y1,h=r.y2,p=r.strokeWidth,v=r.seriesGroup,y=r.realIndex,C=r.i,k=r.j,S=r.w,R=new Ke(this.barCtx.ctx);(p=Array.isArray(p)?p[y]:p)||(p=0);var N=o,B=l;null!==(i=S.config.series[y].data[k])&&void 0!==i&&i.columnWidthOffset&&(B=l-S.config.series[y].data[k].columnWidthOffset/2,N=o+S.config.series[y].data[k].columnWidthOffset);var U=p/2,j=B+U,K=B+N-U;h+=.001+U;var x=R.move(j,u+=.001-U),I=R.move(j,u),W=R.line(K,u);if(S.globals.previousPaths.length>0&&(I=this.barCtx.getPreviousPath(y,k,!1)),x=x+R.line(j,h)+R.line(K,h)+R.line(K,u)+("around"===S.config.plotOptions.bar.borderRadiusApplication?" Z":" z"),I=I+R.line(j,u)+W+W+W+W+W+R.line(j,u)+("around"===S.config.plotOptions.bar.borderRadiusApplication?" Z":" z"),this.shouldApplyRadius(y)&&(x=R.roundPathCorners(x,S.config.plotOptions.bar.borderRadius)),S.config.chart.stacked){var q=this.barCtx;(q=this.barCtx[v]).yArrj.push(h-U),q.yArrjF.push(Math.abs(u-h+p)),q.yArrjVal.push(this.barCtx.series[C][k])}return{pathTo:x,pathFrom:I}}},{key:"getBarpaths",value:function(r){var i,o=r.barYPosition,l=r.barHeight,u=r.x1,h=r.x2,p=r.strokeWidth,v=r.seriesGroup,y=r.realIndex,C=r.i,k=r.j,S=r.w,R=new Ke(this.barCtx.ctx);(p=Array.isArray(p)?p[y]:p)||(p=0);var N=o,B=l;null!==(i=S.config.series[y].data[k])&&void 0!==i&&i.barHeightOffset&&(N=o-S.config.series[y].data[k].barHeightOffset/2,B=l+S.config.series[y].data[k].barHeightOffset);var U=p/2,j=N+U,K=N+B-U;h+=.001+U;var x=R.move(u+=.001-U,j),I=R.move(u,j);S.globals.previousPaths.length>0&&(I=this.barCtx.getPreviousPath(y,k,!1));var W=R.line(u,K);if(x=x+R.line(h,j)+R.line(h,K)+W+("around"===S.config.plotOptions.bar.borderRadiusApplication?" Z":" z"),I=I+R.line(u,j)+W+W+W+W+W+R.line(u,j)+("around"===S.config.plotOptions.bar.borderRadiusApplication?" Z":" z"),this.shouldApplyRadius(y)&&(x=R.roundPathCorners(x,S.config.plotOptions.bar.borderRadius)),S.config.chart.stacked){var q=this.barCtx;(q=this.barCtx[v]).xArrj.push(h+U),q.xArrjF.push(Math.abs(u-h)),q.xArrjVal.push(this.barCtx.series[C][k])}return{pathTo:x,pathFrom:I}}},{key:"checkZeroSeries",value:function(r){for(var i=r.series,o=this.w,l=0;l<i.length;l++){for(var u=0,h=0;h<i[o.globals.maxValsInArrayIndex].length;h++)u+=i[l][h];0===u&&this.barCtx.zeroSerieses.push(l)}}},{key:"getXForValue",value:function(r,i){var o=arguments.length>2&&void 0!==arguments[2]&&!arguments[2]?null:i;return null!=r&&(o=i+r/this.barCtx.invertedYRatio-2*(this.barCtx.isReversed?r/this.barCtx.invertedYRatio:0)),o}},{key:"getYForValue",value:function(r,i,o){var l=arguments.length>3&&void 0!==arguments[3]&&!arguments[3]?null:i;return null!=r&&(l=i-r/this.barCtx.yRatio[o]+2*(this.barCtx.isReversed?r/this.barCtx.yRatio[o]:0)),l}},{key:"getGoalValues",value:function(r,i,o,l,u,h){var p=this,v=this.w,y=[],C=function(R,N){var B;y.push((st(B={},r,"x"===r?p.getXForValue(R,i,!1):p.getYForValue(R,o,h,!1)),st(B,"attrs",N),B))};if(v.globals.seriesGoals[l]&&v.globals.seriesGoals[l][u]&&Array.isArray(v.globals.seriesGoals[l][u])&&v.globals.seriesGoals[l][u].forEach(function(R){C(R.value,R)}),this.barCtx.barOptions.isDumbbell&&v.globals.seriesRange.length){var k=this.barCtx.barOptions.dumbbellColors?this.barCtx.barOptions.dumbbellColors:v.globals.colors,S={strokeHeight:"x"===r?0:v.globals.markers.size[l],strokeWidth:"x"===r?v.globals.markers.size[l]:0,strokeDashArray:0,strokeLineCap:"round",strokeColor:Array.isArray(k[l])?k[l][0]:k[l]};C(v.globals.seriesRangeStart[l][u],S),C(v.globals.seriesRangeEnd[l][u],Ze(Ze({},S),{},{strokeColor:Array.isArray(k[l])?k[l][1]:k[l]}))}return y}},{key:"drawGoalLine",value:function(r){var i=r.barXPosition,o=r.barYPosition,l=r.goalX,u=r.goalY,h=r.barWidth,p=r.barHeight,v=new Ke(this.barCtx.ctx),y=v.group({className:"apexcharts-bar-goals-groups"});y.node.classList.add("apexcharts-element-hidden"),this.barCtx.w.globals.delayedElements.push({el:y.node}),y.attr("clip-path","url(#gridRectMarkerMask".concat(this.barCtx.w.globals.cuid,")"));var C=null;return this.barCtx.isHorizontal?Array.isArray(l)&&l.forEach(function(k){if(k.x>=-1&&k.x<=v.w.globals.gridWidth+1){var S=void 0!==k.attrs.strokeHeight?k.attrs.strokeHeight:p/2,R=o+S+p/2;C=v.drawLine(k.x,R-2*S,k.x,R,k.attrs.strokeColor?k.attrs.strokeColor:void 0,k.attrs.strokeDashArray,k.attrs.strokeWidth?k.attrs.strokeWidth:2,k.attrs.strokeLineCap),y.add(C)}}):Array.isArray(u)&&u.forEach(function(k){if(k.y>=-1&&k.y<=v.w.globals.gridHeight+1){var S=void 0!==k.attrs.strokeWidth?k.attrs.strokeWidth:h/2,R=i+S+h/2;C=v.drawLine(R-2*S,k.y,R,k.y,k.attrs.strokeColor?k.attrs.strokeColor:void 0,k.attrs.strokeDashArray,k.attrs.strokeHeight?k.attrs.strokeHeight:2,k.attrs.strokeLineCap),y.add(C)}}),y}},{key:"drawBarShadow",value:function(r){var i=r.prevPaths,o=r.currPaths,l=r.color,u=this.w,h=i.x,p=i.x1,y=o.x,C=o.x1,k=o.barYPosition,S=i.barYPosition+o.barHeight,R=new Ke(this.barCtx.ctx),N=new pe,B=R.move(p,S)+R.line(h,S)+R.line(y,k)+R.line(C,k)+R.line(p,S)+("around"===u.config.plotOptions.bar.borderRadiusApplication?" Z":" z");return R.drawPath({d:B,fill:N.shadeColor(.5,pe.rgb2hex(l)),stroke:"none",strokeWidth:0,fillOpacity:1,classes:"apexcharts-bar-shadows"})}},{key:"getZeroValueEncounters",value:function(r){var i,o=r.i,l=r.j,u=this.w,h=0,p=0;return(u.config.plotOptions.bar.horizontal?u.globals.series.map(function(v,y){return y}):(null===(i=u.globals.columnSeries)||void 0===i?void 0:i.i.map(function(v){return v}))||[]).forEach(function(v){var y=u.globals.seriesPercent[v][l];y&&h++,v<o&&0===y&&p++}),{nonZeroColumns:h,zeroEncounters:p}}},{key:"getGroupIndex",value:function(r){var i=this.w,o=i.globals.seriesGroups.findIndex(function(h){return h.indexOf(i.globals.seriesNames[r])>-1}),l=this.barCtx.columnGroupIndices,u=l.indexOf(o);return u<0&&(l.push(o),u=l.length-1),{groupIndex:o,columnGroupIndex:u}}}]),P}(),rn=function(){function P(r,i){F(this,P),this.ctx=r,this.w=r.w;var o=this.w;this.barOptions=o.config.plotOptions.bar,this.isHorizontal=this.barOptions.horizontal,this.strokeWidth=o.config.stroke.width,this.isNullValue=!1,this.isRangeBar=o.globals.seriesRange.length&&this.isHorizontal,this.isVerticalGroupedRangeBar=!o.globals.isBarHorizontal&&o.globals.seriesRange.length&&o.config.plotOptions.bar.rangeBarGroupRows,this.isFunnel=this.barOptions.isFunnel,this.xyRatios=i,null!==this.xyRatios&&(this.xRatio=i.xRatio,this.yRatio=i.yRatio,this.invertedXRatio=i.invertedXRatio,this.invertedYRatio=i.invertedYRatio,this.baseLineY=i.baseLineY,this.baseLineInvertedY=i.baseLineInvertedY),this.yaxisIndex=0,this.translationsIndex=0,this.seriesLen=0,this.pathArr=[];var l=new Dr(this.ctx);this.lastActiveBarSerieIndex=l.getActiveConfigSeriesIndex("desc",["bar","column"]),this.columnGroupIndices=[];var u=l.getBarSeriesIndices(),h=new yn(this.ctx);this.stackedSeriesTotals=h.getStackedSeriesTotals(this.w.config.series.map(function(p,v){return-1===u.indexOf(v)?v:-1}).filter(function(p){return-1!==p})),this.barHelpers=new Wr(this)}return me(P,[{key:"draw",value:function(r,i){var o=this.w,l=new Ke(this.ctx),u=new yn(this.ctx,o);r=u.getLogSeries(r),this.series=r,this.yRatio=u.getLogYRatios(this.yRatio),this.barHelpers.initVariables(r);var h=l.group({class:"apexcharts-bar-series apexcharts-plot-series"});o.config.dataLabels.enabled&&this.totalItems>this.barOptions.dataLabels.maxItems&&console.warn("WARNING: DataLabels are enabled but there are too many to display. This may cause performance issue when rendering - ApexCharts");for(var p=0,v=0;p<r.length;p++,v++){var y,C,k,S,R=void 0,N=void 0,B=[],U=[],j=o.globals.comboCharts?i[p]:p,K=this.barHelpers.getGroupIndex(j).columnGroupIndex,x=l.group({class:"apexcharts-series",rel:p+1,seriesName:pe.escapeString(o.globals.seriesNames[j]),"data:realIndex":j});this.ctx.series.addCollapsedClassToSeries(x,j),r[p].length>0&&(this.visibleI=this.visibleI+1);var I=0,W=0;this.yRatio.length>1&&(this.yaxisIndex=o.globals.seriesYAxisReverseMap[j],this.translationsIndex=j);var q=this.translationsIndex;this.isReversed=o.config.yaxis[this.yaxisIndex]&&o.config.yaxis[this.yaxisIndex].reversed;var J=this.barHelpers.initialPositions();N=J.y,I=J.barHeight,C=J.yDivision,S=J.zeroW,R=J.x,W=J.barWidth,y=J.xDivision,k=J.zeroH,this.horizontal||U.push(R+W/2);var ne=l.group({class:"apexcharts-datalabels","data:realIndex":j});o.globals.delayedElements.push({el:ne.node}),ne.node.classList.add("apexcharts-element-hidden");var ve=l.group({class:"apexcharts-bar-goals-markers"}),ge=l.group({class:"apexcharts-bar-shadows"});o.globals.delayedElements.push({el:ge.node}),ge.node.classList.add("apexcharts-element-hidden");for(var Le=0;Le<r[p].length;Le++){var qe=this.barHelpers.getStrokeWidth(p,Le,j),Pe=null,Ue={indexes:{i:p,j:Le,realIndex:j,translationsIndex:q,bc:v},x:R,y:N,strokeWidth:qe,elSeries:x};this.isHorizontal?(Pe=this.drawBarPaths(Ze(Ze({},Ue),{},{barHeight:I,zeroW:S,yDivision:C})),W=this.series[p][Le]/this.invertedYRatio):(Pe=this.drawColumnPaths(Ze(Ze({},Ue),{},{xDivision:y,barWidth:W,zeroH:k})),I=this.series[p][Le]/this.yRatio[q]);var lt=this.barHelpers.getPathFillColor(r,p,Le,j);if(this.isFunnel&&this.barOptions.isFunnel3d&&this.pathArr.length&&Le>0){var ft=this.barHelpers.drawBarShadow({color:"string"==typeof lt&&-1===lt?.indexOf("url")?lt:pe.hexToRgba(o.globals.colors[p]),prevPaths:this.pathArr[this.pathArr.length-1],currPaths:Pe});ft&&ge.add(ft)}this.pathArr.push(Pe);var At=this.barHelpers.drawGoalLine({barXPosition:Pe.barXPosition,barYPosition:Pe.barYPosition,goalX:Pe.goalX,goalY:Pe.goalY,barHeight:I,barWidth:W});At&&ve.add(At),N=Pe.y,R=Pe.x,Le>0&&U.push(R+W/2),B.push(N),this.renderSeries({realIndex:j,pathFill:lt,j:Le,i:p,columnGroupIndex:K,pathFrom:Pe.pathFrom,pathTo:Pe.pathTo,strokeWidth:qe,elSeries:x,x:R,y:N,series:r,barHeight:Pe.barHeight?Pe.barHeight:I,barWidth:Pe.barWidth?Pe.barWidth:W,elDataLabelsWrap:ne,elGoalsMarkers:ve,elBarShadows:ge,visibleSeries:this.visibleI,type:"bar"})}o.globals.seriesXvalues[j]=U,o.globals.seriesYvalues[j]=B,h.add(x)}return h}},{key:"renderSeries",value:function(r){var At,St,Gt,i=r.realIndex,o=r.pathFill,l=r.lineFill,u=r.j,h=r.i,p=r.columnGroupIndex,v=r.pathFrom,y=r.pathTo,C=r.strokeWidth,k=r.elSeries,S=r.x,R=r.y,N=r.y1,B=r.y2,U=r.series,j=r.barHeight,K=r.barWidth,x=r.barXPosition,I=r.barYPosition,W=r.elDataLabelsWrap,q=r.elGoalsMarkers,J=r.elBarShadows,ne=r.visibleSeries,ve=r.type,ge=this.w,Le=new Ke(this.ctx);if(!l){var qe="function"==typeof ge.globals.stroke.colors[i]?(At=i,Gt=ge.config.stroke.colors,Array.isArray(Gt)&&Gt.length>0&&((St=Gt[At])||(St=""),"function"==typeof St)?St({value:ge.globals.series[At][u],dataPointIndex:u,w:ge}):St):ge.globals.stroke.colors[i];l=this.barOptions.distributed?ge.globals.stroke.colors[u]:qe}ge.config.series[h].data[u]&&ge.config.series[h].data[u].strokeColor&&(l=ge.config.series[h].data[u].strokeColor),this.isNullValue&&(o="none");var Ue=Le.renderPaths({i:h,j:u,realIndex:i,pathFrom:v,pathTo:y,stroke:l,strokeWidth:C,strokeLineCap:ge.config.stroke.lineCap,fill:o,animationDelay:u/ge.config.chart.animations.animateGradually.delay*(ge.config.chart.animations.speed/ge.globals.dataPoints)/2.4,initialSpeed:ge.config.chart.animations.speed,dataChangeSpeed:ge.config.chart.animations.dynamicAnimation.speed,className:"apexcharts-".concat(ve,"-area")});Ue.attr("clip-path","url(#gridRectMask".concat(ge.globals.cuid,")"));var lt=ge.config.forecastDataPoints;lt.count>0&&u>=ge.globals.dataPoints-lt.count&&(Ue.node.setAttribute("stroke-dasharray",lt.dashArray),Ue.node.setAttribute("stroke-width",lt.strokeWidth),Ue.node.setAttribute("fill-opacity",lt.fillOpacity)),void 0!==N&&void 0!==B&&(Ue.attr("data-range-y1",N),Ue.attr("data-range-y2",B)),new On(this.ctx).setSelectionFilter(Ue,i,u),k.add(Ue);var ft=new ua(this).handleBarDataLabels({x:S,y:R,y1:N,y2:B,i:h,j:u,series:U,realIndex:i,columnGroupIndex:p,barHeight:j,barWidth:K,barXPosition:x,barYPosition:I,renderedPath:Ue,visibleSeries:ne});return null!==ft.dataLabels&&W.add(ft.dataLabels),ft.totalDataLabels&&W.add(ft.totalDataLabels),k.add(W),q&&k.add(q),J&&k.add(J),k}},{key:"drawBarPaths",value:function(r){var i,p,o=r.indexes,l=r.barHeight,u=r.strokeWidth,h=r.zeroW,v=r.y,y=r.yDivision,C=r.elSeries,k=this.w,S=o.i,R=o.j;if(k.globals.isXNumeric)i=(v=(k.globals.seriesX[S][R]-k.globals.minX)/this.invertedXRatio-l)+l*this.visibleI;else if(k.config.plotOptions.bar.hideZeroBarsWhenGrouped){var N=0,B=0;k.globals.seriesPercent.forEach(function(j,K){j[R]&&N++,K<S&&0===j[R]&&B++}),N>0&&(l=this.seriesLen*l/N),i=v+l*this.visibleI,i-=l*B}else i=v+l*this.visibleI;this.isFunnel&&(h-=(this.barHelpers.getXForValue(this.series[S][R],h)-h)/2),p=this.barHelpers.getXForValue(this.series[S][R],h);var U=this.barHelpers.getBarpaths({barYPosition:i,barHeight:l,x1:h,x2:p,strokeWidth:u,series:this.series,realIndex:o.realIndex,i:S,j:R,w:k});return k.globals.isXNumeric||(v+=y),this.barHelpers.barBackground({j:R,i:S,y1:i-l*this.visibleI,y2:l*this.seriesLen,elSeries:C}),{pathTo:U.pathTo,pathFrom:U.pathFrom,x1:h,x:p,y:v,goalX:this.barHelpers.getGoalValues("x",h,null,S,R),barYPosition:i,barHeight:l}}},{key:"drawColumnPaths",value:function(r){var i,u,o=r.indexes,l=r.x,h=r.xDivision,p=r.barWidth,v=r.zeroH,y=r.strokeWidth,C=r.elSeries,k=this.w,S=o.realIndex,R=o.translationsIndex,N=o.i,B=o.j,U=o.bc;if(k.globals.isXNumeric){var j=this.getBarXForNumericXAxis({x:l,j:B,realIndex:S,barWidth:p});l=j.x,i=j.barXPosition}else if(k.config.plotOptions.bar.hideZeroBarsWhenGrouped){var K=this.barHelpers.getZeroValueEncounters({i:N,j:B}),x=K.nonZeroColumns;x>0&&(p=this.seriesLen*p/x),i=l+p*this.visibleI,i-=p*K.zeroEncounters}else i=l+p*this.visibleI;u=this.barHelpers.getYForValue(this.series[N][B],v,R);var W=this.barHelpers.getColumnPaths({barXPosition:i,barWidth:p,y1:v,y2:u,strokeWidth:y,series:this.series,realIndex:S,i:N,j:B,w:k});return k.globals.isXNumeric||(l+=h),this.barHelpers.barBackground({bc:U,j:B,i:N,x1:i-y/2-p*this.visibleI,x2:p*this.seriesLen+y/2,elSeries:C}),{pathTo:W.pathTo,pathFrom:W.pathFrom,x:l,y:u,goalY:this.barHelpers.getGoalValues("y",null,v,N,B,R),barXPosition:i,barWidth:p}}},{key:"getBarXForNumericXAxis",value:function(r){var i=r.x,o=r.barWidth,l=r.realIndex,u=r.j,h=this.w,p=l;return h.globals.seriesX[l].length||(p=h.globals.maxValsInArrayIndex),h.globals.seriesX[p][u]&&(i=(h.globals.seriesX[p][u]-h.globals.minX)/this.xRatio-o*this.seriesLen/2),{barXPosition:i+o*this.visibleI,x:i}}},{key:"getPreviousPath",value:function(r,i){for(var o,l=this.w,u=0;u<l.globals.previousPaths.length;u++){var h=l.globals.previousPaths[u];h.paths&&h.paths.length>0&&parseInt(h.realIndex,10)===parseInt(r,10)&&void 0!==l.globals.previousPaths[u].paths[i]&&(o=l.globals.previousPaths[u].paths[i].d)}return o}}]),P}(),Me=function(P){_e(i,P);var r=dn(i);function i(){return F(this,i),r.apply(this,arguments)}return me(i,[{key:"draw",value:function(o,l){var u=this,h=this.w;this.graphics=new Ke(this.ctx),this.bar=new rn(this.ctx,this.xyRatios);var p=new yn(this.ctx,h);o=p.getLogSeries(o),this.yRatio=p.getLogYRatios(this.yRatio),this.barHelpers.initVariables(o),"100%"===h.config.chart.stackType&&(o=h.globals.comboCharts?l.map(function(N){return h.globals.seriesPercent[N]}):h.globals.seriesPercent.slice()),this.series=o,this.barHelpers.initializeStackedPrevVars(this);for(var v=this.graphics.group({class:"apexcharts-bar-series apexcharts-plot-series"}),y=0,C=0,k=function(N,B){var U=void 0,j=void 0,K=void 0,x=void 0,I=h.globals.comboCharts?l[N]:N,W=u.barHelpers.getGroupIndex(I),q=W.groupIndex,J=W.columnGroupIndex;u.groupCtx=u[h.globals.seriesGroups[q]];var ne=[],ve=[],ge=0;u.yRatio.length>1&&(u.yaxisIndex=h.globals.seriesYAxisReverseMap[I][0],ge=I),u.isReversed=h.config.yaxis[u.yaxisIndex]&&h.config.yaxis[u.yaxisIndex].reversed;var Le=u.graphics.group({class:"apexcharts-series",seriesName:pe.escapeString(h.globals.seriesNames[I]),rel:N+1,"data:realIndex":I});u.ctx.series.addCollapsedClassToSeries(Le,I);var qe=u.graphics.group({class:"apexcharts-datalabels","data:realIndex":I}),Pe=u.graphics.group({class:"apexcharts-bar-goals-markers"}),Ue=0,lt=0,ft=u.initialPositions(y,C,U,j,K,x,ge);C=ft.y,j=ft.yDivision,x=ft.zeroW,y=ft.x,lt=ft.barWidth,U=ft.xDivision,K=ft.zeroH,h.globals.barHeight=Ue=ft.barHeight,h.globals.barWidth=lt,u.barHelpers.initializeStackedXYVars(u),1===u.groupCtx.prevY.length&&u.groupCtx.prevY[0].every(function(En){return isNaN(En)})&&(u.groupCtx.prevY[0]=u.groupCtx.prevY[0].map(function(){return K}),u.groupCtx.prevYF[0]=u.groupCtx.prevYF[0].map(function(){return 0}));for(var At=0;At<h.globals.dataPoints;At++){var St=u.barHelpers.getStrokeWidth(N,At,I),Gt={indexes:{i:N,j:At,realIndex:I,translationsIndex:ge,bc:B},strokeWidth:St,x:y,y:C,elSeries:Le,columnGroupIndex:J,seriesGroup:h.globals.seriesGroups[q]},Lt=null;u.isHorizontal?(Lt=u.drawStackedBarPaths(Ze(Ze({},Gt),{},{zeroW:x,barHeight:Ue,yDivision:j})),lt=u.series[N][At]/u.invertedYRatio):(Lt=u.drawStackedColumnPaths(Ze(Ze({},Gt),{},{xDivision:U,barWidth:lt,zeroH:K})),Ue=u.series[N][At]/u.yRatio[ge]);var $t=u.barHelpers.drawGoalLine({barXPosition:Lt.barXPosition,barYPosition:Lt.barYPosition,goalX:Lt.goalX,goalY:Lt.goalY,barHeight:Ue,barWidth:lt});$t&&Pe.add($t),C=Lt.y,ne.push(y=Lt.x),ve.push(C);var zn=u.barHelpers.getPathFillColor(o,N,At,I);Le=u.renderSeries({realIndex:I,pathFill:zn,j:At,i:N,columnGroupIndex:J,pathFrom:Lt.pathFrom,pathTo:Lt.pathTo,strokeWidth:St,elSeries:Le,x:y,y:C,series:o,barHeight:Ue,barWidth:lt,elDataLabelsWrap:qe,elGoalsMarkers:Pe,type:"bar",visibleSeries:0})}h.globals.seriesXvalues[I]=ne,h.globals.seriesYvalues[I]=ve,u.groupCtx.prevY.push(u.groupCtx.yArrj),u.groupCtx.prevYF.push(u.groupCtx.yArrjF),u.groupCtx.prevYVal.push(u.groupCtx.yArrjVal),u.groupCtx.prevX.push(u.groupCtx.xArrj),u.groupCtx.prevXF.push(u.groupCtx.xArrjF),u.groupCtx.prevXVal.push(u.groupCtx.xArrjVal),v.add(Le)},S=0,R=0;S<o.length;S++,R++)k(S,R);return v}},{key:"initialPositions",value:function(o,l,u,h,p,v,y){var C,k,S=this.w;if(this.isHorizontal){h=S.globals.gridHeight/S.globals.dataPoints;var R=S.config.plotOptions.bar.barHeight;C=-1===String(R).indexOf("%")?parseInt(R,10):h*parseInt(R,10)/100,v=S.globals.padHorizontal+(this.isReversed?S.globals.gridWidth-this.baseLineInvertedY:this.baseLineInvertedY),l=(h-C)/2}else{k=u=S.globals.gridWidth/S.globals.dataPoints;var N=S.config.plotOptions.bar.columnWidth;S.globals.isXNumeric&&S.globals.dataPoints>1?k=(u=S.globals.minXDiff/this.xRatio)*parseInt(this.barOptions.columnWidth,10)/100:-1===String(N).indexOf("%")?k=parseInt(N,10):k*=parseInt(N,10)/100,p=S.globals.gridHeight-this.baseLineY[y]-(this.isReversed?S.globals.gridHeight:0),o=S.globals.padHorizontal+(u-k)/2}var B=S.globals.barGroups.length||1;return{x:o,y:l,yDivision:h,xDivision:u,barHeight:C/B,barWidth:k/B,zeroH:p,zeroW:v}}},{key:"drawStackedBarPaths",value:function(o){for(var l,y,u=o.indexes,h=o.barHeight,p=o.strokeWidth,v=o.zeroW,C=o.y,S=o.seriesGroup,R=o.yDivision,N=o.elSeries,B=this.w,U=C+o.columnGroupIndex*h,j=u.i,K=u.j,x=u.realIndex,I=u.translationsIndex,W=0,q=0;q<this.groupCtx.prevXF.length;q++)W+=this.groupCtx.prevXF[q][K];var J;if((J=S.indexOf(B.config.series[x].name))>0){var ne=v;this.groupCtx.prevXVal[J-1][K]<0?ne=this.series[j][K]>=0?this.groupCtx.prevX[J-1][K]+W-2*(this.isReversed?W:0):this.groupCtx.prevX[J-1][K]:this.groupCtx.prevXVal[J-1][K]>=0&&(ne=this.series[j][K]>=0?this.groupCtx.prevX[J-1][K]:this.groupCtx.prevX[J-1][K]-W+2*(this.isReversed?W:0)),l=ne}else l=v;var ve=this.barHelpers.getBarpaths({barYPosition:U,barHeight:h,x1:l,x2:y=null===this.series[j][K]?l:l+this.series[j][K]/this.invertedYRatio-2*(this.isReversed?this.series[j][K]/this.invertedYRatio:0),strokeWidth:p,series:this.series,realIndex:u.realIndex,seriesGroup:S,i:j,j:K,w:B});return this.barHelpers.barBackground({j:K,i:j,y1:U,y2:h,elSeries:N}),C+=R,{pathTo:ve.pathTo,pathFrom:ve.pathFrom,goalX:this.barHelpers.getGoalValues("x",v,null,j,K,I),barXPosition:l,barYPosition:U,x:y,y:C}}},{key:"drawStackedColumnPaths",value:function(o){var h,l=o.indexes,u=o.x,p=o.xDivision,v=o.barWidth,y=o.zeroH,k=o.seriesGroup,S=o.elSeries,R=this.w,N=l.i,B=l.j,U=l.bc,j=l.realIndex,K=l.translationsIndex;if(R.globals.isXNumeric){var x=R.globals.seriesX[j][B];x||(x=0),u=(x-R.globals.minX)/this.xRatio-v/2*R.globals.barGroups.length}for(var I,W=u+o.columnGroupIndex*v,q=0,J=0;J<this.groupCtx.prevYF.length;J++)q+=isNaN(this.groupCtx.prevYF[J][B])?0:this.groupCtx.prevYF[J][B];var ne=N;if(k&&(ne=k.indexOf(R.globals.seriesNames[j])),ne>0&&!R.globals.isXNumeric||ne>0&&R.globals.isXNumeric&&R.globals.seriesX[j-1][B]===R.globals.seriesX[j][B]){var ve,ge,Le,qe=Math.min(this.yRatio.length+1,j+1);if(void 0!==this.groupCtx.prevY[ne-1]&&this.groupCtx.prevY[ne-1].length)for(var Pe=1;Pe<qe;Pe++){var Ue;if(!isNaN(null===(Ue=this.groupCtx.prevY[ne-Pe])||void 0===Ue?void 0:Ue[B])){Le=this.groupCtx.prevY[ne-Pe][B];break}}for(var lt=1;lt<qe;lt++){var ft,At;if((null===(ft=this.groupCtx.prevYVal[ne-lt])||void 0===ft?void 0:ft[B])<0){ge=this.series[N][B]>=0?Le-q+2*(this.isReversed?q:0):Le;break}if((null===(At=this.groupCtx.prevYVal[ne-lt])||void 0===At?void 0:At[B])>=0){ge=this.series[N][B]>=0?Le:Le+q-2*(this.isReversed?q:0);break}}void 0===ge&&(ge=R.globals.gridHeight),I=null!==(ve=this.groupCtx.prevYF[0])&&void 0!==ve&&ve.every(function(Gt){return 0===Gt})&&this.groupCtx.prevYF.slice(1,ne).every(function(Gt){return Gt.every(function(Lt){return isNaN(Lt)})})?y:ge}else I=y;var St=this.barHelpers.getColumnPaths({barXPosition:W,barWidth:v,y1:I,y2:h=this.series[N][B]?I-this.series[N][B]/this.yRatio[K]+2*(this.isReversed?this.series[N][B]/this.yRatio[K]:0):I,yRatio:this.yRatio[K],strokeWidth:this.strokeWidth,series:this.series,seriesGroup:k,realIndex:l.realIndex,i:N,j:B,w:R});return this.barHelpers.barBackground({bc:U,j:B,i:N,x1:W,x2:v,elSeries:S}),{pathTo:St.pathTo,pathFrom:St.pathFrom,goalY:this.barHelpers.getGoalValues("y",null,y,N,B),barXPosition:W,x:R.globals.isXNumeric?u:u+p,y:h}}}]),i}(rn),ha=function(P){_e(i,P);var r=dn(i);function i(){return F(this,i),r.apply(this,arguments)}return me(i,[{key:"draw",value:function(o,l,u){var h=this,p=this.w,v=new Ke(this.ctx),y=p.globals.comboCharts?l:p.config.chart.type,C=new Fr(this.ctx);this.candlestickOptions=this.w.config.plotOptions.candlestick,this.boxOptions=this.w.config.plotOptions.boxPlot,this.isHorizontal=p.config.plotOptions.bar.horizontal;var k=new yn(this.ctx,p);o=k.getLogSeries(o),this.series=o,this.yRatio=k.getLogYRatios(this.yRatio),this.barHelpers.initVariables(o);for(var S=v.group({class:"apexcharts-".concat(y,"-series apexcharts-plot-series")}),R=function(B){h.isBoxPlot="boxPlot"===p.config.chart.type||"boxPlot"===p.config.series[B].type;var U,j,K,x,I=void 0,W=void 0,q=[],J=[],ne=p.globals.comboCharts?u[B]:B,ve=h.barHelpers.getGroupIndex(ne).columnGroupIndex,ge=v.group({class:"apexcharts-series",seriesName:pe.escapeString(p.globals.seriesNames[ne]),rel:B+1,"data:realIndex":ne});h.ctx.series.addCollapsedClassToSeries(ge,ne),o[B].length>0&&(h.visibleI=h.visibleI+1);var Le,qe,Pe=0;h.yRatio.length>1&&(h.yaxisIndex=p.globals.seriesYAxisReverseMap[ne][0],Pe=ne);var Ue=h.barHelpers.initialPositions();W=Ue.y,Le=Ue.barHeight,j=Ue.yDivision,x=Ue.zeroW,U=Ue.xDivision,K=Ue.zeroH,J.push((I=Ue.x)+(qe=Ue.barWidth)/2);for(var lt=v.group({class:"apexcharts-datalabels","data:realIndex":ne}),ft=function(St){var Gt=h.barHelpers.getStrokeWidth(B,St,ne),Lt=null,$t={indexes:{i:B,j:St,realIndex:ne,translationsIndex:Pe},x:I,y:W,strokeWidth:Gt,elSeries:ge};Lt=h.isHorizontal?h.drawHorizontalBoxPaths(Ze(Ze({},$t),{},{yDivision:j,barHeight:Le,zeroW:x})):h.drawVerticalBoxPaths(Ze(Ze({},$t),{},{xDivision:U,barWidth:qe,zeroH:K})),W=Lt.y,I=Lt.x,St>0&&J.push(I+qe/2),q.push(W),Lt.pathTo.forEach(function(zn,En){var _n=!h.isBoxPlot&&h.candlestickOptions.wick.useFillColor?Lt.color[En]:p.globals.stroke.colors[B],sr=C.fillPath({seriesNumber:ne,dataPointIndex:St,color:Lt.color[En],value:o[B][St]});h.renderSeries({realIndex:ne,pathFill:sr,lineFill:_n,j:St,i:B,pathFrom:Lt.pathFrom,pathTo:zn,strokeWidth:Gt,elSeries:ge,x:I,y:W,series:o,columnGroupIndex:ve,barHeight:Le,barWidth:qe,elDataLabelsWrap:lt,visibleSeries:h.visibleI,type:p.config.chart.type})})},At=0;At<p.globals.dataPoints;At++)ft(At);p.globals.seriesXvalues[ne]=J,p.globals.seriesYvalues[ne]=q,S.add(ge)},N=0;N<o.length;N++)R(N);return S}},{key:"drawVerticalBoxPaths",value:function(o){var l=o.indexes,u=o.x,h=o.xDivision,p=o.barWidth,v=o.zeroH,y=o.strokeWidth,C=this.w,k=new Ke(this.ctx),S=l.i,R=l.j,N=!0,B=C.config.plotOptions.candlestick.colors.upward,U=C.config.plotOptions.candlestick.colors.downward,j="";this.isBoxPlot&&(j=[this.boxOptions.colors.lower,this.boxOptions.colors.upper]);var K=this.yRatio[l.translationsIndex],x=l.realIndex,I=this.getOHLCValue(x,R),W=v,q=v;I.o>I.c&&(N=!1);var J=Math.min(I.o,I.c),ne=Math.max(I.o,I.c),ve=I.m;C.globals.isXNumeric&&(u=(C.globals.seriesX[x][R]-C.globals.minX)/this.xRatio-p/2);var ge=u+p*this.visibleI;null==this.series[S][R]?(J=v,ne=v):(J=v-J/K,ne=v-ne/K,W=v-I.h/K,q=v-I.l/K,ve=v-I.m/K);var Le=k.move(ge,v),qe=k.move(ge+p/2,J);return C.globals.previousPaths.length>0&&(qe=this.getPreviousPath(x,R,!0)),Le=this.isBoxPlot?[k.move(ge,J)+k.line(ge+p/2,J)+k.line(ge+p/2,W)+k.line(ge+p/4,W)+k.line(ge+p-p/4,W)+k.line(ge+p/2,W)+k.line(ge+p/2,J)+k.line(ge+p,J)+k.line(ge+p,ve)+k.line(ge,ve)+k.line(ge,J+y/2),k.move(ge,ve)+k.line(ge+p,ve)+k.line(ge+p,ne)+k.line(ge+p/2,ne)+k.line(ge+p/2,q)+k.line(ge+p-p/4,q)+k.line(ge+p/4,q)+k.line(ge+p/2,q)+k.line(ge+p/2,ne)+k.line(ge,ne)+k.line(ge,ve)+"z"]:[k.move(ge,ne)+k.line(ge+p/2,ne)+k.line(ge+p/2,W)+k.line(ge+p/2,ne)+k.line(ge+p,ne)+k.line(ge+p,J)+k.line(ge+p/2,J)+k.line(ge+p/2,q)+k.line(ge+p/2,J)+k.line(ge,J)+k.line(ge,ne-y/2)],qe+=k.move(ge,J),C.globals.isXNumeric||(u+=h),{pathTo:Le,pathFrom:qe,x:u,y:ne,barXPosition:ge,color:this.isBoxPlot?j:N?[B]:[U]}}},{key:"drawHorizontalBoxPaths",value:function(o){var l=o.indexes,u=o.y,h=o.yDivision,p=o.barHeight,v=o.zeroW,y=o.strokeWidth,C=this.w,k=new Ke(this.ctx),S=l.i,R=l.j,N=this.boxOptions.colors.lower;this.isBoxPlot&&(N=[this.boxOptions.colors.lower,this.boxOptions.colors.upper]);var B=this.invertedYRatio,U=l.realIndex,j=this.getOHLCValue(U,R),K=v,x=v,I=Math.min(j.o,j.c),W=Math.max(j.o,j.c),q=j.m;C.globals.isXNumeric&&(u=(C.globals.seriesX[U][R]-C.globals.minX)/this.invertedXRatio-p/2);var J=u+p*this.visibleI;null==this.series[S][R]?(I=v,W=v):(I=v+I/B,W=v+W/B,K=v+j.h/B,x=v+j.l/B,q=v+j.m/B);var ne=k.move(v,J),ve=k.move(I,J+p/2);return C.globals.previousPaths.length>0&&(ve=this.getPreviousPath(U,R,!0)),ne=[k.move(I,J)+k.line(I,J+p/2)+k.line(K,J+p/2)+k.line(K,J+p/2-p/4)+k.line(K,J+p/2+p/4)+k.line(K,J+p/2)+k.line(I,J+p/2)+k.line(I,J+p)+k.line(q,J+p)+k.line(q,J)+k.line(I+y/2,J),k.move(q,J)+k.line(q,J+p)+k.line(W,J+p)+k.line(W,J+p/2)+k.line(x,J+p/2)+k.line(x,J+p-p/4)+k.line(x,J+p/4)+k.line(x,J+p/2)+k.line(W,J+p/2)+k.line(W,J)+k.line(q,J)+"z"],ve+=k.move(I,J),C.globals.isXNumeric||(u+=h),{pathTo:ne,pathFrom:ve,x:W,y:u,barYPosition:J,color:N}}},{key:"getOHLCValue",value:function(o,l){var u=this.w;return{o:this.isBoxPlot?u.globals.seriesCandleH[o][l]:u.globals.seriesCandleO[o][l],h:this.isBoxPlot?u.globals.seriesCandleO[o][l]:u.globals.seriesCandleH[o][l],m:u.globals.seriesCandleM[o][l],l:this.isBoxPlot?u.globals.seriesCandleC[o][l]:u.globals.seriesCandleL[o][l],c:this.isBoxPlot?u.globals.seriesCandleL[o][l]:u.globals.seriesCandleC[o][l]}}}]),i}(rn),La=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w}return me(P,[{key:"checkColorRange",value:function(){var r=this.w,i=!1,o=r.config.plotOptions[r.config.chart.type];return o.colorScale.ranges.length>0&&o.colorScale.ranges.map(function(l,u){l.from<=0&&(i=!0)}),i}},{key:"getShadeColor",value:function(r,i,o,l){var u=this.w,h=1,p=u.config.plotOptions[r].shadeIntensity,v=this.determineColor(r,i,o);u.globals.hasNegs||l?h=u.config.plotOptions[r].reverseNegativeShade?v.percent<0?v.percent/100*(1.25*p):1.25*p*(1-v.percent/100):v.percent<=0?1-(1+v.percent/100)*p:(1-v.percent/100)*p:(h=1-v.percent/100,"treemap"===r&&(h=1.25*p*(1-v.percent/100)));var y=v.color,C=new pe;return u.config.plotOptions[r].enableShades&&(y=pe.hexToRgba(C.shadeColor("dark"===this.w.config.theme.mode?-1*h:h,v.color),u.config.fill.opacity)),{color:y,colorProps:v}}},{key:"determineColor",value:function(r,i,o){var l=this.w,u=l.globals.series[i][o],h=l.config.plotOptions[r],p=h.colorScale.inverse?o:i;h.distributed&&"treemap"===l.config.chart.type&&(p=o);var v=l.globals.colors[p],y=null,C=Math.min.apply(Math,gt(l.globals.series[i])),k=Math.max.apply(Math,gt(l.globals.series[i]));h.distributed||"heatmap"!==r||(C=l.globals.minY,k=l.globals.maxY),void 0!==h.colorScale.min&&(C=h.colorScale.min<l.globals.minY?h.colorScale.min:l.globals.minY,k=h.colorScale.max>l.globals.maxY?h.colorScale.max:l.globals.maxY);var S=Math.abs(k)+Math.abs(C),R=100*u/(0===S?S-1e-6:S);return h.colorScale.ranges.length>0&&h.colorScale.ranges.map(function(N,B){if(u>=N.from&&u<=N.to){v=N.color,y=N.foreColor?N.foreColor:null,C=N.from,k=N.to;var U=Math.abs(k)+Math.abs(C);R=100*u/(0===U?U-1e-6:U)}}),{color:v,foreColor:y,percent:R}}},{key:"calculateDataLabels",value:function(r){var i=r.text,o=r.x,l=r.y,u=r.i,h=r.j,p=r.colorProps,v=r.fontSize,y=this.w.config.dataLabels,C=new Ke(this.ctx),k=new wn(this.ctx),S=null;if(y.enabled){S=C.group({class:"apexcharts-data-labels"});var N=y.offsetY,B=o+y.offsetX,U=l+parseFloat(y.style.fontSize)/3+N;k.plotDataLabelsText({x:B,y:U,text:i,i:u,j:h,color:p.foreColor,parent:S,fontSize:v,dataLabelsConfig:y})}return S}},{key:"addListeners",value:function(r){var i=new Ke(this.ctx);r.node.addEventListener("mouseenter",i.pathMouseEnter.bind(this,r)),r.node.addEventListener("mouseleave",i.pathMouseLeave.bind(this,r)),r.node.addEventListener("mousedown",i.pathMouseDown.bind(this,r))}}]),P}(),Hr=function(){function P(r,i){F(this,P),this.ctx=r,this.w=r.w,this.xRatio=i.xRatio,this.yRatio=i.yRatio,this.dynamicAnim=this.w.config.chart.animations.dynamicAnimation,this.helpers=new La(r),this.rectRadius=this.w.config.plotOptions.heatmap.radius,this.strokeWidth=this.w.config.stroke.show?this.w.config.stroke.width:0}return me(P,[{key:"draw",value:function(r){var i=this.w,o=new Ke(this.ctx),l=o.group({class:"apexcharts-heatmap"});l.attr("clip-path","url(#gridRectMask".concat(i.globals.cuid,")"));var u=i.globals.gridWidth/i.globals.dataPoints,h=i.globals.gridHeight/i.globals.series.length,p=0,v=!1;this.negRange=this.helpers.checkColorRange();var y=r.slice();i.config.yaxis[0].reversed&&(v=!0,y.reverse());for(var C=v?0:y.length-1;v?C<y.length:C>=0;v?C++:C--){var k=o.group({class:"apexcharts-series apexcharts-heatmap-series",seriesName:pe.escapeString(i.globals.seriesNames[C]),rel:C+1,"data:realIndex":C});if(this.ctx.series.addCollapsedClassToSeries(k,C),i.config.chart.dropShadow.enabled){var S=i.config.chart.dropShadow;new On(this.ctx).dropShadow(k,S,C)}for(var R=0,N=i.config.plotOptions.heatmap.shadeIntensity,B=0;B<y[C].length;B++){var U=this.helpers.getShadeColor(i.config.chart.type,C,B,this.negRange),j=U.color,K=U.colorProps;"image"===i.config.fill.type&&(j=new Fr(this.ctx).fillPath({seriesNumber:C,dataPointIndex:B,opacity:i.globals.hasNegs?K.percent<0?1-(1+K.percent/100):N+K.percent/100:K.percent/100,patternID:pe.randomId(),width:i.config.fill.image.width?i.config.fill.image.width:u,height:i.config.fill.image.height?i.config.fill.image.height:h}));var I=o.drawRect(R,p,u,h,this.rectRadius);if(I.attr({cx:R,cy:p}),I.node.classList.add("apexcharts-heatmap-rect"),k.add(I),I.attr({fill:j,i:C,index:C,j:B,val:r[C][B],"stroke-width":this.strokeWidth,stroke:i.config.plotOptions.heatmap.useFillColorAsStroke?j:i.globals.stroke.colors[0],color:j}),this.helpers.addListeners(I),i.config.chart.animations.enabled&&!i.globals.dataChanged){var W=1;i.globals.resized||(W=i.config.chart.animations.speed),this.animateHeatMap(I,R,p,u,h,W)}if(i.globals.dataChanged){var q=1;if(this.dynamicAnim.enabled&&i.globals.shouldAnimate){q=this.dynamicAnim.speed;var J=i.globals.previousPaths[C]&&i.globals.previousPaths[C][B]&&i.globals.previousPaths[C][B].color;J||(J="rgba(255, 255, 255, 0)"),this.animateHeatColor(I,pe.isColorHex(J)?J:pe.rgb2hex(J),pe.isColorHex(j)?j:pe.rgb2hex(j),q)}}var ne=(0,i.config.dataLabels.formatter)(i.globals.series[C][B],{value:i.globals.series[C][B],seriesIndex:C,dataPointIndex:B,w:i}),ve=this.helpers.calculateDataLabels({text:ne,x:R+u/2,y:p+h/2,i:C,j:B,colorProps:K,series:y});null!==ve&&k.add(ve),R+=u}p+=h,l.add(k)}var ge=i.globals.yAxisScale[0].result.slice();return i.config.yaxis[0].reversed?ge.unshift(""):ge.push(""),i.globals.yAxisScale[0].result=ge,l}},{key:"animateHeatMap",value:function(r,i,o,l,u,h){var p=new hi(this.ctx);p.animateRect(r,{x:i+l/2,y:o+u/2,width:0,height:0},{x:i,y:o,width:l,height:u},h,function(){p.animationCompleted(r)})}},{key:"animateHeatColor",value:function(r,i,o,l){r.attr({fill:i}).animate(l).attr({fill:o})}}]),P}(),wr=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w}return me(P,[{key:"drawYAxisTexts",value:function(r,i,o,l){var u=this.w,h=u.config.yaxis[0],p=u.globals.yLabelFormatters[0];return new Ke(this.ctx).drawText({x:r+h.labels.offsetX,y:i+h.labels.offsetY,text:p(l,o),textAnchor:"middle",fontSize:h.labels.style.fontSize,fontFamily:h.labels.style.fontFamily,foreColor:Array.isArray(h.labels.style.colors)?h.labels.style.colors[o]:h.labels.style.colors})}}]),P}(),ka=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w;var i=this.w;this.chartType=this.w.config.chart.type,this.initialAnim=this.w.config.chart.animations.enabled,this.dynamicAnim=this.initialAnim&&this.w.config.chart.animations.dynamicAnimation.enabled,this.animBeginArr=[0],this.animDur=0,this.donutDataLabels=this.w.config.plotOptions.pie.donut.labels,this.lineColorArr=void 0!==i.globals.stroke.colors?i.globals.stroke.colors:i.globals.colors,this.defaultSize=Math.min(i.globals.gridWidth,i.globals.gridHeight),this.centerY=this.defaultSize/2,this.centerX=i.globals.gridWidth/2,this.fullAngle="radialBar"===i.config.chart.type?360:Math.abs(i.config.plotOptions.pie.endAngle-i.config.plotOptions.pie.startAngle),this.initialAngle=i.config.plotOptions.pie.startAngle%this.fullAngle,i.globals.radialSize=this.defaultSize/2.05-i.config.stroke.width-(i.config.chart.sparkline.enabled?0:i.config.chart.dropShadow.blur),this.donutSize=i.globals.radialSize*parseInt(i.config.plotOptions.pie.donut.size,10)/100;var o=i.config.plotOptions.pie.customScale,l=i.globals.gridWidth/2,u=i.globals.gridHeight/2;this.translateX=l-l*o,this.translateY=u-u*o,this.dataLabelsGroup=new Ke(this.ctx).group({class:"apexcharts-datalabels-group",transform:"translate(".concat(this.translateX,", ").concat(this.translateY,") scale(").concat(o,")")}),this.maxY=0,this.sliceLabels=[],this.sliceSizes=[],this.prevSectorAngleArr=[]}return me(P,[{key:"draw",value:function(r){var i=this,o=this.w,l=new Ke(this.ctx),u=l.group({class:"apexcharts-pie"});if(o.globals.noData)return u;for(var h=0,p=0;p<r.length;p++)h+=pe.negToZero(r[p]);var v=[],y=l.group();0===h&&(h=1e-5),r.forEach(function(x){i.maxY=Math.max(i.maxY,x)}),o.config.yaxis[0].max&&(this.maxY=o.config.yaxis[0].max),"back"===o.config.grid.position&&"polarArea"===this.chartType&&this.drawPolarElements(u);for(var C=0;C<r.length;C++){var k=this.fullAngle*pe.negToZero(r[C])/h;v.push(k),"polarArea"===this.chartType?(v[C]=this.fullAngle/r.length,this.sliceSizes.push(o.globals.radialSize*r[C]/this.maxY)):this.sliceSizes.push(o.globals.radialSize)}if(o.globals.dataChanged){for(var S,R=0,N=0;N<o.globals.previousPaths.length;N++)R+=pe.negToZero(o.globals.previousPaths[N]);for(var B=0;B<o.globals.previousPaths.length;B++)S=this.fullAngle*pe.negToZero(o.globals.previousPaths[B])/R,this.prevSectorAngleArr.push(S)}if(this.donutSize<0&&(this.donutSize=0),"donut"===this.chartType){var U=l.drawCircle(this.donutSize);U.attr({cx:this.centerX,cy:this.centerY,fill:o.config.plotOptions.pie.donut.background?o.config.plotOptions.pie.donut.background:"transparent"}),y.add(U)}var j=this.drawArcs(v,r);if(this.sliceLabels.forEach(function(x){j.add(x)}),y.attr({transform:"translate(".concat(this.translateX,", ").concat(this.translateY,") scale(").concat(o.config.plotOptions.pie.customScale,")")}),y.add(j),u.add(y),this.donutDataLabels.show){var K=this.renderInnerDataLabels(this.dataLabelsGroup,this.donutDataLabels,{hollowSize:this.donutSize,centerX:this.centerX,centerY:this.centerY,opacity:this.donutDataLabels.show});u.add(K)}return"front"===o.config.grid.position&&"polarArea"===this.chartType&&this.drawPolarElements(u),u}},{key:"drawArcs",value:function(r,i){var o=this.w,l=new On(this.ctx),u=new Ke(this.ctx),h=new Fr(this.ctx),p=u.group({class:"apexcharts-slices"}),v=this.initialAngle,y=this.initialAngle,C=this.initialAngle,k=this.initialAngle;this.strokeWidth=o.config.stroke.show?o.config.stroke.width:0;for(var S=0;S<r.length;S++){var R=u.group({class:"apexcharts-series apexcharts-pie-series",seriesName:pe.escapeString(o.globals.seriesNames[S]),rel:S+1,"data:realIndex":S});p.add(R),C=(v=C)+r[S],k=(y=k)+this.prevSectorAngleArr[S];var N=C<v?this.fullAngle+C-v:C-v,B=h.fillPath({seriesNumber:S,size:this.sliceSizes[S],value:i[S]}),U=this.getChangedPath(y,k),j=u.drawPath({d:U,stroke:Array.isArray(this.lineColorArr)?this.lineColorArr[S]:this.lineColorArr,strokeWidth:0,fill:B,fillOpacity:o.config.fill.opacity,classes:"apexcharts-pie-area apexcharts-".concat(this.chartType.toLowerCase(),"-slice-").concat(S)});j.attr({index:0,j:S}),l.setSelectionFilter(j,0,S),o.config.chart.dropShadow.enabled&&l.dropShadow(j,o.config.chart.dropShadow,S),this.addListeners(j,this.donutDataLabels),Ke.setAttrs(j.node,{"data:angle":N,"data:startAngle":v,"data:strokeWidth":this.strokeWidth,"data:value":i[S]});var x={x:0,y:0};"pie"===this.chartType||"polarArea"===this.chartType?x=pe.polarToCartesian(this.centerX,this.centerY,o.globals.radialSize/1.25+o.config.plotOptions.pie.dataLabels.offset,(v+N/2)%this.fullAngle):"donut"===this.chartType&&(x=pe.polarToCartesian(this.centerX,this.centerY,(o.globals.radialSize+this.donutSize)/2+o.config.plotOptions.pie.dataLabels.offset,(v+N/2)%this.fullAngle)),R.add(j);var I=0;if(!this.initialAnim||o.globals.resized||o.globals.dataChanged?this.animBeginArr.push(0):(0==(I=N/this.fullAngle*o.config.chart.animations.speed)&&(I=1),this.animDur=I+this.animDur,this.animBeginArr.push(this.animDur)),this.animatePaths(j,this.dynamicAnim&&o.globals.dataChanged?{size:this.sliceSizes[S],endAngle:C,startAngle:v,prevStartAngle:y,prevEndAngle:k,animateStartingPos:!0,i:S,animBeginArr:this.animBeginArr,shouldSetPrevPaths:!0,dur:o.config.chart.animations.dynamicAnimation.speed}:{size:this.sliceSizes[S],endAngle:C,startAngle:v,i:S,totalItems:r.length-1,animBeginArr:this.animBeginArr,dur:I}),o.config.plotOptions.pie.expandOnClick&&"polarArea"!==this.chartType&&j.node.addEventListener("mouseup",this.pieClicked.bind(this,S)),void 0!==o.globals.selectedDataPoints[0]&&o.globals.selectedDataPoints[0].indexOf(S)>-1&&this.pieClicked(S),o.config.dataLabels.enabled){var W=x.x,q=x.y,J=100*N/this.fullAngle+"%";if(0!==N&&o.config.plotOptions.pie.dataLabels.minAngleToShowLabel<r[S]){var ne=o.config.dataLabels.formatter;void 0!==ne&&(J=ne(o.globals.seriesPercent[S][0],{seriesIndex:S,w:o}));var ve=o.globals.dataLabels.style.colors[S],ge=u.group({class:"apexcharts-datalabels"}),Le=u.drawText({x:W,y:q,text:J,textAnchor:"middle",fontSize:o.config.dataLabels.style.fontSize,fontFamily:o.config.dataLabels.style.fontFamily,fontWeight:o.config.dataLabels.style.fontWeight,foreColor:ve});ge.add(Le),o.config.dataLabels.dropShadow.enabled&&l.dropShadow(Le,o.config.dataLabels.dropShadow),Le.node.classList.add("apexcharts-pie-label"),o.config.chart.animations.animate&&!1===o.globals.resized&&(Le.node.classList.add("apexcharts-pie-label-delay"),Le.node.style.animationDelay=o.config.chart.animations.speed/940+"s"),this.sliceLabels.push(ge)}}}return p}},{key:"addListeners",value:function(r,i){var o=new Ke(this.ctx);r.node.addEventListener("mouseenter",o.pathMouseEnter.bind(this,r)),r.node.addEventListener("mouseleave",o.pathMouseLeave.bind(this,r)),r.node.addEventListener("mouseleave",this.revertDataLabelsInner.bind(this,r.node,i)),r.node.addEventListener("mousedown",o.pathMouseDown.bind(this,r)),this.donutDataLabels.total.showAlways||(r.node.addEventListener("mouseenter",this.printDataLabelsInner.bind(this,r.node,i)),r.node.addEventListener("mousedown",this.printDataLabelsInner.bind(this,r.node,i)))}},{key:"animatePaths",value:function(r,i){var l=i.endAngle<i.startAngle?this.fullAngle+i.endAngle-i.startAngle:i.endAngle-i.startAngle,u=l,h=i.startAngle,p=i.startAngle;void 0!==i.prevStartAngle&&void 0!==i.prevEndAngle&&(h=i.prevEndAngle,u=i.prevEndAngle<i.prevStartAngle?this.fullAngle+i.prevEndAngle-i.prevStartAngle:i.prevEndAngle-i.prevStartAngle),i.i===this.w.config.series.length-1&&(l+p>this.fullAngle?i.endAngle=i.endAngle-(l+p):l+p<this.fullAngle&&(i.endAngle=i.endAngle+(this.fullAngle-(l+p)))),l===this.fullAngle&&(l=this.fullAngle-.01),this.animateArc(r,h,p,l,u,i)}},{key:"animateArc",value:function(r,i,o,l,u,h){var p,v=this,y=this.w,C=new hi(this.ctx),k=h.size;(isNaN(i)||isNaN(u))&&(i=o,u=l,h.dur=0);var S=l,R=o,N=i<o?this.fullAngle+i-o:i-o;y.globals.dataChanged&&h.shouldSetPrevPaths&&h.prevEndAngle&&(p=v.getPiePath({me:v,startAngle:h.prevStartAngle,angle:h.prevEndAngle<h.prevStartAngle?this.fullAngle+h.prevEndAngle-h.prevStartAngle:h.prevEndAngle-h.prevStartAngle,size:k}),r.attr({d:p})),0!==h.dur?r.animate(h.dur,y.globals.easing,h.animBeginArr[h.i]).afterAll(function(){"pie"!==v.chartType&&"donut"!==v.chartType&&"polarArea"!==v.chartType||this.animate(y.config.chart.animations.dynamicAnimation.speed).attr({"stroke-width":v.strokeWidth}),h.i===y.config.series.length-1&&C.animationCompleted(r)}).during(function(B){S=N+(l-N)*B,h.animateStartingPos&&(S=u+(l-u)*B,R=i-u+(o-(i-u))*B),p=v.getPiePath({me:v,startAngle:R,angle:S,size:k}),r.node.setAttribute("data:pathOrig",p),r.attr({d:p})}):(p=v.getPiePath({me:v,startAngle:R,angle:l,size:k}),h.isTrack||(y.globals.animationEnded=!0),r.node.setAttribute("data:pathOrig",p),r.attr({d:p,"stroke-width":v.strokeWidth}))}},{key:"pieClicked",value:function(r){var i,o=this.w,l=this,u=l.sliceSizes[r]+(o.config.plotOptions.pie.expandOnClick?4:0),h=o.globals.dom.Paper.select(".apexcharts-".concat(l.chartType.toLowerCase(),"-slice-").concat(r)).members[0];if("true"!==h.attr("data:pieClicked")){var p=o.globals.dom.baseEl.getElementsByClassName("apexcharts-pie-area");Array.prototype.forEach.call(p,function(k){k.setAttribute("data:pieClicked","false");var S=k.getAttribute("data:pathOrig");S&&k.setAttribute("d",S)}),o.globals.capturedDataPointIndex=r,h.attr("data:pieClicked","true");var v=parseInt(h.attr("data:startAngle"),10),y=parseInt(h.attr("data:angle"),10);i=l.getPiePath({me:l,startAngle:v,angle:y,size:u}),360!==y&&h.plot(i)}else{h.attr({"data:pieClicked":"false"}),this.revertDataLabelsInner(h.node,this.donutDataLabels);var C=h.attr("data:pathOrig");h.attr({d:C})}}},{key:"getChangedPath",value:function(r,i){var o="";return this.dynamicAnim&&this.w.globals.dataChanged&&(o=this.getPiePath({me:this,startAngle:r,angle:i-r,size:this.size})),o}},{key:"getPiePath",value:function(r){var i,o=r.me,l=r.startAngle,u=r.angle,h=r.size,p=new Ke(this.ctx),v=l,y=Math.PI*(v-90)/180,C=u+l;Math.ceil(C)>=this.fullAngle+this.w.config.plotOptions.pie.startAngle%this.fullAngle&&(C=this.fullAngle+this.w.config.plotOptions.pie.startAngle%this.fullAngle-.01),Math.ceil(C)>this.fullAngle&&(C-=this.fullAngle);var k=Math.PI*(C-90)/180,S=o.centerX+h*Math.cos(y),R=o.centerY+h*Math.sin(y),N=o.centerX+h*Math.cos(k),B=o.centerY+h*Math.sin(k),U=pe.polarToCartesian(o.centerX,o.centerY,o.donutSize,C),j=pe.polarToCartesian(o.centerX,o.centerY,o.donutSize,v),K=u>180?1:0,x=["M",S,R,"A",h,h,0,K,1,N,B];return i="donut"===o.chartType?[].concat(x,["L",U.x,U.y,"A",o.donutSize,o.donutSize,0,K,0,j.x,j.y,"L",S,R,"z"]).join(" "):"pie"===o.chartType||"polarArea"===o.chartType?[].concat(x,["L",o.centerX,o.centerY,"L",S,R]).join(" "):[].concat(x).join(" "),p.roundPathCorners(i,2*this.strokeWidth)}},{key:"drawPolarElements",value:function(r){var i=this.w,o=new Si(this.ctx),l=new Ke(this.ctx),u=new wr(this.ctx),h=l.group(),p=l.group(),v=o.niceScale(0,Math.ceil(this.maxY),0),y=v.result.reverse(),C=v.result.length;this.maxY=v.niceMax;for(var k=i.globals.radialSize,S=k/(C-1),R=0;R<C-1;R++){var N=l.drawCircle(k);if(N.attr({cx:this.centerX,cy:this.centerY,fill:"none","stroke-width":i.config.plotOptions.polarArea.rings.strokeWidth,stroke:i.config.plotOptions.polarArea.rings.strokeColor}),i.config.yaxis[0].show){var B=u.drawYAxisTexts(this.centerX,this.centerY-k+parseInt(i.config.yaxis[0].labels.style.fontSize,10)/2,R,y[R]);p.add(B)}h.add(N),k-=S}this.drawSpokes(r),r.add(h),r.add(p)}},{key:"renderInnerDataLabels",value:function(r,i,o){var l=this.w,u=new Ke(this.ctx),h=i.total.show;r.node.innerHTML="",r.node.style.opacity=o.opacity;var p,v,y=o.centerX,C=o.centerY;p=void 0===i.name.color?l.globals.colors[0]:i.name.color;var k=i.name.fontSize,S=i.name.fontFamily,R=i.name.fontWeight;v=void 0===i.value.color?l.config.chart.foreColor:i.value.color;var N=i.value.formatter,B="",U="";if(h?(p=i.total.color,k=i.total.fontSize,S=i.total.fontFamily,R=i.total.fontWeight,U=i.total.label,B=i.total.formatter(l)):1===l.globals.series.length&&(B=N(l.globals.series[0],l),U=l.globals.seriesNames[0]),U&&(U=i.name.formatter(U,i.total.show,l)),i.name.show){var j=u.drawText({x:y,y:C+parseFloat(i.name.offsetY),text:U,textAnchor:"middle",foreColor:p,fontSize:k,fontWeight:R,fontFamily:S});j.node.classList.add("apexcharts-datalabel-label"),r.add(j)}if(i.value.show){var K=i.name.show?parseFloat(i.value.offsetY)+16:i.value.offsetY,x=u.drawText({x:y,y:C+K,text:B,textAnchor:"middle",foreColor:v,fontWeight:i.value.fontWeight,fontSize:i.value.fontSize,fontFamily:i.value.fontFamily});x.node.classList.add("apexcharts-datalabel-value"),r.add(x)}return r}},{key:"printInnerLabels",value:function(r,i,o,l){var u,h=this.w;l?u=void 0===r.name.color?h.globals.colors[parseInt(l.parentNode.getAttribute("rel"),10)-1]:r.name.color:h.globals.series.length>1&&r.total.show&&(u=r.total.color);var p=h.globals.dom.baseEl.querySelector(".apexcharts-datalabel-label"),v=h.globals.dom.baseEl.querySelector(".apexcharts-datalabel-value");o=(0,r.value.formatter)(o,h),l||"function"!=typeof r.total.formatter||(o=r.total.formatter(h)),i=r.name.formatter(i,i===r.total.label,h),null!==p&&(p.textContent=i),null!==v&&(v.textContent=o),null!==p&&(p.style.fill=u)}},{key:"printDataLabelsInner",value:function(r,i){var o=this.w,l=r.getAttribute("data:value"),u=o.globals.seriesNames[parseInt(r.parentNode.getAttribute("rel"),10)-1];o.globals.series.length>1&&this.printInnerLabels(i,u,l,r);var h=o.globals.dom.baseEl.querySelector(".apexcharts-datalabels-group");null!==h&&(h.style.opacity=1)}},{key:"drawSpokes",value:function(r){var i=this,o=this.w,l=new Ke(this.ctx),u=o.config.plotOptions.polarArea.spokes;if(0!==u.strokeWidth){for(var h=[],p=360/o.globals.series.length,v=0;v<o.globals.series.length;v++)h.push(pe.polarToCartesian(this.centerX,this.centerY,o.globals.radialSize,o.config.plotOptions.pie.startAngle+p*v));h.forEach(function(y,C){var k=l.drawLine(y.x,y.y,i.centerX,i.centerY,Array.isArray(u.connectorColors)?u.connectorColors[C]:u.connectorColors);r.add(k)})}}},{key:"revertDataLabelsInner",value:function(){var r=this.w;if(this.donutDataLabels.show){var i=r.globals.dom.Paper.select(".apexcharts-datalabels-group").members[0],o=this.renderInnerDataLabels(i,this.donutDataLabels,{hollowSize:this.donutSize,centerX:this.centerX,centerY:this.centerY,opacity:this.donutDataLabels.show});r.globals.dom.Paper.select(".apexcharts-radialbar, .apexcharts-pie").members[0].add(o)}}}]),P}(),da=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w,this.chartType=this.w.config.chart.type,this.initialAnim=this.w.config.chart.animations.enabled,this.dynamicAnim=this.initialAnim&&this.w.config.chart.animations.dynamicAnimation.enabled,this.animDur=0;var i=this.w;this.graphics=new Ke(this.ctx),this.lineColorArr=void 0!==i.globals.stroke.colors?i.globals.stroke.colors:i.globals.colors,this.defaultSize=i.globals.svgHeight<i.globals.svgWidth?i.globals.gridHeight+1.5*i.globals.goldenPadding:i.globals.gridWidth,this.isLog=i.config.yaxis[0].logarithmic,this.logBase=i.config.yaxis[0].logBase,this.coreUtils=new yn(this.ctx),this.maxValue=this.isLog?this.coreUtils.getLogVal(this.logBase,i.globals.maxY,0):i.globals.maxY,this.minValue=this.isLog?this.coreUtils.getLogVal(this.logBase,this.w.globals.minY,0):i.globals.minY,this.polygons=i.config.plotOptions.radar.polygons,this.strokeWidth=i.config.stroke.show?i.config.stroke.width:0,this.size=this.defaultSize/2.1-this.strokeWidth-i.config.chart.dropShadow.blur,i.config.xaxis.labels.show&&(this.size=this.size-i.globals.xAxisLabelsWidth/1.75),void 0!==i.config.plotOptions.radar.size&&(this.size=i.config.plotOptions.radar.size),this.dataRadiusOfPercent=[],this.dataRadius=[],this.angleArr=[],this.yaxisLabelsTextsPos=[]}return me(P,[{key:"draw",value:function(r){var i=this,o=this.w,l=new Fr(this.ctx),u=[],h=new wn(this.ctx);r.length&&(this.dataPointsLen=r[o.globals.maxValsInArrayIndex].length),this.disAngle=2*Math.PI/this.dataPointsLen;var C=o.globals.gridHeight/2+o.config.plotOptions.radar.offsetY,k=this.graphics.group({class:"apexcharts-radar-series apexcharts-plot-series",transform:"translate(".concat(o.globals.gridWidth/2+o.config.plotOptions.radar.offsetX||0,", ").concat(C||0,")")}),S=[],R=null,N=null;if(this.yaxisLabels=this.graphics.group({class:"apexcharts-yaxis"}),r.forEach(function(U,j){var K=U.length===o.globals.dataPoints,x=i.graphics.group().attr({class:"apexcharts-series","data:longestSeries":K,seriesName:pe.escapeString(o.globals.seriesNames[j]),rel:j+1,"data:realIndex":j});i.dataRadiusOfPercent[j]=[],i.dataRadius[j]=[],i.angleArr[j]=[],U.forEach(function(Pe,Ue){var lt=Math.abs(i.maxValue-i.minValue);Pe-=i.minValue,i.isLog&&(Pe=i.coreUtils.getLogVal(i.logBase,Pe,0)),i.dataRadiusOfPercent[j][Ue]=Pe/lt,i.dataRadius[j][Ue]=i.dataRadiusOfPercent[j][Ue]*i.size,i.angleArr[j][Ue]=Ue*i.disAngle}),S=i.getDataPointsPos(i.dataRadius[j],i.angleArr[j]);var I=i.createPaths(S,{x:0,y:0});R=i.graphics.group({class:"apexcharts-series-markers-wrap apexcharts-element-hidden"}),N=i.graphics.group({class:"apexcharts-datalabels","data:realIndex":j}),o.globals.delayedElements.push({el:R.node,index:j});var W={i:j,realIndex:j,animationDelay:j,initialSpeed:o.config.chart.animations.speed,dataChangeSpeed:o.config.chart.animations.dynamicAnimation.speed,className:"apexcharts-radar",shouldClipToGrid:!1,bindEventsOnPaths:!1,stroke:o.globals.stroke.colors[j],strokeLineCap:o.config.stroke.lineCap},q=null;o.globals.previousPaths.length>0&&(q=i.getPreviousPath(j));for(var J=0;J<I.linePathsTo.length;J++){var ne=i.graphics.renderPaths(Ze(Ze({},W),{},{pathFrom:null===q?I.linePathsFrom[J]:q,pathTo:I.linePathsTo[J],strokeWidth:Array.isArray(i.strokeWidth)?i.strokeWidth[j]:i.strokeWidth,fill:"none",drawShadow:!1}));x.add(ne);var ve=l.fillPath({seriesNumber:j}),ge=i.graphics.renderPaths(Ze(Ze({},W),{},{pathFrom:null===q?I.areaPathsFrom[J]:q,pathTo:I.areaPathsTo[J],strokeWidth:0,fill:ve,drawShadow:!1}));o.config.chart.dropShadow.enabled&&new On(i.ctx).dropShadow(ge,Object.assign({},o.config.chart.dropShadow,{noUserSpaceOnUse:!0}),j),x.add(ge)}U.forEach(function(Pe,Ue){var lt=new Rr(i.ctx).getMarkerConfig({cssClass:"apexcharts-marker",seriesIndex:j,dataPointIndex:Ue}),ft=i.graphics.drawMarker(S[Ue].x,S[Ue].y,lt);ft.attr("rel",Ue),ft.attr("j",Ue),ft.attr("index",j),ft.node.setAttribute("default-marker-size",lt.pSize);var At=i.graphics.group({class:"apexcharts-series-markers"});At&&At.add(ft),R.add(At),x.add(R);var St=o.config.dataLabels;if(St.enabled){var Gt=St.formatter(o.globals.series[j][Ue],{seriesIndex:j,dataPointIndex:Ue,w:o});h.plotDataLabelsText({x:S[Ue].x,y:S[Ue].y,text:Gt,textAnchor:"middle",i:j,j,parent:N,offsetCorrection:!1,dataLabelsConfig:Ze({},St)})}x.add(N)}),u.push(x)}),this.drawPolygons({parent:k}),o.config.xaxis.labels.show){var B=this.drawXAxisTexts();k.add(B)}return u.forEach(function(U){k.add(U)}),k.add(this.yaxisLabels),k}},{key:"drawPolygons",value:function(r){for(var i=this,o=this.w,l=r.parent,u=new wr(this.ctx),h=o.globals.yAxisScale[0].result.reverse(),p=h.length,v=[],y=this.size/(p-1),C=0;C<p;C++)v[C]=y*C;v.reverse();var k=[],S=[];v.forEach(function(R,N){var B=pe.getPolygonPos(R,i.dataPointsLen),U="";B.forEach(function(j,K){if(0===N){var x=i.graphics.drawLine(j.x,j.y,0,0,Array.isArray(i.polygons.connectorColors)?i.polygons.connectorColors[K]:i.polygons.connectorColors);S.push(x)}0===K&&i.yaxisLabelsTextsPos.push({x:j.x,y:j.y}),U+=j.x+","+j.y+" "}),k.push(U)}),k.forEach(function(R,N){var B=i.polygons.strokeColors,U=i.polygons.strokeWidth,j=i.graphics.drawPolygon(R,Array.isArray(B)?B[N]:B,Array.isArray(U)?U[N]:U,o.globals.radarPolygons.fill.colors[N]);l.add(j)}),S.forEach(function(R){l.add(R)}),o.config.yaxis[0].show&&this.yaxisLabelsTextsPos.forEach(function(R,N){var B=u.drawYAxisTexts(R.x,R.y,N,h[N]);i.yaxisLabels.add(B)})}},{key:"drawXAxisTexts",value:function(){var r=this,i=this.w,o=i.config.xaxis.labels,l=this.graphics.group({class:"apexcharts-xaxis"}),u=pe.getPolygonPos(this.size,this.dataPointsLen);return i.globals.labels.forEach(function(h,p){var v=i.config.xaxis.labels.formatter,y=new wn(r.ctx);if(u[p]){var C=r.getTextPos(u[p],r.size),k=v(h,{seriesIndex:-1,dataPointIndex:p,w:i});y.plotDataLabelsText({x:C.newX,y:C.newY,text:k,textAnchor:C.textAnchor,i:p,j:p,parent:l,className:"apexcharts-xaxis-label",color:Array.isArray(o.style.colors)&&o.style.colors[p]?o.style.colors[p]:"#a8a8a8",dataLabelsConfig:Ze({textAnchor:C.textAnchor,dropShadow:{enabled:!1}},o),offsetCorrection:!1}).on("click",function(S){if("function"==typeof i.config.chart.events.xAxisLabelClick){var R=Object.assign({},i,{labelIndex:p});i.config.chart.events.xAxisLabelClick(S,r.ctx,R)}})}}),l}},{key:"createPaths",value:function(r,i){var o=this,l=[],u=[],h=[],p=[];if(r.length){u=[this.graphics.move(i.x,i.y)],p=[this.graphics.move(i.x,i.y)];var v=this.graphics.move(r[0].x,r[0].y),y=this.graphics.move(r[0].x,r[0].y);r.forEach(function(C,k){v+=o.graphics.line(C.x,C.y),y+=o.graphics.line(C.x,C.y),k===r.length-1&&(v+="Z",y+="Z")}),l.push(v),h.push(y)}return{linePathsFrom:u,linePathsTo:l,areaPathsFrom:p,areaPathsTo:h}}},{key:"getTextPos",value:function(r,i){var o="middle",l=r.x,u=r.y;return Math.abs(r.x)>=10?r.x>0?(o="start",l+=10):r.x<0&&(o="end",l-=10):o="middle",Math.abs(r.y)>=i-10&&(r.y<0?u-=10:r.y>0&&(u+=10)),{textAnchor:o,newX:l,newY:u}}},{key:"getPreviousPath",value:function(r){for(var i=this.w,o=null,l=0;l<i.globals.previousPaths.length;l++){var u=i.globals.previousPaths[l];u.paths.length>0&&parseInt(u.realIndex,10)===parseInt(r,10)&&void 0!==i.globals.previousPaths[l].paths[0]&&(o=i.globals.previousPaths[l].paths[0].d)}return o}},{key:"getDataPointsPos",value:function(r,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.dataPointsLen;r=r||[],i=i||[];for(var l=[],u=0;u<o;u++){var h={};h.x=r[u]*Math.sin(i[u]),h.y=-r[u]*Math.cos(i[u]),l.push(h)}return l}}]),P}(),Fi=function(P){_e(i,P);var r=dn(i);function i(o){var l;F(this,i),(l=r.call(this,o)).ctx=o,l.w=o.w,l.animBeginArr=[0],l.animDur=0;var u=l.w;return l.startAngle=u.config.plotOptions.radialBar.startAngle,l.endAngle=u.config.plotOptions.radialBar.endAngle,l.totalAngle=Math.abs(u.config.plotOptions.radialBar.endAngle-u.config.plotOptions.radialBar.startAngle),l.trackStartAngle=u.config.plotOptions.radialBar.track.startAngle,l.trackEndAngle=u.config.plotOptions.radialBar.track.endAngle,l.barLabels=l.w.config.plotOptions.radialBar.barLabels,l.donutDataLabels=l.w.config.plotOptions.radialBar.dataLabels,l.radialDataLabels=l.donutDataLabels,l.trackStartAngle||(l.trackStartAngle=l.startAngle),l.trackEndAngle||(l.trackEndAngle=l.endAngle),360===l.endAngle&&(l.endAngle=359.99),l.margin=parseInt(u.config.plotOptions.radialBar.track.margin,10),l.onBarLabelClick=l.onBarLabelClick.bind(cn(l)),l}return me(i,[{key:"draw",value:function(o){var l=this.w,u=new Ke(this.ctx),h=u.group({class:"apexcharts-radialbar"});if(l.globals.noData)return h;var p=u.group(),v=this.defaultSize/2,y=l.globals.gridWidth/2,C=this.defaultSize/2.05;l.config.chart.sparkline.enabled||(C=C-l.config.stroke.width-l.config.chart.dropShadow.blur);var k=l.globals.fill.colors;if(l.config.plotOptions.radialBar.track.show){var S=this.drawTracks({size:C,centerX:y,centerY:v,colorArr:k,series:o});p.add(S)}var R=this.drawArcs({size:C,centerX:y,centerY:v,colorArr:k,series:o}),N=360;l.config.plotOptions.radialBar.startAngle<0&&(N=this.totalAngle);var B=(360-N)/360;if(l.globals.radialSize=C-C*B,this.radialDataLabels.value.show){var U=Math.max(this.radialDataLabels.value.offsetY,this.radialDataLabels.name.offsetY);l.globals.radialSize+=U*B}return p.add(R.g),"front"===l.config.plotOptions.radialBar.hollow.position&&(R.g.add(R.elHollow),R.dataLabels&&R.g.add(R.dataLabels)),h.add(p),h}},{key:"drawTracks",value:function(o){var l=this.w,u=new Ke(this.ctx),h=u.group({class:"apexcharts-tracks"}),p=new On(this.ctx),v=new Fr(this.ctx),y=this.getStrokeWidth(o);o.size=o.size-y/2;for(var C=0;C<o.series.length;C++){var k=u.group({class:"apexcharts-radialbar-track apexcharts-track"});h.add(k),k.attr({rel:C+1}),o.size=o.size-y-this.margin;var S=l.config.plotOptions.radialBar.track,R=v.fillPath({seriesNumber:0,size:o.size,fillColors:Array.isArray(S.background)?S.background[C]:S.background,solid:!0}),N=this.trackStartAngle,B=this.trackEndAngle;Math.abs(B)+Math.abs(N)>=360&&(B=360-Math.abs(this.startAngle)-.1);var U=u.drawPath({d:"",stroke:R,strokeWidth:y*parseInt(S.strokeWidth,10)/100,fill:"none",strokeOpacity:S.opacity,classes:"apexcharts-radialbar-area"});S.dropShadow.enabled&&p.dropShadow(U,S.dropShadow),k.add(U),U.attr("id","apexcharts-radialbarTrack-"+C),this.animatePaths(U,{centerX:o.centerX,centerY:o.centerY,endAngle:B,startAngle:N,size:o.size,i:C,totalItems:2,animBeginArr:0,dur:0,isTrack:!0,easing:l.globals.easing})}return h}},{key:"drawArcs",value:function(o){var l=this.w,u=new Ke(this.ctx),h=new Fr(this.ctx),p=new On(this.ctx),v=u.group(),y=this.getStrokeWidth(o);o.size=o.size-y/2;var C=l.config.plotOptions.radialBar.hollow.background,k=o.size-y*o.series.length-this.margin*o.series.length-y*parseInt(l.config.plotOptions.radialBar.track.strokeWidth,10)/100/2,S=k-l.config.plotOptions.radialBar.hollow.margin;void 0!==l.config.plotOptions.radialBar.hollow.image&&(C=this.drawHollowImage(o,v,k,C));var R=this.drawHollow({size:S,centerX:o.centerX,centerY:o.centerY,fill:C||"transparent"});l.config.plotOptions.radialBar.hollow.dropShadow.enabled&&p.dropShadow(R,l.config.plotOptions.radialBar.hollow.dropShadow);var B=1;!this.radialDataLabels.total.show&&l.globals.series.length>1&&(B=0);var U=null;if(this.radialDataLabels.show){var j=l.globals.dom.Paper.select(".apexcharts-datalabels-group").members[0];U=this.renderInnerDataLabels(j,this.radialDataLabels,{hollowSize:k,centerX:o.centerX,centerY:o.centerY,opacity:B})}"back"===l.config.plotOptions.radialBar.hollow.position&&(v.add(R),U&&v.add(U));var K=!1;l.config.plotOptions.radialBar.inverseOrder&&(K=!0);for(var x=K?o.series.length-1:0;K?x>=0:x<o.series.length;K?x--:x++){var I=u.group({class:"apexcharts-series apexcharts-radial-series",seriesName:pe.escapeString(l.globals.seriesNames[x])});v.add(I),I.attr({rel:x+1,"data:realIndex":x}),this.ctx.series.addCollapsedClassToSeries(I,x),o.size=o.size-y-this.margin;var W=h.fillPath({seriesNumber:x,size:o.size,value:o.series[x]}),q=this.startAngle,J=void 0,ne=pe.negToZero(o.series[x]>100?100:o.series[x])/100,ve=Math.round(this.totalAngle*ne)+this.startAngle,ge=void 0;l.globals.dataChanged&&(J=this.startAngle,ge=Math.round(this.totalAngle*pe.negToZero(l.globals.previousPaths[x])/100)+J),Math.abs(ve)+Math.abs(q)>=360&&(ve-=.01),Math.abs(ge)+Math.abs(J)>=360&&(ge-=.01);var Le=ve-q,qe=Array.isArray(l.config.stroke.dashArray)?l.config.stroke.dashArray[x]:l.config.stroke.dashArray,Pe=u.drawPath({d:"",stroke:W,strokeWidth:y,fill:"none",fillOpacity:l.config.fill.opacity,classes:"apexcharts-radialbar-area apexcharts-radialbar-slice-"+x,strokeDashArray:qe});if(Ke.setAttrs(Pe.node,{"data:angle":Le,"data:value":o.series[x]}),l.config.chart.dropShadow.enabled&&p.dropShadow(Pe,l.config.chart.dropShadow,x),p.setSelectionFilter(Pe,0,x),this.addListeners(Pe,this.radialDataLabels),I.add(Pe),Pe.attr({index:0,j:x}),this.barLabels.enabled){var lt=pe.polarToCartesian(o.centerX,o.centerY,o.size,q),ft=this.barLabels.formatter(l.globals.seriesNames[x],{seriesIndex:x,w:l}),At=["apexcharts-radialbar-label"];this.barLabels.onClick||At.push("apexcharts-no-click");var St=this.barLabels.useSeriesColors?l.globals.colors[x]:l.config.chart.foreColor;St||(St=l.config.chart.foreColor);var Gt=lt.x-this.barLabels.margin,Lt=lt.y,$t=u.drawText({x:Gt,y:Lt,text:ft,textAnchor:"end",dominantBaseline:"middle",fontFamily:this.barLabels.fontFamily,fontWeight:this.barLabels.fontWeight,fontSize:this.barLabels.fontSize,foreColor:St,cssClass:At.join(" ")});$t.on("click",this.onBarLabelClick),$t.attr({rel:x+1}),0!==q&&$t.attr({"transform-origin":"".concat(Gt," ").concat(Lt),transform:"rotate(".concat(q," 0 0)")}),I.add($t)}var zn=0;!this.initialAnim||l.globals.resized||l.globals.dataChanged||(zn=l.config.chart.animations.speed),l.globals.dataChanged&&(zn=l.config.chart.animations.dynamicAnimation.speed),this.animDur=zn/(1.2*o.series.length)+this.animDur,this.animBeginArr.push(this.animDur),this.animatePaths(Pe,{centerX:o.centerX,centerY:o.centerY,endAngle:ve,startAngle:q,prevEndAngle:ge,prevStartAngle:J,size:o.size,i:x,totalItems:2,animBeginArr:this.animBeginArr,dur:zn,shouldSetPrevPaths:!0,easing:l.globals.easing})}return{g:v,elHollow:R,dataLabels:U}}},{key:"drawHollow",value:function(o){var l=new Ke(this.ctx).drawCircle(2*o.size);return l.attr({class:"apexcharts-radialbar-hollow",cx:o.centerX,cy:o.centerY,r:o.size,fill:o.fill}),l}},{key:"drawHollowImage",value:function(o,l,u,h){var p=this.w,v=new Fr(this.ctx),y=pe.randomId(),C=p.config.plotOptions.radialBar.hollow.image;if(p.config.plotOptions.radialBar.hollow.imageClipped)v.clippedImgArea({width:u,height:u,image:C,patternID:"pattern".concat(p.globals.cuid).concat(y)}),h="url(#pattern".concat(p.globals.cuid).concat(y,")");else{var k=p.config.plotOptions.radialBar.hollow.imageWidth,S=p.config.plotOptions.radialBar.hollow.imageHeight;if(void 0===k&&void 0===S){var R=p.globals.dom.Paper.image(C).loaded(function(B){this.move(o.centerX-B.width/2+p.config.plotOptions.radialBar.hollow.imageOffsetX,o.centerY-B.height/2+p.config.plotOptions.radialBar.hollow.imageOffsetY)});l.add(R)}else{var N=p.globals.dom.Paper.image(C).loaded(function(B){this.move(o.centerX-k/2+p.config.plotOptions.radialBar.hollow.imageOffsetX,o.centerY-S/2+p.config.plotOptions.radialBar.hollow.imageOffsetY),this.size(k,S)});l.add(N)}}return h}},{key:"getStrokeWidth",value:function(o){return o.size*(100-parseInt(this.w.config.plotOptions.radialBar.hollow.size,10))/100/(o.series.length+1)-this.margin}},{key:"onBarLabelClick",value:function(o){var l=parseInt(o.target.getAttribute("rel"),10)-1,u=this.barLabels.onClick,h=this.w;u&&u(h.globals.seriesNames[l],{w:h,seriesIndex:l})}}]),i}(ka),Fa=function(P){_e(i,P);var r=dn(i);function i(){return F(this,i),r.apply(this,arguments)}return me(i,[{key:"draw",value:function(o,l){var u=this.w,h=new Ke(this.ctx);this.rangeBarOptions=this.w.config.plotOptions.rangeBar,this.series=o,this.seriesRangeStart=u.globals.seriesRangeStart,this.seriesRangeEnd=u.globals.seriesRangeEnd,this.barHelpers.initVariables(o);for(var p=h.group({class:"apexcharts-rangebar-series apexcharts-plot-series"}),v=0;v<o.length;v++){var y,C,k,S,R=void 0,N=void 0,B=u.globals.comboCharts?l[v]:v,U=this.barHelpers.getGroupIndex(B).columnGroupIndex,j=h.group({class:"apexcharts-series",seriesName:pe.escapeString(u.globals.seriesNames[B]),rel:v+1,"data:realIndex":B});this.ctx.series.addCollapsedClassToSeries(j,B),o[v].length>0&&(this.visibleI=this.visibleI+1);var K=0,x=0,I=0;this.yRatio.length>1&&(this.yaxisIndex=u.globals.seriesYAxisReverseMap[B][0],I=B);var W=this.barHelpers.initialPositions();N=W.y,S=W.zeroW,R=W.x,x=W.barWidth,K=W.barHeight,y=W.xDivision,C=W.yDivision,k=W.zeroH;for(var q=h.group({class:"apexcharts-datalabels","data:realIndex":B}),J=h.group({class:"apexcharts-rangebar-goals-markers"}),ne=0;ne<u.globals.dataPoints;ne++){var ve=this.barHelpers.getStrokeWidth(v,ne,B),ge=this.seriesRangeStart[v][ne],Le=this.seriesRangeEnd[v][ne],qe=null,Pe=null,Ue=null,lt={x:R,y:N,strokeWidth:ve,elSeries:j},ft=this.seriesLen;if(u.config.plotOptions.bar.rangeBarGroupRows&&(ft=1),void 0===u.config.series[v].data[ne])break;if(this.isHorizontal){if(Ue=N+K*this.visibleI,u.config.series[v].data[ne].x){var St=this.detectOverlappingBars({i:v,j:ne,barYPosition:Ue,srty:(C-K*ft)/2,barHeight:K,yDivision:C,initPositions:W});K=St.barHeight,Ue=St.barYPosition}x=(qe=this.drawRangeBarPaths(Ze({indexes:{i:v,j:ne,realIndex:B},barHeight:K,barYPosition:Ue,zeroW:S,yDivision:C,y1:ge,y2:Le},lt))).barWidth}else{if(u.globals.isXNumeric&&(R=(u.globals.seriesX[v][ne]-u.globals.minX)/this.xRatio-x/2),Pe=R+x*this.visibleI,u.config.series[v].data[ne].x){var Lt=this.detectOverlappingBars({i:v,j:ne,barXPosition:Pe,srtx:(y-x*ft)/2,barWidth:x,xDivision:y,initPositions:W});x=Lt.barWidth,Pe=Lt.barXPosition}K=(qe=this.drawRangeColumnPaths(Ze({indexes:{i:v,j:ne,realIndex:B,translationsIndex:I},barWidth:x,barXPosition:Pe,zeroH:k,xDivision:y},lt))).barHeight}var $t=this.barHelpers.drawGoalLine({barXPosition:qe.barXPosition,barYPosition:Ue,goalX:qe.goalX,goalY:qe.goalY,barHeight:K,barWidth:x});$t&&J.add($t),N=qe.y,R=qe.x;var zn=this.barHelpers.getPathFillColor(o,v,ne,B);this.renderSeries({realIndex:B,pathFill:zn,lineFill:u.globals.stroke.colors[B],j:ne,i:v,x:R,y:N,y1:ge,y2:Le,pathFrom:qe.pathFrom,pathTo:qe.pathTo,strokeWidth:ve,elSeries:j,series:o,barHeight:K,barWidth:x,barXPosition:Pe,barYPosition:Ue,columnGroupIndex:U,elDataLabelsWrap:q,elGoalsMarkers:J,visibleSeries:this.visibleI,type:"rangebar"})}p.add(j)}return p}},{key:"detectOverlappingBars",value:function(o){var l=o.i,u=o.j,h=o.barYPosition,p=o.barXPosition,v=o.srty,y=o.srtx,C=o.barHeight,k=o.barWidth,S=o.yDivision,R=o.xDivision,N=o.initPositions,B=this.w,U=[],j=B.config.series[l].data[u].rangeName,K=B.config.series[l].data[u].x,x=Array.isArray(K)?K.join(" "):K,I=B.globals.labels.map(function(q){return Array.isArray(q)?q.join(" "):q}).indexOf(x),W=B.globals.seriesRange[l].findIndex(function(q){return q.x===x&&q.overlaps.length>0});return this.isHorizontal?(h=B.config.plotOptions.bar.rangeBarGroupRows?v+S*I:v+C*this.visibleI+S*I,W>-1&&!B.config.plotOptions.bar.rangeBarOverlap&&(U=B.globals.seriesRange[l][W].overlaps).indexOf(j)>-1&&(h=(C=N.barHeight/U.length)*this.visibleI+S*(100-parseInt(this.barOptions.barHeight,10))/100/2+C*(this.visibleI+U.indexOf(j))+S*I)):(I>-1&&!B.globals.timescaleLabels.length&&(p=B.config.plotOptions.bar.rangeBarGroupRows?y+R*I:y+k*this.visibleI+R*I),W>-1&&!B.config.plotOptions.bar.rangeBarOverlap&&(U=B.globals.seriesRange[l][W].overlaps).indexOf(j)>-1&&(p=(k=N.barWidth/U.length)*this.visibleI+R*(100-parseInt(this.barOptions.barWidth,10))/100/2+k*(this.visibleI+U.indexOf(j))+R*I)),{barYPosition:h,barXPosition:p,barHeight:C,barWidth:k}}},{key:"drawRangeColumnPaths",value:function(o){var l=o.indexes,u=o.x,h=o.xDivision,p=o.barWidth,v=o.barXPosition,y=o.zeroH,C=this.w,k=l.i,S=l.j,R=l.realIndex,N=l.translationsIndex,B=this.yRatio[N],U=this.getRangeValue(R,S),j=Math.min(U.start,U.end),K=Math.max(U.start,U.end);null==this.series[k][S]?j=y:(j=y-j/B,K=y-K/B);var x=Math.abs(K-j),I=this.barHelpers.getColumnPaths({barXPosition:v,barWidth:p,y1:j,y2:K,strokeWidth:this.strokeWidth,series:this.seriesRangeEnd,realIndex:R,i:R,j:S,w:C});if(C.globals.isXNumeric){var W=this.getBarXForNumericXAxis({x:u,j:S,realIndex:R,barWidth:p});u=W.x,v=W.barXPosition}else u+=h;return{pathTo:I.pathTo,pathFrom:I.pathFrom,barHeight:x,x:u,y:U.start<0&&U.end<0?j:K,goalY:this.barHelpers.getGoalValues("y",null,y,k,S,N),barXPosition:v}}},{key:"preventBarOverflow",value:function(o){var l=this.w;return o<0&&(o=0),o>l.globals.gridWidth&&(o=l.globals.gridWidth),o}},{key:"drawRangeBarPaths",value:function(o){var l=o.indexes,u=o.y,p=o.y2,v=o.yDivision,y=o.barHeight,C=o.barYPosition,k=o.zeroW,S=this.w,R=l.realIndex,N=l.j,B=this.preventBarOverflow(k+o.y1/this.invertedYRatio),U=this.preventBarOverflow(k+p/this.invertedYRatio),j=this.getRangeValue(R,N),K=Math.abs(U-B),x=this.barHelpers.getBarpaths({barYPosition:C,barHeight:y,x1:B,x2:U,strokeWidth:this.strokeWidth,series:this.seriesRangeEnd,i:R,realIndex:R,j:N,w:S});return S.globals.isXNumeric||(u+=v),{pathTo:x.pathTo,pathFrom:x.pathFrom,barWidth:K,x:j.start<0&&j.end<0?B:U,goalX:this.barHelpers.getGoalValues("x",k,null,R,N),y:u}}},{key:"getRangeValue",value:function(o,l){var u=this.w;return{start:u.globals.seriesRangeStart[o][l],end:u.globals.seriesRangeEnd[o][l]}}}]),i}(rn),Oi=function(){function P(r){F(this,P),this.w=r.w,this.lineCtx=r}return me(P,[{key:"sameValueSeriesFix",value:function(r,i){var o=this.w;if(("gradient"===o.config.fill.type||"gradient"===o.config.fill.type[r])&&new yn(this.lineCtx.ctx,o).seriesHaveSameValues(r)){var l=i[r].slice();l[l.length-1]=l[l.length-1]+1e-6,i[r]=l}return i}},{key:"calculatePoints",value:function(r){var i=r.series,l=r.x,u=r.y,h=r.i,p=r.j,v=r.prevY,y=this.w,C=[],k=[];if(0===p){var S=this.lineCtx.categoryAxisCorrection+y.config.markers.offsetX;y.globals.isXNumeric&&(S=(y.globals.seriesX[r.realIndex][0]-y.globals.minX)/this.lineCtx.xRatio+y.config.markers.offsetX),C.push(S),k.push(pe.isNumber(i[h][0])?v+y.config.markers.offsetY:null),C.push(l+y.config.markers.offsetX),k.push(pe.isNumber(i[h][p+1])?u+y.config.markers.offsetY:null)}else C.push(l+y.config.markers.offsetX),k.push(pe.isNumber(i[h][p+1])?u+y.config.markers.offsetY:null);return{x:C,y:k}}},{key:"checkPreviousPaths",value:function(r){for(var i=r.pathFromLine,o=r.pathFromArea,l=r.realIndex,u=this.w,h=0;h<u.globals.previousPaths.length;h++){var p=u.globals.previousPaths[h];("line"===p.type||"area"===p.type)&&p.paths.length>0&&parseInt(p.realIndex,10)===parseInt(l,10)&&("line"===p.type?(this.lineCtx.appendPathFrom=!1,i=u.globals.previousPaths[h].paths[0].d):"area"===p.type&&(this.lineCtx.appendPathFrom=!1,o=u.globals.previousPaths[h].paths[0].d,u.config.stroke.show&&u.globals.previousPaths[h].paths[1]&&(i=u.globals.previousPaths[h].paths[1].d)))}return{pathFromLine:i,pathFromArea:o}}},{key:"determineFirstPrevY",value:function(r){var i,o,l,u=r.i,h=r.realIndex,p=r.series,v=r.prevY,y=r.lineYPosition,C=r.translationsIndex,k=this.w,S=k.config.chart.stacked&&!k.globals.comboCharts||k.config.chart.stacked&&k.globals.comboCharts&&(!this.w.config.chart.stackOnlyBar||"bar"===(null===(i=this.w.config.series[h])||void 0===i?void 0:i.type)||"column"===(null===(o=this.w.config.series[h])||void 0===o?void 0:o.type));if(void 0!==(null===(l=p[u])||void 0===l?void 0:l[0]))v=(y=S&&u>0?this.lineCtx.prevSeriesY[u-1][0]:this.lineCtx.zeroY)-p[u][0]/this.lineCtx.yRatio[C]+2*(this.lineCtx.isReversed?p[u][0]/this.lineCtx.yRatio[C]:0);else if(S&&u>0&&void 0===p[u][0])for(var R=u-1;R>=0;R--)if(null!=p[R][0]){v=y=this.lineCtx.prevSeriesY[R][0];break}return{prevY:v,lineYPosition:y}}}]),P}(),Ei=function(P,r,i){var o=P.slice(r,i);if(r){if(i-r>1&&o[1].length<6){var l=o[0].length;o[1]=[2*o[0][l-2]-o[0][l-4],2*o[0][l-1]-o[0][l-3]].concat(o[1])}o[0]=o[0].slice(-2)}return o};function Zi(P,r){return(r[1]-P[1])/(r[0]-P[0])}var Ji=function(){function P(r,i,o){F(this,P),this.ctx=r,this.w=r.w,this.xyRatios=i,this.pointsChart=!("bubble"!==this.w.config.chart.type&&"scatter"!==this.w.config.chart.type)||o,this.scatter=new Ui(this.ctx),this.noNegatives=this.w.globals.minX===Number.MAX_VALUE,this.lineHelpers=new Oi(this),this.markers=new Rr(this.ctx),this.prevSeriesY=[],this.categoryAxisCorrection=0,this.yaxisIndex=0}return me(P,[{key:"draw",value:function(r,i,o,l){var u,h=this.w,p=new Ke(this.ctx),v=h.globals.comboCharts?i:h.config.chart.type,y=p.group({class:"apexcharts-".concat(v,"-series apexcharts-plot-series")}),C=new yn(this.ctx,h);this.yRatio=this.xyRatios.yRatio,this.zRatio=this.xyRatios.zRatio,this.xRatio=this.xyRatios.xRatio,this.baseLineY=this.xyRatios.baseLineY,r=C.getLogSeries(r),this.yRatio=C.getLogYRatios(this.yRatio),this.prevSeriesY=[];for(var k=[],S=0;S<r.length;S++){r=this.lineHelpers.sameValueSeriesFix(S,r);var R=h.globals.comboCharts?o[S]:S,N=this.yRatio.length>1?R:0;this._initSerieVariables(r,S,R);var B=[],U=[],j=[],K=h.globals.padHorizontal+this.categoryAxisCorrection;this.ctx.series.addCollapsedClassToSeries(this.elSeries,R),h.globals.isXNumeric&&h.globals.seriesX.length>0&&(K=(h.globals.seriesX[R][0]-h.globals.minX)/this.xRatio),j.push(K);var x,I=K,W=void 0,q=I,J=this.zeroY,ne=this.zeroY;J=this.lineHelpers.determineFirstPrevY({i:S,realIndex:R,series:r,prevY:J,lineYPosition:0,translationsIndex:N}).prevY,B.push("monotoneCubic"===h.config.stroke.curve&&null===r[S][0]?null:J),x=J,"rangeArea"===v&&(W=ne=this.lineHelpers.determineFirstPrevY({i:S,realIndex:R,series:l,prevY:ne,lineYPosition:0,translationsIndex:N}).prevY,U.push(null!==B[0]?ne:null));var ve=this._calculatePathsFrom({type:v,series:r,i:S,realIndex:R,translationsIndex:N,prevX:q,prevY:J,prevY2:ne}),ge=[B[0]],Le=[U[0]],qe={type:v,series:r,realIndex:R,translationsIndex:N,i:S,x:K,y:1,pX:I,pY:x,pathsFrom:ve,linePaths:[],areaPaths:[],seriesIndex:o,lineYPosition:0,xArrj:j,yArrj:B,y2Arrj:U,seriesRangeEnd:l},Pe=this._iterateOverDataPoints(Ze(Ze({},qe),{},{iterations:"rangeArea"===v?r[S].length-1:void 0,isRangeStart:!0}));if("rangeArea"===v){for(var Ue=this._calculatePathsFrom({series:l,i:S,realIndex:R,prevX:q,prevY:ne}),lt=this._iterateOverDataPoints(Ze(Ze({},qe),{},{series:l,xArrj:[K],yArrj:ge,y2Arrj:Le,pY:W,areaPaths:Pe.areaPaths,pathsFrom:Ue,iterations:l[S].length-1,isRangeStart:!1})),ft=Pe.linePaths.length/2,At=0;At<ft;At++)Pe.linePaths[At]=lt.linePaths[At+ft]+Pe.linePaths[At];Pe.linePaths.splice(ft),Pe.pathFromLine=lt.pathFromLine+Pe.pathFromLine}else Pe.pathFromArea+="z";this._handlePaths({type:v,realIndex:R,i:S,paths:Pe}),this.elSeries.add(this.elPointsMain),this.elSeries.add(this.elDataLabelsWrap),k.push(this.elSeries)}if(void 0!==(null===(u=h.config.series[0])||void 0===u?void 0:u.zIndex)&&k.sort(function(Lt,$t){return Number(Lt.node.getAttribute("zIndex"))-Number($t.node.getAttribute("zIndex"))}),h.config.chart.stacked)for(var St=k.length-1;St>=0;St--)y.add(k[St]);else for(var Gt=0;Gt<k.length;Gt++)y.add(k[Gt]);return y}},{key:"_initSerieVariables",value:function(r,i,o){var l=this.w,u=new Ke(this.ctx);this.xDivision=l.globals.gridWidth/(l.globals.dataPoints-("on"===l.config.xaxis.tickPlacement?1:0)),this.strokeWidth=Array.isArray(l.config.stroke.width)?l.config.stroke.width[o]:l.config.stroke.width;var h=0;this.yRatio.length>1&&(this.yaxisIndex=l.globals.seriesYAxisReverseMap[o],h=o),this.isReversed=l.config.yaxis[this.yaxisIndex]&&l.config.yaxis[this.yaxisIndex].reversed,this.zeroY=l.globals.gridHeight-this.baseLineY[h]-(this.isReversed?l.globals.gridHeight:0)+(this.isReversed?2*this.baseLineY[h]:0),this.areaBottomY=this.zeroY,(this.zeroY>l.globals.gridHeight||"end"===l.config.plotOptions.area.fillTo)&&(this.areaBottomY=l.globals.gridHeight),this.categoryAxisCorrection=this.xDivision/2,this.elSeries=u.group({class:"apexcharts-series",zIndex:void 0!==l.config.series[o].zIndex?l.config.series[o].zIndex:o,seriesName:pe.escapeString(l.globals.seriesNames[o])}),this.elPointsMain=u.group({class:"apexcharts-series-markers-wrap","data:realIndex":o}),this.elDataLabelsWrap=u.group({class:"apexcharts-datalabels","data:realIndex":o}),this.elSeries.attr({"data:longestSeries":r[i].length===l.globals.dataPoints,rel:i+1,"data:realIndex":o}),this.appendPathFrom=!0}},{key:"_calculatePathsFrom",value:function(r){var i,o,l,u,h=r.type,p=r.series,v=r.i,y=r.realIndex,C=r.translationsIndex,k=r.prevX,S=r.prevY,R=r.prevY2,N=this.w,B=new Ke(this.ctx);if(null===p[v][0]){for(var U=0;U<p[v].length;U++)if(null!==p[v][U]){i=B.move(k=this.xDivision*U,S=this.zeroY-p[v][U]/this.yRatio[C]),o=B.move(k,this.areaBottomY);break}}else i=B.move(k,S),"rangeArea"===h&&(i=B.move(k,R)+B.line(k,S)),o=B.move(k,this.areaBottomY)+B.line(k,S);if(l=B.move(0,this.zeroY)+B.line(0,this.zeroY),u=B.move(0,this.zeroY)+B.line(0,this.zeroY),N.globals.previousPaths.length>0){var j=this.lineHelpers.checkPreviousPaths({pathFromLine:l,pathFromArea:u,realIndex:y});l=j.pathFromLine,u=j.pathFromArea}return{prevX:k,prevY:S,linePath:i,areaPath:o,pathFromLine:l,pathFromArea:u}}},{key:"_handlePaths",value:function(r){var i=r.type,o=r.realIndex,l=r.i,u=r.paths,h=this.w,p=new Ke(this.ctx),v=new Fr(this.ctx);this.prevSeriesY.push(u.yArrj),h.globals.seriesXvalues[o]=u.xArrj,h.globals.seriesYvalues[o]=u.yArrj;var y=h.config.forecastDataPoints;if(y.count>0&&"rangeArea"!==i){var C=h.globals.seriesXvalues[o][h.globals.seriesXvalues[o].length-y.count-1],k=p.drawRect(C,0,h.globals.gridWidth,h.globals.gridHeight,0);h.globals.dom.elForecastMask.appendChild(k.node);var S=p.drawRect(0,0,C,h.globals.gridHeight,0);h.globals.dom.elNonForecastMask.appendChild(S.node)}this.pointsChart||h.globals.delayedElements.push({el:this.elPointsMain.node,index:o});var R={i:l,realIndex:o,animationDelay:l,initialSpeed:h.config.chart.animations.speed,dataChangeSpeed:h.config.chart.animations.dynamicAnimation.speed,className:"apexcharts-".concat(i)};if("area"===i)for(var N=v.fillPath({seriesNumber:o}),B=0;B<u.areaPaths.length;B++){var U=p.renderPaths(Ze(Ze({},R),{},{pathFrom:u.pathFromArea,pathTo:u.areaPaths[B],stroke:"none",strokeWidth:0,strokeLineCap:null,fill:N}));this.elSeries.add(U)}if(h.config.stroke.show&&!this.pointsChart){var j=null;if("line"===i)j=v.fillPath({seriesNumber:o,i:l});else if("solid"===h.config.stroke.fill.type)j=h.globals.stroke.colors[o];else{var K=h.config.fill;h.config.fill=h.config.stroke.fill,j=v.fillPath({seriesNumber:o,i:l}),h.config.fill=K}for(var x=0;x<u.linePaths.length;x++){var I=j;"rangeArea"===i&&(I=v.fillPath({seriesNumber:o}));var W=Ze(Ze({},R),{},{pathFrom:u.pathFromLine,pathTo:u.linePaths[x],stroke:j,strokeWidth:this.strokeWidth,strokeLineCap:h.config.stroke.lineCap,fill:"rangeArea"===i?I:"none"}),q=p.renderPaths(W);if(this.elSeries.add(q),q.attr("fill-rule","evenodd"),y.count>0&&"rangeArea"!==i){var J=p.renderPaths(W);J.node.setAttribute("stroke-dasharray",y.dashArray),y.strokeWidth&&J.node.setAttribute("stroke-width",y.strokeWidth),this.elSeries.add(J),J.attr("clip-path","url(#forecastMask".concat(h.globals.cuid,")")),q.attr("clip-path","url(#nonForecastMask".concat(h.globals.cuid,")"))}}}}},{key:"_iterateOverDataPoints",value:function(r){var i,o,l=this,u=r.type,h=r.series,p=r.iterations,v=r.realIndex,y=r.translationsIndex,C=r.i,k=r.x,S=r.y,R=r.pX,N=r.pY,B=r.pathsFrom,U=r.linePaths,j=r.areaPaths,K=r.seriesIndex,x=r.lineYPosition,I=r.xArrj,W=r.yArrj,q=r.y2Arrj,J=r.isRangeStart,ne=r.seriesRangeEnd,ve=this.w,ge=new Ke(this.ctx),Le=this.yRatio,qe=B.prevY,Pe=B.linePath,Ue=B.areaPath,lt=B.pathFromLine,ft=B.pathFromArea,At=pe.isNumber(ve.globals.minYArr[v])?ve.globals.minYArr[v]:ve.globals.minY;p||(p=ve.globals.dataPoints>1?ve.globals.dataPoints-1:ve.globals.dataPoints);var St=function(Gn,cr){return cr-Gn/Le[y]+2*(l.isReversed?Gn/Le[y]:0)},Gt=S,Lt=ve.config.chart.stacked&&!ve.globals.comboCharts||ve.config.chart.stacked&&ve.globals.comboCharts&&(!this.w.config.chart.stackOnlyBar||"bar"===(null===(i=this.w.config.series[v])||void 0===i?void 0:i.type)||"column"===(null===(o=this.w.config.series[v])||void 0===o?void 0:o.type)),$t=ve.config.stroke.curve;Array.isArray($t)&&($t=Array.isArray(K)?$t[K[C]]:$t[C]);for(var zn,En=0,_n=0;_n<p;_n++){var sr=null==h[C][_n+1];if(ve.globals.isXNumeric){var fn=ve.globals.seriesX[v][_n+1];void 0===ve.globals.seriesX[v][_n+1]&&(fn=ve.globals.seriesX[v][p-1]),k=(fn-ve.globals.minX)/this.xRatio}else k+=this.xDivision;x=Lt&&C>0&&ve.globals.collapsedSeries.length<ve.config.series.length-1?this.prevSeriesY[function(Gn){for(var cr=Gn;cr>0;cr--){if(!(ve.globals.collapsedSeriesIndices.indexOf(K?.[cr]||cr)>-1))return cr;cr--}return 0}(C-1)][_n+1]:this.zeroY,sr?S=St(At,x):(S=St(h[C][_n+1],x),"rangeArea"===u&&(Gt=St(ne[C][_n+1],x))),I.push(k),!sr||"smooth"!==ve.config.stroke.curve&&"monotoneCubic"!==ve.config.stroke.curve?(W.push(S),q.push(Gt)):(W.push(null),q.push(null));var en=this.lineHelpers.calculatePoints({series:h,x:k,y:S,realIndex:v,i:C,j:_n,prevY:qe}),kn=this._createPaths({type:u,series:h,i:C,realIndex:v,j:_n,x:k,y:S,y2:Gt,xArrj:I,yArrj:W,y2Arrj:q,pX:R,pY:N,pathState:En,segmentStartX:zn,linePath:Pe,areaPath:Ue,linePaths:U,areaPaths:j,curve:$t,isRangeStart:J});j=kn.areaPaths,U=kn.linePaths,R=kn.pX,N=kn.pY,En=kn.pathState,zn=kn.segmentStartX,Ue=kn.areaPath,Pe=kn.linePath,!this.appendPathFrom||"monotoneCubic"===$t&&"rangeArea"===u||(lt+=ge.line(k,this.zeroY),ft+=ge.line(k,this.zeroY)),this.handleNullDataPoints(h,en,C,_n,v),this._handleMarkersAndLabels({type:u,pointsPos:en,i:C,j:_n,realIndex:v,isRangeStart:J})}return{yArrj:W,xArrj:I,pathFromArea:ft,areaPaths:j,pathFromLine:lt,linePaths:U,linePath:Pe,areaPath:Ue}}},{key:"_handleMarkersAndLabels",value:function(r){var i=r.type,o=r.pointsPos,l=r.isRangeStart,u=r.i,h=r.j,p=r.realIndex,v=this.w,y=new wn(this.ctx);if(this.pointsChart)this.scatter.draw(this.elSeries,h,{realIndex:p,pointsPos:o,zRatio:this.zRatio,elParent:this.elPointsMain});else{v.globals.series[u].length>1&&this.elPointsMain.node.classList.add("apexcharts-element-hidden");var C=this.markers.plotChartMarkers(o,p,h+1);null!==C&&this.elPointsMain.add(C)}var k=y.drawDataLabel({type:i,isRangeStart:l,pos:o,i:p,j:h+1});null!==k&&this.elDataLabelsWrap.add(k)}},{key:"_createPaths",value:function(r){var q,i=r.type,o=r.series,l=r.i,u=r.j,h=r.x,p=r.y,v=r.xArrj,y=r.yArrj,C=r.y2,k=r.y2Arrj,S=r.pX,R=r.pY,N=r.pathState,B=r.segmentStartX,U=r.linePath,j=r.areaPath,K=r.linePaths,x=r.areaPaths,I=r.curve,W=r.isRangeStart,J=new Ke(this.ctx),ne=this.areaBottomY,ve="rangeArea"===i,ge="rangeArea"===i&&W;switch(I){case"monotoneCubic":var Le=W?y:k;switch(N){case 0:if(null===Le[u+1])break;N=1;case 1:if(!(ve?v.length===o[l].length:u===o[l].length-2))break;case 2:var qe=W?v:v.slice().reverse(),Pe=W?Le:Le.slice().reverse(),Ue=(q=Pe,qe.map(function(fn,en){return[fn,q[en]]}).filter(function(fn){return null!==fn[1]})),lt=Ue.length>1?function(P){var r=function(P){for(var r,i,o,l,u=function(C){for(var k=[],S=C[0],R=C[1],N=k[0]=Zi(S,R),B=1,U=C.length-1;B<U;B++)k[B]=.5*(N+(N=Zi(S=R,R=C[B+1])));return k[B]=N,k}(P),h=P.length-1,p=[],v=0;v<h;v++)o=Zi(P[v],P[v+1]),Math.abs(o)<1e-6?u[v]=u[v+1]=0:(l=(r=u[v]/o)*r+(i=u[v+1]/o)*i)>9&&(l=3*o/Math.sqrt(l),u[v]=l*r,u[v+1]=l*i);for(var y=0;y<=h;y++)l=(P[Math.min(h,y+1)][0]-P[Math.max(0,y-1)][0])/(6*(1+u[y]*u[y])),p.push([l||0,u[y]*l||0]);return p}(P),i=P[1],o=P[0],l=[],u=r[1],h=r[0];l.push(o,[o[0]+h[0],o[1]+h[1],i[0]-u[0],i[1]-u[1],i[0],i[1]]);for(var p=2,v=r.length;p<v;p++){var y=P[p],C=r[p];l.push([y[0]-C[0],y[1]-C[1],y[0],y[1]])}return l}(Ue):Ue,ft=[];ve&&(ge?x=Ue:ft=x.reverse());var At=0,St=0;if(function(fn,en){for(var kn=function(Qi){var rr=[],kr=0;return Qi.forEach(function(ko){null!==ko?kr++:kr>0&&(rr.push(kr),kr=0)}),kr>0&&rr.push(kr),rr}(fn),Gn=[],cr=0,Xr=0;cr<kn.length;Xr+=kn[cr++])Gn[cr]=Ei(en,Xr,Xr+kn[cr]);return Gn}(Pe,lt).forEach(function(fn){At++;var en=function(cr){for(var Xr="",Qi=0;Qi<cr.length;Qi++){var rr=cr[Qi],kr=rr.length;kr>4?(Xr+="C".concat(rr[0],", ").concat(rr[1]),Xr+=", ".concat(rr[2],", ").concat(rr[3]),Xr+=", ".concat(rr[4],", ").concat(rr[5])):kr>2&&(Xr+="S".concat(rr[0],", ").concat(rr[1]),Xr+=", ".concat(rr[2],", ").concat(rr[3]))}return Xr}(fn),kn=St,Gn=(St+=fn.length)-1;ge?U=J.move(Ue[kn][0],Ue[kn][1])+en:ve?U=J.move(ft[kn][0],ft[kn][1])+J.line(Ue[kn][0],Ue[kn][1])+en+J.line(ft[Gn][0],ft[Gn][1]):(U=J.move(Ue[kn][0],Ue[kn][1])+en,j=U+J.line(Ue[Gn][0],ne)+J.line(Ue[kn][0],ne)+"z",x.push(j)),K.push(U)}),ve&&At>1&&!ge){var Gt=K.slice(At).reverse();K.splice(At),Gt.forEach(function(fn){return K.push(fn)})}N=0}break;case"smooth":var Lt=.35*(h-S);if(null===o[l][u])N=0;else switch(N){case 0:if(B=S,U=ge?J.move(S,k[u])+J.line(S,R):J.move(S,R),j=J.move(S,R),N=1,u<o[l].length-2){var $t=J.curve(S+Lt,R,h-Lt,p,h,p);U+=$t,j+=$t;break}case 1:if(null===o[l][u+1])U+=ge?J.line(S,C):J.move(S,R),j+=J.line(S,ne)+J.line(B,ne)+"z",K.push(U),x.push(j),N=-1;else{var zn=J.curve(S+Lt,R,h-Lt,p,h,p);U+=zn,j+=zn,u>=o[l].length-2&&(ge&&(U+=J.curve(h,p,h,p,h,C)+J.move(h,C)),j+=J.curve(h,p,h,p,h,ne)+J.line(B,ne)+"z",K.push(U),x.push(j),N=-1)}}S=h,R=p;break;default:var En=function(fn,en,kn){var Gn=[];switch(fn){case"stepline":Gn=J.line(en,null,"H")+J.line(null,kn,"V");break;case"linestep":Gn=J.line(null,kn,"V")+J.line(en,null,"H");break;case"straight":Gn=J.line(en,kn)}return Gn};if(null===o[l][u])N=0;else switch(N){case 0:if(B=S,U=ge?J.move(S,k[u])+J.line(S,R):J.move(S,R),j=J.move(S,R),N=1,u<o[l].length-2){var _n=En(I,h,p);U+=_n,j+=_n;break}case 1:if(null===o[l][u+1])U+=ge?J.line(S,C):J.move(S,R),j+=J.line(S,ne)+J.line(B,ne)+"z",K.push(U),x.push(j),N=-1;else{var sr=En(I,h,p);U+=sr,j+=sr,u>=o[l].length-2&&(ge&&(U+=J.line(h,C)),j+=J.line(h,ne)+J.line(B,ne)+"z",K.push(U),x.push(j),N=-1)}}S=h,R=p}return{linePaths:K,areaPaths:x,pX:S,pY:R,pathState:N,segmentStartX:B,linePath:U,areaPath:j}}},{key:"handleNullDataPoints",value:function(r,i,o,l,u){var h=this.w;if(null===r[o][l]&&h.config.markers.showNullDataPoints||1===r[o].length){var p=this.strokeWidth-h.config.markers.strokeWidth/2;p>0||(p=0);var v=this.markers.plotChartMarkers(i,u,l+1,p,!0);null!==v&&this.elPointsMain.add(v)}}}]),P}();window.TreemapSquared={},window.TreemapSquared.generate=function(){function P(p,v,y,C){this.xoffset=p,this.yoffset=v,this.height=C,this.width=y,this.shortestEdge=function(){return Math.min(this.height,this.width)},this.getCoordinates=function(k){var S,R=[],N=this.xoffset,B=this.yoffset,U=u(k)/this.height,j=u(k)/this.width;if(this.width>=this.height)for(S=0;S<k.length;S++)R.push([N,B,N+U,B+k[S]/U]),B+=k[S]/U;else for(S=0;S<k.length;S++)R.push([N,B,N+k[S]/j,B+j]),N+=k[S]/j;return R},this.cutArea=function(k){var S;if(this.width>=this.height){var R=k/this.height;S=new P(this.xoffset+R,this.yoffset,this.width-R,this.height)}else{var B=k/this.width;S=new P(this.xoffset,this.yoffset+B,this.width,this.height-B)}return S}}function r(p,v,y,C,k){return C=void 0===C?0:C,k=void 0===k?0:k,function(R){var N,B,U=[];for(N=0;N<R.length;N++)for(B=0;B<R[N].length;B++)U.push(R[N][B]);return U}(i(function(R,N){var B,U=[],j=N/u(R);for(B=0;B<R.length;B++)U[B]=R[B]*j;return U}(p,v*y),[],new P(C,k,v,y),[]))}function i(p,v,y,C){var k,S,R,N,B,U,j;if(0!==p.length)return k=y.shortestEdge(),B=S=p[0],U=k,0===(N=v).length||((j=N.slice()).push(B),o(N,U)>=o(j,U))?(v.push(S),i(p.slice(1),v,y,C)):(R=y.cutArea(u(v),C),C.push(y.getCoordinates(v)),i(p,[],R,C)),C;C.push(y.getCoordinates(v))}function o(p,v){var y=Math.min.apply(Math,p),C=Math.max.apply(Math,p),k=u(p);return Math.max(Math.pow(v,2)*C/Math.pow(k,2),Math.pow(k,2)/(Math.pow(v,2)*y))}function l(p){return p&&p.constructor===Array}function u(p){var v,y=0;for(v=0;v<p.length;v++)y+=p[v];return y}function h(p){var v,y=0;if(l(p[0]))for(v=0;v<p.length;v++)y+=h(p[v]);else y=u(p);return y}return function p(v,y,C,k,S){k=void 0===k?0:k,S=void 0===S?0:S;var R,N,B=[],U=[];if(l(v[0])){for(N=0;N<v.length;N++)B[N]=h(v[N]);for(R=r(B,y,C,k,S),N=0;N<v.length;N++)U.push(p(v[N],R[N][2]-R[N][0],R[N][3]-R[N][1],R[N][0],R[N][1]))}else U=r(v,y,C,k,S);return U}}();var Dn,Wi,Bn=function(){function P(r,i){F(this,P),this.ctx=r,this.w=r.w,this.strokeWidth=this.w.config.stroke.width,this.helpers=new La(r),this.dynamicAnim=this.w.config.chart.animations.dynamicAnimation,this.labels=[]}return me(P,[{key:"draw",value:function(r){var i=this,o=this.w,l=new Ke(this.ctx),u=new Fr(this.ctx),h=l.group({class:"apexcharts-treemap"});if(o.globals.noData)return h;var p=[];return r.forEach(function(v){var y=v.map(function(C){return Math.abs(C)});p.push(y)}),this.negRange=this.helpers.checkColorRange(),o.config.series.forEach(function(v,y){v.data.forEach(function(C){Array.isArray(i.labels[y])||(i.labels[y]=[]),i.labels[y].push(C.x)})}),window.TreemapSquared.generate(p,o.globals.gridWidth,o.globals.gridHeight).forEach(function(v,y){var C=l.group({class:"apexcharts-series apexcharts-treemap-series",seriesName:pe.escapeString(o.globals.seriesNames[y]),rel:y+1,"data:realIndex":y});if(o.config.chart.dropShadow.enabled){var k=o.config.chart.dropShadow;new On(i.ctx).dropShadow(h,k,y)}var S=l.group({class:"apexcharts-data-labels"});v.forEach(function(R,N){var B=R[0],U=R[1],j=R[2],K=R[3],x=l.drawRect(B,U,j-B,K-U,o.config.plotOptions.treemap.borderRadius,"#fff",1,i.strokeWidth,o.config.plotOptions.treemap.useFillColorAsStroke?W:o.globals.stroke.colors[y]);x.attr({cx:B,cy:U,index:y,i:y,j:N,width:j-B,height:K-U});var I=i.helpers.getShadeColor(o.config.chart.type,y,N,i.negRange),W=I.color;void 0!==o.config.series[y].data[N]&&o.config.series[y].data[N].fillColor&&(W=o.config.series[y].data[N].fillColor);var q=u.fillPath({color:W,seriesNumber:y,dataPointIndex:N});x.node.classList.add("apexcharts-treemap-rect"),x.attr({fill:q}),i.helpers.addListeners(x);var J={x:B+(j-B)/2,y:U+(K-U)/2,width:0,height:0},ne={x:B,y:U,width:j-B,height:K-U};if(o.config.chart.animations.enabled&&!o.globals.dataChanged){var ve=1;o.globals.resized||(ve=o.config.chart.animations.speed),i.animateTreemap(x,J,ne,ve)}o.globals.dataChanged&&i.dynamicAnim.enabled&&o.globals.shouldAnimate&&(o.globals.previousPaths[y]&&o.globals.previousPaths[y][N]&&o.globals.previousPaths[y][N].rect&&(J=o.globals.previousPaths[y][N].rect),i.animateTreemap(x,J,ne,i.dynamicAnim.speed));var Le=i.getFontSize(R),qe=o.config.dataLabels.formatter(i.labels[y][N],{value:o.globals.series[y][N],seriesIndex:y,dataPointIndex:N,w:o});"truncate"===o.config.plotOptions.treemap.dataLabels.format&&(Le=parseInt(o.config.dataLabels.style.fontSize,10),qe=i.truncateLabels(qe,Le,B,U,j,K));var Pe=i.helpers.calculateDataLabels({text:qe,x:(B+j)/2,y:(U+K)/2+i.strokeWidth/2+Le/3,i:y,j:N,colorProps:I,fontSize:Le,series:r});o.config.dataLabels.enabled&&Pe&&i.rotateToFitLabel(Pe,Le,qe,B,U,j,K),C.add(x),null!==Pe&&C.add(Pe)}),C.add(S),h.add(C)}),h}},{key:"getFontSize",value:function(r){var h,i=this.w,p=function v(y){var C,k=0;if(Array.isArray(y[0]))for(C=0;C<y.length;C++)k+=v(y[C]);else for(C=0;C<y.length;C++)k+=y[C].length;return k}(this.labels)/function v(y){var C,k=0;if(Array.isArray(y[0]))for(C=0;C<y.length;C++)k+=v(y[C]);else for(C=0;C<y.length;C++)k+=1;return k}(this.labels);return h=Math.pow((r[2]-r[0])*(r[3]-r[1]),.5),Math.min(h/p,parseInt(i.config.dataLabels.style.fontSize,10))}},{key:"rotateToFitLabel",value:function(r,i,o,l,u,h,p){var v=new Ke(this.ctx),y=v.getTextRects(o,i);if(y.width+this.w.config.stroke.width+5>h-l&&y.width<=p-u){var C=v.rotateAroundCenter(r.node);r.node.setAttribute("transform","rotate(-90 ".concat(C.x," ").concat(C.y,") translate(").concat(y.height/3,")"))}}},{key:"truncateLabels",value:function(r,i,o,l,u,h){var p=new Ke(this.ctx),v=p.getTextRects(r,i).width+this.w.config.stroke.width+5>u-o&&h-l>u-o?h-l:u-o,y=p.getTextBasedOnMaxWidth({text:r,maxWidth:v,fontSize:i});return r.length!==y.length&&v/i<5?"":y}},{key:"animateTreemap",value:function(r,i,o,l){var u=new hi(this.ctx);u.animateRect(r,{x:i.x,y:i.y,width:i.width,height:i.height},{x:o.x,y:o.y,width:o.width,height:o.height},l,function(){u.animationCompleted(r)})}}]),P}(),no=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w,this.timeScaleArray=[],this.utc=this.w.config.xaxis.labels.datetimeUTC}return me(P,[{key:"calculateTimeScaleTicks",value:function(r,i){var o=this,l=this.w;if(l.globals.allSeriesCollapsed)return l.globals.labels=[],l.globals.timescaleLabels=[],[];var u=new Mn(this.ctx),h=(i-r)/864e5;this.determineInterval(h),l.globals.disableZoomIn=!1,l.globals.disableZoomOut=!1,h<.00011574074074074075?l.globals.disableZoomIn=!0:h>5e4&&(l.globals.disableZoomOut=!0);var p=u.getTimeUnitsfromTimestamp(r,i,this.utc),v=l.globals.gridWidth/h,y=v/24,C=y/60,k=C/60,S=Math.floor(24*h),R=Math.floor(1440*h),N=Math.floor(86400*h),B=Math.floor(h),U=Math.floor(h/30),j=Math.floor(h/365),K={minMillisecond:p.minMillisecond,minSecond:p.minSecond,minMinute:p.minMinute,minHour:p.minHour,minDate:p.minDate,minMonth:p.minMonth,minYear:p.minYear},x={firstVal:K,currentMillisecond:K.minMillisecond,currentSecond:K.minSecond,currentMinute:K.minMinute,currentHour:K.minHour,currentMonthDate:K.minDate,currentDate:K.minDate,currentMonth:K.minMonth,currentYear:K.minYear,daysWidthOnXAxis:v,hoursWidthOnXAxis:y,minutesWidthOnXAxis:C,secondsWidthOnXAxis:k,numberOfSeconds:N,numberOfMinutes:R,numberOfHours:S,numberOfDays:B,numberOfMonths:U,numberOfYears:j};switch(this.tickInterval){case"years":this.generateYearScale(x);break;case"months":case"half_year":this.generateMonthScale(x);break;case"months_days":case"months_fortnight":case"days":case"week_days":this.generateDayScale(x);break;case"hours":this.generateHourScale(x);break;case"minutes_fives":case"minutes":this.generateMinuteScale(x);break;case"seconds_tens":case"seconds_fives":case"seconds":this.generateSecondScale(x)}var I=this.timeScaleArray.map(function(W){var q={position:W.position,unit:W.unit,year:W.year,day:W.day?W.day:1,hour:W.hour?W.hour:0,month:W.month+1};return"month"===W.unit?Ze(Ze({},q),{},{day:1,value:W.value+1}):"day"===W.unit||"hour"===W.unit?Ze(Ze({},q),{},{value:W.value}):"minute"===W.unit?Ze(Ze({},q),{},{value:W.value,minute:W.value}):"second"===W.unit?Ze(Ze({},q),{},{value:W.value,minute:W.minute,second:W.second}):W});return I.filter(function(W){var q=1,J=Math.ceil(l.globals.gridWidth/120),ne=W.value;void 0!==l.config.xaxis.tickAmount&&(J=l.config.xaxis.tickAmount),I.length>J&&(q=Math.floor(I.length/J));var ve=!1,ge=!1;switch(o.tickInterval){case"years":"year"===W.unit&&(ve=!0);break;case"half_year":q=7,"year"===W.unit&&(ve=!0);break;case"months":q=1,"year"===W.unit&&(ve=!0);break;case"months_fortnight":q=15,"year"!==W.unit&&"month"!==W.unit||(ve=!0),30===ne&&(ge=!0);break;case"months_days":q=10,"month"===W.unit&&(ve=!0),30===ne&&(ge=!0);break;case"week_days":q=8,"month"===W.unit&&(ve=!0);break;case"days":q=1,"month"===W.unit&&(ve=!0);break;case"hours":"day"===W.unit&&(ve=!0);break;case"minutes_fives":case"seconds_fives":ne%5!=0&&(ge=!0);break;case"seconds_tens":ne%10!=0&&(ge=!0)}if("hours"===o.tickInterval||"minutes_fives"===o.tickInterval||"seconds_tens"===o.tickInterval||"seconds_fives"===o.tickInterval){if(!ge)return!0}else if((ne%q==0||ve)&&!ge)return!0})}},{key:"recalcDimensionsBasedOnFormat",value:function(r,i){var o=this.w,l=this.formatDates(r),u=this.removeOverlappingTS(l);o.globals.timescaleLabels=u.slice(),new Pa(this.ctx).plotCoords()}},{key:"determineInterval",value:function(r){var i=24*r,o=60*i;switch(!0){case r/365>5:this.tickInterval="years";break;case r>800:this.tickInterval="half_year";break;case r>180:this.tickInterval="months";break;case r>90:this.tickInterval="months_fortnight";break;case r>60:this.tickInterval="months_days";break;case r>30:this.tickInterval="week_days";break;case r>2:this.tickInterval="days";break;case i>2.4:this.tickInterval="hours";break;case o>15:this.tickInterval="minutes_fives";break;case o>5:this.tickInterval="minutes";break;case o>1:this.tickInterval="seconds_tens";break;case 60*o>20:this.tickInterval="seconds_fives";break;default:this.tickInterval="seconds"}}},{key:"generateYearScale",value:function(r){var i=r.firstVal,o=r.currentMonth,l=r.currentYear,u=r.daysWidthOnXAxis,h=r.numberOfYears,p=i.minYear,v=0,y=new Mn(this.ctx),C="year";if(i.minDate>1||i.minMonth>0){var k=y.determineRemainingDaysOfYear(i.minYear,i.minMonth,i.minDate);v=(y.determineDaysOfYear(i.minYear)-k+1)*u,this.timeScaleArray.push({position:v,value:p=i.minYear+1,unit:C,year:p,month:pe.monthMod(o+1)})}else 1===i.minDate&&0===i.minMonth&&this.timeScaleArray.push({position:v,value:p,unit:C,year:l,month:pe.monthMod(o+1)});for(var S=p,R=v,N=0;N<h;N++)S++,R=y.determineDaysOfYear(S-1)*u+R,this.timeScaleArray.push({position:R,value:S,unit:C,year:S,month:1})}},{key:"generateMonthScale",value:function(r){var i=r.firstVal,o=r.currentMonthDate,l=r.currentMonth,u=r.currentYear,h=r.daysWidthOnXAxis,p=r.numberOfMonths,v=l,y=0,C=new Mn(this.ctx),k="month",S=0;if(i.minDate>1){y=(C.determineDaysOfMonths(l+1,i.minYear)-o+1)*h,v=pe.monthMod(l+1);var R=u+S,N=pe.monthMod(v),B=v;0===v&&(k="year",B=R,N=1,R+=S+=1),this.timeScaleArray.push({position:y,value:B,unit:k,year:R,month:N})}else this.timeScaleArray.push({position:y,value:v,unit:k,year:u,month:pe.monthMod(l)});for(var U=v+1,j=y,K=0,x=1;K<p;K++,x++){0===(U=pe.monthMod(U))?(k="year",S+=1):k="month";var I=this._getYear(u,U,S);j=C.determineDaysOfMonths(U,I)*h+j,this.timeScaleArray.push({position:j,value:0===U?I:U,unit:k,year:I,month:0===U?1:U}),U++}}},{key:"generateDayScale",value:function(r){var i=r.firstVal,o=r.currentMonth,l=r.currentYear,u=r.hoursWidthOnXAxis,h=r.numberOfDays,p=new Mn(this.ctx),v="day",y=i.minDate+1,C=y,k=function(x,I,W){return x>p.determineDaysOfMonths(I+1,W)&&(C=1,v="month",R=I+=1),I},S=(24-i.minHour)*u,R=y,N=k(C,o,l);0===i.minHour&&1===i.minDate?(S=0,R=pe.monthMod(i.minMonth),v="month",C=i.minDate):1!==i.minDate&&0===i.minHour&&0===i.minMinute&&(S=0,R=y=i.minDate,N=k(C=y,o,l)),this.timeScaleArray.push({position:S,value:R,unit:v,year:this._getYear(l,N,0),month:pe.monthMod(N),day:C});for(var B=S,U=0;U<h;U++){v="day",N=k(C+=1,N,this._getYear(l,N,0));var j=this._getYear(l,N,0);B=24*u+B;var K=1===C?pe.monthMod(N):C;this.timeScaleArray.push({position:B,value:K,unit:v,year:j,month:pe.monthMod(N),day:K})}}},{key:"generateHourScale",value:function(r){var i=r.firstVal,o=r.currentDate,l=r.currentMonth,u=r.currentYear,h=r.minutesWidthOnXAxis,p=r.numberOfHours,v=new Mn(this.ctx),y="hour",C=function(q,J){return q>v.determineDaysOfMonths(J+1,u)&&(U=1,J+=1),{month:J,date:U}},k=function(q,J){return q>v.determineDaysOfMonths(J+1,u)?J+=1:J},S=60-(i.minMinute+i.minSecond/60),R=S*h,N=i.minHour+1,B=N;60===S&&(R=0,B=N=i.minHour);var U=o;B>=24&&(B=0,U+=1,y="day");var j=C(U,l).month;j=k(U,j),this.timeScaleArray.push({position:R,value:N,unit:y,day:U,hour:B,year:u,month:pe.monthMod(j)}),B++;for(var K=R,x=0;x<p;x++){y="hour",B>=24&&(B=0,y="day",j=C(U+=1,j).month,j=k(U,j));var I=this._getYear(u,j,0);this.timeScaleArray.push({position:K=60*h+K,value:0===B?U:B,unit:y,hour:B,day:U,year:I,month:pe.monthMod(j)}),B++}}},{key:"generateMinuteScale",value:function(r){for(var y=r.minutesWidthOnXAxis,k=r.numberOfMinutes,S=r.currentMinute+1,R=r.currentDate,N=r.currentMonth,B=r.currentYear,U=r.currentHour,j=(60-r.currentSecond-r.currentMillisecond/1e3)*r.secondsWidthOnXAxis,K=0;K<k;K++)S>=60&&(S=0,24===(U+=1)&&(U=0)),this.timeScaleArray.push({position:j,value:S,unit:"minute",hour:U,minute:S,day:R,year:this._getYear(B,N,0),month:pe.monthMod(N)}),j+=y,S++}},{key:"generateSecondScale",value:function(r){for(var y=r.secondsWidthOnXAxis,C=r.numberOfSeconds,k=r.currentSecond+1,S=r.currentMinute,R=r.currentDate,N=r.currentMonth,B=r.currentYear,U=r.currentHour,j=(1e3-r.currentMillisecond)/1e3*y,K=0;K<C;K++)k>=60&&(k=0,++S>=60&&(S=0,24==++U&&(U=0))),this.timeScaleArray.push({position:j,value:k,unit:"second",hour:U,minute:S,second:k,day:R,year:this._getYear(B,N,0),month:pe.monthMod(N)}),j+=y,k++}},{key:"createRawDateString",value:function(r,i){var o=r.year;return 0===r.month&&(r.month=1),o+="-"+("0"+r.month.toString()).slice(-2),o+="day"===r.unit?"day"===r.unit?"-"+("0"+i).slice(-2):"-01":"-"+("0"+(r.day?r.day:"1")).slice(-2),o+="hour"===r.unit?"hour"===r.unit?"T"+("0"+i).slice(-2):"T00":"T"+("0"+(r.hour?r.hour:"0")).slice(-2),o+="minute"===r.unit?":"+("0"+i).slice(-2):":"+(r.minute?("0"+r.minute).slice(-2):"00"),o+="second"===r.unit?":"+("0"+i).slice(-2):":00",this.utc&&(o+=".000Z"),o}},{key:"formatDates",value:function(r){var i=this,o=this.w;return r.map(function(l){var u=l.value.toString(),h=new Mn(i.ctx),p=i.createRawDateString(l,u),v=h.getDate(h.parseDate(p));if(i.utc||(v=h.getDate(h.parseDateWithTimezone(p))),void 0===o.config.xaxis.labels.format){var y="dd MMM",C=o.config.xaxis.labels.datetimeFormatter;"year"===l.unit&&(y=C.year),"month"===l.unit&&(y=C.month),"day"===l.unit&&(y=C.day),"hour"===l.unit&&(y=C.hour),"minute"===l.unit&&(y=C.minute),"second"===l.unit&&(y=C.second),u=h.formatDate(v,y)}else u=h.formatDate(v,o.config.xaxis.labels.format);return{dateString:p,position:l.position,value:u,unit:l.unit,year:l.year,month:l.month}})}},{key:"removeOverlappingTS",value:function(r){var i,o=this,l=new Ke(this.ctx),u=!1;r.length>0&&r[0].value&&r.every(function(v){return v.value.length===r[0].value.length})&&(u=!0,i=l.getTextRects(r[0].value).width);var h=0;return r.map(function(v,y){if(y>0&&o.w.config.xaxis.labels.hideOverlappingLabels){var C=u?i:l.getTextRects(r[h].value).width;return v.position>r[h].position+C+10?(h=y,v):null}return v}).filter(function(v){return null!==v})}},{key:"_getYear",value:function(r,i,o){return r+Math.floor(i/12)+o}}]),P}(),qr=function(){function P(r,i){F(this,P),this.ctx=i,this.w=i.w,this.el=r}return me(P,[{key:"setupElements",value:function(){var r=this.w.globals,i=this.w.config,o=i.chart.type;r.axisCharts=["line","area","bar","rangeBar","rangeArea","candlestick","boxPlot","scatter","bubble","radar","heatmap","treemap"].indexOf(o)>-1,r.xyCharts=["line","area","bar","rangeBar","rangeArea","candlestick","boxPlot","scatter","bubble"].indexOf(o)>-1,r.isBarHorizontal=("bar"===i.chart.type||"rangeBar"===i.chart.type||"boxPlot"===i.chart.type)&&i.plotOptions.bar.horizontal,r.chartClass=".apexcharts"+r.chartID,r.dom.baseEl=this.el,r.dom.elWrap=document.createElement("div"),Ke.setAttrs(r.dom.elWrap,{id:r.chartClass.substring(1),class:"apexcharts-canvas "+r.chartClass.substring(1)}),this.el.appendChild(r.dom.elWrap),r.dom.Paper=new window.SVG.Doc(r.dom.elWrap),r.dom.Paper.attr({class:"apexcharts-svg","xmlns:data":"ApexChartsNS",transform:"translate(".concat(i.chart.offsetX,", ").concat(i.chart.offsetY,")")}),r.dom.Paper.node.style.background="dark"!==i.theme.mode||i.chart.background?i.chart.background:"rgba(0, 0, 0, 0.8)",this.setSVGDimensions(),r.dom.elLegendForeign=document.createElementNS(r.SVGNS,"foreignObject"),Ke.setAttrs(r.dom.elLegendForeign,{x:0,y:0,width:r.svgWidth,height:r.svgHeight}),r.dom.elLegendWrap=document.createElement("div"),r.dom.elLegendWrap.classList.add("apexcharts-legend"),r.dom.elLegendWrap.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),r.dom.elLegendForeign.appendChild(r.dom.elLegendWrap),r.dom.Paper.node.appendChild(r.dom.elLegendForeign),r.dom.elGraphical=r.dom.Paper.group().attr({class:"apexcharts-inner apexcharts-graphical"}),r.dom.elDefs=r.dom.Paper.defs(),r.dom.Paper.add(r.dom.elGraphical),r.dom.elGraphical.add(r.dom.elDefs)}},{key:"plotChartType",value:function(r,i){var o=this.w,l=o.config,u=o.globals,h={series:[],i:[]},p={series:[],i:[]},v={series:[],i:[]},y={series:[],i:[]},C={series:[],i:[]},k={series:[],i:[]},S={series:[],i:[]},R={series:[],i:[]},N={series:[],seriesRangeEnd:[],i:[]},B=void 0!==l.chart.type?l.chart.type:"line",U=null,j=0;u.series.forEach(function(Pe,Ue){var lt=r[Ue].type||B;switch(lt){case"column":case"bar":C.series.push(Pe),C.i.push(Ue),o.globals.columnSeries=C;break;case"area":p.series.push(Pe),p.i.push(Ue);break;case"line":h.series.push(Pe),h.i.push(Ue);break;case"scatter":v.series.push(Pe),v.i.push(Ue);break;case"bubble":y.series.push(Pe),y.i.push(Ue);break;case"candlestick":k.series.push(Pe),k.i.push(Ue);break;case"boxPlot":S.series.push(Pe),S.i.push(Ue);break;case"rangeBar":R.series.push(Pe),R.i.push(Ue);break;case"rangeArea":N.series.push(u.seriesRangeStart[Ue]),N.seriesRangeEnd.push(u.seriesRangeEnd[Ue]),N.i.push(Ue);break;case"heatmap":case"treemap":case"pie":case"donut":case"polarArea":case"radialBar":case"radar":U=lt;break;default:console.warn("You have specified an unrecognized series type (",lt,").")}B!==lt&&"scatter"!==lt&&j++}),j>0&&(null!==U&&console.warn("Chart or series type ",U," can not appear with other chart or series types."),C.series.length>0&&l.plotOptions.bar.horizontal&&(j-=C.length,C={series:[],i:[]},o.globals.columnSeries={series:[],i:[]},console.warn("Horizontal bars are not supported in a mixed/combo chart. Please turn off `plotOptions.bar.horizontal`"))),u.comboCharts||(u.comboCharts=j>0);var K=new Ji(this.ctx,i),x=new ha(this.ctx,i);this.ctx.pie=new ka(this.ctx);var I=new Fi(this.ctx);this.ctx.rangeBar=new Fa(this.ctx,i);var W=new da(this.ctx),q=[];if(u.comboCharts){var J,ne,ve=new yn(this.ctx);if(p.series.length>0&&(J=q).push.apply(J,gt(ve.drawSeriesByGroup(p,u.areaGroups,"area",K))),C.series.length>0)if(o.config.chart.stacked){var ge=new Me(this.ctx,i);q.push(ge.draw(C.series,C.i))}else this.ctx.bar=new rn(this.ctx,i),q.push(this.ctx.bar.draw(C.series,C.i));if(N.series.length>0&&q.push(K.draw(N.series,"rangeArea",N.i,N.seriesRangeEnd)),h.series.length>0&&(ne=q).push.apply(ne,gt(ve.drawSeriesByGroup(h,u.lineGroups,"line",K))),k.series.length>0&&q.push(x.draw(k.series,"candlestick",k.i)),S.series.length>0&&q.push(x.draw(S.series,"boxPlot",S.i)),R.series.length>0&&q.push(this.ctx.rangeBar.draw(R.series,R.i)),v.series.length>0){var Le=new Ji(this.ctx,i,!0);q.push(Le.draw(v.series,"scatter",v.i))}if(y.series.length>0){var qe=new Ji(this.ctx,i,!0);q.push(qe.draw(y.series,"bubble",y.i))}}else switch(l.chart.type){case"line":q=K.draw(u.series,"line");break;case"area":q=K.draw(u.series,"area");break;case"bar":l.chart.stacked?q=new Me(this.ctx,i).draw(u.series):(this.ctx.bar=new rn(this.ctx,i),q=this.ctx.bar.draw(u.series));break;case"candlestick":q=new ha(this.ctx,i).draw(u.series,"candlestick");break;case"boxPlot":q=new ha(this.ctx,i).draw(u.series,l.chart.type);break;case"rangeBar":q=this.ctx.rangeBar.draw(u.series);break;case"rangeArea":q=K.draw(u.seriesRangeStart,"rangeArea",void 0,u.seriesRangeEnd);break;case"heatmap":q=new Hr(this.ctx,i).draw(u.series);break;case"treemap":q=new Bn(this.ctx,i).draw(u.series);break;case"pie":case"donut":case"polarArea":q=this.ctx.pie.draw(u.series);break;case"radialBar":q=I.draw(u.series);break;case"radar":q=W.draw(u.series);break;default:q=K.draw(u.series)}return q}},{key:"setSVGDimensions",value:function(){var r=this.w.globals,i=this.w.config;r.svgWidth=i.chart.width,r.svgHeight=i.chart.height;var o=pe.getDimensions(this.el),l=i.chart.width.toString().split(/[0-9]+/g).pop();"%"===l?pe.isNumber(o[0])&&(0===o[0].width&&(o=pe.getDimensions(this.el.parentNode)),r.svgWidth=o[0]*parseInt(i.chart.width,10)/100):"px"!==l&&""!==l||(r.svgWidth=parseInt(i.chart.width,10));var u=i.chart.height.toString().split(/[0-9]+/g).pop();if("auto"!==r.svgHeight&&""!==r.svgHeight)if("%"===u){var h=pe.getDimensions(this.el.parentNode);r.svgHeight=h[1]*parseInt(i.chart.height,10)/100}else r.svgHeight=parseInt(i.chart.height,10);else r.svgHeight=r.axisCharts?r.svgWidth/1.61:r.svgWidth/1.2;r.svgWidth<0&&(r.svgWidth=0),r.svgHeight<0&&(r.svgHeight=0),Ke.setAttrs(r.dom.Paper.node,{width:r.svgWidth,height:r.svgHeight}),"%"!==u&&(r.dom.Paper.node.parentNode.parentNode.style.minHeight=r.svgHeight+(i.chart.sparkline.enabled?0:r.axisCharts?i.chart.parentHeightOffset:0)+"px"),r.dom.elWrap.style.width=r.svgWidth+"px",r.dom.elWrap.style.height=r.svgHeight+"px"}},{key:"shiftGraphPosition",value:function(){var r=this.w.globals;Ke.setAttrs(r.dom.elGraphical.node,{transform:"translate("+r.translateX+", "+r.translateY+")"})}},{key:"resizeNonAxisCharts",value:function(){var r=this.w,i=r.globals,o=0,l=r.config.chart.sparkline.enabled?1:15;l+=r.config.grid.padding.bottom,"top"!==r.config.legend.position&&"bottom"!==r.config.legend.position||!r.config.legend.show||r.config.legend.floating||(o=new Mi(this.ctx).legendHelpers.getLegendBBox().clwh+10);var u=r.globals.dom.baseEl.querySelector(".apexcharts-radialbar, .apexcharts-pie"),h=2.05*r.globals.radialSize;if(u&&!r.config.chart.sparkline.enabled&&0!==r.config.plotOptions.radialBar.startAngle){var p=pe.getBoundingClientRect(u);h=p.bottom,h=Math.max(2.05*r.globals.radialSize,p.bottom-p.top)}var y=h+i.translateY+o+l;i.dom.elLegendForeign&&i.dom.elLegendForeign.setAttribute("height",y),r.config.chart.height&&String(r.config.chart.height).indexOf("%")>0||(i.dom.elWrap.style.height=y+"px",Ke.setAttrs(i.dom.Paper.node,{height:y}),i.dom.Paper.node.parentNode.parentNode.style.minHeight=y+"px")}},{key:"coreCalculations",value:function(){new Br(this.ctx).init()}},{key:"resetGlobals",value:function(){var r=this,i=function(){return r.w.config.series.map(function(u){return[]})},o=new Ai,l=this.w.globals;o.initGlobalVars(l),l.seriesXvalues=i(),l.seriesYvalues=i()}},{key:"isMultipleY",value:function(){if(this.w.config.yaxis.constructor===Array&&this.w.config.yaxis.length>1)return this.w.globals.isMultipleYAxis=!0,!0}},{key:"xySettings",value:function(){var r=null,i=this.w;if(i.globals.axisCharts){if("back"===i.config.xaxis.crosshairs.position&&new Da(this.ctx).drawXCrosshairs(),"back"===i.config.yaxis[0].crosshairs.position&&new Da(this.ctx).drawYCrosshairs(),"datetime"===i.config.xaxis.type&&void 0===i.config.xaxis.labels.formatter){this.ctx.timeScale=new no(this.ctx);var o=[];isFinite(i.globals.minX)&&isFinite(i.globals.maxX)&&!i.globals.isBarHorizontal?o=this.ctx.timeScale.calculateTimeScaleTicks(i.globals.minX,i.globals.maxX):i.globals.isBarHorizontal&&(o=this.ctx.timeScale.calculateTimeScaleTicks(i.globals.minY,i.globals.maxY)),this.ctx.timeScale.recalcDimensionsBasedOnFormat(o)}r=new yn(this.ctx).getCalculatedRatios()}return r}},{key:"updateSourceChart",value:function(r){this.ctx.w.globals.selection=void 0,this.ctx.updateHelpers._updateOptions({chart:{selection:{xaxis:{min:r.w.globals.minX,max:r.w.globals.maxX}}}},!1,!1)}},{key:"setupBrushHandler",value:function(){var r=this,i=this.w;if(i.config.chart.brush.enabled&&"function"!=typeof i.config.chart.events.selection){var o=Array.isArray(i.config.chart.brush.targets)?i.config.chart.brush.targets:[i.config.chart.brush.target];o.forEach(function(l){var u=ApexCharts.getChartByID(l);u.w.globals.brushSource=r.ctx,"function"!=typeof u.w.config.chart.events.zoomed&&(u.w.config.chart.events.zoomed=function(){r.updateSourceChart(u)}),"function"!=typeof u.w.config.chart.events.scrolled&&(u.w.config.chart.events.scrolled=function(){r.updateSourceChart(u)})}),i.config.chart.events.selection=function(l,u){o.forEach(function(h){ApexCharts.getChartByID(h).ctx.updateHelpers._updateOptions({xaxis:{min:u.xaxis.min,max:u.xaxis.max}},!1,!1,!1,!1)})}}}}]),P}(),Mr=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w}return me(P,[{key:"_updateOptions",value:function(r){var i=this,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],u=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],h=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return new Promise(function(p){var v=[i.ctx];u&&(v=i.ctx.getSyncedCharts()),i.ctx.w.globals.isExecCalled&&(v=[i.ctx],i.ctx.w.globals.isExecCalled=!1),v.forEach(function(y,C){var k=y.w;if(k.globals.shouldAnimate=l,o||(k.globals.resized=!0,k.globals.dataChanged=!0,l&&y.series.getPreviousPaths()),r&&"object"===ut(r)&&(y.config=new Je(r),r=yn.extendArrayProps(y.config,r,k),y.w.globals.chartID!==i.ctx.w.globals.chartID&&delete r.series,k.config=pe.extend(k.config,r),h&&(k.globals.lastXAxis=r.xaxis?pe.clone(r.xaxis):[],k.globals.lastYAxis=r.yaxis?pe.clone(r.yaxis):[],k.globals.initialConfig=pe.extend({},k.config),k.globals.initialSeries=pe.clone(k.config.series),r.series))){for(var S=0;S<k.globals.collapsedSeriesIndices.length;S++){var R=k.config.series[k.globals.collapsedSeriesIndices[S]];k.globals.collapsedSeries[S].data=k.globals.axisCharts?R.data.slice():R}for(var N=0;N<k.globals.ancillaryCollapsedSeriesIndices.length;N++){var B=k.config.series[k.globals.ancillaryCollapsedSeriesIndices[N]];k.globals.ancillaryCollapsedSeries[N].data=k.globals.axisCharts?B.data.slice():B}y.series.emptyCollapsedSeries(k.config.series)}return y.update(r).then(function(){C===v.length-1&&p(y)})})})}},{key:"_updateSeries",value:function(r,i){var o=this,l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise(function(u){var h,p=o.w;return p.globals.shouldAnimate=i,p.globals.dataChanged=!0,i&&o.ctx.series.getPreviousPaths(),p.globals.axisCharts?(0===(h=r.map(function(v,y){return o._extendSeries(v,y)})).length&&(h=[{data:[]}]),p.config.series=h):p.config.series=r.slice(),l&&(p.globals.initialConfig.series=pe.clone(p.config.series),p.globals.initialSeries=pe.clone(p.config.series)),o.ctx.update().then(function(){u(o.ctx)})})}},{key:"_extendSeries",value:function(r,i){var o=this.w,l=o.config.series[i];return Ze(Ze({},o.config.series[i]),{},{name:r.name?r.name:l?.name,color:r.color?r.color:l?.color,type:r.type?r.type:l?.type,group:r.group?r.group:l?.group,data:r.data?r.data:l?.data,zIndex:void 0!==r.zIndex?r.zIndex:i})}},{key:"toggleDataPointSelection",value:function(r,i){var o=this.w,l=null,u=".apexcharts-series[data\\:realIndex='".concat(r,"']");return o.globals.axisCharts?l=o.globals.dom.Paper.select("".concat(u," path[j='").concat(i,"'], ").concat(u," circle[j='").concat(i,"'], ").concat(u," rect[j='").concat(i,"']")).members[0]:void 0===i&&(l=o.globals.dom.Paper.select("".concat(u," path[j='").concat(r,"']")).members[0],"pie"!==o.config.chart.type&&"polarArea"!==o.config.chart.type&&"donut"!==o.config.chart.type||this.ctx.pie.pieClicked(r)),l?(new Ke(this.ctx).pathMouseDown(l,null),l.node?l.node:null):(console.warn("toggleDataPointSelection: Element not found"),null)}},{key:"forceXAxisUpdate",value:function(r){var i=this.w;if(["min","max"].forEach(function(l){void 0!==r.xaxis[l]&&(i.config.xaxis[l]=r.xaxis[l],i.globals.lastXAxis[l]=r.xaxis[l])}),r.xaxis.categories&&r.xaxis.categories.length&&(i.config.xaxis.categories=r.xaxis.categories),i.config.xaxis.convertedCatToNumeric){var o=new Nn(r);r=o.convertCatToNumericXaxis(r,this.ctx)}return r}},{key:"forceYAxisUpdate",value:function(r){return r.chart&&r.chart.stacked&&"100%"===r.chart.stackType&&(Array.isArray(r.yaxis)?r.yaxis.forEach(function(i,o){r.yaxis[o].min=0,r.yaxis[o].max=100}):(r.yaxis.min=0,r.yaxis.max=100)),r}},{key:"revertDefaultAxisMinMax",value:function(r){var i=this,o=this.w,l=o.globals.lastXAxis,u=o.globals.lastYAxis;r&&r.xaxis&&(l=r.xaxis),r&&r.yaxis&&(u=r.yaxis),o.config.xaxis.min=l.min,o.config.xaxis.max=l.max,o.config.yaxis.map(function(p,v){o.globals.zoomed||void 0!==u[v]?function(p){void 0!==u[p]&&(o.config.yaxis[p].min=u[p].min,o.config.yaxis[p].max=u[p].max)}(v):void 0!==i.ctx.opts.yaxis[v]&&(p.min=i.ctx.opts.yaxis[v].min,p.max=i.ctx.opts.yaxis[v].max)})}}]),P}();Dn=typeof window<"u"?window:void 0,Wi=function(P,r){var i=(void 0!==this?this:P).SVG=function(x){if(i.supported)return x=new i.Doc(x),i.parser.draw||i.prepare(),x};if(i.ns="http://www.w3.org/2000/svg",i.xmlns="http://www.w3.org/2000/xmlns/",i.xlink="http://www.w3.org/1999/xlink",i.svgjs="http://svgjs.dev",i.supported=!0,!i.supported)return!1;i.did=1e3,i.eid=function(x){return"Svgjs"+C(x)+i.did++},i.create=function(x){var I=r.createElementNS(this.ns,x);return I.setAttribute("id",this.eid(x)),I},i.extend=function(){var x,I;I=(x=[].slice.call(arguments)).pop();for(var W=x.length-1;W>=0;W--)if(x[W])for(var q in I)x[W].prototype[q]=I[q];i.Set&&i.Set.inherit&&i.Set.inherit()},i.invent=function(x){var I="function"==typeof x.create?x.create:function(){this.constructor.call(this,i.create(x.create))};return x.inherit&&(I.prototype=new x.inherit),x.extend&&i.extend(I,x.extend),x.construct&&i.extend(x.parent||i.Container,x.construct),I},i.adopt=function(x){return x?x.instance?x.instance:((I="svg"==x.nodeName?x.parentNode instanceof P.SVGElement?new i.Nested:new i.Doc:"linearGradient"==x.nodeName?new i.Gradient("linear"):"radialGradient"==x.nodeName?new i.Gradient("radial"):i[C(x.nodeName)]?new(i[C(x.nodeName)]):new i.Element(x)).type=x.nodeName,I.node=x,x.instance=I,I instanceof i.Doc&&I.namespace().defs(),I.setData(JSON.parse(x.getAttribute("svgjs:data"))||{}),I):null;var I},i.prepare=function(){var x=r.getElementsByTagName("body")[0],I=(x?new i.Doc(x):i.adopt(r.documentElement).nested()).size(2,0);i.parser={body:x||r.documentElement,draw:I.style("opacity:0;position:absolute;left:-100%;top:-100%;overflow:hidden").node,poly:I.polyline().node,path:I.path().node,native:i.create("svg")}},i.parser={native:i.create("svg")},r.addEventListener("DOMContentLoaded",function(){i.parser.draw||i.prepare()},!1),i.regex={numberAndUnit:/^([+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?)([a-z%]*)$/i,hex:/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,rgb:/rgb\((\d+),(\d+),(\d+)\)/,reference:/#([a-z0-9\-_]+)/i,transforms:/\)\s*,?\s*/,whitespace:/\s/g,isHex:/^#[a-f0-9]{3,6}$/i,isRgb:/^rgb\(/,isCss:/[^:]+:[^;]+;?/,isBlank:/^(\s+)?$/,isNumber:/^[+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,isPercent:/^-?[\d\.]+%$/,isImage:/\.(jpg|jpeg|png|gif|svg)(\?[^=]+.*)?/i,delimiter:/[\s,]+/,hyphen:/([^e])\-/gi,pathLetters:/[MLHVCSQTAZ]/gi,isPathLetter:/[MLHVCSQTAZ]/i,numbersWithDots:/((\d?\.\d+(?:e[+-]?\d+)?)((?:\.\d+(?:e[+-]?\d+)?)+))+/gi,dots:/\./g},i.utils={map:function(x,I){for(var W=x.length,q=[],J=0;J<W;J++)q.push(I(x[J]));return q},filter:function(x,I){for(var W=x.length,q=[],J=0;J<W;J++)I(x[J])&&q.push(x[J]);return q},filterSVGElements:function(x){return this.filter(x,function(I){return I instanceof P.SVGElement})}},i.defaults={attrs:{"fill-opacity":1,"stroke-opacity":1,"stroke-width":0,"stroke-linejoin":"miter","stroke-linecap":"butt",fill:"#000000",stroke:"#000000",opacity:1,x:0,y:0,cx:0,cy:0,width:0,height:0,r:0,rx:0,ry:0,offset:0,"stop-opacity":1,"stop-color":"#000000","font-size":16,"font-family":"Helvetica, Arial, sans-serif","text-anchor":"start"}},i.Color=function(x){var I,W;this.r=0,this.g=0,this.b=0,x&&("string"==typeof x?i.regex.isRgb.test(x)?(I=i.regex.rgb.exec(x.replace(i.regex.whitespace,"")),this.r=parseInt(I[1]),this.g=parseInt(I[2]),this.b=parseInt(I[3])):i.regex.isHex.test(x)&&(I=i.regex.hex.exec(4==(W=x).length?["#",W.substring(1,2),W.substring(1,2),W.substring(2,3),W.substring(2,3),W.substring(3,4),W.substring(3,4)].join(""):W),this.r=parseInt(I[1],16),this.g=parseInt(I[2],16),this.b=parseInt(I[3],16)):"object"===ut(x)&&(this.r=x.r,this.g=x.g,this.b=x.b))},i.extend(i.Color,{toString:function(){return this.toHex()},toHex:function(){return"#"+k(this.r)+k(this.g)+k(this.b)},toRgb:function(){return"rgb("+[this.r,this.g,this.b].join()+")"},brightness:function(){return this.r/255*.3+this.g/255*.59+this.b/255*.11},morph:function(x){return this.destination=new i.Color(x),this},at:function(x){return this.destination?new i.Color({r:~~(this.r+(this.destination.r-this.r)*(x=x<0?0:x>1?1:x)),g:~~(this.g+(this.destination.g-this.g)*x),b:~~(this.b+(this.destination.b-this.b)*x)}):this}}),i.Color.test=function(x){return i.regex.isHex.test(x+="")||i.regex.isRgb.test(x)},i.Color.isRgb=function(x){return x&&"number"==typeof x.r&&"number"==typeof x.g&&"number"==typeof x.b},i.Color.isColor=function(x){return i.Color.isRgb(x)||i.Color.test(x)},i.Array=function(x,I){0==(x=(x||[]).valueOf()).length&&I&&(x=I.valueOf()),this.value=this.parse(x)},i.extend(i.Array,{toString:function(){return this.value.join(" ")},valueOf:function(){return this.value},parse:function(x){return x=x.valueOf(),Array.isArray(x)?x:this.split(x)}}),i.PointArray=function(x,I){i.Array.call(this,x,I||[[0,0]])},i.PointArray.prototype=new i.Array,i.PointArray.prototype.constructor=i.PointArray;for(var o={M:function(x,I,W){return I.x=W.x=x[0],I.y=W.y=x[1],["M",I.x,I.y]},L:function(x,I){return I.x=x[0],I.y=x[1],["L",x[0],x[1]]},H:function(x,I){return I.x=x[0],["H",x[0]]},V:function(x,I){return I.y=x[0],["V",x[0]]},C:function(x,I){return I.x=x[4],I.y=x[5],["C",x[0],x[1],x[2],x[3],x[4],x[5]]},Q:function(x,I){return I.x=x[2],I.y=x[3],["Q",x[0],x[1],x[2],x[3]]},S:function(x,I){return I.x=x[2],I.y=x[3],["S",x[0],x[1],x[2],x[3]]},Z:function(x,I,W){return I.x=W.x,I.y=W.y,["Z"]}},l="mlhvqtcsaz".split(""),u=0,h=l.length;u<h;++u)o[l[u]]=function(x){return function(I,W,q){if("H"==x)I[0]=I[0]+W.x;else if("V"==x)I[0]=I[0]+W.y;else if("A"==x)I[5]=I[5]+W.x,I[6]=I[6]+W.y;else for(var J=0,ne=I.length;J<ne;++J)I[J]=I[J]+(J%2?W.y:W.x);if(o&&"function"==typeof o[x])return o[x](I,W,q)}}(l[u].toUpperCase());i.PathArray=function(x,I){i.Array.call(this,x,I||[["M",0,0]])},i.PathArray.prototype=new i.Array,i.PathArray.prototype.constructor=i.PathArray,i.extend(i.PathArray,{toString:function(){return function(x){for(var I=0,W=x.length,q="";I<W;I++)q+=x[I][0],null!=x[I][1]&&(q+=x[I][1],null!=x[I][2]&&(q+=" ",q+=x[I][2],null!=x[I][3]&&(q+=" ",q+=x[I][3],q+=" ",q+=x[I][4],null!=x[I][5]&&(q+=" ",q+=x[I][5],q+=" ",q+=x[I][6],null!=x[I][7]&&(q+=" ",q+=x[I][7])))));return q+" "}(this.value)},move:function(x,I){return this.bbox(),this},at:function(x){if(!this.destination)return this;for(var I=this.value,W=this.destination.value,q=[],J=new i.PathArray,ne=0,ve=I.length;ne<ve;ne++){q[ne]=[I[ne][0]];for(var ge=1,Le=I[ne].length;ge<Le;ge++)q[ne][ge]=I[ne][ge]+(W[ne][ge]-I[ne][ge])*x;"A"===q[ne][0]&&(q[ne][4]=+(0!=q[ne][4]),q[ne][5]=+(0!=q[ne][5]))}return J.value=q,J},parse:function(x){if(x instanceof i.PathArray)return x.valueOf();var I,W={M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7,Z:0};x="string"==typeof x?x.replace(i.regex.numbersWithDots,v).replace(i.regex.pathLetters," $& ").replace(i.regex.hyphen,"$1 -").trim().split(i.regex.delimiter):x.reduce(function(Le,qe){return[].concat.call(Le,qe)},[]);var q=[],J=new i.Point,ne=new i.Point,ve=0,ge=x.length;do{i.regex.isPathLetter.test(x[ve])?(I=x[ve],++ve):"M"==I?I="L":"m"==I&&(I="l"),q.push(o[I].call(null,x.slice(ve,ve+=W[I.toUpperCase()]).map(parseFloat),J,ne))}while(ge>ve);return q},bbox:function(){return i.parser.draw||i.prepare(),i.parser.path.setAttribute("d",this.toString()),i.parser.path.getBBox()}}),i.Number=i.invent({create:function(x,I){this.value=0,this.unit=I||"","number"==typeof x?this.value=isNaN(x)?0:isFinite(x)?x:x<0?-34e37:34e37:"string"==typeof x?(I=x.match(i.regex.numberAndUnit))&&(this.value=parseFloat(I[1]),"%"==I[5]?this.value/=100:"s"==I[5]&&(this.value*=1e3),this.unit=I[5]):x instanceof i.Number&&(this.value=x.valueOf(),this.unit=x.unit)},extend:{toString:function(){return("%"==this.unit?~~(1e8*this.value)/1e6:"s"==this.unit?this.value/1e3:this.value)+this.unit},toJSON:function(){return this.toString()},valueOf:function(){return this.value},plus:function(x){return x=new i.Number(x),new i.Number(this+x,this.unit||x.unit)},minus:function(x){return x=new i.Number(x),new i.Number(this-x,this.unit||x.unit)},times:function(x){return x=new i.Number(x),new i.Number(this*x,this.unit||x.unit)},divide:function(x){return x=new i.Number(x),new i.Number(this/x,this.unit||x.unit)},to:function(x){var I=new i.Number(this);return"string"==typeof x&&(I.unit=x),I},morph:function(x){return this.destination=new i.Number(x),x.relative&&(this.destination.value+=this.value),this},at:function(x){return this.destination?new i.Number(this.destination).minus(this).times(x).plus(this):this}}}),i.Element=i.invent({create:function(x){this._stroke=i.defaults.attrs.stroke,this._event=null,this.dom={},(this.node=x)&&(this.type=x.nodeName,this.node.instance=this,this._stroke=x.getAttribute("stroke")||this._stroke)},extend:{x:function(x){return this.attr("x",x)},y:function(x){return this.attr("y",x)},cx:function(x){return null==x?this.x()+this.width()/2:this.x(x-this.width()/2)},cy:function(x){return null==x?this.y()+this.height()/2:this.y(x-this.height()/2)},move:function(x,I){return this.x(x).y(I)},center:function(x,I){return this.cx(x).cy(I)},width:function(x){return this.attr("width",x)},height:function(x){return this.attr("height",x)},size:function(x,I){var W=S(this,x,I);return this.width(new i.Number(W.width)).height(new i.Number(W.height))},clone:function(x){this.writeDataToDom();var I=B(this.node.cloneNode(!0));return x?x.add(I):this.after(I),I},remove:function(){return this.parent()&&this.parent().removeElement(this),this},replace:function(x){return this.after(x).remove(),x},addTo:function(x){return x.put(this)},putIn:function(x){return x.add(this)},id:function(x){return this.attr("id",x)},show:function(){return this.style("display","")},hide:function(){return this.style("display","none")},visible:function(){return"none"!=this.style("display")},toString:function(){return this.attr("id")},classes:function(){var x=this.attr("class");return null==x?[]:x.trim().split(i.regex.delimiter)},hasClass:function(x){return-1!=this.classes().indexOf(x)},addClass:function(x){if(!this.hasClass(x)){var I=this.classes();I.push(x),this.attr("class",I.join(" "))}return this},removeClass:function(x){return this.hasClass(x)&&this.attr("class",this.classes().filter(function(I){return I!=x}).join(" ")),this},toggleClass:function(x){return this.hasClass(x)?this.removeClass(x):this.addClass(x)},reference:function(x){return i.get(this.attr(x))},parent:function(x){var I=this;if(!I.node.parentNode)return null;if(I=i.adopt(I.node.parentNode),!x)return I;for(;I&&I.node instanceof P.SVGElement;){if("string"==typeof x?I.matches(x):I instanceof x)return I;if(!I.node.parentNode||"#document"==I.node.parentNode.nodeName)return null;I=i.adopt(I.node.parentNode)}},doc:function(){return this instanceof i.Doc?this:this.parent(i.Doc)},parents:function(x){var I=[],W=this;do{if(!(W=W.parent(x))||!W.node)break;I.push(W)}while(W.parent);return I},matches:function(x){return((I=this.node).matches||I.matchesSelector||I.msMatchesSelector||I.mozMatchesSelector||I.webkitMatchesSelector||I.oMatchesSelector).call(I,x);var I},native:function(){return this.node},svg:function(x){var I=r.createElementNS("http://www.w3.org/2000/svg","svg");if(!(x&&this instanceof i.Parent))return I.appendChild(x=r.createElementNS("http://www.w3.org/2000/svg","svg")),this.writeDataToDom(),x.appendChild(this.node.cloneNode(!0)),I.innerHTML.replace(/^<svg>/,"").replace(/<\/svg>$/,"");I.innerHTML="<svg>"+x.replace(/\n/,"").replace(/<([\w:-]+)([^<]+?)\/>/g,"<$1$2></$1>")+"</svg>";for(var W=0,q=I.firstChild.childNodes.length;W<q;W++)this.node.appendChild(I.firstChild.firstChild);return this},writeDataToDom:function(){return(this.each||this.lines)&&(this.each?this:this.lines()).each(function(){this.writeDataToDom()}),this.node.removeAttribute("svgjs:data"),Object.keys(this.dom).length&&this.node.setAttribute("svgjs:data",JSON.stringify(this.dom)),this},setData:function(x){return this.dom=x,this},is:function(x){return this instanceof x}}}),i.easing={"-":function(x){return x},"<>":function(x){return-Math.cos(x*Math.PI)/2+.5},">":function(x){return Math.sin(x*Math.PI/2)},"<":function(x){return 1-Math.cos(x*Math.PI/2)}},i.morph=function(x){return function(I,W){return new i.MorphObj(I,W).at(x)}},i.Situation=i.invent({create:function(x){this.init=!1,this.reversed=!1,this.reversing=!1,this.duration=new i.Number(x.duration).valueOf(),this.delay=new i.Number(x.delay).valueOf(),this.start=+new Date+this.delay,this.finish=this.start+this.duration,this.ease=x.ease,this.loop=0,this.loops=!1,this.animations={},this.attrs={},this.styles={},this.transforms=[],this.once={}}}),i.FX=i.invent({create:function(x){this._target=x,this.situations=[],this.active=!1,this.situation=null,this.paused=!1,this.lastPos=0,this.pos=0,this.absPos=0,this._speed=1},extend:{animate:function(x,I,W){"object"===ut(x)&&(I=x.ease,W=x.delay,x=x.duration);var q=new i.Situation({duration:x||1e3,delay:W||0,ease:i.easing[I||"-"]||I});return this.queue(q),this},target:function(x){return x&&x instanceof i.Element?(this._target=x,this):this._target},timeToAbsPos:function(x){return(x-this.situation.start)/(this.situation.duration/this._speed)},absPosToTime:function(x){return this.situation.duration/this._speed*x+this.situation.start},startAnimFrame:function(){this.stopAnimFrame(),this.animationFrame=P.requestAnimationFrame(function(){this.step()}.bind(this))},stopAnimFrame:function(){P.cancelAnimationFrame(this.animationFrame)},start:function(){return!this.active&&this.situation&&(this.active=!0,this.startCurrent()),this},startCurrent:function(){return this.situation.start=+new Date+this.situation.delay/this._speed,this.situation.finish=this.situation.start+this.situation.duration/this._speed,this.initAnimations().step()},queue:function(x){return("function"==typeof x||x instanceof i.Situation)&&this.situations.push(x),this.situation||(this.situation=this.situations.shift()),this},dequeue:function(){return this.stop(),this.situation=this.situations.shift(),this.situation&&(this.situation instanceof i.Situation?this.start():this.situation.call(this)),this},initAnimations:function(){var x,I=this.situation;if(I.init)return this;for(var W in I.animations){x=this.target()[W](),Array.isArray(x)||(x=[x]),Array.isArray(I.animations[W])||(I.animations[W]=[I.animations[W]]);for(var q=x.length;q--;)I.animations[W][q]instanceof i.Number&&(x[q]=new i.Number(x[q])),I.animations[W][q]=x[q].morph(I.animations[W][q])}for(var W in I.attrs)I.attrs[W]=new i.MorphObj(this.target().attr(W),I.attrs[W]);for(var W in I.styles)I.styles[W]=new i.MorphObj(this.target().style(W),I.styles[W]);return I.initialTransformation=this.target().matrixify(),I.init=!0,this},clearQueue:function(){return this.situations=[],this},clearCurrent:function(){return this.situation=null,this},stop:function(x,I){var W=this.active;return this.active=!1,I&&this.clearQueue(),x&&this.situation&&(!W&&this.startCurrent(),this.atEnd()),this.stopAnimFrame(),this.clearCurrent()},after:function(x){var I=this.last();return this.target().on("finished.fx",function W(q){q.detail.situation==I&&(x.call(this,I),this.off("finished.fx",W))}),this._callStart()},during:function(x){var I=this.last(),W=function(q){q.detail.situation==I&&x.call(this,q.detail.pos,i.morph(q.detail.pos),q.detail.eased,I)};return this.target().off("during.fx",W).on("during.fx",W),this.after(function(){this.off("during.fx",W)}),this._callStart()},afterAll:function(x){var I=function W(q){x.call(this),this.off("allfinished.fx",W)};return this.target().off("allfinished.fx",I).on("allfinished.fx",I),this._callStart()},last:function(){return this.situations.length?this.situations[this.situations.length-1]:this.situation},add:function(x,I,W){return this.last()[W||"animations"][x]=I,this._callStart()},step:function(x){var I,W,q;x||(this.absPos=this.timeToAbsPos(+new Date)),!1!==this.situation.loops?(I=Math.max(this.absPos,0),W=Math.floor(I),!0===this.situation.loops||W<this.situation.loops?(this.pos=I-W,q=this.situation.loop,this.situation.loop=W):(this.absPos=this.situation.loops,this.pos=1,q=this.situation.loop-1,this.situation.loop=this.situation.loops),this.situation.reversing&&(this.situation.reversed=this.situation.reversed!=!!((this.situation.loop-q)%2))):(this.absPos=Math.min(this.absPos,1),this.pos=this.absPos),this.pos<0&&(this.pos=0),this.situation.reversed&&(this.pos=1-this.pos);var J=this.situation.ease(this.pos);for(var ne in this.situation.once)ne>this.lastPos&&ne<=J&&(this.situation.once[ne].call(this.target(),this.pos,J),delete this.situation.once[ne]);return this.active&&this.target().fire("during",{pos:this.pos,eased:J,fx:this,situation:this.situation}),this.situation?(this.eachAt(),1==this.pos&&!this.situation.reversed||this.situation.reversed&&0==this.pos?(this.stopAnimFrame(),this.target().fire("finished",{fx:this,situation:this.situation}),this.situations.length||(this.target().fire("allfinished"),this.situations.length||(this.target().off(".fx"),this.active=!1)),this.active?this.dequeue():this.clearCurrent()):!this.paused&&this.active&&this.startAnimFrame(),this.lastPos=J,this):this},eachAt:function(){var x,I=this,W=this.target(),q=this.situation;for(var J in q.animations)x=[].concat(q.animations[J]).map(function(ge){return"string"!=typeof ge&&ge.at?ge.at(q.ease(I.pos),I.pos):ge}),W[J].apply(W,x);for(var J in q.attrs)x=[J].concat(q.attrs[J]).map(function(Le){return"string"!=typeof Le&&Le.at?Le.at(q.ease(I.pos),I.pos):Le}),W.attr.apply(W,x);for(var J in q.styles)x=[J].concat(q.styles[J]).map(function(Le){return"string"!=typeof Le&&Le.at?Le.at(q.ease(I.pos),I.pos):Le}),W.style.apply(W,x);if(q.transforms.length){x=q.initialTransformation,J=0;for(var ne=q.transforms.length;J<ne;J++){var ve=q.transforms[J];ve instanceof i.Matrix?x=ve.relative?x.multiply((new i.Matrix).morph(ve).at(q.ease(this.pos))):x.morph(ve).at(q.ease(this.pos)):(ve.relative||ve.undo(x.extract()),x=x.multiply(ve.at(q.ease(this.pos))))}W.matrix(x)}return this},once:function(x,I,W){var q=this.last();return W||(x=q.ease(x)),q.once[x]=I,this},_callStart:function(){return setTimeout(function(){this.start()}.bind(this),0),this}},parent:i.Element,construct:{animate:function(x,I,W){return(this.fx||(this.fx=new i.FX(this))).animate(x,I,W)},delay:function(x){return(this.fx||(this.fx=new i.FX(this))).delay(x)},stop:function(x,I){return this.fx&&this.fx.stop(x,I),this},finish:function(){return this.fx&&this.fx.finish(),this}}}),i.MorphObj=i.invent({create:function(x,I){return i.Color.isColor(I)?new i.Color(x).morph(I):i.regex.delimiter.test(x)?i.regex.pathLetters.test(x)?new i.PathArray(x).morph(I):new i.Array(x).morph(I):i.regex.numberAndUnit.test(I)?new i.Number(x).morph(I):(this.value=x,void(this.destination=I))},extend:{at:function(x,I){return I<1?this.value:this.destination},valueOf:function(){return this.value}}}),i.extend(i.FX,{attr:function(x,I,W){if("object"===ut(x))for(var q in x)this.attr(q,x[q]);else this.add(x,I,"attrs");return this},plot:function(x,I,W,q){return 4==arguments.length?this.plot([x,I,W,q]):this.add("plot",new(this.target().morphArray)(x))}}),i.Box=i.invent({create:function(x,I,W,q){if(!("object"!==ut(x)||x instanceof i.Element))return i.Box.call(this,null!=x.left?x.left:x.x,null!=x.top?x.top:x.y,x.width,x.height);var J;4==arguments.length&&(this.x=x,this.y=I,this.width=W,this.height=q),null==(J=this).x&&(J.x=0,J.y=0,J.width=0,J.height=0),J.w=J.width,J.h=J.height,J.x2=J.x+J.width,J.y2=J.y+J.height,J.cx=J.x+J.width/2,J.cy=J.y+J.height/2}}),i.BBox=i.invent({create:function(x){if(i.Box.apply(this,[].slice.call(arguments)),x instanceof i.Element){var I;try{if(!r.documentElement.contains){for(var W=x.node;W.parentNode;)W=W.parentNode;if(W!=r)throw new Error("Element not in the dom")}I=x.node.getBBox()}catch{if(x instanceof i.Shape){i.parser.draw||i.prepare();var q=x.clone(i.parser.draw.instance).show();q&&q.node&&"function"==typeof q.node.getBBox&&(I=q.node.getBBox()),q&&"function"==typeof q.remove&&q.remove()}else I={x:x.node.clientLeft,y:x.node.clientTop,width:x.node.clientWidth,height:x.node.clientHeight}}i.Box.call(this,I)}},inherit:i.Box,parent:i.Element,construct:{bbox:function(){return new i.BBox(this)}}}),i.BBox.prototype.constructor=i.BBox,i.Matrix=i.invent({create:function(x){var I=N([1,0,0,1,0,0]);x=null===x?I:x instanceof i.Element?x.matrixify():"string"==typeof x?N(x.split(i.regex.delimiter).map(parseFloat)):6==arguments.length?N([].slice.call(arguments)):Array.isArray(x)?N(x):x&&"object"===ut(x)?x:I;for(var W=j.length-1;W>=0;--W)this[j[W]]=null!=x[j[W]]?x[j[W]]:I[j[W]]},extend:{extract:function(){var x=R(this,0,1);R(this,1,0);var I=180/Math.PI*Math.atan2(x.y,x.x)-90;return{x:this.e,y:this.f,transformedX:(this.e*Math.cos(I*Math.PI/180)+this.f*Math.sin(I*Math.PI/180))/Math.sqrt(this.a*this.a+this.b*this.b),transformedY:(this.f*Math.cos(I*Math.PI/180)+this.e*Math.sin(-I*Math.PI/180))/Math.sqrt(this.c*this.c+this.d*this.d),rotation:I,a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f,matrix:new i.Matrix(this)}},clone:function(){return new i.Matrix(this)},morph:function(x){return this.destination=new i.Matrix(x),this},multiply:function(x){return new i.Matrix(this.native().multiply((I=x,I instanceof i.Matrix||(I=new i.Matrix(I)),I).native()));var I},inverse:function(){return new i.Matrix(this.native().inverse())},translate:function(x,I){return new i.Matrix(this.native().translate(x||0,I||0))},native:function(){for(var x=i.parser.native.createSVGMatrix(),I=j.length-1;I>=0;I--)x[j[I]]=this[j[I]];return x},toString:function(){return"matrix("+U(this.a)+","+U(this.b)+","+U(this.c)+","+U(this.d)+","+U(this.e)+","+U(this.f)+")"}},parent:i.Element,construct:{ctm:function(){return new i.Matrix(this.node.getCTM())},screenCTM:function(){if(this instanceof i.Nested){var x=this.rect(1,1),I=x.node.getScreenCTM();return x.remove(),new i.Matrix(I)}return new i.Matrix(this.node.getScreenCTM())}}}),i.Point=i.invent({create:function(x,I){var W;W=Array.isArray(x)?{x:x[0],y:x[1]}:"object"===ut(x)?{x:x.x,y:x.y}:null!=x?{x,y:I??x}:{x:0,y:0},this.x=W.x,this.y=W.y},extend:{clone:function(){return new i.Point(this)},morph:function(x,I){return this.destination=new i.Point(x,I),this}}}),i.extend(i.Element,{point:function(x,I){return new i.Point(x,I).transform(this.screenCTM().inverse())}}),i.extend(i.Element,{attr:function(x,I,W){if(null==x){for(x={},W=(I=this.node.attributes).length-1;W>=0;W--)x[I[W].nodeName]=i.regex.isNumber.test(I[W].nodeValue)?parseFloat(I[W].nodeValue):I[W].nodeValue;return x}if("object"===ut(x))for(var q in x)this.attr(q,x[q]);else if(null===I)this.node.removeAttribute(x);else{if(null==I)return null==(I=this.node.getAttribute(x))?i.defaults.attrs[x]:i.regex.isNumber.test(I)?parseFloat(I):I;"stroke-width"==x?this.attr("stroke",parseFloat(I)>0?this._stroke:null):"stroke"==x&&(this._stroke=I),"fill"!=x&&"stroke"!=x||(i.regex.isImage.test(I)&&(I=this.doc().defs().image(I,0,0)),I instanceof i.Image&&(I=this.doc().defs().pattern(0,0,function(){this.add(I)}))),"number"==typeof I?I=new i.Number(I):i.Color.isColor(I)?I=new i.Color(I):Array.isArray(I)&&(I=new i.Array(I)),"leading"==x?this.leading&&this.leading(I):"string"==typeof W?this.node.setAttributeNS(W,x,I.toString()):this.node.setAttribute(x,I.toString()),!this.rebuild||"font-size"!=x&&"x"!=x||this.rebuild(x,I)}return this}}),i.extend(i.Element,{transform:function(x,I){var W;return"object"!==ut(x)?(W=new i.Matrix(this).extract(),"string"==typeof x?W[x]:W):(W=new i.Matrix(this),I=!!I||!!x.relative,null!=x.a&&(W=I?W.multiply(new i.Matrix(x)):new i.Matrix(x)),this.attr("transform",W))}}),i.extend(i.Element,{untransform:function(){return this.attr("transform",null)},matrixify:function(){return(this.attr("transform")||"").split(i.regex.transforms).slice(0,-1).map(function(x){var I=x.trim().split("(");return[I[0],I[1].split(i.regex.delimiter).map(function(W){return parseFloat(W)})]}).reduce(function(x,I){return"matrix"==I[0]?x.multiply(N(I[1])):x[I[0]].apply(x,I[1])},new i.Matrix)},toParent:function(x){if(this==x)return this;var I=this.screenCTM(),W=x.screenCTM().inverse();return this.addTo(x).untransform().transform(W.multiply(I)),this},toDoc:function(){return this.toParent(this.doc())}}),i.Transformation=i.invent({create:function(x,I){if(arguments.length>1&&"boolean"!=typeof I)return this.constructor.call(this,[].slice.call(arguments));if(Array.isArray(x))for(var W=0,q=this.arguments.length;W<q;++W)this[this.arguments[W]]=x[W];else if(x&&"object"===ut(x))for(W=0,q=this.arguments.length;W<q;++W)this[this.arguments[W]]=x[this.arguments[W]];this.inversed=!1,!0===I&&(this.inversed=!0)}}),i.Translate=i.invent({parent:i.Matrix,inherit:i.Transformation,create:function(x,I){this.constructor.apply(this,[].slice.call(arguments))},extend:{arguments:["transformedX","transformedY"],method:"translate"}}),i.extend(i.Element,{style:function(x,I){if(0==arguments.length)return this.node.style.cssText||"";if(arguments.length<2)if("object"===ut(x))for(var W in x)this.style(W,x[W]);else{if(!i.regex.isCss.test(x))return this.node.style[y(x)];for(x=x.split(/\s*;\s*/).filter(function(q){return!!q}).map(function(q){return q.split(/\s*:\s*/)});I=x.pop();)this.style(I[0],I[1])}else this.node.style[y(x)]=null===I||i.regex.isBlank.test(I)?"":I;return this}}),i.Parent=i.invent({create:function(x){this.constructor.call(this,x)},inherit:i.Element,extend:{children:function(){return i.utils.map(i.utils.filterSVGElements(this.node.childNodes),function(x){return i.adopt(x)})},add:function(x,I){return null==I?this.node.appendChild(x.node):x.node!=this.node.childNodes[I]&&this.node.insertBefore(x.node,this.node.childNodes[I]),this},put:function(x,I){return this.add(x,I),x},has:function(x){return this.index(x)>=0},index:function(x){return[].slice.call(this.node.childNodes).indexOf(x.node)},get:function(x){return i.adopt(this.node.childNodes[x])},first:function(){return this.get(0)},last:function(){return this.get(this.node.childNodes.length-1)},each:function(x,I){for(var W=this.children(),q=0,J=W.length;q<J;q++)W[q]instanceof i.Element&&x.apply(W[q],[q,W]),I&&W[q]instanceof i.Container&&W[q].each(x,I);return this},removeElement:function(x){return this.node.removeChild(x.node),this},clear:function(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return delete this._defs,this},defs:function(){return this.doc().defs()}}}),i.extend(i.Parent,{ungroup:function(x,I){return 0===I||this instanceof i.Defs||this.node==i.parser.draw||(x=x||(this instanceof i.Doc?this:this.parent(i.Parent)),I=I||1/0,this.each(function(){return this instanceof i.Defs?this:this instanceof i.Parent?this.ungroup(x,I-1):this.toParent(x)}),this.node.firstChild||this.remove()),this},flatten:function(x,I){return this.ungroup(x,I)}}),i.Container=i.invent({create:function(x){this.constructor.call(this,x)},inherit:i.Parent}),i.ViewBox=i.invent({parent:i.Container,construct:{}}),["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","touchstart","touchmove","touchleave","touchend","touchcancel"].forEach(function(x){i.Element.prototype[x]=function(I){return i.on(this.node,x,I),this}}),i.listeners=[],i.handlerMap=[],i.listenerId=0,i.on=function(x,I,W,q,J){var ne=W.bind(q||x.instance||x),ve=(i.handlerMap.indexOf(x)+1||i.handlerMap.push(x))-1,ge=I.split(".")[0],Le=I.split(".")[1]||"*";i.listeners[ve]=i.listeners[ve]||{},i.listeners[ve][ge]=i.listeners[ve][ge]||{},i.listeners[ve][ge][Le]=i.listeners[ve][ge][Le]||{},W._svgjsListenerId||(W._svgjsListenerId=++i.listenerId),i.listeners[ve][ge][Le][W._svgjsListenerId]=ne,x.addEventListener(ge,ne,J||{passive:!1})},i.off=function(x,I,W){var q=i.handlerMap.indexOf(x),J=I&&I.split(".")[0],ne=I&&I.split(".")[1],ve="";if(-1!=q)if(W){if("function"==typeof W&&(W=W._svgjsListenerId),!W)return;i.listeners[q][J]&&i.listeners[q][J][ne||"*"]&&(x.removeEventListener(J,i.listeners[q][J][ne||"*"][W],!1),delete i.listeners[q][J][ne||"*"][W])}else if(ne&&J){if(i.listeners[q][J]&&i.listeners[q][J][ne]){for(var ge in i.listeners[q][J][ne])i.off(x,[J,ne].join("."),ge);delete i.listeners[q][J][ne]}}else if(ne)for(var Le in i.listeners[q])for(var ve in i.listeners[q][Le])ne===ve&&i.off(x,[Le,ne].join("."));else if(J){if(i.listeners[q][J]){for(var ve in i.listeners[q][J])i.off(x,[J,ve].join("."));delete i.listeners[q][J]}}else{for(var Le in i.listeners[q])i.off(x,Le);delete i.listeners[q],delete i.handlerMap[q]}},i.extend(i.Element,{on:function(x,I,W,q){return i.on(this.node,x,I,W,q),this},off:function(x,I){return i.off(this.node,x,I),this},fire:function(x,I){return this.node.dispatchEvent(x instanceof P.Event?x:x=new i.CustomEvent(x,{detail:I,cancelable:!0})),this._event=x,this},event:function(){return this._event}}),i.Defs=i.invent({create:"defs",inherit:i.Container}),i.G=i.invent({create:"g",inherit:i.Container,extend:{x:function(x){return null==x?this.transform("x"):this.transform({x:x-this.x()},!0)}},construct:{group:function(){return this.put(new i.G)}}}),i.Doc=i.invent({create:function(x){x&&("svg"==(x="string"==typeof x?r.getElementById(x):x).nodeName?this.constructor.call(this,x):(this.constructor.call(this,i.create("svg")),x.appendChild(this.node),this.size("100%","100%")),this.namespace().defs())},inherit:i.Container,extend:{namespace:function(){return this.attr({xmlns:i.ns,version:"1.1"}).attr("xmlns:xlink",i.xlink,i.xmlns).attr("xmlns:svgjs",i.svgjs,i.xmlns)},defs:function(){var x;return this._defs||(this._defs=(x=this.node.getElementsByTagName("defs")[0])?i.adopt(x):new i.Defs,this.node.appendChild(this._defs.node)),this._defs},parent:function(){return this.node.parentNode&&"#document"!=this.node.parentNode.nodeName?this.node.parentNode:null},remove:function(){return this.parent()&&this.parent().removeChild(this.node),this},clear:function(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return delete this._defs,i.parser.draw&&!i.parser.draw.parentNode&&this.node.appendChild(i.parser.draw),this},clone:function(x){this.writeDataToDom();var I=this.node,W=B(I.cloneNode(!0));return x?(x.node||x).appendChild(W.node):I.parentNode.insertBefore(W.node,I.nextSibling),W}}}),i.extend(i.Element,{}),i.Gradient=i.invent({create:function(x){this.constructor.call(this,i.create(x+"Gradient")),this.type=x},inherit:i.Container,extend:{at:function(x,I,W){return this.put(new i.Stop).update(x,I,W)},update:function(x){return this.clear(),"function"==typeof x&&x.call(this,this),this},fill:function(){return"url(#"+this.id()+")"},toString:function(){return this.fill()},attr:function(x,I,W){return"transform"==x&&(x="gradientTransform"),i.Container.prototype.attr.call(this,x,I,W)}},construct:{gradient:function(x,I){return this.defs().gradient(x,I)}}}),i.extend(i.Gradient,i.FX,{from:function(x,I){return this.attr("radial"==(this._target||this).type?{fx:new i.Number(x),fy:new i.Number(I)}:{x1:new i.Number(x),y1:new i.Number(I)})},to:function(x,I){return this.attr("radial"==(this._target||this).type?{cx:new i.Number(x),cy:new i.Number(I)}:{x2:new i.Number(x),y2:new i.Number(I)})}}),i.extend(i.Defs,{gradient:function(x,I){return this.put(new i.Gradient(x)).update(I)}}),i.Stop=i.invent({create:"stop",inherit:i.Element,extend:{update:function(x){return("number"==typeof x||x instanceof i.Number)&&(x={offset:arguments[0],color:arguments[1],opacity:arguments[2]}),null!=x.opacity&&this.attr("stop-opacity",x.opacity),null!=x.color&&this.attr("stop-color",x.color),null!=x.offset&&this.attr("offset",new i.Number(x.offset)),this}}}),i.Pattern=i.invent({create:"pattern",inherit:i.Container,extend:{fill:function(){return"url(#"+this.id()+")"},update:function(x){return this.clear(),"function"==typeof x&&x.call(this,this),this},toString:function(){return this.fill()},attr:function(x,I,W){return"transform"==x&&(x="patternTransform"),i.Container.prototype.attr.call(this,x,I,W)}},construct:{pattern:function(x,I,W){return this.defs().pattern(x,I,W)}}}),i.extend(i.Defs,{pattern:function(x,I,W){return this.put(new i.Pattern).update(W).attr({x:0,y:0,width:x,height:I,patternUnits:"userSpaceOnUse"})}}),i.Shape=i.invent({create:function(x){this.constructor.call(this,x)},inherit:i.Element}),i.Symbol=i.invent({create:"symbol",inherit:i.Container,construct:{symbol:function(){return this.put(new i.Symbol)}}}),i.Use=i.invent({create:"use",inherit:i.Shape,extend:{element:function(x,I){return this.attr("href",(I||"")+"#"+x,i.xlink)}},construct:{use:function(x,I){return this.put(new i.Use).element(x,I)}}}),i.Rect=i.invent({create:"rect",inherit:i.Shape,construct:{rect:function(x,I){return this.put(new i.Rect).size(x,I)}}}),i.Circle=i.invent({create:"circle",inherit:i.Shape,construct:{circle:function(x){return this.put(new i.Circle).rx(new i.Number(x).divide(2)).move(0,0)}}}),i.extend(i.Circle,i.FX,{rx:function(x){return this.attr("r",x)},ry:function(x){return this.rx(x)}}),i.Ellipse=i.invent({create:"ellipse",inherit:i.Shape,construct:{ellipse:function(x,I){return this.put(new i.Ellipse).size(x,I).move(0,0)}}}),i.extend(i.Ellipse,i.Rect,i.FX,{rx:function(x){return this.attr("rx",x)},ry:function(x){return this.attr("ry",x)}}),i.extend(i.Circle,i.Ellipse,{x:function(x){return null==x?this.cx()-this.rx():this.cx(x+this.rx())},y:function(x){return null==x?this.cy()-this.ry():this.cy(x+this.ry())},cx:function(x){return null==x?this.attr("cx"):this.attr("cx",x)},cy:function(x){return null==x?this.attr("cy"):this.attr("cy",x)},width:function(x){return null==x?2*this.rx():this.rx(new i.Number(x).divide(2))},height:function(x){return null==x?2*this.ry():this.ry(new i.Number(x).divide(2))},size:function(x,I){var W=S(this,x,I);return this.rx(new i.Number(W.width).divide(2)).ry(new i.Number(W.height).divide(2))}}),i.Line=i.invent({create:"line",inherit:i.Shape,extend:{array:function(){return new i.PointArray([[this.attr("x1"),this.attr("y1")],[this.attr("x2"),this.attr("y2")]])},plot:function(x,I,W,q){return null==x?this.array():(x=void 0!==I?{x1:x,y1:I,x2:W,y2:q}:new i.PointArray(x).toLine(),this.attr(x))},move:function(x,I){return this.attr(this.array().move(x,I).toLine())},size:function(x,I){var W=S(this,x,I);return this.attr(this.array().size(W.width,W.height).toLine())}},construct:{line:function(x,I,W,q){return i.Line.prototype.plot.apply(this.put(new i.Line),null!=x?[x,I,W,q]:[0,0,0,0])}}}),i.Polyline=i.invent({create:"polyline",inherit:i.Shape,construct:{polyline:function(x){return this.put(new i.Polyline).plot(x||new i.PointArray)}}}),i.Polygon=i.invent({create:"polygon",inherit:i.Shape,construct:{polygon:function(x){return this.put(new i.Polygon).plot(x||new i.PointArray)}}}),i.extend(i.Polyline,i.Polygon,{array:function(){return this._array||(this._array=new i.PointArray(this.attr("points")))},plot:function(x){return null==x?this.array():this.clear().attr("points","string"==typeof x?x:this._array=new i.PointArray(x))},clear:function(){return delete this._array,this},move:function(x,I){return this.attr("points",this.array().move(x,I))},size:function(x,I){var W=S(this,x,I);return this.attr("points",this.array().size(W.width,W.height))}}),i.extend(i.Line,i.Polyline,i.Polygon,{morphArray:i.PointArray,x:function(x){return null==x?this.bbox().x:this.move(x,this.bbox().y)},y:function(x){return null==x?this.bbox().y:this.move(this.bbox().x,x)},width:function(x){var I=this.bbox();return null==x?I.width:this.size(x,I.height)},height:function(x){var I=this.bbox();return null==x?I.height:this.size(I.width,x)}}),i.Path=i.invent({create:"path",inherit:i.Shape,extend:{morphArray:i.PathArray,array:function(){return this._array||(this._array=new i.PathArray(this.attr("d")))},plot:function(x){return null==x?this.array():this.clear().attr("d","string"==typeof x?x:this._array=new i.PathArray(x))},clear:function(){return delete this._array,this}},construct:{path:function(x){return this.put(new i.Path).plot(x||new i.PathArray)}}}),i.Image=i.invent({create:"image",inherit:i.Shape,extend:{load:function(x){if(!x)return this;var I=this,W=new P.Image;return i.on(W,"load",function(){i.off(W);var q=I.parent(i.Pattern);null!==q&&(0==I.width()&&0==I.height()&&I.size(W.width,W.height),q&&0==q.width()&&0==q.height()&&q.size(I.width(),I.height()),"function"==typeof I._loaded&&I._loaded.call(I,{width:W.width,height:W.height,ratio:W.width/W.height,url:x}))}),i.on(W,"error",function(q){i.off(W),"function"==typeof I._error&&I._error.call(I,q)}),this.attr("href",W.src=this.src=x,i.xlink)},loaded:function(x){return this._loaded=x,this},error:function(x){return this._error=x,this}},construct:{image:function(x,I,W){return this.put(new i.Image).load(x).size(I||0,W||I||0)}}}),i.Text=i.invent({create:function(){this.constructor.call(this,i.create("text")),this.dom.leading=new i.Number(1.3),this._rebuild=!0,this._build=!1,this.attr("font-family",i.defaults.attrs["font-family"])},inherit:i.Shape,extend:{x:function(x){return null==x?this.attr("x"):this.attr("x",x)},text:function(x){if(void 0===x){x="";for(var I=this.node.childNodes,W=0,q=I.length;W<q;++W)0!=W&&3!=I[W].nodeType&&1==i.adopt(I[W]).dom.newLined&&(x+="\n"),x+=I[W].textContent;return x}if(this.clear().build(!0),"function"==typeof x)x.call(this,this);else{W=0;for(var J=(x=x.split("\n")).length;W<J;W++)this.tspan(x[W]).newLine()}return this.build(!1).rebuild()},size:function(x){return this.attr("font-size",x).rebuild()},leading:function(x){return null==x?this.dom.leading:(this.dom.leading=new i.Number(x),this.rebuild())},lines:function(){var x=(this.textPath&&this.textPath()||this).node,I=i.utils.map(i.utils.filterSVGElements(x.childNodes),function(W){return i.adopt(W)});return new i.Set(I)},rebuild:function(x){if("boolean"==typeof x&&(this._rebuild=x),this._rebuild){var I=this,W=0,q=this.dom.leading*new i.Number(this.attr("font-size"));this.lines().each(function(){this.dom.newLined&&(I.textPath()||this.attr("x",I.attr("x")),"\n"==this.text()?W+=q:(this.attr("dy",q+W),W=0))}),this.fire("rebuild")}return this},build:function(x){return this._build=!!x,this},setData:function(x){return this.dom=x,this.dom.leading=new i.Number(x.leading||1.3),this}},construct:{text:function(x){return this.put(new i.Text).text(x)},plain:function(x){return this.put(new i.Text).plain(x)}}}),i.Tspan=i.invent({create:"tspan",inherit:i.Shape,extend:{text:function(x){return null==x?this.node.textContent+(this.dom.newLined?"\n":""):("function"==typeof x?x.call(this,this):this.plain(x),this)},dx:function(x){return this.attr("dx",x)},dy:function(x){return this.attr("dy",x)},newLine:function(){var x=this.parent(i.Text);return this.dom.newLined=!0,this.dy(x.dom.leading*x.attr("font-size")).attr("x",x.x())}}}),i.extend(i.Text,i.Tspan,{plain:function(x){return!1===this._build&&this.clear(),this.node.appendChild(r.createTextNode(x)),this},tspan:function(x){var I=(this.textPath&&this.textPath()||this).node,W=new i.Tspan;return!1===this._build&&this.clear(),I.appendChild(W.node),W.text(x)},clear:function(){for(var x=(this.textPath&&this.textPath()||this).node;x.hasChildNodes();)x.removeChild(x.lastChild);return this},length:function(){return this.node.getComputedTextLength()}}),i.TextPath=i.invent({create:"textPath",inherit:i.Parent,parent:i.Text,construct:{morphArray:i.PathArray,array:function(){var x=this.track();return x?x.array():null},plot:function(x){var I=this.track(),W=null;return I&&(W=I.plot(x)),null==x?W:this},track:function(){var x=this.textPath();if(x)return x.reference("href")},textPath:function(){if(this.node.firstChild&&"textPath"==this.node.firstChild.nodeName)return i.adopt(this.node.firstChild)}}}),i.Nested=i.invent({create:function(){this.constructor.call(this,i.create("svg")),this.style("overflow","visible")},inherit:i.Container,construct:{nested:function(){return this.put(new i.Nested)}}});var p={stroke:["color","width","opacity","linecap","linejoin","miterlimit","dasharray","dashoffset"],fill:["color","opacity","rule"],prefix:function(x,I){return"color"==I?x:x+"-"+I}};function v(x,I,W,q){return W+q.replace(i.regex.dots," .")}function y(x){return x.toLowerCase().replace(/-(.)/g,function(I,W){return W.toUpperCase()})}function C(x){return x.charAt(0).toUpperCase()+x.slice(1)}function k(x){var I=x.toString(16);return 1==I.length?"0"+I:I}function S(x,I,W){if(null==I||null==W){var q=x.bbox();null==I?I=q.width/q.height*W:null==W&&(W=q.height/q.width*I)}return{width:I,height:W}}function R(x,I,W){return{x:I*x.a+W*x.c+0,y:I*x.b+W*x.d+0}}function N(x){return{a:x[0],b:x[1],c:x[2],d:x[3],e:x[4],f:x[5]}}function B(x){for(var I=x.childNodes.length-1;I>=0;I--)x.childNodes[I]instanceof P.SVGElement&&B(x.childNodes[I]);return i.adopt(x).id(i.eid(x.nodeName))}function U(x){return Math.abs(x)>1e-37?x:0}["fill","stroke"].forEach(function(x){var I={};I[x]=function(W){if(void 0===W)return this;if("string"==typeof W||i.Color.isRgb(W)||W&&"function"==typeof W.fill)this.attr(x,W);else for(var q=p[x].length-1;q>=0;q--)null!=W[p[x][q]]&&this.attr(p.prefix(x,p[x][q]),W[p[x][q]]);return this},i.extend(i.Element,i.FX,I)}),i.extend(i.Element,i.FX,{translate:function(x,I){return this.transform({x,y:I})},matrix:function(x){return this.attr("transform",new i.Matrix(6==arguments.length?[].slice.call(arguments):x))},opacity:function(x){return this.attr("opacity",x)},dx:function(x){return this.x(new i.Number(x).plus(this instanceof i.FX?0:this.x()),!0)},dy:function(x){return this.y(new i.Number(x).plus(this instanceof i.FX?0:this.y()),!0)}}),i.extend(i.Path,{length:function(){return this.node.getTotalLength()},pointAt:function(x){return this.node.getPointAtLength(x)}}),i.Set=i.invent({create:function(x){Array.isArray(x)?this.members=x:this.clear()},extend:{add:function(){for(var x=[].slice.call(arguments),I=0,W=x.length;I<W;I++)this.members.push(x[I]);return this},remove:function(x){var I=this.index(x);return I>-1&&this.members.splice(I,1),this},each:function(x){for(var I=0,W=this.members.length;I<W;I++)x.apply(this.members[I],[I,this.members]);return this},clear:function(){return this.members=[],this},length:function(){return this.members.length},has:function(x){return this.index(x)>=0},index:function(x){return this.members.indexOf(x)},get:function(x){return this.members[x]},first:function(){return this.get(0)},last:function(){return this.get(this.members.length-1)},valueOf:function(){return this.members}},construct:{set:function(x){return new i.Set(x)}}}),i.FX.Set=i.invent({create:function(x){this.set=x}}),i.Set.inherit=function(){var x=[];for(var I in i.Shape.prototype)"function"==typeof i.Shape.prototype[I]&&"function"!=typeof i.Set.prototype[I]&&x.push(I);for(var I in x.forEach(function(q){i.Set.prototype[q]=function(){for(var J=0,ne=this.members.length;J<ne;J++)this.members[J]&&"function"==typeof this.members[J][q]&&this.members[J][q].apply(this.members[J],arguments);return"animate"==q?this.fx||(this.fx=new i.FX.Set(this)):this}}),x=[],i.FX.prototype)"function"==typeof i.FX.prototype[I]&&"function"!=typeof i.FX.Set.prototype[I]&&x.push(I);x.forEach(function(W){i.FX.Set.prototype[W]=function(){for(var q=0,J=this.set.members.length;q<J;q++)this.set.members[q].fx[W].apply(this.set.members[q].fx,arguments);return this}})},i.extend(i.Element,{}),i.extend(i.Element,{remember:function(x,I){if("object"===ut(arguments[0]))for(var W in x)this.remember(W,x[W]);else{if(1==arguments.length)return this.memory()[x];this.memory()[x]=I}return this},forget:function(){if(0==arguments.length)this._memory={};else for(var x=arguments.length-1;x>=0;x--)delete this.memory()[arguments[x]];return this},memory:function(){return this._memory||(this._memory={})}}),i.get=function(x){var I=r.getElementById(function(W){var q=(W||"").toString().match(i.regex.reference);if(q)return q[1]}(x)||x);return i.adopt(I)},i.select=function(x,I){return new i.Set(i.utils.map((I||r).querySelectorAll(x),function(W){return i.adopt(W)}))},i.extend(i.Parent,{select:function(x){return i.select(x,this.node)}});var j="abcdef".split("");if("function"!=typeof P.CustomEvent){var K=function(x,I){I=I||{bubbles:!1,cancelable:!1,detail:void 0};var W=r.createEvent("CustomEvent");return W.initCustomEvent(x,I.bubbles,I.cancelable,I.detail),W};K.prototype=P.Event.prototype,i.CustomEvent=K}else i.CustomEvent=P.CustomEvent;return i},"function"==typeof define&&define.amd?define(function(){return Wi(Dn,Dn.document)}):"object"===(typeof exports>"u"?"undefined":ut(exports))&&typeof module<"u"?module.exports=Dn.document?Wi(Dn,Dn.document):function(P){return Wi(P,P.document)}:Dn.SVG=Wi(Dn,Dn.document),
/*! svg.filter.js - v2.0.2 - 2016-02-24
    * https://github.com/wout/svg.filter.js
    * Copyright (c) 2016 Wout Fierens; Licensed MIT */
function(){SVG.Filter=SVG.invent({create:"filter",inherit:SVG.Parent,extend:{source:"SourceGraphic",sourceAlpha:"SourceAlpha",background:"BackgroundImage",backgroundAlpha:"BackgroundAlpha",fill:"FillPaint",stroke:"StrokePaint",autoSetIn:!0,put:function(h,p){return this.add(h,p),!h.attr("in")&&this.autoSetIn&&h.attr("in",this.source),h.attr("result")||h.attr("result",h),h},blend:function(h,p,v){return this.put(new SVG.BlendEffect(h,p,v))},colorMatrix:function(h,p){return this.put(new SVG.ColorMatrixEffect(h,p))},convolveMatrix:function(h){return this.put(new SVG.ConvolveMatrixEffect(h))},componentTransfer:function(h){return this.put(new SVG.ComponentTransferEffect(h))},composite:function(h,p,v){return this.put(new SVG.CompositeEffect(h,p,v))},flood:function(h,p){return this.put(new SVG.FloodEffect(h,p))},offset:function(h,p){return this.put(new SVG.OffsetEffect(h,p))},image:function(h){return this.put(new SVG.ImageEffect(h))},merge:function(){var h=[void 0];for(var p in arguments)h.push(arguments[p]);return this.put(new(SVG.MergeEffect.bind.apply(SVG.MergeEffect,h)))},gaussianBlur:function(h,p){return this.put(new SVG.GaussianBlurEffect(h,p))},morphology:function(h,p){return this.put(new SVG.MorphologyEffect(h,p))},diffuseLighting:function(h,p,v){return this.put(new SVG.DiffuseLightingEffect(h,p,v))},displacementMap:function(h,p,v,y,C){return this.put(new SVG.DisplacementMapEffect(h,p,v,y,C))},specularLighting:function(h,p,v,y){return this.put(new SVG.SpecularLightingEffect(h,p,v,y))},tile:function(){return this.put(new SVG.TileEffect)},turbulence:function(h,p,v,y,C){return this.put(new SVG.TurbulenceEffect(h,p,v,y,C))},toString:function(){return"url(#"+this.attr("id")+")"}}}),SVG.extend(SVG.Defs,{filter:function(h){var p=this.put(new SVG.Filter);return"function"==typeof h&&h.call(p,p),p}}),SVG.extend(SVG.Container,{filter:function(h){return this.defs().filter(h)}}),SVG.extend(SVG.Element,SVG.G,SVG.Nested,{filter:function(h){return this.filterer=h instanceof SVG.Element?h:this.doc().filter(h),this.doc()&&this.filterer.doc()!==this.doc()&&this.doc().defs().add(this.filterer),this.attr("filter",this.filterer),this.filterer},unfilter:function(h){return this.filterer&&!0===h&&this.filterer.remove(),delete this.filterer,this.attr("filter",null)}}),SVG.Effect=SVG.invent({create:function(){this.constructor.call(this)},inherit:SVG.Element,extend:{in:function(h){return null==h?this.parent()&&this.parent().select('[result="'+this.attr("in")+'"]').get(0)||this.attr("in"):this.attr("in",h)},result:function(h){return null==h?this.attr("result"):this.attr("result",h)},toString:function(){return this.result()}}}),SVG.ParentEffect=SVG.invent({create:function(){this.constructor.call(this)},inherit:SVG.Parent,extend:{in:function(h){return null==h?this.parent()&&this.parent().select('[result="'+this.attr("in")+'"]').get(0)||this.attr("in"):this.attr("in",h)},result:function(h){return null==h?this.attr("result"):this.attr("result",h)},toString:function(){return this.result()}}});var P={blend:function(h,p){return this.parent()&&this.parent().blend(this,h,p)},colorMatrix:function(h,p){return this.parent()&&this.parent().colorMatrix(h,p).in(this)},convolveMatrix:function(h){return this.parent()&&this.parent().convolveMatrix(h).in(this)},componentTransfer:function(h){return this.parent()&&this.parent().componentTransfer(h).in(this)},composite:function(h,p){return this.parent()&&this.parent().composite(this,h,p)},flood:function(h,p){return this.parent()&&this.parent().flood(h,p)},offset:function(h,p){return this.parent()&&this.parent().offset(h,p).in(this)},image:function(h){return this.parent()&&this.parent().image(h)},merge:function(){return this.parent()&&this.parent().merge.apply(this.parent(),[this].concat(arguments))},gaussianBlur:function(h,p){return this.parent()&&this.parent().gaussianBlur(h,p).in(this)},morphology:function(h,p){return this.parent()&&this.parent().morphology(h,p).in(this)},diffuseLighting:function(h,p,v){return this.parent()&&this.parent().diffuseLighting(h,p,v).in(this)},displacementMap:function(h,p,v,y){return this.parent()&&this.parent().displacementMap(this,h,p,v,y)},specularLighting:function(h,p,v,y){return this.parent()&&this.parent().specularLighting(h,p,v,y).in(this)},tile:function(){return this.parent()&&this.parent().tile().in(this)},turbulence:function(h,p,v,y,C){return this.parent()&&this.parent().turbulence(h,p,v,y,C).in(this)}};SVG.extend(SVG.Effect,P),SVG.extend(SVG.ParentEffect,P),SVG.ChildEffect=SVG.invent({create:function(){this.constructor.call(this)},inherit:SVG.Element,extend:{in:function(h){this.attr("in",h)}}});var r={blend:function(h,p,v){this.attr({in:h,in2:p,mode:v||"normal"})},colorMatrix:function(h,p){"matrix"==h&&(p=l(p)),this.attr({type:h,values:void 0===p?null:p})},convolveMatrix:function(h){h=l(h),this.attr({order:Math.sqrt(h.split(" ").length),kernelMatrix:h})},composite:function(h,p,v){this.attr({in:h,in2:p,operator:v})},flood:function(h,p){this.attr("flood-color",h),null!=p&&this.attr("flood-opacity",p)},offset:function(h,p){this.attr({dx:h,dy:p})},image:function(h){this.attr("href",h,SVG.xlink)},displacementMap:function(h,p,v,y,C){this.attr({in:h,in2:p,scale:v,xChannelSelector:y,yChannelSelector:C})},gaussianBlur:function(h,p){this.attr("stdDeviation",null!=h||null!=p?function(v){if(!Array.isArray(v))return v;for(var y=0,C=v.length,k=[];y<C;y++)k.push(v[y]);return k.join(" ")}(Array.prototype.slice.call(arguments)):"0 0")},morphology:function(h,p){this.attr({operator:h,radius:p})},tile:function(){},turbulence:function(h,p,v,y,C){this.attr({numOctaves:p,seed:v,stitchTiles:y,baseFrequency:h,type:C})}},i={merge:function(){var h;if(arguments[0]instanceof SVG.Set){var p=this;arguments[0].each(function(y){this instanceof SVG.MergeNode?p.put(this):(this instanceof SVG.Effect||this instanceof SVG.ParentEffect)&&p.put(new SVG.MergeNode(this))})}else{h=Array.isArray(arguments[0])?arguments[0]:arguments;for(var v=0;v<h.length;v++)h[v]instanceof SVG.MergeNode?this.put(h[v]):this.put(new SVG.MergeNode(h[v]))}},componentTransfer:function(h){if(this.rgb=new SVG.Set,["r","g","b","a"].forEach(function(v){this[v]=new(SVG["Func"+v.toUpperCase()])("identity"),this.rgb.add(this[v]),this.node.appendChild(this[v].node)}.bind(this)),h)for(var p in h.rgb&&(["r","g","b"].forEach(function(v){this[v].attr(h.rgb)}.bind(this)),delete h.rgb),h)this[p].attr(h[p])},diffuseLighting:function(h,p,v){this.attr({surfaceScale:h,diffuseConstant:p,kernelUnitLength:v})},specularLighting:function(h,p,v,y){this.attr({surfaceScale:h,diffuseConstant:p,specularExponent:v,kernelUnitLength:y})}},o={distantLight:function(h,p){this.attr({azimuth:h,elevation:p})},pointLight:function(h,p,v){this.attr({x:h,y:p,z:v})},spotLight:function(h,p,v,y,C,k){this.attr({x:h,y:p,z:v,pointsAtX:y,pointsAtY:C,pointsAtZ:k})},mergeNode:function(h){this.attr("in",h)}};function l(h){return Array.isArray(h)&&(h=new SVG.Array(h)),h.toString().replace(/^\s+/,"").replace(/\s+$/,"").replace(/\s+/g," ")}function u(){var h=function(){};for(var p in"function"==typeof arguments[arguments.length-1]&&(h=arguments[arguments.length-1],Array.prototype.splice.call(arguments,arguments.length-1,1)),arguments)for(var v in arguments[p])h(arguments[p][v],v,arguments[p])}["r","g","b","a"].forEach(function(h){o["Func"+h.toUpperCase()]=function(p){switch(this.attr("type",p),p){case"table":this.attr("tableValues",arguments[1]);break;case"linear":this.attr("slope",arguments[1]),this.attr("intercept",arguments[2]);break;case"gamma":this.attr("amplitude",arguments[1]),this.attr("exponent",arguments[2]),this.attr("offset",arguments[2])}}}),u(r,function(h,p){var v=p.charAt(0).toUpperCase()+p.slice(1);SVG[v+"Effect"]=SVG.invent({create:function(){this.constructor.call(this,SVG.create("fe"+v)),h.apply(this,arguments),this.result(this.attr("id")+"Out")},inherit:SVG.Effect,extend:{}})}),u(i,function(h,p){var v=p.charAt(0).toUpperCase()+p.slice(1);SVG[v+"Effect"]=SVG.invent({create:function(){this.constructor.call(this,SVG.create("fe"+v)),h.apply(this,arguments),this.result(this.attr("id")+"Out")},inherit:SVG.ParentEffect,extend:{}})}),u(o,function(h,p){var v=p.charAt(0).toUpperCase()+p.slice(1);SVG[v]=SVG.invent({create:function(){this.constructor.call(this,SVG.create("fe"+v)),h.apply(this,arguments)},inherit:SVG.ChildEffect,extend:{}})}),SVG.extend(SVG.MergeEffect,{in:function(h){return h instanceof SVG.MergeNode?this.add(h,0):this.add(new SVG.MergeNode(h),0),this}}),SVG.extend(SVG.CompositeEffect,SVG.BlendEffect,SVG.DisplacementMapEffect,{in2:function(h){return null==h?this.parent()&&this.parent().select('[result="'+this.attr("in2")+'"]').get(0)||this.attr("in2"):this.attr("in2",h)}}),SVG.filter={sepiatone:[.343,.669,.119,0,0,.249,.626,.13,0,0,.172,.334,.111,0,0,0,0,0,1,0]}}.call(void 0),function(){function P(u,h,p,v,y,C,k){for(var S=u.slice(h,p||k),R=v.slice(y,C||k),N=0,B={pos:[0,0],start:[0,0]},U={pos:[0,0],start:[0,0]};S[N]=r.call(B,S[N]),R[N]=r.call(U,R[N]),S[N][0]!=R[N][0]||"M"==S[N][0]||"A"==S[N][0]&&(S[N][4]!=R[N][4]||S[N][5]!=R[N][5])?(Array.prototype.splice.apply(S,[N,1].concat(o.call(B,S[N]))),Array.prototype.splice.apply(R,[N,1].concat(o.call(U,R[N])))):(S[N]=i.call(B,S[N]),R[N]=i.call(U,R[N])),++N!=S.length||N!=R.length;)N==S.length&&S.push(["C",B.pos[0],B.pos[1],B.pos[0],B.pos[1],B.pos[0],B.pos[1]]),N==R.length&&R.push(["C",U.pos[0],U.pos[1],U.pos[0],U.pos[1],U.pos[0],U.pos[1]]);return{start:S,dest:R}}function r(u){switch(u[0]){case"z":case"Z":u[0]="L",u[1]=this.start[0],u[2]=this.start[1];break;case"H":u[0]="L",u[2]=this.pos[1];break;case"V":u[0]="L",u[2]=u[1],u[1]=this.pos[0];break;case"T":u[0]="Q",u[3]=u[1],u[4]=u[2],u[1]=this.reflection[1],u[2]=this.reflection[0];break;case"S":u[0]="C",u[6]=u[4],u[5]=u[3],u[4]=u[2],u[3]=u[1],u[2]=this.reflection[1],u[1]=this.reflection[0]}return u}function i(u){var h=u.length;return this.pos=[u[h-2],u[h-1]],-1!="SCQT".indexOf(u[0])&&(this.reflection=[2*this.pos[0]-u[h-4],2*this.pos[1]-u[h-3]]),u}function o(u){var h=[u];switch(u[0]){case"M":return this.pos=this.start=[u[1],u[2]],h;case"L":u[5]=u[3]=u[1],u[6]=u[4]=u[2],u[1]=this.pos[0],u[2]=this.pos[1];break;case"Q":u[6]=u[4],u[5]=u[3],u[4]=1*u[4]/3+2*u[2]/3,u[3]=1*u[3]/3+2*u[1]/3,u[2]=1*this.pos[1]/3+2*u[2]/3,u[1]=1*this.pos[0]/3+2*u[1]/3;break;case"A":u=(h=function(p,v){var y,C,k,S,R,N,B,U,j,K,x,I,W,q,J,ne,ve,ge,Le,qe,Pe,Ue,lt,ft,At,St,Gt=Math.abs(v[1]),Lt=Math.abs(v[2]),$t=v[3]%360,zn=v[4],En=v[5],_n=v[6],sr=v[7],fn=new SVG.Point(p),en=new SVG.Point(_n,sr),kn=[];if(0===Gt||0===Lt||fn.x===en.x&&fn.y===en.y)return[["C",fn.x,fn.y,en.x,en.y,en.x,en.y]];for((C=(y=new SVG.Point((fn.x-en.x)/2,(fn.y-en.y)/2).transform((new SVG.Matrix).rotate($t))).x*y.x/(Gt*Gt)+y.y*y.y/(Lt*Lt))>1&&(Gt*=C=Math.sqrt(C),Lt*=C),k=(new SVG.Matrix).rotate($t).scale(1/Gt,1/Lt).rotate(-$t),fn=fn.transform(k),N=(S=[(en=en.transform(k)).x-fn.x,en.y-fn.y])[0]*S[0]+S[1]*S[1],R=Math.sqrt(N),S[0]/=R,S[1]/=R,B=N<4?Math.sqrt(1-N/4):0,zn===En&&(B*=-1),U=new SVG.Point((en.x+fn.x)/2+B*-S[1],(en.y+fn.y)/2+B*S[0]),j=new SVG.Point(fn.x-U.x,fn.y-U.y),K=new SVG.Point(en.x-U.x,en.y-U.y),x=Math.acos(j.x/Math.sqrt(j.x*j.x+j.y*j.y)),j.y<0&&(x*=-1),I=Math.acos(K.x/Math.sqrt(K.x*K.x+K.y*K.y)),K.y<0&&(I*=-1),En&&x>I&&(I+=2*Math.PI),!En&&x<I&&(I-=2*Math.PI),ne=[],ve=x,W=(I-x)/(q=Math.ceil(2*Math.abs(x-I)/Math.PI)),J=4*Math.tan(W/4)/3,Pe=0;Pe<=q;Pe++)Le=Math.cos(ve),ge=Math.sin(ve),qe=new SVG.Point(U.x+Le,U.y+ge),ne[Pe]=[new SVG.Point(qe.x+J*ge,qe.y-J*Le),qe,new SVG.Point(qe.x-J*ge,qe.y+J*Le)],ve+=W;for(ne[0][0]=ne[0][1].clone(),ne[ne.length-1][2]=ne[ne.length-1][1].clone(),k=(new SVG.Matrix).rotate($t).scale(Gt,Lt).rotate(-$t),Pe=0,Ue=ne.length;Pe<Ue;Pe++)ne[Pe][0]=ne[Pe][0].transform(k),ne[Pe][1]=ne[Pe][1].transform(k),ne[Pe][2]=ne[Pe][2].transform(k);for(Pe=1,Ue=ne.length;Pe<Ue;Pe++)lt=(qe=ne[Pe-1][2]).x,ft=qe.y,At=(qe=ne[Pe][0]).x,St=qe.y,_n=(qe=ne[Pe][1]).x,kn.push(["C",lt,ft,At,St,_n,sr=qe.y]);return kn}(this.pos,u))[0]}return u[0]="C",this.pos=[u[5],u[6]],this.reflection=[2*u[5]-u[3],2*u[6]-u[4]],h}function l(u,h){if(!1===h)return!1;for(var p=h,v=u.length;p<v;++p)if("M"==u[p][0])return p;return!1}SVG.extend(SVG.PathArray,{morph:function(u){for(var h=this.value,p=this.parse(u),v=0,y=0,C=!1,k=!1;!1!==v||!1!==y;){var S;C=l(h,!1!==v&&v+1),k=l(p,!1!==y&&y+1),!1===v&&(v=0==(S=new SVG.PathArray(R.start).bbox()).height||0==S.width?h.push(h[0])-1:h.push(["M",S.x+S.width/2,S.y+S.height/2])-1),!1===y&&(y=0==(S=new SVG.PathArray(R.dest).bbox()).height||0==S.width?p.push(p[0])-1:p.push(["M",S.x+S.width/2,S.y+S.height/2])-1);var R=P(h,v,C,p,y,k);h=h.slice(0,v).concat(R.start,!1===C?[]:h.slice(C)),p=p.slice(0,y).concat(R.dest,!1===k?[]:p.slice(k)),v=!1!==C&&v+R.start.length,y=!1!==k&&y+R.dest.length}return this.value=h,this.destination=new SVG.PathArray,this.destination.value=p,this}})}(),
/*! svg.draggable.js - v2.2.2 - 2019-01-08
    * https://github.com/svgdotjs/svg.draggable.js
    * Copyright (c) 2019 Wout Fierens; Licensed MIT */
function(){function P(r){r.remember("_draggable",this),this.el=r}P.prototype.init=function(r,i){var o=this;this.constraint=r,this.value=i,this.el.on("mousedown.drag",function(l){o.start(l)}),this.el.on("touchstart.drag",function(l){o.start(l)})},P.prototype.transformPoint=function(r,i){var o=(r=r||window.event).changedTouches&&r.changedTouches[0]||r;return this.p.x=o.clientX-(i||0),this.p.y=o.clientY,this.p.matrixTransform(this.m)},P.prototype.getBBox=function(){var r=this.el.bbox();return this.el instanceof SVG.Nested&&(r=this.el.rbox()),(this.el instanceof SVG.G||this.el instanceof SVG.Use||this.el instanceof SVG.Nested)&&(r.x=this.el.x(),r.y=this.el.y()),r},P.prototype.start=function(r){if("click"!=r.type&&"mousedown"!=r.type&&"mousemove"!=r.type||1==(r.which||r.buttons)){var i=this;if(this.el.fire("beforedrag",{event:r,handler:this}),!this.el.event().defaultPrevented){r.preventDefault(),r.stopPropagation(),this.parent=this.parent||this.el.parent(SVG.Nested)||this.el.parent(SVG.Doc),this.p=this.parent.node.createSVGPoint(),this.m=this.el.node.getScreenCTM().inverse();var o,l=this.getBBox();if(this.el instanceof SVG.Text)switch(o=this.el.node.getComputedTextLength(),this.el.attr("text-anchor")){case"middle":o/=2;break;case"start":o=0}this.startPoints={point:this.transformPoint(r,o),box:l,transform:this.el.transform()},SVG.on(window,"mousemove.drag",function(u){i.drag(u)}),SVG.on(window,"touchmove.drag",function(u){i.drag(u)}),SVG.on(window,"mouseup.drag",function(u){i.end(u)}),SVG.on(window,"touchend.drag",function(u){i.end(u)}),this.el.fire("dragstart",{event:r,p:this.startPoints.point,m:this.m,handler:this})}}},P.prototype.drag=function(r){var i=this.getBBox(),o=this.transformPoint(r),l=this.startPoints.box.x+o.x-this.startPoints.point.x,u=this.startPoints.box.y+o.y-this.startPoints.point.y,h=this.constraint,p=o.x-this.startPoints.point.x,v=o.y-this.startPoints.point.y;if(this.el.fire("dragmove",{event:r,p:o,m:this.m,handler:this}),this.el.event().defaultPrevented)return o;if("function"==typeof h){var y=h.call(this.el,l,u,this.m);"boolean"==typeof y&&(y={x:y,y}),!0===y.x?this.el.x(l):!1!==y.x&&this.el.x(y.x),!0===y.y?this.el.y(u):!1!==y.y&&this.el.y(y.y)}else"object"==typeof h&&(null!=h.minX&&l<h.minX?p=(l=h.minX)-this.startPoints.box.x:null!=h.maxX&&l>h.maxX-i.width&&(p=(l=h.maxX-i.width)-this.startPoints.box.x),null!=h.minY&&u<h.minY?v=(u=h.minY)-this.startPoints.box.y:null!=h.maxY&&u>h.maxY-i.height&&(v=(u=h.maxY-i.height)-this.startPoints.box.y),null!=h.snapToGrid&&(l-=l%h.snapToGrid,u-=u%h.snapToGrid,p-=p%h.snapToGrid,v-=v%h.snapToGrid),this.el instanceof SVG.G?this.el.matrix(this.startPoints.transform).transform({x:p,y:v},!0):this.el.move(l,u));return o},P.prototype.end=function(r){var i=this.drag(r);this.el.fire("dragend",{event:r,p:i,m:this.m,handler:this}),SVG.off(window,"mousemove.drag"),SVG.off(window,"touchmove.drag"),SVG.off(window,"mouseup.drag"),SVG.off(window,"touchend.drag")},SVG.extend(SVG.Element,{draggable:function(r,i){"function"!=typeof r&&"object"!=typeof r||(i=r,r=!0);var o=this.remember("_draggable")||new P(this);return(r=void 0===r||r)?o.init(i||{},r):(this.off("mousedown.drag"),this.off("touchstart.drag")),this}})}.call(void 0),function(){function P(r){this.el=r,r.remember("_selectHandler",this),this.pointSelection={isSelected:!1},this.rectSelection={isSelected:!1},this.pointsList={lt:[0,0],rt:["width",0],rb:["width","height"],lb:[0,"height"],t:["width",0],r:["width","height"],b:["width","height"],l:[0,"height"]},this.pointCoord=function(i,o,l){var u="string"!=typeof i?i:o[i];return l?u/2:u},this.pointCoords=function(i,o){var l=this.pointsList[i];return{x:this.pointCoord(l[0],o,"t"===i||"b"===i),y:this.pointCoord(l[1],o,"r"===i||"l"===i)}}}P.prototype.init=function(r,i){var o=this.el.bbox();this.options={};var l=this.el.selectize.defaults.points;for(var u in this.el.selectize.defaults)this.options[u]=this.el.selectize.defaults[u],void 0!==i[u]&&(this.options[u]=i[u]);var h=["points","pointsExclude"];for(var u in h){var p=this.options[h[u]];"string"==typeof p?p=p.length>0?p.split(/\s*,\s*/i):[]:"boolean"==typeof p&&"points"===h[u]&&(p=p?l:[]),this.options[h[u]]=p}this.options.points=[l,this.options.points].reduce(function(v,y){return v.filter(function(C){return y.indexOf(C)>-1})}),this.options.points=[this.options.points,this.options.pointsExclude].reduce(function(v,y){return v.filter(function(C){return y.indexOf(C)<0})}),this.parent=this.el.parent(),this.nested=this.nested||this.parent.group(),this.nested.matrix(new SVG.Matrix(this.el).translate(o.x,o.y)),this.options.deepSelect&&-1!==["line","polyline","polygon"].indexOf(this.el.type)?this.selectPoints(r):this.selectRect(r),this.observe(),this.cleanup()},P.prototype.selectPoints=function(r){return this.pointSelection.isSelected=r,this.pointSelection.set||(this.pointSelection.set=this.parent.set(),this.drawPoints()),this},P.prototype.getPointArray=function(){var r=this.el.bbox();return this.el.array().valueOf().map(function(i){return[i[0]-r.x,i[1]-r.y]})},P.prototype.drawPoints=function(){for(var r=this,i=this.getPointArray(),o=0,l=i.length;o<l;++o){var u=function(p){return function(v){(v=v||window.event).preventDefault?v.preventDefault():v.returnValue=!1,v.stopPropagation(),r.el.fire("point",{x:v.pageX||v.touches[0].pageX,y:v.pageY||v.touches[0].pageY,i:p,event:v})}}(o),h=this.drawPoint(i[o][0],i[o][1]).addClass(this.options.classPoints).addClass(this.options.classPoints+"_point").on("touchstart",u).on("mousedown",u);this.pointSelection.set.add(h)}},P.prototype.drawPoint=function(r,i){var o=this.options.pointType;switch(o){case"circle":return this.drawCircle(r,i);case"rect":return this.drawRect(r,i);default:if("function"==typeof o)return o.call(this,r,i);throw new Error("Unknown "+o+" point type!")}},P.prototype.drawCircle=function(r,i){return this.nested.circle(this.options.pointSize).center(r,i)},P.prototype.drawRect=function(r,i){return this.nested.rect(this.options.pointSize,this.options.pointSize).center(r,i)},P.prototype.updatePointSelection=function(){var r=this.getPointArray();this.pointSelection.set.each(function(i){this.cx()===r[i][0]&&this.cy()===r[i][1]||this.center(r[i][0],r[i][1])})},P.prototype.updateRectSelection=function(){var r=this,i=this.el.bbox();if(this.rectSelection.set.get(0).attr({width:i.width,height:i.height}),this.options.points.length&&this.options.points.map(function(l,u){var h=r.pointCoords(l,i);r.rectSelection.set.get(u+1).center(h.x,h.y)}),this.options.rotationPoint){var o=this.rectSelection.set.length();this.rectSelection.set.get(o-1).center(i.width/2,20)}},P.prototype.selectRect=function(r){var i=this,o=this.el.bbox();function l(p){return function(v){(v=v||window.event).preventDefault?v.preventDefault():v.returnValue=!1,v.stopPropagation(),i.el.fire(p,{x:v.pageX||v.touches[0].pageX,y:v.pageY||v.touches[0].pageY,event:v})}}if(this.rectSelection.isSelected=r,this.rectSelection.set=this.rectSelection.set||this.parent.set(),this.rectSelection.set.get(0)||this.rectSelection.set.add(this.nested.rect(o.width,o.height).addClass(this.options.classRect)),this.options.points.length&&this.rectSelection.set.length()<2&&(this.options.points.map(function(p,v){var y=i.pointCoords(p,o),C=i.drawPoint(y.x,y.y).attr("class",i.options.classPoints+"_"+p).on("mousedown",l(p)).on("touchstart",l(p));i.rectSelection.set.add(C)}),this.rectSelection.set.each(function(){this.addClass(i.options.classPoints)})),this.options.rotationPoint&&(this.options.points&&!this.rectSelection.set.get(9)||!this.options.points&&!this.rectSelection.set.get(1))){var u=function(p){(p=p||window.event).preventDefault?p.preventDefault():p.returnValue=!1,p.stopPropagation(),i.el.fire("rot",{x:p.pageX||p.touches[0].pageX,y:p.pageY||p.touches[0].pageY,event:p})},h=this.drawPoint(o.width/2,20).attr("class",this.options.classPoints+"_rot").on("touchstart",u).on("mousedown",u);this.rectSelection.set.add(h)}},P.prototype.handler=function(){var r=this.el.bbox();this.nested.matrix(new SVG.Matrix(this.el).translate(r.x,r.y)),this.rectSelection.isSelected&&this.updateRectSelection(),this.pointSelection.isSelected&&this.updatePointSelection()},P.prototype.observe=function(){var r=this;if(MutationObserver)if(this.rectSelection.isSelected||this.pointSelection.isSelected)this.observerInst=this.observerInst||new MutationObserver(function(){r.handler()}),this.observerInst.observe(this.el.node,{attributes:!0});else try{this.observerInst.disconnect(),delete this.observerInst}catch{}else this.el.off("DOMAttrModified.select"),(this.rectSelection.isSelected||this.pointSelection.isSelected)&&this.el.on("DOMAttrModified.select",function(){r.handler()})},P.prototype.cleanup=function(){!this.rectSelection.isSelected&&this.rectSelection.set&&(this.rectSelection.set.each(function(){this.remove()}),this.rectSelection.set.clear(),delete this.rectSelection.set),!this.pointSelection.isSelected&&this.pointSelection.set&&(this.pointSelection.set.each(function(){this.remove()}),this.pointSelection.set.clear(),delete this.pointSelection.set),this.pointSelection.isSelected||this.rectSelection.isSelected||(this.nested.remove(),delete this.nested)},SVG.extend(SVG.Element,{selectize:function(r,i){return"object"==typeof r&&(i=r,r=!0),(this.remember("_selectHandler")||new P(this)).init(void 0===r||r,i||{}),this}}),SVG.Element.prototype.selectize.defaults={points:["lt","rt","rb","lb","t","r","b","l"],pointsExclude:[],classRect:"svg_select_boundingRect",classPoints:"svg_select_points",pointSize:7,rotationPoint:!0,deepSelect:!1,pointType:"circle"}}(),function(){(function(){function P(r){r.remember("_resizeHandler",this),this.el=r,this.parameters={},this.lastUpdateCall=null,this.p=r.doc().node.createSVGPoint()}P.prototype.transformPoint=function(r,i,o){return this.p.x=r-(this.offset.x-window.pageXOffset),this.p.y=i-(this.offset.y-window.pageYOffset),this.p.matrixTransform(o||this.m)},P.prototype._extractPosition=function(r){return{x:null!=r.clientX?r.clientX:r.touches[0].clientX,y:null!=r.clientY?r.clientY:r.touches[0].clientY}},P.prototype.init=function(r){var i=this;if(this.stop(),"stop"!==r){for(var o in this.options={},this.el.resize.defaults)this.options[o]=this.el.resize.defaults[o],void 0!==r[o]&&(this.options[o]=r[o]);this.el.on("lt.resize",function(l){i.resize(l||window.event)}),this.el.on("rt.resize",function(l){i.resize(l||window.event)}),this.el.on("rb.resize",function(l){i.resize(l||window.event)}),this.el.on("lb.resize",function(l){i.resize(l||window.event)}),this.el.on("t.resize",function(l){i.resize(l||window.event)}),this.el.on("r.resize",function(l){i.resize(l||window.event)}),this.el.on("b.resize",function(l){i.resize(l||window.event)}),this.el.on("l.resize",function(l){i.resize(l||window.event)}),this.el.on("rot.resize",function(l){i.resize(l||window.event)}),this.el.on("point.resize",function(l){i.resize(l||window.event)}),this.update()}},P.prototype.stop=function(){return this.el.off("lt.resize"),this.el.off("rt.resize"),this.el.off("rb.resize"),this.el.off("lb.resize"),this.el.off("t.resize"),this.el.off("r.resize"),this.el.off("b.resize"),this.el.off("l.resize"),this.el.off("rot.resize"),this.el.off("point.resize"),this},P.prototype.resize=function(r){var i=this;this.m=this.el.node.getScreenCTM().inverse(),this.offset={x:window.pageXOffset,y:window.pageYOffset};var o=this._extractPosition(r.detail.event);if(this.parameters={type:this.el.type,p:this.transformPoint(o.x,o.y),x:r.detail.x,y:r.detail.y,box:this.el.bbox(),rotation:this.el.transform().rotation},"text"===this.el.type&&(this.parameters.fontSize=this.el.attr()["font-size"]),void 0!==r.detail.i){var l=this.el.array().valueOf();this.parameters.i=r.detail.i,this.parameters.pointCoords=[l[r.detail.i][0],l[r.detail.i][1]]}switch(r.type){case"lt":this.calc=function(u,h){var p=this.snapToGrid(u,h);if(this.parameters.box.width-p[0]>0&&this.parameters.box.height-p[1]>0){if("text"===this.parameters.type)return this.el.move(this.parameters.box.x+p[0],this.parameters.box.y),void this.el.attr("font-size",this.parameters.fontSize-p[0]);p=this.checkAspectRatio(p),this.el.move(this.parameters.box.x+p[0],this.parameters.box.y+p[1]).size(this.parameters.box.width-p[0],this.parameters.box.height-p[1])}};break;case"rt":this.calc=function(u,h){var p=this.snapToGrid(u,h,2);if(this.parameters.box.width+p[0]>0&&this.parameters.box.height-p[1]>0){if("text"===this.parameters.type)return this.el.move(this.parameters.box.x-p[0],this.parameters.box.y),void this.el.attr("font-size",this.parameters.fontSize+p[0]);p=this.checkAspectRatio(p,!0),this.el.move(this.parameters.box.x,this.parameters.box.y+p[1]).size(this.parameters.box.width+p[0],this.parameters.box.height-p[1])}};break;case"rb":this.calc=function(u,h){var p=this.snapToGrid(u,h,0);if(this.parameters.box.width+p[0]>0&&this.parameters.box.height+p[1]>0){if("text"===this.parameters.type)return this.el.move(this.parameters.box.x-p[0],this.parameters.box.y),void this.el.attr("font-size",this.parameters.fontSize+p[0]);p=this.checkAspectRatio(p),this.el.move(this.parameters.box.x,this.parameters.box.y).size(this.parameters.box.width+p[0],this.parameters.box.height+p[1])}};break;case"lb":this.calc=function(u,h){var p=this.snapToGrid(u,h,1);if(this.parameters.box.width-p[0]>0&&this.parameters.box.height+p[1]>0){if("text"===this.parameters.type)return this.el.move(this.parameters.box.x+p[0],this.parameters.box.y),void this.el.attr("font-size",this.parameters.fontSize-p[0]);p=this.checkAspectRatio(p,!0),this.el.move(this.parameters.box.x+p[0],this.parameters.box.y).size(this.parameters.box.width-p[0],this.parameters.box.height+p[1])}};break;case"t":this.calc=function(u,h){var p=this.snapToGrid(u,h,2);if(this.parameters.box.height-p[1]>0){if("text"===this.parameters.type)return;this.el.move(this.parameters.box.x,this.parameters.box.y+p[1]).height(this.parameters.box.height-p[1])}};break;case"r":this.calc=function(u,h){var p=this.snapToGrid(u,h,0);if(this.parameters.box.width+p[0]>0){if("text"===this.parameters.type)return;this.el.move(this.parameters.box.x,this.parameters.box.y).width(this.parameters.box.width+p[0])}};break;case"b":this.calc=function(u,h){var p=this.snapToGrid(u,h,0);if(this.parameters.box.height+p[1]>0){if("text"===this.parameters.type)return;this.el.move(this.parameters.box.x,this.parameters.box.y).height(this.parameters.box.height+p[1])}};break;case"l":this.calc=function(u,h){var p=this.snapToGrid(u,h,1);if(this.parameters.box.width-p[0]>0){if("text"===this.parameters.type)return;this.el.move(this.parameters.box.x+p[0],this.parameters.box.y).width(this.parameters.box.width-p[0])}};break;case"rot":this.calc=function(u,h){var p=u+this.parameters.p.x,v=h+this.parameters.p.y,y=Math.atan2(this.parameters.p.y-this.parameters.box.y-this.parameters.box.height/2,this.parameters.p.x-this.parameters.box.x-this.parameters.box.width/2),C=Math.atan2(v-this.parameters.box.y-this.parameters.box.height/2,p-this.parameters.box.x-this.parameters.box.width/2),k=this.parameters.rotation+180*(C-y)/Math.PI+this.options.snapToAngle/2;this.el.center(this.parameters.box.cx,this.parameters.box.cy).rotate(k-k%this.options.snapToAngle,this.parameters.box.cx,this.parameters.box.cy)};break;case"point":this.calc=function(u,h){var p=this.snapToGrid(u,h,this.parameters.pointCoords[0],this.parameters.pointCoords[1]),v=this.el.array().valueOf();v[this.parameters.i][0]=this.parameters.pointCoords[0]+p[0],v[this.parameters.i][1]=this.parameters.pointCoords[1]+p[1],this.el.plot(v)}}this.el.fire("resizestart",{dx:this.parameters.x,dy:this.parameters.y,event:r}),SVG.on(window,"touchmove.resize",function(u){i.update(u||window.event)}),SVG.on(window,"touchend.resize",function(){i.done()}),SVG.on(window,"mousemove.resize",function(u){i.update(u||window.event)}),SVG.on(window,"mouseup.resize",function(){i.done()})},P.prototype.update=function(r){if(r){var i=this._extractPosition(r),o=this.transformPoint(i.x,i.y),l=o.x-this.parameters.p.x,u=o.y-this.parameters.p.y;this.lastUpdateCall=[l,u],this.calc(l,u),this.el.fire("resizing",{dx:l,dy:u,event:r})}else this.lastUpdateCall&&this.calc(this.lastUpdateCall[0],this.lastUpdateCall[1])},P.prototype.done=function(){this.lastUpdateCall=null,SVG.off(window,"mousemove.resize"),SVG.off(window,"mouseup.resize"),SVG.off(window,"touchmove.resize"),SVG.off(window,"touchend.resize"),this.el.fire("resizedone")},P.prototype.snapToGrid=function(r,i,o,l){var u;return u=void 0!==l?[(o+r)%this.options.snapToGrid,(l+i)%this.options.snapToGrid]:[(this.parameters.box.x+r+(1&(o=o??3)?0:this.parameters.box.width))%this.options.snapToGrid,(this.parameters.box.y+i+(2&o?0:this.parameters.box.height))%this.options.snapToGrid],r<0&&(u[0]-=this.options.snapToGrid),i<0&&(u[1]-=this.options.snapToGrid),r-=Math.abs(u[0])<this.options.snapToGrid/2?u[0]:u[0]-(r<0?-this.options.snapToGrid:this.options.snapToGrid),i-=Math.abs(u[1])<this.options.snapToGrid/2?u[1]:u[1]-(i<0?-this.options.snapToGrid:this.options.snapToGrid),this.constraintToBox(r,i,o,l)},P.prototype.constraintToBox=function(r,i,o,l){var u,h,p=this.options.constraint||{};return void 0!==l?(u=o,h=l):(u=this.parameters.box.x+(1&o?0:this.parameters.box.width),h=this.parameters.box.y+(2&o?0:this.parameters.box.height)),void 0!==p.minX&&u+r<p.minX&&(r=p.minX-u),void 0!==p.maxX&&u+r>p.maxX&&(r=p.maxX-u),void 0!==p.minY&&h+i<p.minY&&(i=p.minY-h),void 0!==p.maxY&&h+i>p.maxY&&(i=p.maxY-h),[r,i]},P.prototype.checkAspectRatio=function(r,i){if(!this.options.saveAspectRatio)return r;var o=r.slice(),l=this.parameters.box.width/this.parameters.box.height,u=this.parameters.box.width+r[0],h=this.parameters.box.height-r[1],p=u/h;return p<l?(o[1]=u/l-this.parameters.box.height,i&&(o[1]=-o[1])):p>l&&(o[0]=this.parameters.box.width-h*l,i&&(o[0]=-o[0])),o},SVG.extend(SVG.Element,{resize:function(r){return(this.remember("_resizeHandler")||new P(this)).init(r||{}),this}}),SVG.Element.prototype.resize.defaults={snapToAngle:.1,snapToGrid:1,constraint:{},saveAspectRatio:!1}}).call(this)}(),void 0===window.Apex&&(window.Apex={});var Cr=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w}return me(P,[{key:"initModules",value:function(){this.ctx.publicMethods=["updateOptions","updateSeries","appendData","appendSeries","isSeriesHidden","toggleSeries","showSeries","hideSeries","setLocale","resetSeries","zoomX","toggleDataPointSelection","dataURI","exportToCSV","addXaxisAnnotation","addYaxisAnnotation","addPointAnnotation","clearAnnotations","removeAnnotation","paper","destroy"],this.ctx.eventList=["click","mousedown","mousemove","mouseleave","touchstart","touchmove","touchleave","mouseup","touchend"],this.ctx.animations=new hi(this.ctx),this.ctx.axes=new fi(this.ctx),this.ctx.core=new qr(this.ctx.el,this.ctx),this.ctx.config=new Je({}),this.ctx.data=new Ot(this.ctx),this.ctx.grid=new qi(this.ctx),this.ctx.graphics=new Ke(this.ctx),this.ctx.coreUtils=new yn(this.ctx),this.ctx.crosshairs=new Da(this.ctx),this.ctx.events=new yr(this.ctx),this.ctx.exports=new Or(this.ctx),this.ctx.localization=new di(this.ctx),this.ctx.options=new Lr,this.ctx.responsive=new wa(this.ctx),this.ctx.series=new Dr(this.ctx),this.ctx.theme=new pi(this.ctx),this.ctx.formatters=new Qt(this.ctx),this.ctx.titleSubtitle=new ii(this.ctx),this.ctx.legend=new Mi(this.ctx),this.ctx.toolbar=new $i(this.ctx),this.ctx.tooltip=new Ve(this.ctx),this.ctx.dimensions=new Pa(this.ctx),this.ctx.updateHelpers=new Mr(this.ctx),this.ctx.zoomPanSelection=new Ni(this.ctx),this.ctx.w.globals.tooltip=new Ve(this.ctx)}}]),P}(),Nr=function(){function P(r){F(this,P),this.ctx=r,this.w=r.w}return me(P,[{key:"clear",value:function(r){var i=r.isUpdating;this.ctx.zoomPanSelection&&this.ctx.zoomPanSelection.destroy(),this.ctx.toolbar&&this.ctx.toolbar.destroy(),this.ctx.animations=null,this.ctx.axes=null,this.ctx.annotations=null,this.ctx.core=null,this.ctx.data=null,this.ctx.grid=null,this.ctx.series=null,this.ctx.responsive=null,this.ctx.theme=null,this.ctx.formatters=null,this.ctx.titleSubtitle=null,this.ctx.legend=null,this.ctx.dimensions=null,this.ctx.options=null,this.ctx.crosshairs=null,this.ctx.zoomPanSelection=null,this.ctx.updateHelpers=null,this.ctx.toolbar=null,this.ctx.localization=null,this.ctx.w.globals.tooltip=null,this.clearDomElements({isUpdating:i})}},{key:"killSVG",value:function(r){r.each(function(i,o){this.removeClass("*"),this.off(),this.stop()},!0),r.ungroup(),r.clear()}},{key:"clearDomElements",value:function(r){var i=this,l=this.w.globals.dom.Paper.node;l.parentNode&&l.parentNode.parentNode&&!r.isUpdating&&(l.parentNode.parentNode.style.minHeight="unset");var u=this.w.globals.dom.baseEl;u&&this.ctx.eventList.forEach(function(p){u.removeEventListener(p,i.ctx.events.documentEvent)});var h=this.w.globals.dom;if(null!==this.ctx.el)for(;this.ctx.el.firstChild;)this.ctx.el.removeChild(this.ctx.el.firstChild);this.killSVG(h.Paper),h.Paper.remove(),h.elWrap=null,h.elGraphical=null,h.elLegendWrap=null,h.elLegendForeign=null,h.baseEl=null,h.elGridRect=null,h.elGridRectMask=null,h.elGridRectMarkerMask=null,h.elForecastMask=null,h.elNonForecastMask=null,h.elDefs=null}}]),P}(),dt=new WeakMap,Aa=function(){function P(r,i){F(this,P),this.opts=i,this.ctx=this,this.w=new la(i).init(),this.el=r,this.w.globals.cuid=pe.randomId(),this.w.globals.chartID=this.w.config.chart.id?pe.escapeString(this.w.config.chart.id):this.w.globals.cuid,new Cr(this).initModules(),this.create=pe.bind(this.create,this),this.windowResizeHandler=this._windowResizeHandler.bind(this),this.parentResizeHandler=this._parentResizeCallback.bind(this)}return me(P,[{key:"render",value:function(){var r=this;return new Promise(function(i,o){if(null!==r.el){void 0===Apex._chartInstances&&(Apex._chartInstances=[]),r.w.config.chart.id&&Apex._chartInstances.push({id:r.w.globals.chartID,group:r.w.config.chart.group,chart:r}),r.setLocale(r.w.config.chart.defaultLocale);var l=r.w.config.chart.events.beforeMount;"function"==typeof l&&l(r,r.w),r.events.fireEvent("beforeMount",[r,r.w]),window.addEventListener("resize",r.windowResizeHandler),function(S,R){var N=!1;if(S.nodeType!==Node.DOCUMENT_FRAGMENT_NODE){var B=S.getBoundingClientRect();"none"!==S.style.display&&0!==B.width||(N=!0)}var U=new ResizeObserver(function(j){N&&R.call(S,j),N=!0});S.nodeType===Node.DOCUMENT_FRAGMENT_NODE?Array.from(S.children).forEach(function(j){return U.observe(j)}):U.observe(S),dt.set(R,U)}(r.el.parentNode,r.parentResizeHandler);var u=r.el.getRootNode&&r.el.getRootNode(),h=pe.is("ShadowRoot",u),p=r.el.ownerDocument,v=h?u.getElementById("apexcharts-css"):p.getElementById("apexcharts-css");if(!v){var y;(v=document.createElement("style")).id="apexcharts-css",v.textContent='@keyframes opaque {\n  0% {\n    opacity: 0\n  }\n\n  to {\n    opacity: 1\n  }\n}\n\n@keyframes resizeanim {\n\n  0%,\n  to {\n    opacity: 0\n  }\n}\n\n.apexcharts-canvas {\n  position: relative;\n  user-select: none\n}\n\n.apexcharts-canvas ::-webkit-scrollbar {\n  -webkit-appearance: none;\n  width: 6px\n}\n\n.apexcharts-canvas ::-webkit-scrollbar-thumb {\n  border-radius: 4px;\n  background-color: rgba(0, 0, 0, .5);\n  box-shadow: 0 0 1px rgba(255, 255, 255, .5);\n  -webkit-box-shadow: 0 0 1px rgba(255, 255, 255, .5)\n}\n\n.apexcharts-inner {\n  position: relative\n}\n\n.apexcharts-text tspan {\n  font-family: inherit\n}\n\nrect.legend-mouseover-inactive,\n.legend-mouseover-inactive rect,\n.legend-mouseover-inactive path,\n.legend-mouseover-inactive circle,\n.legend-mouseover-inactive line,\n.legend-mouseover-inactive text.apexcharts-yaxis-title-text,\n.legend-mouseover-inactive text.apexcharts-yaxis-label {\n  transition: .15s ease all;\n  opacity: .2\n}\n\n.apexcharts-legend-text {\n  padding-left: 15px;\n  margin-left: -15px;\n}\n\n.apexcharts-series-collapsed {\n  opacity: 0\n}\n\n.apexcharts-tooltip {\n  border-radius: 5px;\n  box-shadow: 2px 2px 6px -4px #999;\n  cursor: default;\n  font-size: 14px;\n  left: 62px;\n  opacity: 0;\n  pointer-events: none;\n  position: absolute;\n  top: 20px;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  white-space: nowrap;\n  z-index: 12;\n  transition: .15s ease all\n}\n\n.apexcharts-tooltip.apexcharts-active {\n  opacity: 1;\n  transition: .15s ease all\n}\n\n.apexcharts-tooltip.apexcharts-theme-light {\n  border: 1px solid #e3e3e3;\n  background: rgba(255, 255, 255, .96)\n}\n\n.apexcharts-tooltip.apexcharts-theme-dark {\n  color: #fff;\n  background: rgba(30, 30, 30, .8)\n}\n\n.apexcharts-tooltip * {\n  font-family: inherit\n}\n\n.apexcharts-tooltip-title {\n  padding: 6px;\n  font-size: 15px;\n  margin-bottom: 4px\n}\n\n.apexcharts-tooltip.apexcharts-theme-light .apexcharts-tooltip-title {\n  background: #eceff1;\n  border-bottom: 1px solid #ddd\n}\n\n.apexcharts-tooltip.apexcharts-theme-dark .apexcharts-tooltip-title {\n  background: rgba(0, 0, 0, .7);\n  border-bottom: 1px solid #333\n}\n\n.apexcharts-tooltip-text-goals-value,\n.apexcharts-tooltip-text-y-value,\n.apexcharts-tooltip-text-z-value {\n  display: inline-block;\n  margin-left: 5px;\n  font-weight: 600\n}\n\n.apexcharts-tooltip-text-goals-label:empty,\n.apexcharts-tooltip-text-goals-value:empty,\n.apexcharts-tooltip-text-y-label:empty,\n.apexcharts-tooltip-text-y-value:empty,\n.apexcharts-tooltip-text-z-value:empty,\n.apexcharts-tooltip-title:empty {\n  display: none\n}\n\n.apexcharts-tooltip-text-goals-label,\n.apexcharts-tooltip-text-goals-value {\n  padding: 6px 0 5px\n}\n\n.apexcharts-tooltip-goals-group,\n.apexcharts-tooltip-text-goals-label,\n.apexcharts-tooltip-text-goals-value {\n  display: flex\n}\n\n.apexcharts-tooltip-text-goals-label:not(:empty),\n.apexcharts-tooltip-text-goals-value:not(:empty) {\n  margin-top: -6px\n}\n\n.apexcharts-tooltip-marker {\n  width: 12px;\n  height: 12px;\n  position: relative;\n  top: 0;\n  margin-right: 10px;\n  border-radius: 50%\n}\n\n.apexcharts-tooltip-series-group {\n  padding: 0 10px;\n  display: none;\n  text-align: left;\n  justify-content: left;\n  align-items: center\n}\n\n.apexcharts-tooltip-series-group.apexcharts-active .apexcharts-tooltip-marker {\n  opacity: 1\n}\n\n.apexcharts-tooltip-series-group.apexcharts-active,\n.apexcharts-tooltip-series-group:last-child {\n  padding-bottom: 4px\n}\n\n.apexcharts-tooltip-series-group-hidden {\n  opacity: 0;\n  height: 0;\n  line-height: 0;\n  padding: 0 !important\n}\n\n.apexcharts-tooltip-y-group {\n  padding: 6px 0 5px\n}\n\n.apexcharts-custom-tooltip,\n.apexcharts-tooltip-box {\n  padding: 4px 8px\n}\n\n.apexcharts-tooltip-boxPlot {\n  display: flex;\n  flex-direction: column-reverse\n}\n\n.apexcharts-tooltip-box>div {\n  margin: 4px 0\n}\n\n.apexcharts-tooltip-box span.value {\n  font-weight: 700\n}\n\n.apexcharts-tooltip-rangebar {\n  padding: 5px 8px\n}\n\n.apexcharts-tooltip-rangebar .category {\n  font-weight: 600;\n  color: #777\n}\n\n.apexcharts-tooltip-rangebar .series-name {\n  font-weight: 700;\n  display: block;\n  margin-bottom: 5px\n}\n\n.apexcharts-xaxistooltip,\n.apexcharts-yaxistooltip {\n  opacity: 0;\n  pointer-events: none;\n  color: #373d3f;\n  font-size: 13px;\n  text-align: center;\n  border-radius: 2px;\n  position: absolute;\n  z-index: 10;\n  background: #eceff1;\n  border: 1px solid #90a4ae\n}\n\n.apexcharts-xaxistooltip {\n  padding: 9px 10px;\n  transition: .15s ease all\n}\n\n.apexcharts-xaxistooltip.apexcharts-theme-dark {\n  background: rgba(0, 0, 0, .7);\n  border: 1px solid rgba(0, 0, 0, .5);\n  color: #fff\n}\n\n.apexcharts-xaxistooltip:after,\n.apexcharts-xaxistooltip:before {\n  left: 50%;\n  border: solid transparent;\n  content: " ";\n  height: 0;\n  width: 0;\n  position: absolute;\n  pointer-events: none\n}\n\n.apexcharts-xaxistooltip:after {\n  border-color: transparent;\n  border-width: 6px;\n  margin-left: -6px\n}\n\n.apexcharts-xaxistooltip:before {\n  border-color: transparent;\n  border-width: 7px;\n  margin-left: -7px\n}\n\n.apexcharts-xaxistooltip-bottom:after,\n.apexcharts-xaxistooltip-bottom:before {\n  bottom: 100%\n}\n\n.apexcharts-xaxistooltip-top:after,\n.apexcharts-xaxistooltip-top:before {\n  top: 100%\n}\n\n.apexcharts-xaxistooltip-bottom:after {\n  border-bottom-color: #eceff1\n}\n\n.apexcharts-xaxistooltip-bottom:before {\n  border-bottom-color: #90a4ae\n}\n\n.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:after,\n.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:before {\n  border-bottom-color: rgba(0, 0, 0, .5)\n}\n\n.apexcharts-xaxistooltip-top:after {\n  border-top-color: #eceff1\n}\n\n.apexcharts-xaxistooltip-top:before {\n  border-top-color: #90a4ae\n}\n\n.apexcharts-xaxistooltip-top.apexcharts-theme-dark:after,\n.apexcharts-xaxistooltip-top.apexcharts-theme-dark:before {\n  border-top-color: rgba(0, 0, 0, .5)\n}\n\n.apexcharts-xaxistooltip.apexcharts-active {\n  opacity: 1;\n  transition: .15s ease all\n}\n\n.apexcharts-yaxistooltip {\n  padding: 4px 10px\n}\n\n.apexcharts-yaxistooltip.apexcharts-theme-dark {\n  background: rgba(0, 0, 0, .7);\n  border: 1px solid rgba(0, 0, 0, .5);\n  color: #fff\n}\n\n.apexcharts-yaxistooltip:after,\n.apexcharts-yaxistooltip:before {\n  top: 50%;\n  border: solid transparent;\n  content: " ";\n  height: 0;\n  width: 0;\n  position: absolute;\n  pointer-events: none\n}\n\n.apexcharts-yaxistooltip:after {\n  border-color: transparent;\n  border-width: 6px;\n  margin-top: -6px\n}\n\n.apexcharts-yaxistooltip:before {\n  border-color: transparent;\n  border-width: 7px;\n  margin-top: -7px\n}\n\n.apexcharts-yaxistooltip-left:after,\n.apexcharts-yaxistooltip-left:before {\n  left: 100%\n}\n\n.apexcharts-yaxistooltip-right:after,\n.apexcharts-yaxistooltip-right:before {\n  right: 100%\n}\n\n.apexcharts-yaxistooltip-left:after {\n  border-left-color: #eceff1\n}\n\n.apexcharts-yaxistooltip-left:before {\n  border-left-color: #90a4ae\n}\n\n.apexcharts-yaxistooltip-left.apexcharts-theme-dark:after,\n.apexcharts-yaxistooltip-left.apexcharts-theme-dark:before {\n  border-left-color: rgba(0, 0, 0, .5)\n}\n\n.apexcharts-yaxistooltip-right:after {\n  border-right-color: #eceff1\n}\n\n.apexcharts-yaxistooltip-right:before {\n  border-right-color: #90a4ae\n}\n\n.apexcharts-yaxistooltip-right.apexcharts-theme-dark:after,\n.apexcharts-yaxistooltip-right.apexcharts-theme-dark:before {\n  border-right-color: rgba(0, 0, 0, .5)\n}\n\n.apexcharts-yaxistooltip.apexcharts-active {\n  opacity: 1\n}\n\n.apexcharts-yaxistooltip-hidden {\n  display: none\n}\n\n.apexcharts-xcrosshairs,\n.apexcharts-ycrosshairs {\n  pointer-events: none;\n  opacity: 0;\n  transition: .15s ease all\n}\n\n.apexcharts-xcrosshairs.apexcharts-active,\n.apexcharts-ycrosshairs.apexcharts-active {\n  opacity: 1;\n  transition: .15s ease all\n}\n\n.apexcharts-ycrosshairs-hidden {\n  opacity: 0\n}\n\n.apexcharts-selection-rect {\n  cursor: move\n}\n\n.svg_select_boundingRect,\n.svg_select_points_rot {\n  pointer-events: none;\n  opacity: 0;\n  visibility: hidden\n}\n\n.apexcharts-selection-rect+g .svg_select_boundingRect,\n.apexcharts-selection-rect+g .svg_select_points_rot {\n  opacity: 0;\n  visibility: hidden\n}\n\n.apexcharts-selection-rect+g .svg_select_points_l,\n.apexcharts-selection-rect+g .svg_select_points_r {\n  cursor: ew-resize;\n  opacity: 1;\n  visibility: visible\n}\n\n.svg_select_points {\n  fill: #efefef;\n  stroke: #333;\n  rx: 2\n}\n\n.apexcharts-svg.apexcharts-zoomable.hovering-zoom {\n  cursor: crosshair\n}\n\n.apexcharts-svg.apexcharts-zoomable.hovering-pan {\n  cursor: move\n}\n\n.apexcharts-menu-icon,\n.apexcharts-pan-icon,\n.apexcharts-reset-icon,\n.apexcharts-selection-icon,\n.apexcharts-toolbar-custom-icon,\n.apexcharts-zoom-icon,\n.apexcharts-zoomin-icon,\n.apexcharts-zoomout-icon {\n  cursor: pointer;\n  width: 20px;\n  height: 20px;\n  line-height: 24px;\n  color: #6e8192;\n  text-align: center\n}\n\n.apexcharts-menu-icon svg,\n.apexcharts-reset-icon svg,\n.apexcharts-zoom-icon svg,\n.apexcharts-zoomin-icon svg,\n.apexcharts-zoomout-icon svg {\n  fill: #6e8192\n}\n\n.apexcharts-selection-icon svg {\n  fill: #444;\n  transform: scale(.76)\n}\n\n.apexcharts-theme-dark .apexcharts-menu-icon svg,\n.apexcharts-theme-dark .apexcharts-pan-icon svg,\n.apexcharts-theme-dark .apexcharts-reset-icon svg,\n.apexcharts-theme-dark .apexcharts-selection-icon svg,\n.apexcharts-theme-dark .apexcharts-toolbar-custom-icon svg,\n.apexcharts-theme-dark .apexcharts-zoom-icon svg,\n.apexcharts-theme-dark .apexcharts-zoomin-icon svg,\n.apexcharts-theme-dark .apexcharts-zoomout-icon svg {\n  fill: #f3f4f5\n}\n\n.apexcharts-canvas .apexcharts-reset-zoom-icon.apexcharts-selected svg,\n.apexcharts-canvas .apexcharts-selection-icon.apexcharts-selected svg,\n.apexcharts-canvas .apexcharts-zoom-icon.apexcharts-selected svg {\n  fill: #008ffb\n}\n\n.apexcharts-theme-light .apexcharts-menu-icon:hover svg,\n.apexcharts-theme-light .apexcharts-reset-icon:hover svg,\n.apexcharts-theme-light .apexcharts-selection-icon:not(.apexcharts-selected):hover svg,\n.apexcharts-theme-light .apexcharts-zoom-icon:not(.apexcharts-selected):hover svg,\n.apexcharts-theme-light .apexcharts-zoomin-icon:hover svg,\n.apexcharts-theme-light .apexcharts-zoomout-icon:hover svg {\n  fill: #333\n}\n\n.apexcharts-menu-icon,\n.apexcharts-selection-icon {\n  position: relative\n}\n\n.apexcharts-reset-icon {\n  margin-left: 5px\n}\n\n.apexcharts-menu-icon,\n.apexcharts-reset-icon,\n.apexcharts-zoom-icon {\n  transform: scale(.85)\n}\n\n.apexcharts-zoomin-icon,\n.apexcharts-zoomout-icon {\n  transform: scale(.7)\n}\n\n.apexcharts-zoomout-icon {\n  margin-right: 3px\n}\n\n.apexcharts-pan-icon {\n  transform: scale(.62);\n  position: relative;\n  left: 1px;\n  top: 0\n}\n\n.apexcharts-pan-icon svg {\n  fill: #fff;\n  stroke: #6e8192;\n  stroke-width: 2\n}\n\n.apexcharts-pan-icon.apexcharts-selected svg {\n  stroke: #008ffb\n}\n\n.apexcharts-pan-icon:not(.apexcharts-selected):hover svg {\n  stroke: #333\n}\n\n.apexcharts-toolbar {\n  position: absolute;\n  z-index: 11;\n  max-width: 176px;\n  text-align: right;\n  border-radius: 3px;\n  padding: 0 6px 2px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center\n}\n\n.apexcharts-menu {\n  background: #fff;\n  position: absolute;\n  top: 100%;\n  border: 1px solid #ddd;\n  border-radius: 3px;\n  padding: 3px;\n  right: 10px;\n  opacity: 0;\n  min-width: 110px;\n  transition: .15s ease all;\n  pointer-events: none\n}\n\n.apexcharts-menu.apexcharts-menu-open {\n  opacity: 1;\n  pointer-events: all;\n  transition: .15s ease all\n}\n\n.apexcharts-menu-item {\n  padding: 6px 7px;\n  font-size: 12px;\n  cursor: pointer\n}\n\n.apexcharts-theme-light .apexcharts-menu-item:hover {\n  background: #eee\n}\n\n.apexcharts-theme-dark .apexcharts-menu {\n  background: rgba(0, 0, 0, .7);\n  color: #fff\n}\n\n@media screen and (min-width:768px) {\n  .apexcharts-canvas:hover .apexcharts-toolbar {\n    opacity: 1\n  }\n}\n\n.apexcharts-canvas .apexcharts-element-hidden,\n.apexcharts-datalabel.apexcharts-element-hidden,\n.apexcharts-hide .apexcharts-series-points {\n  opacity: 0;\n}\n\n.apexcharts-hidden-element-shown {\n  opacity: 1;\n  transition: 0.25s ease all;\n}\n\n.apexcharts-datalabel,\n.apexcharts-datalabel-label,\n.apexcharts-datalabel-value,\n.apexcharts-datalabels,\n.apexcharts-pie-label {\n  cursor: default;\n  pointer-events: none\n}\n\n.apexcharts-pie-label-delay {\n  opacity: 0;\n  animation-name: opaque;\n  animation-duration: .3s;\n  animation-fill-mode: forwards;\n  animation-timing-function: ease\n}\n\n.apexcharts-radialbar-label {\n  cursor: pointer;\n}\n\n.apexcharts-annotation-rect,\n.apexcharts-area-series .apexcharts-area,\n.apexcharts-area-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,\n.apexcharts-gridline,\n.apexcharts-line,\n.apexcharts-line-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,\n.apexcharts-point-annotation-label,\n.apexcharts-radar-series path,\n.apexcharts-radar-series polygon,\n.apexcharts-toolbar svg,\n.apexcharts-tooltip .apexcharts-marker,\n.apexcharts-xaxis-annotation-label,\n.apexcharts-yaxis-annotation-label,\n.apexcharts-zoom-rect {\n  pointer-events: none\n}\n\n.apexcharts-marker {\n  transition: .15s ease all\n}\n\n.resize-triggers {\n  animation: 1ms resizeanim;\n  visibility: hidden;\n  opacity: 0;\n  height: 100%;\n  width: 100%;\n  overflow: hidden\n}\n\n.contract-trigger:before,\n.resize-triggers,\n.resize-triggers>div {\n  content: " ";\n  display: block;\n  position: absolute;\n  top: 0;\n  left: 0\n}\n\n.resize-triggers>div {\n  height: 100%;\n  width: 100%;\n  background: #eee;\n  overflow: auto\n}\n\n.contract-trigger:before {\n  overflow: hidden;\n  width: 200%;\n  height: 200%\n}\n\n.apexcharts-bar-goals-markers {\n  pointer-events: none\n}\n\n.apexcharts-bar-shadows {\n  pointer-events: none\n}\n\n.apexcharts-rangebar-goals-markers {\n  pointer-events: none\n}';var C=(null===(y=r.opts.chart)||void 0===y?void 0:y.nonce)||r.w.config.chart.nonce;C&&v.setAttribute("nonce",C),h?u.prepend(v):p.head.appendChild(v)}var k=r.create(r.w.config.series,{});if(!k)return i(r);r.mount(k).then(function(){"function"==typeof r.w.config.chart.events.mounted&&r.w.config.chart.events.mounted(r,r.w),r.events.fireEvent("mounted",[r,r.w]),i(k)}).catch(function(S){o(S)})}else o(new Error("Element not found"))})}},{key:"create",value:function(r,i){var o=this.w;new Cr(this).initModules();var l=this.w.globals;if(l.noData=!1,l.animationEnded=!1,this.responsive.checkResponsiveConfig(i),o.config.xaxis.convertedCatToNumeric&&new Nn(o.config).convertCatToNumericXaxis(o.config,this.ctx),null===this.el||(this.core.setupElements(),"treemap"===o.config.chart.type&&(o.config.grid.show=!1,o.config.yaxis[0].show=!1),0===l.svgWidth))return l.animationEnded=!0,null;var u=yn.checkComboSeries(r,o.config.chart.type);l.comboCharts=u.comboCharts,l.comboBarCount=u.comboBarCount;var h=r.every(function(C){return C.data&&0===C.data.length});(0===r.length||h&&l.collapsedSeries.length<1)&&this.series.handleNoData(),this.events.setupEventHandlers(),this.data.parseData(r),this.theme.init(),new Rr(this).setGlobalMarkerSize(),this.formatters.setLabelFormatters(),this.titleSubtitle.draw(),l.noData&&l.collapsedSeries.length!==l.series.length&&!o.config.legend.showForSingleSeries||this.legend.init(),this.series.hasAllSeriesEqualX(),l.axisCharts&&(this.core.coreCalculations(),"category"!==o.config.xaxis.type&&this.formatters.setLabelFormatters(),this.ctx.toolbar.minX=o.globals.minX,this.ctx.toolbar.maxX=o.globals.maxX),this.formatters.heatmapLabelFormatters(),new yn(this).getLargestMarkerSize(),this.dimensions.plotCoords();var p=this.core.xySettings();this.grid.createGridMask();var v=this.core.plotChartType(r,p),y=new wn(this);return y.bringForward(),o.config.dataLabels.background.enabled&&y.dataLabelsBackground(),this.core.shiftGraphPosition(),{elGraph:v,xyRatios:p,dimensions:{plot:{left:o.globals.translateX,top:o.globals.translateY,width:o.globals.gridWidth,height:o.globals.gridHeight}}}}},{key:"mount",value:function(){var r=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=this,l=o.w;return new Promise(function(u,h){if(null===o.el)return h(new Error("Not enough data to display or target element not found"));(null===i||l.globals.allSeriesCollapsed)&&o.series.handleNoData(),o.grid=new qi(o);var p,v,y=o.grid.drawGrid();if(o.annotations=new ji(o),o.annotations.drawImageAnnos(),o.annotations.drawTextAnnos(),"back"===l.config.grid.position&&(y&&l.globals.dom.elGraphical.add(y.el),null!=y&&null!==(p=y.elGridBorders)&&void 0!==p&&p.node&&l.globals.dom.elGraphical.add(y.elGridBorders)),Array.isArray(i.elGraph))for(var C=0;C<i.elGraph.length;C++)l.globals.dom.elGraphical.add(i.elGraph[C]);else l.globals.dom.elGraphical.add(i.elGraph);"front"===l.config.grid.position&&(y&&l.globals.dom.elGraphical.add(y.el),null!=y&&null!==(v=y.elGridBorders)&&void 0!==v&&v.node&&l.globals.dom.elGraphical.add(y.elGridBorders)),"front"===l.config.xaxis.crosshairs.position&&o.crosshairs.drawXCrosshairs(),"front"===l.config.yaxis[0].crosshairs.position&&o.crosshairs.drawYCrosshairs(),"treemap"!==l.config.chart.type&&o.axes.drawAxis(l.config.chart.type,y);var k=new Pr(r.ctx,y),S=new ca(r.ctx,y);if(null!==y&&(k.xAxisLabelCorrections(y.xAxisTickWidth),S.setYAxisTextAlignments(),l.config.yaxis.map(function(N,B){-1===l.globals.ignoreYAxisIndexes.indexOf(B)&&S.yAxisTitleRotate(B,N.opposite)})),o.annotations.drawAxesAnnotations(),!l.globals.noData){if(l.config.tooltip.enabled&&!l.globals.noData&&o.w.globals.tooltip.drawTooltip(i.xyRatios),l.globals.axisCharts&&(l.globals.isXNumeric||l.config.xaxis.convertedCatToNumeric||l.globals.isRangeBar))(l.config.chart.zoom.enabled||l.config.chart.selection&&l.config.chart.selection.enabled||l.config.chart.pan&&l.config.chart.pan.enabled)&&o.zoomPanSelection.init({xyRatios:i.xyRatios});else{var R=l.config.chart.toolbar.tools;["zoom","zoomin","zoomout","selection","pan","reset"].forEach(function(N){R[N]=!1})}l.config.chart.toolbar.show&&!l.globals.allSeriesCollapsed&&o.toolbar.createToolbar()}l.globals.memory.methodsToExec.length>0&&l.globals.memory.methodsToExec.forEach(function(N){N.method(N.params,!1,N.context)}),l.globals.axisCharts||l.globals.noData||o.core.resizeNonAxisCharts(),u(o)})}},{key:"destroy",value:function(){var r,i;window.removeEventListener("resize",this.windowResizeHandler),(i=dt.get(r=this.parentResizeHandler))&&(i.disconnect(),dt.delete(r));var o=this.w.config.chart.id;o&&Apex._chartInstances.forEach(function(l,u){l.id===pe.escapeString(o)&&Apex._chartInstances.splice(u,1)}),new Nr(this.ctx).clear({isUpdating:!1})}},{key:"updateOptions",value:function(r){var i=this,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],u=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],h=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],p=this.w;return p.globals.selection=void 0,r.series&&(this.series.resetSeries(!1,!0,!1),r.series.length&&r.series[0].data&&(r.series=r.series.map(function(v,y){return i.updateHelpers._extendSeries(v,y)})),this.updateHelpers.revertDefaultAxisMinMax()),r.xaxis&&(r=this.updateHelpers.forceXAxisUpdate(r)),r.yaxis&&(r=this.updateHelpers.forceYAxisUpdate(r)),p.globals.collapsedSeriesIndices.length>0&&this.series.clearPreviousPaths(),r.theme&&(r=this.theme.updateThemeOptions(r)),this.updateHelpers._updateOptions(r,o,l,u,h)}},{key:"updateSeries",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.series.resetSeries(!1),this.updateHelpers.revertDefaultAxisMinMax(),this.updateHelpers._updateSeries(r,i,o)}},{key:"appendSeries",value:function(r){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],l=this.w.config.series.slice();return l.push(r),this.series.resetSeries(!1),this.updateHelpers.revertDefaultAxisMinMax(),this.updateHelpers._updateSeries(l,i,o)}},{key:"appendData",value:function(r){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=this;o.w.globals.dataChanged=!0,o.series.getPreviousPaths();for(var l=o.w.config.series.slice(),u=0;u<l.length;u++)if(null!=r[u])for(var h=0;h<r[u].data.length;h++)l[u].data.push(r[u].data[h]);return o.w.config.series=l,i&&(o.w.globals.initialSeries=pe.clone(o.w.config.series)),this.update()}},{key:"update",value:function(r){var i=this;return new Promise(function(o,l){new Nr(i.ctx).clear({isUpdating:!0});var u=i.create(i.w.config.series,r);if(!u)return o(i);i.mount(u).then(function(){"function"==typeof i.w.config.chart.events.updated&&i.w.config.chart.events.updated(i,i.w),i.events.fireEvent("updated",[i,i.w]),i.w.globals.isDirty=!0,o(i)}).catch(function(h){l(h)})})}},{key:"getSyncedCharts",value:function(){var r=this.getGroupedCharts(),i=[this];return r.length&&(i=[],r.forEach(function(o){i.push(o)})),i}},{key:"getGroupedCharts",value:function(){var r=this;return Apex._chartInstances.filter(function(i){if(i.group)return!0}).map(function(i){return r.w.config.chart.group===i.group?i.chart:r})}},{key:"toggleSeries",value:function(r){return this.series.toggleSeries(r)}},{key:"highlightSeriesOnLegendHover",value:function(r,i){return this.series.toggleSeriesOnHover(r,i)}},{key:"showSeries",value:function(r){this.series.showSeries(r)}},{key:"hideSeries",value:function(r){this.series.hideSeries(r)}},{key:"isSeriesHidden",value:function(r){this.series.isSeriesHidden(r)}},{key:"resetSeries",value:function(){this.series.resetSeries(!(arguments.length>0&&void 0!==arguments[0])||arguments[0],!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}},{key:"addEventListener",value:function(r,i){this.events.addEventListener(r,i)}},{key:"removeEventListener",value:function(r,i){this.events.removeEventListener(r,i)}},{key:"addXaxisAnnotation",value:function(r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,l=this;o&&(l=o),l.annotations.addXaxisAnnotationExternal(r,!(arguments.length>1&&void 0!==arguments[1])||arguments[1],l)}},{key:"addYaxisAnnotation",value:function(r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,l=this;o&&(l=o),l.annotations.addYaxisAnnotationExternal(r,!(arguments.length>1&&void 0!==arguments[1])||arguments[1],l)}},{key:"addPointAnnotation",value:function(r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,l=this;o&&(l=o),l.annotations.addPointAnnotationExternal(r,!(arguments.length>1&&void 0!==arguments[1])||arguments[1],l)}},{key:"clearAnnotations",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,i=this;r&&(i=r),i.annotations.clearAnnotations(i)}},{key:"removeAnnotation",value:function(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=this;i&&(o=i),o.annotations.removeAnnotation(o,r)}},{key:"getChartArea",value:function(){return this.w.globals.dom.baseEl.querySelector(".apexcharts-inner")}},{key:"getSeriesTotalXRange",value:function(r,i){return this.coreUtils.getSeriesTotalsXRange(r,i)}},{key:"getHighestValueInSeries",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Br(this.ctx).getMinYMaxY(r).highestY}},{key:"getLowestValueInSeries",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Br(this.ctx).getMinYMaxY(r).lowestY}},{key:"getSeriesTotal",value:function(){return this.w.globals.seriesTotals}},{key:"toggleDataPointSelection",value:function(r,i){return this.updateHelpers.toggleDataPointSelection(r,i)}},{key:"zoomX",value:function(r,i){this.ctx.toolbar.zoomUpdateOptions(r,i)}},{key:"setLocale",value:function(r){this.localization.setCurrentLocaleValues(r)}},{key:"dataURI",value:function(r){return new Or(this.ctx).dataURI(r)}},{key:"exportToCSV",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Or(this.ctx).exportToCSV(r)}},{key:"paper",value:function(){return this.w.globals.dom.Paper}},{key:"_parentResizeCallback",value:function(){this.w.globals.animationEnded&&this.w.config.chart.redrawOnParentResize&&this._windowResize()}},{key:"_windowResize",value:function(){var r=this;clearTimeout(this.w.globals.resizeTimer),this.w.globals.resizeTimer=window.setTimeout(function(){r.w.globals.resized=!0,r.w.globals.dataChanged=!1,r.ctx.update()},150)}},{key:"_windowResizeHandler",value:function(){var r=this.w.config.chart.redrawOnWindowResize;"function"==typeof r&&(r=r()),r&&this._windowResize()}}],[{key:"getChartByID",value:function(r){var i=pe.escapeString(r);if(Apex._chartInstances){var o=Apex._chartInstances.filter(function(l){return l.id===i})[0];return o&&o.chart}}},{key:"initOnLoad",value:function(){for(var r=document.querySelectorAll("[data-apexcharts]"),i=0;i<r.length;i++)new P(r[i],JSON.parse(r[i].getAttribute("data-options"))).render()}},{key:"exec",value:function(r,i){var o=this.getChartByID(r);if(o){o.w.globals.isExecCalled=!0;var l=null;if(-1!==o.publicMethods.indexOf(i)){for(var u=arguments.length,h=new Array(u>2?u-2:0),p=2;p<u;p++)h[p-2]=arguments[p];l=o[i].apply(o,h)}return l}}},{key:"merge",value:function(r,i){return pe.extend(r,i)}}]),P}();return Aa}),function(Ce,Ze){"object"==typeof exports&&typeof module<"u"?module.exports=Ze():"function"==typeof define&&define.amd?define(Ze):(Ce=typeof globalThis<"u"?globalThis:Ce||self).bootstrap=Ze()}(this,function(){"use strict";const Ce=new Map,Ze={set(Q,E,Y){Ce.has(Q)||Ce.set(Q,new Map);const oe=Ce.get(Q);oe.has(E)||0===oe.size?oe.set(E,Y):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(oe.keys())[0]}.`)},get:(Q,E)=>Ce.has(Q)&&Ce.get(Q).get(E)||null,remove(Q,E){if(!Ce.has(Q))return;const Y=Ce.get(Q);Y.delete(E),0===Y.size&&Ce.delete(Q)}},ut="transitionend",F=Q=>(Q&&window.CSS&&window.CSS.escape&&(Q=Q.replace(/#([^\s"#']+)/g,(E,Y)=>`#${CSS.escape(Y)}`)),Q),de=Q=>{Q.dispatchEvent(new Event(ut))},me=Q=>!(!Q||"object"!=typeof Q)&&(void 0!==Q.jquery&&(Q=Q[0]),void 0!==Q.nodeType),st=Q=>me(Q)?Q.jquery?Q[0]:Q:"string"==typeof Q&&Q.length>0?document.querySelector(F(Q)):null,_e=Q=>{if(!me(Q)||0===Q.getClientRects().length)return!1;const E="visible"===getComputedStyle(Q).getPropertyValue("visibility"),Y=Q.closest("details:not([open])");if(!Y)return E;if(Y!==Q){const oe=Q.closest("summary");if(oe&&oe.parentNode!==Y||null===oe)return!1}return E},kt=Q=>!Q||Q.nodeType!==Node.ELEMENT_NODE||!!Q.classList.contains("disabled")||(void 0!==Q.disabled?Q.disabled:Q.hasAttribute("disabled")&&"false"!==Q.getAttribute("disabled")),Ft=Q=>{if(!document.documentElement.attachShadow)return null;if("function"==typeof Q.getRootNode){const E=Q.getRootNode();return E instanceof ShadowRoot?E:null}return Q instanceof ShadowRoot?Q:Q.parentNode?Ft(Q.parentNode):null},cn=()=>{},ar=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,gt=[],Et=()=>"rtl"===document.documentElement.dir,bn=Q=>{var E;E=()=>{const Y=ar();if(Y){const oe=Q.NAME,Se=Y.fn[oe];Y.fn[oe]=Q.jQueryInterface,Y.fn[oe].Constructor=Q,Y.fn[oe].noConflict=()=>(Y.fn[oe]=Se,Q.jQueryInterface)}},"loading"===document.readyState?(gt.length||document.addEventListener("DOMContentLoaded",()=>{for(const Y of gt)Y()}),gt.push(E)):E()},pe=(Q,E=[],Y=Q)=>"function"==typeof Q?Q(...E):Y,hi=(Q,E,Y=!0)=>{if(!Y)return void pe(Q);const oe=($e=>{if(!$e)return 0;let{transitionDuration:rt,transitionDelay:ct}=window.getComputedStyle($e);const _t=Number.parseFloat(rt),It=Number.parseFloat(ct);return _t||It?(rt=rt.split(",")[0],ct=ct.split(",")[0],1e3*(Number.parseFloat(rt)+Number.parseFloat(ct))):0})(E)+5;let Se=!1;const Re=({target:$e})=>{$e===E&&(Se=!0,E.removeEventListener(ut,Re),pe(Q))};E.addEventListener(ut,Re),setTimeout(()=>{Se||de(E)},oe)},On=(Q,E,Y,oe)=>{const Se=Q.length;let Re=Q.indexOf(E);return-1===Re?!Y&&oe?Q[Se-1]:Q[0]:(Re+=Y?1:-1,oe&&(Re=(Re+Se)%Se),Q[Math.max(0,Math.min(Re,Se-1))])},Ke=/[^.]*(?=\..*)\.|.*/,yn=/\..*/,ue=/::\d+$/,z={};let Mn=1;const Qt={mouseenter:"mouseover",mouseleave:"mouseout"},mt=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function or(Q,E){return E&&`${E}::${Mn++}`||Q.uidEvent||Mn++}function Qn(Q){const E=or(Q);return Q.uidEvent=E,z[E]=z[E]||{},z[E]}function Cn(Q,E,Y=null){return Object.values(Q).find(oe=>oe.callable===E&&oe.delegationSelector===Y)}function Lr(Q,E,Y){const oe="string"==typeof E,Se=oe?Y:E||Y;let Re=Nn(Q);return mt.has(Re)||(Re=Q),[oe,Se,Re]}function ji(Q,E,Y,oe,Se){if("string"!=typeof E||!Q)return;let[Re,$e,rt]=Lr(E,Y,oe);var nn;E in Qt&&(nn=$e,$e=function(Zt){if(!Zt.relatedTarget||Zt.relatedTarget!==Zt.delegateTarget&&!Zt.delegateTarget.contains(Zt.relatedTarget))return nn.call(this,Zt)});const ct=Qn(Q),_t=ct[rt]||(ct[rt]={}),It=Cn(_t,$e,Re?Y:null);if(It)return void(It.oneOff=It.oneOff&&Se);const xt=or($e,E.replace(Ke,"")),ln=Re?function(jt,nn,Zt){return function Jt(Un){const qn=jt.querySelectorAll(nn);for(let{target:vn}=Un;vn&&vn!==this;vn=vn.parentNode)for(const Ln of qn)if(Ln===vn)return Ai(Un,{delegateTarget:vn}),Jt.oneOff&&Je.off(jt,Un.type,nn,Zt),Zt.apply(vn,[Un])}}(Q,Y,$e):function(jt,nn){return function Zt(Jt){return Ai(Jt,{delegateTarget:jt}),Zt.oneOff&&Je.off(jt,Jt.type,nn),nn.apply(jt,[Jt])}}(Q,$e);ln.delegationSelector=Re?Y:null,ln.callable=$e,ln.oneOff=Se,ln.uidEvent=xt,_t[xt]=ln,Q.addEventListener(rt,ln,Re)}function sa(Q,E,Y,oe,Se){const Re=Cn(E[Y],oe,Se);Re&&(Q.removeEventListener(Y,Re,!!Se),delete E[Y][Re.uidEvent])}function ri(Q,E,Y,oe){const Se=E[Y]||{};for(const[Re,$e]of Object.entries(Se))Re.includes(oe)&&sa(Q,E,Y,$e.callable,$e.delegationSelector)}function Nn(Q){return Q=Q.replace(yn,""),Qt[Q]||Q}const Je={on(Q,E,Y,oe){ji(Q,E,Y,oe,!1)},one(Q,E,Y,oe){ji(Q,E,Y,oe,!0)},off(Q,E,Y,oe){if("string"!=typeof E||!Q)return;const[Se,Re,$e]=Lr(E,Y,oe),rt=$e!==E,ct=Qn(Q),_t=ct[$e]||{},It=E.startsWith(".");if(void 0===Re){if(It)for(const xt of Object.keys(ct))ri(Q,ct,xt,E.slice(1));for(const[xt,ln]of Object.entries(_t)){const jt=xt.replace(ue,"");rt&&!E.includes(jt)||sa(Q,ct,$e,ln.callable,ln.delegationSelector)}}else{if(!Object.keys(_t).length)return;sa(Q,ct,$e,Re,Se?Y:null)}},trigger(Q,E,Y){if("string"!=typeof E||!Q)return null;const oe=ar();let Se=null,Re=!0,$e=!0,rt=!1;E!==Nn(E)&&oe&&(Se=oe.Event(E,Y),oe(Q).trigger(Se),Re=!Se.isPropagationStopped(),$e=!Se.isImmediatePropagationStopped(),rt=Se.isDefaultPrevented());const ct=Ai(new Event(E,{bubbles:Re,cancelable:!0}),Y);return rt&&ct.preventDefault(),$e&&Q.dispatchEvent(ct),ct.defaultPrevented&&Se&&Se.preventDefault(),ct}};function Ai(Q,E={}){for(const[Y,oe]of Object.entries(E))try{Q[Y]=oe}catch{Object.defineProperty(Q,Y,{configurable:!0,get:()=>oe})}return Q}function la(Q){if("true"===Q)return!0;if("false"===Q)return!1;if(Q===Number(Q).toString())return Number(Q);if(""===Q||"null"===Q)return null;if("string"!=typeof Q)return Q;try{return JSON.parse(decodeURIComponent(Q))}catch{return Q}}function Fr(Q){return Q.replace(/[A-Z]/g,E=>`-${E.toLowerCase()}`)}const Rr={setDataAttribute(Q,E,Y){Q.setAttribute(`data-bs-${Fr(E)}`,Y)},removeDataAttribute(Q,E){Q.removeAttribute(`data-bs-${Fr(E)}`)},getDataAttributes(Q){if(!Q)return{};const E={},Y=Object.keys(Q.dataset).filter(oe=>oe.startsWith("bs")&&!oe.startsWith("bsConfig"));for(const oe of Y){let Se=oe.replace(/^bs/,"");Se=Se.charAt(0).toLowerCase()+Se.slice(1,Se.length),E[Se]=la(Q.dataset[oe])}return E},getDataAttribute:(Q,E)=>la(Q.getAttribute(`data-bs-${Fr(E)}`))};class Ui{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(E){return E=this._mergeConfigObj(E),E=this._configAfterMerge(E),this._typeCheckConfig(E),E}_configAfterMerge(E){return E}_mergeConfigObj(E,Y){const oe=me(Y)?Rr.getDataAttribute(Y,"config"):{};return{...this.constructor.Default,..."object"==typeof oe?oe:{},...me(Y)?Rr.getDataAttributes(Y):{},..."object"==typeof E?E:{}}}_typeCheckConfig(E,Y=this.constructor.DefaultType){for(const[Se,Re]of Object.entries(Y)){const $e=E[Se],rt=me($e)?"element":null==(oe=$e)?`${oe}`:Object.prototype.toString.call(oe).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(Re).test(rt))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${Se}" provided type "${rt}" but expected type "${Re}".`)}var oe}}class wn extends Ui{constructor(E,Y){super(),(E=st(E))&&(this._element=E,this._config=this._getConfig(Y),Ze.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Ze.remove(this._element,this.constructor.DATA_KEY),Je.off(this._element,this.constructor.EVENT_KEY);for(const E of Object.getOwnPropertyNames(this))this[E]=null}_queueCallback(E,Y,oe=!0){hi(E,Y,oe)}_getConfig(E){return E=this._mergeConfigObj(E,this._element),E=this._configAfterMerge(E),this._typeCheckConfig(E),E}static getInstance(E){return Ze.get(st(E),this.DATA_KEY)}static getOrCreateInstance(E,Y={}){return this.getInstance(E)||new this(E,"object"==typeof Y?Y:null)}static get VERSION(){return"5.3.3"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(E){return`${E}${this.EVENT_KEY}`}}const Dr=Q=>{let E=Q.getAttribute("data-bs-target");if(!E||"#"===E){let Y=Q.getAttribute("href");if(!Y||!Y.includes("#")&&!Y.startsWith("."))return null;Y.includes("#")&&!Y.startsWith("#")&&(Y=`#${Y.split("#")[1]}`),E=Y&&"#"!==Y?Y.trim():null}return E?E.split(",").map(Y=>F(Y)).join(","):null},Ot={find:(Q,E=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(E,Q)),findOne:(Q,E=document.documentElement)=>Element.prototype.querySelector.call(E,Q),children:(Q,E)=>[].concat(...Q.children).filter(Y=>Y.matches(E)),parents(Q,E){const Y=[];let oe=Q.parentNode.closest(E);for(;oe;)Y.push(oe),oe=oe.parentNode.closest(E);return Y},prev(Q,E){let Y=Q.previousElementSibling;for(;Y;){if(Y.matches(E))return[Y];Y=Y.previousElementSibling}return[]},next(Q,E){let Y=Q.nextElementSibling;for(;Y;){if(Y.matches(E))return[Y];Y=Y.nextElementSibling}return[]},focusableChildren(Q){const E=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(Y=>`${Y}:not([tabindex^="-"])`).join(",");return this.find(E,Q).filter(Y=>!kt(Y)&&_e(Y))},getSelectorFromElement(Q){const E=Dr(Q);return E&&Ot.findOne(E)?E:null},getElementFromSelector(Q){const E=Dr(Q);return E?Ot.findOne(E):null},getMultipleElementsFromSelector(Q){const E=Dr(Q);return E?Ot.find(E):[]}},Or=(Q,E="hide")=>{const oe=Q.NAME;Je.on(document,`click.dismiss${Q.EVENT_KEY}`,`[data-bs-dismiss="${oe}"]`,function(Se){if(["A","AREA"].includes(this.tagName)&&Se.preventDefault(),kt(this))return;const Re=Ot.getElementFromSelector(this)||this.closest(`.${oe}`);Q.getOrCreateInstance(Re)[E]()})},Pr=".bs.alert",qi=`close${Pr}`,Si=`closed${Pr}`;class Br extends wn{static get NAME(){return"alert"}close(){if(Je.trigger(this._element,qi).defaultPrevented)return;this._element.classList.remove("show");const E=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,E)}_destroyElement(){this._element.remove(),Je.trigger(this._element,Si),this.dispose()}static jQueryInterface(E){return this.each(function(){const Y=Br.getOrCreateInstance(this);if("string"==typeof E){if(void 0===Y[E]||E.startsWith("_")||"constructor"===E)throw new TypeError(`No method named "${E}"`);Y[E](this)}})}}Or(Br,"close"),bn(Br);const ca='[data-bs-toggle="button"]';class yr extends wn{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(E){return this.each(function(){const Y=yr.getOrCreateInstance(this);"toggle"===E&&Y[E]()})}}Je.on(document,"click.bs.button.data-api",ca,Q=>{Q.preventDefault();const E=Q.target.closest(ca);yr.getOrCreateInstance(E).toggle()}),bn(yr);const di=".bs.swipe",fi=`touchstart${di}`,Da=`touchmove${di}`,wa=`touchend${di}`,pi=`pointerdown${di}`,ii=`pointerup${di}`,Ca={endCallback:null,leftCallback:null,rightCallback:null},Pi={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Tt extends Ui{constructor(E,Y){super(),this._element=E,E&&Tt.isSupported()&&(this._config=this._getConfig(Y),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Ca}static get DefaultType(){return Pi}static get NAME(){return"swipe"}dispose(){Je.off(this._element,di)}_start(E){this._supportPointerEvents?this._eventIsPointerPenTouch(E)&&(this._deltaX=E.clientX):this._deltaX=E.touches[0].clientX}_end(E){this._eventIsPointerPenTouch(E)&&(this._deltaX=E.clientX-this._deltaX),this._handleSwipe(),pe(this._config.endCallback)}_move(E){this._deltaX=E.touches&&E.touches.length>1?0:E.touches[0].clientX-this._deltaX}_handleSwipe(){const E=Math.abs(this._deltaX);if(E<=40)return;const Y=E/this._deltaX;this._deltaX=0,Y&&pe(Y>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(Je.on(this._element,pi,E=>this._start(E)),Je.on(this._element,ii,E=>this._end(E)),this._element.classList.add("pointer-event")):(Je.on(this._element,fi,E=>this._start(E)),Je.on(this._element,Da,E=>this._move(E)),Je.on(this._element,wa,E=>this._end(E)))}_eventIsPointerPenTouch(E){return this._supportPointerEvents&&("pen"===E.pointerType||"touch"===E.pointerType)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const nr=".bs.carousel",Pa=".data-api",Ma="next",Mi="prev",$i="left",Ni="right",ai=`slide${nr}`,Ur=`slid${nr}`,Ki=`keydown${nr}`,Na=`mouseenter${nr}`,Li=`mouseleave${nr}`,gi=`dragstart${nr}`,Ve=`load${nr}${Pa}`,ua=`click${nr}${Pa}`,Wr="carousel",rn="active",Me=".active",ha=".carousel-item",La=Me+ha,Hr={ArrowLeft:Ni,ArrowRight:$i},wr={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},ka={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class da extends wn{constructor(E,Y){super(E,Y),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=Ot.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===Wr&&this.cycle()}static get Default(){return wr}static get DefaultType(){return ka}static get NAME(){return"carousel"}next(){this._slide(Ma)}nextWhenVisible(){!document.hidden&&_e(this._element)&&this.next()}prev(){this._slide(Mi)}pause(){this._isSliding&&de(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?Je.one(this._element,Ur,()=>this.cycle()):this.cycle())}to(E){const Y=this._getItems();if(E>Y.length-1||E<0)return;if(this._isSliding)return void Je.one(this._element,Ur,()=>this.to(E));const oe=this._getItemIndex(this._getActive());oe!==E&&this._slide(E>oe?Ma:Mi,Y[E])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(E){return E.defaultInterval=E.interval,E}_addEventListeners(){this._config.keyboard&&Je.on(this._element,Ki,E=>this._keydown(E)),"hover"===this._config.pause&&(Je.on(this._element,Na,()=>this.pause()),Je.on(this._element,Li,()=>this._maybeEnableCycle())),this._config.touch&&Tt.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const Y of Ot.find(".carousel-item img",this._element))Je.on(Y,gi,oe=>oe.preventDefault());this._swipeHelper=new Tt(this._element,{leftCallback:()=>this._slide(this._directionToOrder($i)),rightCallback:()=>this._slide(this._directionToOrder(Ni)),endCallback:()=>{"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}})}_keydown(E){if(/input|textarea/i.test(E.target.tagName))return;const Y=Hr[E.key];Y&&(E.preventDefault(),this._slide(this._directionToOrder(Y)))}_getItemIndex(E){return this._getItems().indexOf(E)}_setActiveIndicatorElement(E){if(!this._indicatorsElement)return;const Y=Ot.findOne(Me,this._indicatorsElement);Y.classList.remove(rn),Y.removeAttribute("aria-current");const oe=Ot.findOne(`[data-bs-slide-to="${E}"]`,this._indicatorsElement);oe&&(oe.classList.add(rn),oe.setAttribute("aria-current","true"))}_updateInterval(){const E=this._activeElement||this._getActive();if(!E)return;const Y=Number.parseInt(E.getAttribute("data-bs-interval"),10);this._config.interval=Y||this._config.defaultInterval}_slide(E,Y=null){if(this._isSliding)return;const oe=this._getActive(),Se=E===Ma,Re=Y||On(this._getItems(),oe,Se,this._config.wrap);if(Re===oe)return;const $e=this._getItemIndex(Re),rt=xt=>Je.trigger(this._element,xt,{relatedTarget:Re,direction:this._orderToDirection(E),from:this._getItemIndex(oe),to:$e});if(rt(ai).defaultPrevented||!oe||!Re)return;const ct=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement($e),this._activeElement=Re;const _t=Se?"carousel-item-start":"carousel-item-end",It=Se?"carousel-item-next":"carousel-item-prev";Re.classList.add(It),oe.classList.add(_t),Re.classList.add(_t),this._queueCallback(()=>{Re.classList.remove(_t,It),Re.classList.add(rn),oe.classList.remove(rn,It,_t),this._isSliding=!1,rt(Ur)},oe,this._isAnimated()),ct&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return Ot.findOne(La,this._element)}_getItems(){return Ot.find(ha,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(E){return Et()?E===$i?Mi:Ma:E===$i?Ma:Mi}_orderToDirection(E){return Et()?E===Mi?$i:Ni:E===Mi?Ni:$i}static jQueryInterface(E){return this.each(function(){const Y=da.getOrCreateInstance(this,E);if("number"!=typeof E){if("string"==typeof E){if(void 0===Y[E]||E.startsWith("_")||"constructor"===E)throw new TypeError(`No method named "${E}"`);Y[E]()}}else Y.to(E)})}}Je.on(document,ua,"[data-bs-slide], [data-bs-slide-to]",function(Q){const E=Ot.getElementFromSelector(this);if(!E||!E.classList.contains(Wr))return;Q.preventDefault();const Y=da.getOrCreateInstance(E),oe=this.getAttribute("data-bs-slide-to");return oe?(Y.to(oe),void Y._maybeEnableCycle()):"next"===Rr.getDataAttribute(this,"slide")?(Y.next(),void Y._maybeEnableCycle()):(Y.prev(),void Y._maybeEnableCycle())}),Je.on(window,Ve,()=>{const Q=Ot.find('[data-bs-ride="carousel"]');for(const E of Q)da.getOrCreateInstance(E)}),bn(da);const Fi=".bs.collapse",Fa=`show${Fi}`,Oi=`shown${Fi}`,Bi=`hide${Fi}`,zi=`hidden${Fi}`,Ei=`click${Fi}.data-api`,Zi="show",Ji="collapse",Dn="collapsing",Wi=`:scope .${Ji} .${Ji}`,Bn='[data-bs-toggle="collapse"]',ns={parent:null,toggle:!0},no={parent:"(null|element)",toggle:"boolean"};class qr extends wn{constructor(E,Y){super(E,Y),this._isTransitioning=!1,this._triggerArray=[];const oe=Ot.find(Bn);for(const Se of oe){const Re=Ot.getSelectorFromElement(Se),$e=Ot.find(Re).filter(rt=>rt===this._element);null!==Re&&$e.length&&this._triggerArray.push(Se)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return ns}static get DefaultType(){return no}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let E=[];if(this._config.parent&&(E=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(Se=>Se!==this._element).map(Se=>qr.getOrCreateInstance(Se,{toggle:!1}))),E.length&&E[0]._isTransitioning||Je.trigger(this._element,Fa).defaultPrevented)return;for(const Se of E)Se.hide();const Y=this._getDimension();this._element.classList.remove(Ji),this._element.classList.add(Dn),this._element.style[Y]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const oe=`scroll${Y[0].toUpperCase()+Y.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(Dn),this._element.classList.add(Ji,Zi),this._element.style[Y]="",Je.trigger(this._element,Oi)},this._element,!0),this._element.style[Y]=`${this._element[oe]}px`}hide(){if(this._isTransitioning||!this._isShown()||Je.trigger(this._element,Bi).defaultPrevented)return;const E=this._getDimension();this._element.style[E]=`${this._element.getBoundingClientRect()[E]}px`,this._element.classList.add(Dn),this._element.classList.remove(Ji,Zi);for(const Y of this._triggerArray){const oe=Ot.getElementFromSelector(Y);oe&&!this._isShown(oe)&&this._addAriaAndCollapsedClass([Y],!1)}this._isTransitioning=!0,this._element.style[E]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(Dn),this._element.classList.add(Ji),Je.trigger(this._element,zi)},this._element,!0)}_isShown(E=this._element){return E.classList.contains(Zi)}_configAfterMerge(E){return E.toggle=!!E.toggle,E.parent=st(E.parent),E}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const E=this._getFirstLevelChildren(Bn);for(const Y of E){const oe=Ot.getElementFromSelector(Y);oe&&this._addAriaAndCollapsedClass([Y],this._isShown(oe))}}_getFirstLevelChildren(E){const Y=Ot.find(Wi,this._config.parent);return Ot.find(E,this._config.parent).filter(oe=>!Y.includes(oe))}_addAriaAndCollapsedClass(E,Y){if(E.length)for(const oe of E)oe.classList.toggle("collapsed",!Y),oe.setAttribute("aria-expanded",Y)}static jQueryInterface(E){const Y={};return"string"==typeof E&&/show|hide/.test(E)&&(Y.toggle=!1),this.each(function(){const oe=qr.getOrCreateInstance(this,Y);if("string"==typeof E){if(void 0===oe[E])throw new TypeError(`No method named "${E}"`);oe[E]()}})}}Je.on(document,Ei,Bn,function(Q){("A"===Q.target.tagName||Q.delegateTarget&&"A"===Q.delegateTarget.tagName)&&Q.preventDefault();for(const E of Ot.getMultipleElementsFromSelector(this))qr.getOrCreateInstance(E,{toggle:!1}).toggle()}),bn(qr);var Mr="top",Cr="bottom",Nr="right",dt="left",Aa="auto",P=[Mr,Cr,Nr,dt],r="start",i="end",o="clippingParents",l="viewport",u="popper",h="reference",p=P.reduce(function(Q,E){return Q.concat([E+"-"+r,E+"-"+i])},[]),v=[].concat(P,[Aa]).reduce(function(Q,E){return Q.concat([E,E+"-"+r,E+"-"+i])},[]),y="beforeRead",C="read",k="afterRead",S="beforeMain",R="main",N="afterMain",B="beforeWrite",U="write",j="afterWrite",K=[y,C,k,S,R,N,B,U,j];function x(Q){return Q?(Q.nodeName||"").toLowerCase():null}function I(Q){if(null==Q)return window;if("[object Window]"!==Q.toString()){var E=Q.ownerDocument;return E&&E.defaultView||window}return Q}function W(Q){return Q instanceof I(Q).Element||Q instanceof Element}function q(Q){return Q instanceof I(Q).HTMLElement||Q instanceof HTMLElement}function J(Q){return typeof ShadowRoot<"u"&&(Q instanceof I(Q).ShadowRoot||Q instanceof ShadowRoot)}const ne={name:"applyStyles",enabled:!0,phase:"write",fn:function(Q){var E=Q.state;Object.keys(E.elements).forEach(function(Y){var oe=E.styles[Y]||{},Se=E.attributes[Y]||{},Re=E.elements[Y];q(Re)&&x(Re)&&(Object.assign(Re.style,oe),Object.keys(Se).forEach(function($e){var rt=Se[$e];!1===rt?Re.removeAttribute($e):Re.setAttribute($e,!0===rt?"":rt)}))})},effect:function(Q){var E=Q.state,Y={popper:{position:E.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(E.elements.popper.style,Y.popper),E.styles=Y,E.elements.arrow&&Object.assign(E.elements.arrow.style,Y.arrow),function(){Object.keys(E.elements).forEach(function(oe){var Se=E.elements[oe],Re=E.attributes[oe]||{},$e=Object.keys(E.styles.hasOwnProperty(oe)?E.styles[oe]:Y[oe]).reduce(function(rt,ct){return rt[ct]="",rt},{});q(Se)&&x(Se)&&(Object.assign(Se.style,$e),Object.keys(Re).forEach(function(rt){Se.removeAttribute(rt)}))})}},requires:["computeStyles"]};function ve(Q){return Q.split("-")[0]}var ge=Math.max,Le=Math.min,qe=Math.round;function Pe(){var Q=navigator.userAgentData;return null!=Q&&Q.brands&&Array.isArray(Q.brands)?Q.brands.map(function(E){return E.brand+"/"+E.version}).join(" "):navigator.userAgent}function Ue(){return!/^((?!chrome|android).)*safari/i.test(Pe())}function lt(Q,E,Y){void 0===E&&(E=!1),void 0===Y&&(Y=!1);var oe=Q.getBoundingClientRect(),Se=1,Re=1;E&&q(Q)&&(Se=Q.offsetWidth>0&&qe(oe.width)/Q.offsetWidth||1,Re=Q.offsetHeight>0&&qe(oe.height)/Q.offsetHeight||1);var $e=(W(Q)?I(Q):window).visualViewport,rt=!Ue()&&Y,ct=(oe.left+(rt&&$e?$e.offsetLeft:0))/Se,_t=(oe.top+(rt&&$e?$e.offsetTop:0))/Re,It=oe.width/Se,xt=oe.height/Re;return{width:It,height:xt,top:_t,right:ct+It,bottom:_t+xt,left:ct,x:ct,y:_t}}function ft(Q){var E=lt(Q),Y=Q.offsetWidth,oe=Q.offsetHeight;return Math.abs(E.width-Y)<=1&&(Y=E.width),Math.abs(E.height-oe)<=1&&(oe=E.height),{x:Q.offsetLeft,y:Q.offsetTop,width:Y,height:oe}}function At(Q,E){var Y=E.getRootNode&&E.getRootNode();if(Q.contains(E))return!0;if(Y&&J(Y)){var oe=E;do{if(oe&&Q.isSameNode(oe))return!0;oe=oe.parentNode||oe.host}while(oe)}return!1}function St(Q){return I(Q).getComputedStyle(Q)}function Gt(Q){return["table","td","th"].indexOf(x(Q))>=0}function Lt(Q){return((W(Q)?Q.ownerDocument:Q.document)||window.document).documentElement}function $t(Q){return"html"===x(Q)?Q:Q.assignedSlot||Q.parentNode||(J(Q)?Q.host:null)||Lt(Q)}function zn(Q){return q(Q)&&"fixed"!==St(Q).position?Q.offsetParent:null}function En(Q){for(var E=I(Q),Y=zn(Q);Y&&Gt(Y)&&"static"===St(Y).position;)Y=zn(Y);return Y&&("html"===x(Y)||"body"===x(Y)&&"static"===St(Y).position)?E:Y||function(oe){var Se=/firefox/i.test(Pe());if(/Trident/i.test(Pe())&&q(oe)&&"fixed"===St(oe).position)return null;var Re=$t(oe);for(J(Re)&&(Re=Re.host);q(Re)&&["html","body"].indexOf(x(Re))<0;){var $e=St(Re);if("none"!==$e.transform||"none"!==$e.perspective||"paint"===$e.contain||-1!==["transform","perspective"].indexOf($e.willChange)||Se&&"filter"===$e.willChange||Se&&$e.filter&&"none"!==$e.filter)return Re;Re=Re.parentNode}return null}(Q)||E}function _n(Q){return["top","bottom"].indexOf(Q)>=0?"x":"y"}function sr(Q,E,Y){return ge(Q,Le(E,Y))}function fn(Q){return Object.assign({},{top:0,right:0,bottom:0,left:0},Q)}function en(Q,E){return E.reduce(function(Y,oe){return Y[oe]=Q,Y},{})}const kn={name:"arrow",enabled:!0,phase:"main",fn:function(Q){var E,Zn,Hn,Y=Q.state,oe=Q.name,Se=Q.options,Re=Y.elements.arrow,$e=Y.modifiersData.popperOffsets,rt=ve(Y.placement),ct=_n(rt),_t=[dt,Nr].indexOf(rt)>=0?"height":"width";if(Re&&$e){var It=(Hn=Y,fn("number"!=typeof(Zn="function"==typeof(Zn=Se.padding)?Zn(Object.assign({},Hn.rects,{placement:Hn.placement})):Zn)?Zn:en(Zn,P))),xt=ft(Re),ln="y"===ct?Mr:dt,jt="y"===ct?Cr:Nr,nn=Y.rects.reference[_t]+Y.rects.reference[ct]-$e[ct]-Y.rects.popper[_t],Zt=$e[ct]-Y.rects.reference[ct],Jt=En(Re),Un=Jt?"y"===ct?Jt.clientHeight||0:Jt.clientWidth||0:0,un=Un/2-xt[_t]/2+(nn/2-Zt/2),Sn=sr(It[ln],un,Un-xt[_t]-It[jt]);Y.modifiersData[oe]=((E={})[ct]=Sn,E.centerOffset=Sn-un,E)}},effect:function(Q){var E=Q.state,Y=Q.options.element,oe=void 0===Y?"[data-popper-arrow]":Y;null!=oe&&("string"!=typeof oe||(oe=E.elements.popper.querySelector(oe)))&&At(E.elements.popper,oe)&&(E.elements.arrow=oe)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Gn(Q){return Q.split("-")[1]}var cr={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Xr(Q){var E,Y=Q.popper,oe=Q.popperRect,Se=Q.placement,Re=Q.variation,$e=Q.offsets,rt=Q.position,ct=Q.gpuAcceleration,_t=Q.adaptive,It=Q.roundOffsets,xt=Q.isFixed,ln=$e.x,jt=void 0===ln?0:ln,nn=$e.y,Zt=void 0===nn?0:nn,Jt="function"==typeof It?It({x:jt,y:Zt}):{x:jt,y:Zt};jt=Jt.x,Zt=Jt.y;var Un=$e.hasOwnProperty("x"),qn=$e.hasOwnProperty("y"),vn=dt,Ln=Mr,un=window;if(_t){var Sn=En(Y),$n="clientHeight",Zn="clientWidth";Sn===I(Y)&&"static"!==St(Sn=Lt(Y)).position&&"absolute"===rt&&($n="scrollHeight",Zn="scrollWidth"),(Se===Mr||(Se===dt||Se===Nr)&&Re===i)&&(Ln=Cr,Zt-=(xt&&Sn===un&&un.visualViewport?un.visualViewport.height:Sn[$n])-oe.height,Zt*=ct?1:-1),Se!==dt&&(Se!==Mr&&Se!==Cr||Re!==i)||(vn=Nr,jt-=(xt&&Sn===un&&un.visualViewport?un.visualViewport.width:Sn[Zn])-oe.width,jt*=ct?1:-1)}var Hn,ra,xi,Gi,xr,Tr=Object.assign({position:rt},_t&&cr),Ri=!0===It?(ra={x:jt,y:Zt},xi=I(Y),Gi=ra.y,{x:qe(ra.x*(xr=xi.devicePixelRatio||1))/xr||0,y:qe(Gi*xr)/xr||0}):{x:jt,y:Zt};return jt=Ri.x,Zt=Ri.y,Object.assign({},Tr,ct?((Hn={})[Ln]=qn?"0":"",Hn[vn]=Un?"0":"",Hn.transform=(un.devicePixelRatio||1)<=1?"translate("+jt+"px, "+Zt+"px)":"translate3d("+jt+"px, "+Zt+"px, 0)",Hn):((E={})[Ln]=qn?Zt+"px":"",E[vn]=Un?jt+"px":"",E.transform="",E))}const Qi={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(Q){var E=Q.state,Y=Q.options,oe=Y.gpuAcceleration,Se=void 0===oe||oe,Re=Y.adaptive,$e=void 0===Re||Re,rt=Y.roundOffsets,ct=void 0===rt||rt,_t={placement:ve(E.placement),variation:Gn(E.placement),popper:E.elements.popper,popperRect:E.rects.popper,gpuAcceleration:Se,isFixed:"fixed"===E.options.strategy};null!=E.modifiersData.popperOffsets&&(E.styles.popper=Object.assign({},E.styles.popper,Xr(Object.assign({},_t,{offsets:E.modifiersData.popperOffsets,position:E.options.strategy,adaptive:$e,roundOffsets:ct})))),null!=E.modifiersData.arrow&&(E.styles.arrow=Object.assign({},E.styles.arrow,Xr(Object.assign({},_t,{offsets:E.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:ct})))),E.attributes.popper=Object.assign({},E.attributes.popper,{"data-popper-placement":E.placement})},data:{}};var rr={passive:!0};const kr={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(Q){var E=Q.state,Y=Q.instance,oe=Q.options,Se=oe.scroll,Re=void 0===Se||Se,$e=oe.resize,rt=void 0===$e||$e,ct=I(E.elements.popper),_t=[].concat(E.scrollParents.reference,E.scrollParents.popper);return Re&&_t.forEach(function(It){It.addEventListener("scroll",Y.update,rr)}),rt&&ct.addEventListener("resize",Y.update,rr),function(){Re&&_t.forEach(function(It){It.removeEventListener("scroll",Y.update,rr)}),rt&&ct.removeEventListener("resize",Y.update,rr)}},data:{}};var ko={left:"right",right:"left",bottom:"top",top:"bottom"};function Oa(Q){return Q.replace(/left|right|bottom|top/g,function(E){return ko[E]})}var Ms={start:"end",end:"start"};function $r(Q){return Q.replace(/start|end/g,function(E){return Ms[E]})}function Ba(Q){var E=I(Q);return{scrollLeft:E.pageXOffset,scrollTop:E.pageYOffset}}function rs(Q){return lt(Lt(Q)).left+Ba(Q).scrollLeft}function Sa(Q){var E=St(Q);return/auto|scroll|overlay|hidden/.test(E.overflow+E.overflowY+E.overflowX)}function Ao(Q){return["html","body","#document"].indexOf(x(Q))>=0?Q.ownerDocument.body:q(Q)&&Sa(Q)?Q:Ao($t(Q))}function za(Q,E){var Y;void 0===E&&(E=[]);var oe=Ao(Q),Se=oe===(null==(Y=Q.ownerDocument)?void 0:Y.body),Re=I(oe),$e=Se?[Re].concat(Re.visualViewport||[],Sa(oe)?oe:[]):oe,rt=E.concat($e);return Se?rt:rt.concat(za($t($e)))}function So(Q){return Object.assign({},Q,{left:Q.x,top:Q.y,right:Q.x+Q.width,bottom:Q.y+Q.height})}function Yt(Q,E,Y){return E===l?So(function(oe,Se){var Re=I(oe),$e=Lt(oe),rt=Re.visualViewport,ct=$e.clientWidth,_t=$e.clientHeight,It=0,xt=0;if(rt){ct=rt.width,_t=rt.height;var ln=Ue();(ln||!ln&&"fixed"===Se)&&(It=rt.offsetLeft,xt=rt.offsetTop)}return{width:ct,height:_t,x:It+rs(oe),y:xt}}(Q,Y)):W(E)?((Re=lt(oe=E,!1,"fixed"===Y)).top=Re.top+oe.clientTop,Re.left=Re.left+oe.clientLeft,Re.bottom=Re.top+oe.clientHeight,Re.right=Re.left+oe.clientWidth,Re.width=oe.clientWidth,Re.height=oe.clientHeight,Re.x=Re.left,Re.y=Re.top,Re):So(function(oe){var Se,Re=Lt(oe),$e=Ba(oe),rt=null==(Se=oe.ownerDocument)?void 0:Se.body,ct=ge(Re.scrollWidth,Re.clientWidth,rt?rt.scrollWidth:0,rt?rt.clientWidth:0),_t=ge(Re.scrollHeight,Re.clientHeight,rt?rt.scrollHeight:0,rt?rt.clientHeight:0),It=-$e.scrollLeft+rs(oe),xt=-$e.scrollTop;return"rtl"===St(rt||Re).direction&&(It+=ge(Re.clientWidth,rt?rt.clientWidth:0)-ct),{width:ct,height:_t,x:It,y:xt}}(Lt(Q)));var oe,Re}function is(Q){var E,Y=Q.reference,oe=Q.element,Se=Q.placement,Re=Se?ve(Se):null,$e=Se?Gn(Se):null,rt=Y.x+Y.width/2-oe.width/2,ct=Y.y+Y.height/2-oe.height/2;switch(Re){case Mr:E={x:rt,y:Y.y-oe.height};break;case Cr:E={x:rt,y:Y.y+Y.height};break;case Nr:E={x:Y.x+Y.width,y:ct};break;case dt:E={x:Y.x-oe.width,y:ct};break;default:E={x:Y.x,y:Y.y}}var _t=Re?_n(Re):null;if(null!=_t){var It="y"===_t?"height":"width";switch($e){case r:E[_t]=E[_t]-(Y[It]/2-oe[It]/2);break;case i:E[_t]=E[_t]+(Y[It]/2-oe[It]/2)}}return E}function ht(Q,E){void 0===E&&(E={});var xi,ia,Gi,xr,tr,bi,Vi,Ia,Ta,Vr,oe=E.placement,Se=void 0===oe?Q.placement:oe,Re=E.strategy,$e=void 0===Re?Q.strategy:Re,rt=E.boundary,ct=void 0===rt?o:rt,_t=E.rootBoundary,It=void 0===_t?l:_t,xt=E.elementContext,ln=void 0===xt?u:xt,jt=E.altBoundary,nn=void 0!==jt&&jt,Zt=E.padding,Jt=void 0===Zt?0:Zt,Un=fn("number"!=typeof Jt?Jt:en(Jt,P)),vn=Q.rects.popper,Ln=Q.elements[nn?ln===u?h:u:ln],un=(xi=W(Ln)?Ln:Ln.contextElement||Lt(Q.elements.popper),Gi=It,xr=$e,Ia="clippingParents"===(ia=ct)?(bi=za($t(tr=xi)),W(Vi=["absolute","fixed"].indexOf(St(tr).position)>=0&&q(tr)?En(tr):tr)?bi.filter(function(co){return W(co)&&At(co,Vi)&&"body"!==x(co)}):[]):[].concat(ia),Vr=(Ta=[].concat(Ia,[Gi])).reduce(function(tr,bi){var Vi=Yt(xi,bi,xr);return tr.top=ge(Vi.top,tr.top),tr.right=Le(Vi.right,tr.right),tr.bottom=Le(Vi.bottom,tr.bottom),tr.left=ge(Vi.left,tr.left),tr},Yt(xi,Ta[0],xr)),Vr.width=Vr.right-Vr.left,Vr.height=Vr.bottom-Vr.top,Vr.x=Vr.left,Vr.y=Vr.top,Vr),Sn=lt(Q.elements.reference),$n=is({reference:Sn,element:vn,strategy:"absolute",placement:Se}),Zn=So(Object.assign({},vn,$n)),Hn=ln===u?Zn:Sn,Tr={top:un.top-Hn.top+Un.top,bottom:Hn.bottom-un.bottom+Un.bottom,left:un.left-Hn.left+Un.left,right:Hn.right-un.right+Un.right},Ri=Q.modifiersData.offset;if(ln===u&&Ri){var ra=Ri[Se];Object.keys(Tr).forEach(function(xi){var ia=[Nr,Cr].indexOf(xi)>=0?1:-1,Gi=[Mr,Cr].indexOf(xi)>=0?"y":"x";Tr[xi]+=ra[Gi]*ia})}return Tr}const _={name:"flip",enabled:!0,phase:"main",fn:function(Q){var E=Q.state,Y=Q.options,oe=Q.name;if(!E.modifiersData[oe]._skip){for(var Se=Y.mainAxis,Re=void 0===Se||Se,$e=Y.altAxis,rt=void 0===$e||$e,ct=Y.fallbackPlacements,_t=Y.padding,It=Y.boundary,xt=Y.rootBoundary,ln=Y.altBoundary,jt=Y.flipVariations,nn=void 0===jt||jt,Zt=Y.allowedAutoPlacements,Jt=E.options.placement,Un=ve(Jt),qn=ct||(Un!==Jt&&nn?function(tr){if(ve(tr)===Aa)return[];var bi=Oa(tr);return[$r(tr),bi,$r(bi)]}(Jt):[Oa(Jt)]),vn=[Jt].concat(qn).reduce(function(tr,bi){return tr.concat(ve(bi)===Aa?function b(Q,E){void 0===E&&(E={});var Se=E.boundary,Re=E.rootBoundary,$e=E.padding,rt=E.flipVariations,ct=E.allowedAutoPlacements,_t=void 0===ct?v:ct,It=Gn(E.placement),xt=It?rt?p:p.filter(function(nn){return Gn(nn)===It}):P,ln=xt.filter(function(nn){return _t.indexOf(nn)>=0});0===ln.length&&(ln=xt);var jt=ln.reduce(function(nn,Zt){return nn[Zt]=ht(Q,{placement:Zt,boundary:Se,rootBoundary:Re,padding:$e})[ve(Zt)],nn},{});return Object.keys(jt).sort(function(nn,Zt){return jt[nn]-jt[Zt]})}(E,{placement:bi,boundary:It,rootBoundary:xt,padding:_t,flipVariations:nn,allowedAutoPlacements:Zt}):bi)},[]),Ln=E.rects.reference,un=E.rects.popper,Sn=new Map,$n=!0,Zn=vn[0],Hn=0;Hn<vn.length;Hn++){var Tr=vn[Hn],Ri=ve(Tr),ra=Gn(Tr)===r,xi=[Mr,Cr].indexOf(Ri)>=0,ia=xi?"width":"height",Gi=ht(E,{placement:Tr,boundary:It,rootBoundary:xt,altBoundary:ln,padding:_t}),xr=xi?ra?Nr:dt:ra?Cr:Mr;Ln[ia]>un[ia]&&(xr=Oa(xr));var Ia=Oa(xr),Ta=[];if(Re&&Ta.push(Gi[Ri]<=0),rt&&Ta.push(Gi[xr]<=0,Gi[Ia]<=0),Ta.every(function(tr){return tr})){Zn=Tr,$n=!1;break}Sn.set(Tr,Ta)}if($n)for(var hs=function(tr){var bi=vn.find(function(Vi){var co=Sn.get(Vi);if(co)return co.slice(0,tr).every(function(vl){return vl})});if(bi)return Zn=bi,"break"},Vr=nn?3:1;Vr>0&&"break"!==hs(Vr);Vr--);E.placement!==Zn&&(E.modifiersData[oe]._skip=!0,E.placement=Zn,E.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function L(Q,E,Y){return void 0===Y&&(Y={x:0,y:0}),{top:Q.top-E.height-Y.y,right:Q.right-E.width+Y.x,bottom:Q.bottom-E.height+Y.y,left:Q.left-E.width-Y.x}}function G(Q){return[Mr,Nr,Cr,dt].some(function(E){return Q[E]>=0})}const Z={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(Q){var E=Q.state,Y=Q.name,oe=E.rects.reference,Se=E.rects.popper,Re=E.modifiersData.preventOverflow,$e=ht(E,{elementContext:"reference"}),rt=ht(E,{altBoundary:!0}),ct=L($e,oe),_t=L(rt,Se,Re),It=G(ct),xt=G(_t);E.modifiersData[Y]={referenceClippingOffsets:ct,popperEscapeOffsets:_t,isReferenceHidden:It,hasPopperEscaped:xt},E.attributes.popper=Object.assign({},E.attributes.popper,{"data-popper-reference-hidden":It,"data-popper-escaped":xt})}},D={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(Q){var E=Q.state,oe=Q.name,Se=Q.options.offset,Re=void 0===Se?[0,0]:Se,$e=v.reduce(function(It,xt){return It[xt]=(jt=E.rects,nn=Re,Zt=ve(ln=xt),Jt=[dt,Mr].indexOf(Zt)>=0?-1:1,qn=(qn=(Un="function"==typeof nn?nn(Object.assign({},jt,{placement:ln})):nn)[0])||0,vn=((vn=Un[1])||0)*Jt,[dt,Nr].indexOf(Zt)>=0?{x:vn,y:qn}:{x:qn,y:vn}),It;var ln,jt,nn,Zt,Jt,Un,qn,vn},{}),rt=$e[E.placement],_t=rt.y;null!=E.modifiersData.popperOffsets&&(E.modifiersData.popperOffsets.x+=rt.x,E.modifiersData.popperOffsets.y+=_t),E.modifiersData[oe]=$e}},ae={name:"popperOffsets",enabled:!0,phase:"read",fn:function(Q){var E=Q.state;E.modifiersData[Q.name]=is({reference:E.rects.reference,element:E.rects.popper,strategy:"absolute",placement:E.placement})},data:{}},ke={name:"preventOverflow",enabled:!0,phase:"main",fn:function(Q){var bl,iu,E=Q.state,Y=Q.options,oe=Q.name,Se=Y.mainAxis,Re=void 0===Se||Se,$e=Y.altAxis,rt=void 0!==$e&&$e,ln=Y.tether,jt=void 0===ln||ln,nn=Y.tetherOffset,Zt=void 0===nn?0:nn,Jt=ht(E,{boundary:Y.boundary,rootBoundary:Y.rootBoundary,padding:Y.padding,altBoundary:Y.altBoundary}),Un=ve(E.placement),qn=Gn(E.placement),vn=!qn,Ln=_n(Un),un="x"===Ln?"y":"x",Sn=E.modifiersData.popperOffsets,$n=E.rects.reference,Zn=E.rects.popper,Hn="function"==typeof Zt?Zt(Object.assign({},E.rects,{placement:E.placement})):Zt,Tr="number"==typeof Hn?{mainAxis:Hn,altAxis:Hn}:Object.assign({mainAxis:0,altAxis:0},Hn),Ri=E.modifiersData.offset?E.modifiersData.offset[E.placement]:null,ra={x:0,y:0};if(Sn){if(Re){var xi,ia="y"===Ln?Mr:dt,Gi="y"===Ln?Cr:Nr,xr="y"===Ln?"height":"width",Ia=Sn[Ln],Ta=Ia+Jt[ia],hs=Ia-Jt[Gi],Vr=jt?-Zn[xr]/2:0,tr=qn===r?$n[xr]:Zn[xr],bi=qn===r?-Zn[xr]:-$n[xr],Vi=E.elements.arrow,co=jt&&Vi?ft(Vi):{width:0,height:0},vl=E.modifiersData["arrow#persistent"]?E.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},Kc=vl[ia],Ql=vl[Gi],$a=sr(0,$n[xr],co[xr]),mh=vn?$n[xr]/2-Vr-$a-Kc-Tr.mainAxis:tr-$a-Kc-Tr.mainAxis,Zc=vn?-$n[xr]/2+Vr+$a+Ql+Tr.mainAxis:bi+$a+Ql+Tr.mainAxis,ml=E.elements.arrow&&En(E.elements.arrow),Jc=ml?"y"===Ln?ml.clientTop||0:ml.clientLeft||0:0,ds=null!=(xi=Ri?.[Ln])?xi:0,Qc=Ia+Zc-ds,ec=sr(jt?Le(Ta,Ia+mh-ds-Jc):Ta,Ia,jt?ge(hs,Qc):hs);Sn[Ln]=ec,ra[Ln]=ec-Ia}if(rt){var tc,uo=Sn[un],Gs="y"===un?"height":"width",nc=uo+Jt["x"===Ln?Mr:dt],rc=uo-Jt["x"===Ln?Cr:Nr],xl=-1!==[Mr,dt].indexOf(Un),ic=null!=(tc=Ri?.[un])?tc:0,ac=xl?nc:uo-$n[Gs]-Zn[Gs]-ic+Tr.altAxis,oc=xl?uo+$n[Gs]+Zn[Gs]-ic-Tr.altAxis:rc,nu=jt&&xl?(iu=sr(ac,uo,bl=oc))>bl?bl:iu:sr(jt?ac:nc,uo,jt?oc:rc);Sn[un]=nu,ra[un]=nu-uo}E.modifiersData[oe]=ra}},requiresIfExists:["offset"]};function we(Q,E,Y){void 0===Y&&(Y=!1);var oe,Se,xt,ln,jt,nn,Re=q(E),$e=q(E)&&(ln=(xt=E).getBoundingClientRect(),jt=qe(ln.width)/xt.offsetWidth||1,nn=qe(ln.height)/xt.offsetHeight||1,1!==jt||1!==nn),rt=Lt(E),ct=lt(Q,$e,Y),_t={scrollLeft:0,scrollTop:0},It={x:0,y:0};return(Re||!Re&&!Y)&&(("body"!==x(E)||Sa(rt))&&(_t=(oe=E)!==I(oe)&&q(oe)?{scrollLeft:(Se=oe).scrollLeft,scrollTop:Se.scrollTop}:Ba(oe)),q(E)?((It=lt(E,!0)).x+=E.clientLeft,It.y+=E.clientTop):rt&&(It.x=rs(rt))),{x:ct.left+_t.scrollLeft-It.x,y:ct.top+_t.scrollTop-It.y,width:ct.width,height:ct.height}}function Ie(Q){var E=new Map,Y=new Set,oe=[];function Se(Re){Y.add(Re.name),[].concat(Re.requires||[],Re.requiresIfExists||[]).forEach(function($e){if(!Y.has($e)){var rt=E.get($e);rt&&Se(rt)}}),oe.push(Re)}return Q.forEach(function(Re){E.set(Re.name,Re)}),Q.forEach(function(Re){Y.has(Re.name)||Se(Re)}),oe}var Oe={placement:"bottom",modifiers:[],strategy:"absolute"};function Ye(){for(var Q=arguments.length,E=new Array(Q),Y=0;Y<Q;Y++)E[Y]=arguments[Y];return!E.some(function(oe){return!(oe&&"function"==typeof oe.getBoundingClientRect)})}function Ne(Q){void 0===Q&&(Q={});var Y=Q.defaultModifiers,oe=void 0===Y?[]:Y,Se=Q.defaultOptions,Re=void 0===Se?Oe:Se;return function($e,rt,ct){void 0===ct&&(ct=Re);var _t,It,xt={placement:"bottom",orderedModifiers:[],options:Object.assign({},Oe,Re),modifiersData:{},elements:{reference:$e,popper:rt},attributes:{},styles:{}},ln=[],jt=!1,nn={state:xt,setOptions:function(Jt){var Un="function"==typeof Jt?Jt(xt.options):Jt;Zt(),xt.options=Object.assign({},Re,xt.options,Un),xt.scrollParents={reference:W($e)?za($e):$e.contextElement?za($e.contextElement):[],popper:za(rt)};var qn,vn,un,Sn,Ln=(qn=[].concat(oe,xt.options.modifiers),vn=qn.reduce(function(un,Sn){var $n=un[Sn.name];return un[Sn.name]=$n?Object.assign({},$n,Sn,{options:Object.assign({},$n.options,Sn.options),data:Object.assign({},$n.data,Sn.data)}):Sn,un},{}),un=Object.keys(vn).map(function(un){return vn[un]}),Sn=Ie(un),K.reduce(function($n,Zn){return $n.concat(Sn.filter(function(Hn){return Hn.phase===Zn}))},[]));return xt.orderedModifiers=Ln.filter(function(un){return un.enabled}),xt.orderedModifiers.forEach(function(un){var $n=un.options,Hn=un.effect;if("function"==typeof Hn){var Tr=Hn({state:xt,name:un.name,instance:nn,options:void 0===$n?{}:$n});ln.push(Tr||function(){})}}),nn.update()},forceUpdate:function(){if(!jt){var Jt=xt.elements,Un=Jt.reference,qn=Jt.popper;if(Ye(Un,qn)){xt.rects={reference:we(Un,En(qn),"fixed"===xt.options.strategy),popper:ft(qn)},xt.reset=!1,xt.placement=xt.options.placement,xt.orderedModifiers.forEach(function(Hn){return xt.modifiersData[Hn.name]=Object.assign({},Hn.data)});for(var vn=0;vn<xt.orderedModifiers.length;vn++)if(!0!==xt.reset){var Ln=xt.orderedModifiers[vn],un=Ln.fn,Sn=Ln.options;"function"==typeof un&&(xt=un({state:xt,options:void 0===Sn?{}:Sn,name:Ln.name,instance:nn})||xt)}else xt.reset=!1,vn=-1}}},update:(_t=function(){return new Promise(function(Jt){nn.forceUpdate(),Jt(xt)})},function(){return It||(It=new Promise(function(Jt){Promise.resolve().then(function(){It=void 0,Jt(_t())})})),It}),destroy:function(){Zt(),jt=!0}};if(!Ye($e,rt))return nn;function Zt(){ln.forEach(function(Jt){return Jt()}),ln=[]}return nn.setOptions(ct).then(function(Jt){!jt&&ct.onFirstUpdate&&ct.onFirstUpdate(Jt)}),nn}}var et=Ne(),Ct=Ne({defaultModifiers:[kr,ae,Qi,ne]}),Xt=Ne({defaultModifiers:[kr,ae,Qi,ne,D,_,ke,kn,Z]});const zt=Object.freeze(Object.defineProperty({__proto__:null,afterMain:N,afterRead:k,afterWrite:j,applyStyles:ne,arrow:kn,auto:Aa,basePlacements:P,beforeMain:S,beforeRead:y,beforeWrite:B,bottom:Cr,clippingParents:o,computeStyles:Qi,createPopper:Xt,createPopperBase:et,createPopperLite:Ct,detectOverflow:ht,end:i,eventListeners:kr,flip:_,hide:Z,left:dt,main:R,modifierPhases:K,offset:D,placements:v,popper:u,popperGenerator:Ne,popperOffsets:ae,preventOverflow:ke,read:C,reference:h,right:Nr,start:r,top:Mr,variationPlacements:p,viewport:l,write:U},Symbol.toStringTag,{value:"Module"})),ye="dropdown",an=".bs.dropdown",ir=".data-api",gr="ArrowUp",Wt="ArrowDown",oi=`hide${an}`,nt=`hidden${an}`,tn=`show${an}`,vi=`shown${an}`,Wa=`click${an}${ir}`,er=`keydown${an}${ir}`,ro=`keyup${an}${ir}`,Kr="show",Zr='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',_i=`${Zr}.${Kr}`,sn=".dropdown-menu",Wn=Et()?"top-end":"top-start",fr=Et()?"top-start":"top-end",Ar=Et()?"bottom-end":"bottom-start",ea=Et()?"bottom-start":"bottom-end",Vt=Et()?"left-start":"right-start",vt=Et()?"right-start":"left-start",ur={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},hr={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class pn extends wn{constructor(E,Y){super(E,Y),this._popper=null,this._parent=this._element.parentNode,this._menu=Ot.next(this._element,sn)[0]||Ot.prev(this._element,sn)[0]||Ot.findOne(sn,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return ur}static get DefaultType(){return hr}static get NAME(){return ye}toggle(){return this._isShown()?this.hide():this.show()}show(){if(kt(this._element)||this._isShown())return;const E={relatedTarget:this._element};if(!Je.trigger(this._element,tn,E).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const Y of[].concat(...document.body.children))Je.on(Y,"mouseover",cn);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Kr),this._element.classList.add(Kr),Je.trigger(this._element,vi,E)}}hide(){!kt(this._element)&&this._isShown()&&this._completeHide({relatedTarget:this._element})}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(E){if(!Je.trigger(this._element,oi,E).defaultPrevented){if("ontouchstart"in document.documentElement)for(const Y of[].concat(...document.body.children))Je.off(Y,"mouseover",cn);this._popper&&this._popper.destroy(),this._menu.classList.remove(Kr),this._element.classList.remove(Kr),this._element.setAttribute("aria-expanded","false"),Rr.removeDataAttribute(this._menu,"popper"),Je.trigger(this._element,nt,E)}}_getConfig(E){if("object"==typeof(E=super._getConfig(E)).reference&&!me(E.reference)&&"function"!=typeof E.reference.getBoundingClientRect)throw new TypeError(`${ye.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return E}_createPopper(){if(void 0===zt)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let E=this._element;"parent"===this._config.reference?E=this._parent:me(this._config.reference)?E=st(this._config.reference):"object"==typeof this._config.reference&&(E=this._config.reference);const Y=this._getPopperConfig();this._popper=Xt(E,this._menu,Y)}_isShown(){return this._menu.classList.contains(Kr)}_getPlacement(){const E=this._parent;if(E.classList.contains("dropend"))return Vt;if(E.classList.contains("dropstart"))return vt;if(E.classList.contains("dropup-center"))return"top";if(E.classList.contains("dropdown-center"))return"bottom";const Y="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return E.classList.contains("dropup")?Y?fr:Wn:Y?ea:Ar}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){const{offset:E}=this._config;return"string"==typeof E?E.split(",").map(Y=>Number.parseInt(Y,10)):"function"==typeof E?Y=>E(Y,this._element):E}_getPopperConfig(){const E={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||"static"===this._config.display)&&(Rr.setDataAttribute(this._menu,"popper","static"),E.modifiers=[{name:"applyStyles",enabled:!1}]),{...E,...pe(this._config.popperConfig,[E])}}_selectMenuItem({key:E,target:Y}){const oe=Ot.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(Se=>_e(Se));oe.length&&On(oe,Y,E===Wt,!oe.includes(Y)).focus()}static jQueryInterface(E){return this.each(function(){const Y=pn.getOrCreateInstance(this,E);if("string"==typeof E){if(void 0===Y[E])throw new TypeError(`No method named "${E}"`);Y[E]()}})}static clearMenus(E){if(2===E.button||"keyup"===E.type&&"Tab"!==E.key)return;const Y=Ot.find(_i);for(const oe of Y){const Se=pn.getInstance(oe);if(!Se||!1===Se._config.autoClose)continue;const Re=E.composedPath(),$e=Re.includes(Se._menu);if(Re.includes(Se._element)||"inside"===Se._config.autoClose&&!$e||"outside"===Se._config.autoClose&&$e||Se._menu.contains(E.target)&&("keyup"===E.type&&"Tab"===E.key||/input|select|option|textarea|form/i.test(E.target.tagName)))continue;const rt={relatedTarget:Se._element};"click"===E.type&&(rt.clickEvent=E),Se._completeHide(rt)}}static dataApiKeydownHandler(E){const Y=/input|textarea/i.test(E.target.tagName),oe="Escape"===E.key,Se=[gr,Wt].includes(E.key);if(!Se&&!oe||Y&&!oe)return;E.preventDefault();const Re=this.matches(Zr)?this:Ot.prev(this,Zr)[0]||Ot.next(this,Zr)[0]||Ot.findOne(Zr,E.delegateTarget.parentNode),$e=pn.getOrCreateInstance(Re);if(Se)return E.stopPropagation(),$e.show(),void $e._selectMenuItem(E);$e._isShown()&&(E.stopPropagation(),$e.hide(),Re.focus())}}Je.on(document,er,Zr,pn.dataApiKeydownHandler),Je.on(document,er,sn,pn.dataApiKeydownHandler),Je.on(document,Wa,pn.clearMenus),Je.on(document,ro,pn.clearMenus),Je.on(document,Wa,Zr,function(Q){Q.preventDefault(),pn.getOrCreateInstance(this).toggle()}),bn(pn);const Ii="backdrop",Hi=`mousedown.bs.${Ii}`,Ha={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Ns={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class fa extends Ui{constructor(E){super(),this._config=this._getConfig(E),this._isAppended=!1,this._element=null}static get Default(){return Ha}static get DefaultType(){return Ns}static get NAME(){return Ii}show(E){if(!this._config.isVisible)return void pe(E);this._append();this._getElement().classList.add("show"),this._emulateAnimation(()=>{pe(E)})}hide(E){this._config.isVisible?(this._getElement().classList.remove("show"),this._emulateAnimation(()=>{this.dispose(),pe(E)})):pe(E)}dispose(){this._isAppended&&(Je.off(this._element,Hi),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const E=document.createElement("div");E.className=this._config.className,this._config.isAnimated&&E.classList.add("fade"),this._element=E}return this._element}_configAfterMerge(E){return E.rootElement=st(E.rootElement),E}_append(){if(this._isAppended)return;const E=this._getElement();this._config.rootElement.append(E),Je.on(E,Hi,()=>{pe(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(E){hi(E,this._getElement(),this._config.isAnimated)}}const Eo=".bs.focustrap",_o=`focusin${Eo}`,as=`keydown.tab${Eo}`,Xi="backward",io={autofocus:!0,trapElement:null},ao={autofocus:"boolean",trapElement:"element"};class os extends Ui{constructor(E){super(),this._config=this._getConfig(E),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return io}static get DefaultType(){return ao}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),Je.off(document,Eo),Je.on(document,_o,E=>this._handleFocusin(E)),Je.on(document,as,E=>this._handleKeydown(E)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,Je.off(document,Eo))}_handleFocusin(E){const{trapElement:Y}=this._config;if(E.target===document||E.target===Y||Y.contains(E.target))return;const oe=Ot.focusableChildren(Y);0===oe.length?Y.focus():this._lastTabNavDirection===Xi?oe[oe.length-1].focus():oe[0].focus()}_handleKeydown(E){"Tab"===E.key&&(this._lastTabNavDirection=E.shiftKey?Xi:"forward")}}const ss=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",oo=".sticky-top",Xa="padding-right",fe="margin-right";class xe{constructor(){this._element=document.body}getWidth(){const E=document.documentElement.clientWidth;return Math.abs(window.innerWidth-E)}hide(){const E=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Xa,Y=>Y+E),this._setElementAttributes(ss,Xa,Y=>Y+E),this._setElementAttributes(oo,fe,Y=>Y-E)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Xa),this._resetElementAttributes(ss,Xa),this._resetElementAttributes(oo,fe)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(E,Y,oe){const Se=this.getWidth();this._applyManipulationCallback(E,Re=>{if(Re!==this._element&&window.innerWidth>Re.clientWidth+Se)return;this._saveInitialAttribute(Re,Y);const $e=window.getComputedStyle(Re).getPropertyValue(Y);Re.style.setProperty(Y,`${oe(Number.parseFloat($e))}px`)})}_saveInitialAttribute(E,Y){const oe=E.style.getPropertyValue(Y);oe&&Rr.setDataAttribute(E,Y,oe)}_resetElementAttributes(E,Y){this._applyManipulationCallback(E,oe=>{const Se=Rr.getDataAttribute(oe,Y);null!==Se?(Rr.removeDataAttribute(oe,Y),oe.style.setProperty(Y,Se)):oe.style.removeProperty(Y)})}_applyManipulationCallback(E,Y){if(me(E))Y(E);else for(const oe of Ot.find(E,this._element))Y(oe)}}const ze=".bs.modal",je=`hide${ze}`,Qe=`hidePrevented${ze}`,bt=`hidden${ze}`,yt=`show${ze}`,Pt=`shown${ze}`,wt=`resize${ze}`,An=`click.dismiss${ze}`,Bt=`mousedown.dismiss${ze}`,Kt=`keydown.dismiss${ze}`,mn=`click${ze}.data-api`,Ht="modal-open",Sr="modal-static",Er={backdrop:!0,focus:!0,keyboard:!0},Jr={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class vr extends wn{constructor(E,Y){super(E,Y),this._dialog=Ot.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new xe,this._addEventListeners()}static get Default(){return Er}static get DefaultType(){return Jr}static get NAME(){return"modal"}toggle(E){return this._isShown?this.hide():this.show(E)}show(E){this._isShown||this._isTransitioning||Je.trigger(this._element,yt,{relatedTarget:E}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Ht),this._adjustDialog(),this._backdrop.show(()=>this._showElement(E)))}hide(){this._isShown&&!this._isTransitioning&&(Je.trigger(this._element,je).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove("show"),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated())))}dispose(){Je.off(window,ze),Je.off(this._dialog,ze),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new fa({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new os({trapElement:this._element})}_showElement(E){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const Y=Ot.findOne(".modal-body",this._dialog);Y&&(Y.scrollTop=0),this._element.classList.add("show"),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Je.trigger(this._element,Pt,{relatedTarget:E})},this._dialog,this._isAnimated())}_addEventListeners(){Je.on(this._element,Kt,E=>{"Escape"===E.key&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())}),Je.on(window,wt,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),Je.on(this._element,Bt,E=>{Je.one(this._element,An,Y=>{this._element===E.target&&this._element===Y.target&&("static"!==this._config.backdrop?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Ht),this._resetAdjustments(),this._scrollBar.reset(),Je.trigger(this._element,bt)})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(Je.trigger(this._element,Qe).defaultPrevented)return;const E=this._element.scrollHeight>document.documentElement.clientHeight,Y=this._element.style.overflowY;"hidden"===Y||this._element.classList.contains(Sr)||(E||(this._element.style.overflowY="hidden"),this._element.classList.add(Sr),this._queueCallback(()=>{this._element.classList.remove(Sr),this._queueCallback(()=>{this._element.style.overflowY=Y},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const E=this._element.scrollHeight>document.documentElement.clientHeight,Y=this._scrollBar.getWidth(),oe=Y>0;if(oe&&!E){const Se=Et()?"paddingLeft":"paddingRight";this._element.style[Se]=`${Y}px`}if(!oe&&E){const Se=Et()?"paddingRight":"paddingLeft";this._element.style[Se]=`${Y}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(E,Y){return this.each(function(){const oe=vr.getOrCreateInstance(this,E);if("string"==typeof E){if(void 0===oe[E])throw new TypeError(`No method named "${E}"`);oe[E](Y)}})}}Je.on(document,mn,'[data-bs-toggle="modal"]',function(Q){const E=Ot.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&Q.preventDefault(),Je.one(E,yt,oe=>{oe.defaultPrevented||Je.one(E,bt,()=>{_e(this)&&this.focus()})});const Y=Ot.findOne(".modal.show");Y&&vr.getInstance(Y).hide(),vr.getOrCreateInstance(E).toggle(this)}),Or(vr),bn(vr);const mr=".bs.offcanvas",Yn=".data-api",Ea=`load${mr}${Yn}`,Gr="showing",To=".offcanvas.show",li=`show${mr}`,Ro=`shown${mr}`,Fc=`hide${mr}`,_r=`hidePrevented${mr}`,Ls=`hidden${mr}`,rl=`resize${mr}`,il=`click${mr}${Yn}`,Oc=`keydown.dismiss${mr}`,Bc={backdrop:!0,keyboard:!0,scroll:!1},Vl={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Ga extends wn{constructor(E,Y){super(E,Y),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Bc}static get DefaultType(){return Vl}static get NAME(){return"offcanvas"}toggle(E){return this._isShown?this.hide():this.show(E)}show(E){this._isShown||Je.trigger(this._element,li,{relatedTarget:E}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||(new xe).hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Gr),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add("show"),this._element.classList.remove(Gr),Je.trigger(this._element,Ro,{relatedTarget:E})},this._element,!0))}hide(){this._isShown&&(Je.trigger(this._element,Fc).defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add("hiding"),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove("show","hiding"),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||(new xe).reset(),Je.trigger(this._element,Ls)},this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const E=!!this._config.backdrop;return new fa({className:"offcanvas-backdrop",isVisible:E,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:E?()=>{"static"!==this._config.backdrop?this.hide():Je.trigger(this._element,_r)}:null})}_initializeFocusTrap(){return new os({trapElement:this._element})}_addEventListeners(){Je.on(this._element,Oc,E=>{"Escape"===E.key&&(this._config.keyboard?this.hide():Je.trigger(this._element,_r))})}static jQueryInterface(E){return this.each(function(){const Y=Ga.getOrCreateInstance(this,E);if("string"==typeof E){if(void 0===Y[E]||E.startsWith("_")||"constructor"===E)throw new TypeError(`No method named "${E}"`);Y[E](this)}})}}Je.on(document,il,'[data-bs-toggle="offcanvas"]',function(Q){const E=Ot.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&Q.preventDefault(),kt(this))return;Je.one(E,Ls,()=>{_e(this)&&this.focus()});const Y=Ot.findOne(To);Y&&Y!==E&&Ga.getInstance(Y).hide(),Ga.getOrCreateInstance(E).toggle(this)}),Je.on(window,Ea,()=>{for(const Q of Ot.find(To))Ga.getOrCreateInstance(Q).show()}),Je.on(window,rl,()=>{for(const Q of Ot.find("[aria-modal][class*=show][class*=offcanvas-]"))"fixed"!==getComputedStyle(Q).position&&Ga.getOrCreateInstance(Q).hide()}),Or(Ga),bn(Ga);const Fs={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},zc=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Wc=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,Os=(Q,E)=>{const Y=Q.nodeName.toLowerCase();return E.includes(Y)?!zc.has(Y)||!!Wc.test(Q.nodeValue):E.filter(oe=>oe instanceof RegExp).some(oe=>oe.test(Y))},dh={allowList:Fs,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Hc={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},Yl={entry:"(string|element|function|null)",selector:"(string|element)"};class al extends Ui{constructor(E){super(),this._config=this._getConfig(E)}static get Default(){return dh}static get DefaultType(){return Hc}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(E=>this._resolvePossibleFunction(E)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(E){return this._checkContent(E),this._config.content={...this._config.content,...E},this}toHtml(){const E=document.createElement("div");E.innerHTML=this._maybeSanitize(this._config.template);for(const[Se,Re]of Object.entries(this._config.content))this._setContent(E,Re,Se);const Y=E.children[0],oe=this._resolvePossibleFunction(this._config.extraClass);return oe&&Y.classList.add(...oe.split(" ")),Y}_typeCheckConfig(E){super._typeCheckConfig(E),this._checkContent(E.content)}_checkContent(E){for(const[Y,oe]of Object.entries(E))super._typeCheckConfig({selector:Y,entry:oe},Yl)}_setContent(E,Y,oe){const Se=Ot.findOne(oe,E);Se&&((Y=this._resolvePossibleFunction(Y))?me(Y)?this._putElementInTemplate(st(Y),Se):this._config.html?Se.innerHTML=this._maybeSanitize(Y):Se.textContent=Y:Se.remove())}_maybeSanitize(E){return this._config.sanitize?function(Y,oe,Se){if(!Y.length)return Y;if(Se&&"function"==typeof Se)return Se(Y);const Re=(new window.DOMParser).parseFromString(Y,"text/html"),$e=[].concat(...Re.body.querySelectorAll("*"));for(const rt of $e){const ct=rt.nodeName.toLowerCase();if(!Object.keys(oe).includes(ct)){rt.remove();continue}const _t=[].concat(...rt.attributes),It=[].concat(oe["*"]||[],oe[ct]||[]);for(const xt of _t)Os(xt,It)||rt.removeAttribute(xt.nodeName)}return Re.body.innerHTML}(E,this._config.allowList,this._config.sanitizeFn):E}_resolvePossibleFunction(E){return pe(E,[this])}_putElementInTemplate(E,Y){if(this._config.html)return Y.innerHTML="",void Y.append(E);Y.textContent=E.textContent}}const Xc=new Set(["sanitize","allowList","sanitizeFn"]),ol="fade",ls="show",Gc="hide.bs.modal",cs="hover",Do="focus",ll={AUTO:"auto",TOP:"top",RIGHT:Et()?"left":"right",BOTTOM:"bottom",LEFT:Et()?"right":"left"},_a={allowList:Fs,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Vc={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Va extends wn{constructor(E,Y){if(void 0===zt)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(E,Y),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return _a}static get DefaultType(){return Vc}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),Je.off(this._element.closest(".modal"),Gc,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if("none"===this._element.style.display)throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const E=Je.trigger(this._element,this.constructor.eventName("show")),Y=(Ft(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(E.defaultPrevented||!Y)return;this._disposePopper();const oe=this._getTipElement();this._element.setAttribute("aria-describedby",oe.getAttribute("id"));const{container:Se}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(Se.append(oe),Je.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(oe),oe.classList.add(ls),"ontouchstart"in document.documentElement)for(const Re of[].concat(...document.body.children))Je.on(Re,"mouseover",cn);this._queueCallback(()=>{Je.trigger(this._element,this.constructor.eventName("shown")),!1===this._isHovered&&this._leave(),this._isHovered=!1},this.tip,this._isAnimated())}hide(){if(this._isShown()&&!Je.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(ls),"ontouchstart"in document.documentElement)for(const E of[].concat(...document.body.children))Je.off(E,"mouseover",cn);this._activeTrigger.click=!1,this._activeTrigger[Do]=!1,this._activeTrigger[cs]=!1,this._isHovered=null,this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),Je.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(E){const Y=this._getTemplateFactory(E).toHtml();if(!Y)return null;Y.classList.remove(ol,ls),Y.classList.add(`bs-${this.constructor.NAME}-auto`);const oe=(Se=>{do{Se+=Math.floor(1e6*Math.random())}while(document.getElementById(Se));return Se})(this.constructor.NAME).toString();return Y.setAttribute("id",oe),this._isAnimated()&&Y.classList.add(ol),Y}setContent(E){this._newContent=E,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(E){return this._templateFactory?this._templateFactory.changeContent(E):this._templateFactory=new al({...this._config,content:E,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{".tooltip-inner":this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(E){return this.constructor.getOrCreateInstance(E.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(ol)}_isShown(){return this.tip&&this.tip.classList.contains(ls)}_createPopper(E){const Y=pe(this._config.placement,[this,E,this._element]),oe=ll[Y.toUpperCase()];return Xt(this._element,E,this._getPopperConfig(oe))}_getOffset(){const{offset:E}=this._config;return"string"==typeof E?E.split(",").map(Y=>Number.parseInt(Y,10)):"function"==typeof E?Y=>E(Y,this._element):E}_resolvePossibleFunction(E){return pe(E,[this._element])}_getPopperConfig(E){const Y={placement:E,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:oe=>{this._getTipElement().setAttribute("data-popper-placement",oe.state.placement)}}]};return{...Y,...pe(this._config.popperConfig,[Y])}}_setListeners(){const E=this._config.trigger.split(" ");for(const Y of E)if("click"===Y)Je.on(this._element,this.constructor.eventName("click"),this._config.selector,oe=>{this._initializeOnDelegatedTarget(oe).toggle()});else if("manual"!==Y){const oe=this.constructor.eventName(Y===cs?"mouseenter":"focusin"),Se=this.constructor.eventName(Y===cs?"mouseleave":"focusout");Je.on(this._element,oe,this._config.selector,Re=>{const $e=this._initializeOnDelegatedTarget(Re);$e._activeTrigger["focusin"===Re.type?Do:cs]=!0,$e._enter()}),Je.on(this._element,Se,this._config.selector,Re=>{const $e=this._initializeOnDelegatedTarget(Re);$e._activeTrigger["focusout"===Re.type?Do:cs]=$e._element.contains(Re.relatedTarget),$e._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},Je.on(this._element.closest(".modal"),Gc,this._hideModalHandler)}_fixTitle(){const E=this._element.getAttribute("title");E&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",E),this._element.setAttribute("data-bs-original-title",E),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(E,Y){clearTimeout(this._timeout),this._timeout=setTimeout(E,Y)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(E){const Y=Rr.getDataAttributes(this._element);for(const oe of Object.keys(Y))Xc.has(oe)&&delete Y[oe];return E={...Y,..."object"==typeof E&&E?E:{}},E=this._mergeConfigObj(E),E=this._configAfterMerge(E),this._typeCheckConfig(E),E}_configAfterMerge(E){return E.container=!1===E.container?document.body:st(E.container),"number"==typeof E.delay&&(E.delay={show:E.delay,hide:E.delay}),"number"==typeof E.title&&(E.title=E.title.toString()),"number"==typeof E.content&&(E.content=E.content.toString()),E}_getDelegateConfig(){const E={};for(const[Y,oe]of Object.entries(this._config))this.constructor.Default[Y]!==oe&&(E[Y]=oe);return E.selector=!1,E.trigger="manual",E}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(E){return this.each(function(){const Y=Va.getOrCreateInstance(this,E);if("string"==typeof E){if(void 0===Y[E])throw new TypeError(`No method named "${E}"`);Y[E]()}})}}bn(Va);const jl={...Va.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},Xe={...Va.DefaultType,content:"(null|string|element|function)"};class Ya extends Va{static get Default(){return jl}static get DefaultType(){return Xe}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{".popover-header":this._getTitle(),".popover-body":this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(E){return this.each(function(){const Y=Ya.getOrCreateInstance(this,E);if("string"==typeof E){if(void 0===Y[E])throw new TypeError(`No method named "${E}"`);Y[E]()}})}}bn(Ya);const Ge=".bs.scrollspy",ja=`activate${Ge}`,Ir=`click${Ge}`,gn=`load${Ge}.data-api`,pa="active",Po="[href]",Ua=".nav-link",Bs=`${Ua}, .nav-item > ${Ua}, .list-group-item`,Ul={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},cl={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Mo extends wn{constructor(E,Y){super(E,Y),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement="visible"===getComputedStyle(this._element).overflowY?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Ul}static get DefaultType(){return cl}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const E of this._observableSections.values())this._observer.observe(E)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(E){return E.target=st(E.target)||document.body,E.rootMargin=E.offset?`${E.offset}px 0px -30%`:E.rootMargin,"string"==typeof E.threshold&&(E.threshold=E.threshold.split(",").map(Y=>Number.parseFloat(Y))),E}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(Je.off(this._config.target,Ir),Je.on(this._config.target,Ir,Po,E=>{const Y=this._observableSections.get(E.target.hash);if(Y){E.preventDefault();const oe=this._rootElement||window,Se=Y.offsetTop-this._element.offsetTop;if(oe.scrollTo)return void oe.scrollTo({top:Se,behavior:"smooth"});oe.scrollTop=Se}}))}_getNewObserver(){return new IntersectionObserver(Y=>this._observerCallback(Y),{root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin})}_observerCallback(E){const Y=$e=>this._targetLinks.get(`#${$e.target.id}`),oe=$e=>{this._previousScrollData.visibleEntryTop=$e.target.offsetTop,this._process(Y($e))},Se=(this._rootElement||document.documentElement).scrollTop,Re=Se>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=Se;for(const $e of E){if(!$e.isIntersecting){this._activeTarget=null,this._clearActiveClass(Y($e));continue}const rt=$e.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(Re&&rt){if(oe($e),!Se)return}else Re||rt||oe($e)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const E=Ot.find(Po,this._config.target);for(const Y of E){if(!Y.hash||kt(Y))continue;const oe=Ot.findOne(decodeURI(Y.hash),this._element);_e(oe)&&(this._targetLinks.set(decodeURI(Y.hash),Y),this._observableSections.set(Y.hash,oe))}}_process(E){this._activeTarget!==E&&(this._clearActiveClass(this._config.target),this._activeTarget=E,E.classList.add(pa),this._activateParents(E),Je.trigger(this._element,ja,{relatedTarget:E}))}_activateParents(E){if(E.classList.contains("dropdown-item"))Ot.findOne(".dropdown-toggle",E.closest(".dropdown")).classList.add(pa);else for(const Y of Ot.parents(E,".nav, .list-group"))for(const oe of Ot.prev(Y,Bs))oe.classList.add(pa)}_clearActiveClass(E){E.classList.remove(pa);const Y=Ot.find(`${Po}.${pa}`,E);for(const oe of Y)oe.classList.remove(pa)}static jQueryInterface(E){return this.each(function(){const Y=Mo.getOrCreateInstance(this,E);if("string"==typeof E){if(void 0===Y[E]||E.startsWith("_")||"constructor"===E)throw new TypeError(`No method named "${E}"`);Y[E]()}})}}Je.on(window,gn,()=>{for(const Q of Ot.find('[data-bs-spy="scroll"]'))Mo.getOrCreateInstance(Q)}),bn(Mo);const na=".bs.tab",zs=`hide${na}`,No=`hidden${na}`,mi=`show${na}`,ul=`shown${na}`,ql=`click${na}`,hl=`keydown${na}`,$l=`load${na}`,fh="ArrowLeft",dl="ArrowRight",Yc="ArrowUp",jc="ArrowDown",Ws="Home",fl="End",so="active",pl="show",Kl=".dropdown-toggle",gl=`:not(${Kl})`,Zl='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Hs=`.nav-link${gl}, .list-group-item${gl}, [role="tab"]${gl}, ${Zl}`,ph=`.${so}[data-bs-toggle="tab"], .${so}[data-bs-toggle="pill"], .${so}[data-bs-toggle="list"]`;class Lo extends wn{constructor(E){super(E),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),Je.on(this._element,hl,Y=>this._keydown(Y)))}static get NAME(){return"tab"}show(){const E=this._element;if(this._elemIsActive(E))return;const Y=this._getActiveElem(),oe=Y?Je.trigger(Y,zs,{relatedTarget:E}):null;Je.trigger(E,mi,{relatedTarget:Y}).defaultPrevented||oe&&oe.defaultPrevented||(this._deactivate(Y,E),this._activate(E,Y))}_activate(E,Y){E&&(E.classList.add(so),this._activate(Ot.getElementFromSelector(E)),this._queueCallback(()=>{"tab"===E.getAttribute("role")?(E.removeAttribute("tabindex"),E.setAttribute("aria-selected",!0),this._toggleDropDown(E,!0),Je.trigger(E,ul,{relatedTarget:Y})):E.classList.add(pl)},E,E.classList.contains("fade")))}_deactivate(E,Y){E&&(E.classList.remove(so),E.blur(),this._deactivate(Ot.getElementFromSelector(E)),this._queueCallback(()=>{"tab"===E.getAttribute("role")?(E.setAttribute("aria-selected",!1),E.setAttribute("tabindex","-1"),this._toggleDropDown(E,!1),Je.trigger(E,No,{relatedTarget:Y})):E.classList.remove(pl)},E,E.classList.contains("fade")))}_keydown(E){if(![fh,dl,Yc,jc,Ws,fl].includes(E.key))return;E.stopPropagation(),E.preventDefault();const Y=this._getChildren().filter(Se=>!kt(Se));let oe;if([Ws,fl].includes(E.key))oe=Y[E.key===Ws?0:Y.length-1];else{const Se=[dl,jc].includes(E.key);oe=On(Y,E.target,Se,!0)}oe&&(oe.focus({preventScroll:!0}),Lo.getOrCreateInstance(oe).show())}_getChildren(){return Ot.find(Hs,this._parent)}_getActiveElem(){return this._getChildren().find(E=>this._elemIsActive(E))||null}_setInitialAttributes(E,Y){this._setAttributeIfNotExists(E,"role","tablist");for(const oe of Y)this._setInitialAttributesOnChild(oe)}_setInitialAttributesOnChild(E){E=this._getInnerElement(E);const Y=this._elemIsActive(E),oe=this._getOuterElement(E);E.setAttribute("aria-selected",Y),oe!==E&&this._setAttributeIfNotExists(oe,"role","presentation"),Y||E.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(E,"role","tab"),this._setInitialAttributesOnTargetPanel(E)}_setInitialAttributesOnTargetPanel(E){const Y=Ot.getElementFromSelector(E);Y&&(this._setAttributeIfNotExists(Y,"role","tabpanel"),E.id&&this._setAttributeIfNotExists(Y,"aria-labelledby",`${E.id}`))}_toggleDropDown(E,Y){const oe=this._getOuterElement(E);if(!oe.classList.contains("dropdown"))return;const Se=(Re,$e)=>{const rt=Ot.findOne(Re,oe);rt&&rt.classList.toggle($e,Y)};Se(Kl,so),Se(".dropdown-menu",pl),oe.setAttribute("aria-expanded",Y)}_setAttributeIfNotExists(E,Y,oe){E.hasAttribute(Y)||E.setAttribute(Y,oe)}_elemIsActive(E){return E.classList.contains(so)}_getInnerElement(E){return E.matches(Hs)?E:Ot.findOne(Hs,E)}_getOuterElement(E){return E.closest(".nav-item, .list-group-item")||E}static jQueryInterface(E){return this.each(function(){const Y=Lo.getOrCreateInstance(this);if("string"==typeof E){if(void 0===Y[E]||E.startsWith("_")||"constructor"===E)throw new TypeError(`No method named "${E}"`);Y[E]()}})}}Je.on(document,ql,Zl,function(Q){["A","AREA"].includes(this.tagName)&&Q.preventDefault(),kt(this)||Lo.getOrCreateInstance(this).show()}),Je.on(window,$l,()=>{for(const Q of Ot.find(ph))Lo.getOrCreateInstance(Q)}),bn(Lo);const lo=".bs.toast",qc=`mouseover${lo}`,Ti=`mouseout${lo}`,ci=`focusin${lo}`,Fo=`focusout${lo}`,Jl=`hide${lo}`,$c=`hidden${lo}`,gh=`show${lo}`,Oo=`shown${lo}`,jn="show",qa="showing",us={animation:"boolean",autohide:"boolean",delay:"number"},vh={animation:!0,autohide:!0,delay:5e3};class Xs extends wn{constructor(E,Y){super(E,Y),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return vh}static get DefaultType(){return us}static get NAME(){return"toast"}show(){Je.trigger(this._element,gh).defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove("hide"),this._element.classList.add(jn,qa),this._queueCallback(()=>{this._element.classList.remove(qa),Je.trigger(this._element,Oo),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&(Je.trigger(this._element,Jl).defaultPrevented||(this._element.classList.add(qa),this._queueCallback(()=>{this._element.classList.add("hide"),this._element.classList.remove(qa,jn),Je.trigger(this._element,$c)},this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(jn),super.dispose()}isShown(){return this._element.classList.contains(jn)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(E,Y){switch(E.type){case"mouseover":case"mouseout":this._hasMouseInteraction=Y;break;case"focusin":case"focusout":this._hasKeyboardInteraction=Y}if(Y)return void this._clearTimeout();const oe=E.relatedTarget;this._element===oe||this._element.contains(oe)||this._maybeScheduleHide()}_setListeners(){Je.on(this._element,qc,E=>this._onInteraction(E,!0)),Je.on(this._element,Ti,E=>this._onInteraction(E,!1)),Je.on(this._element,ci,E=>this._onInteraction(E,!0)),Je.on(this._element,Fo,E=>this._onInteraction(E,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(E){return this.each(function(){const Y=Xs.getOrCreateInstance(this,E);if("string"==typeof E){if(void 0===Y[E])throw new TypeError(`No method named "${E}"`);Y[E](this)}})}}return Or(Xs),bn(Xs),{Alert:Br,Button:yr,Carousel:da,Collapse:qr,Dropdown:pn,Modal:vr,Offcanvas:Ga,Popover:Ya,ScrollSpy:Mo,Tab:Lo,Toast:Xs,Tooltip:Va}}),function(Ce,Ze){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=Ce.document?Ze(Ce,!0):function(ut){if(!ut.document)throw new Error("jQuery requires a window with a document");return Ze(ut)}:Ze(Ce)}(typeof window<"u"?window:this,function(Ce,Ze){"use strict";var ut=[],F=Object.getPrototypeOf,de=ut.slice,me=ut.flat?function(b){return ut.flat.call(b)}:function(b){return ut.concat.apply([],b)},st=ut.push,_e=ut.indexOf,kt={},Ft=kt.toString,cn=kt.hasOwnProperty,dn=cn.toString,ar=dn.call(Object),gt={},Et=function(b){return"function"==typeof b&&"number"!=typeof b.nodeType&&"function"!=typeof b.item},bn=function(b){return null!=b&&b===b.window},pe=Ce.document,hi={type:!0,src:!0,nonce:!0,noModule:!0};function On(b,_,L){var G,Z,D=(L=L||pe).createElement("script");if(D.text=b,_)for(G in hi)(Z=_[G]||_.getAttribute&&_.getAttribute(G))&&D.setAttribute(G,Z);L.head.appendChild(D).parentNode.removeChild(D)}function Ke(b){return null==b?b+"":"object"==typeof b||"function"==typeof b?kt[Ft.call(b)]||"object":typeof b}var ue=/HTML$/i,z=function(b,_){return new z.fn.init(b,_)};function Mn(b){var _=!!b&&"length"in b&&b.length,L=Ke(b);return!Et(b)&&!bn(b)&&("array"===L||0===_||"number"==typeof _&&0<_&&_-1 in b)}function Qt(b,_){return b.nodeName&&b.nodeName.toLowerCase()===_.toLowerCase()}z.fn=z.prototype={jquery:"3.7.1",constructor:z,length:0,toArray:function(){return de.call(this)},get:function(b){return null==b?de.call(this):b<0?this[b+this.length]:this[b]},pushStack:function(b){var _=z.merge(this.constructor(),b);return _.prevObject=this,_},each:function(b){return z.each(this,b)},map:function(b){return this.pushStack(z.map(this,function(_,L){return b.call(_,L,_)}))},slice:function(){return this.pushStack(de.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(z.grep(this,function(b,_){return(_+1)%2}))},odd:function(){return this.pushStack(z.grep(this,function(b,_){return _%2}))},eq:function(b){var _=this.length,L=+b+(b<0?_:0);return this.pushStack(0<=L&&L<_?[this[L]]:[])},end:function(){return this.prevObject||this.constructor()},push:st,sort:ut.sort,splice:ut.splice},z.extend=z.fn.extend=function(){var b,_,L,G,Z,D,ae=arguments[0]||{},ke=1,we=arguments.length,Ie=!1;for("boolean"==typeof ae&&(Ie=ae,ae=arguments[ke]||{},ke++),"object"==typeof ae||Et(ae)||(ae={}),ke===we&&(ae=this,ke--);ke<we;ke++)if(null!=(b=arguments[ke]))for(_ in b)G=b[_],"__proto__"!==_&&ae!==G&&(Ie&&G&&(z.isPlainObject(G)||(Z=Array.isArray(G)))?(L=ae[_],D=Z&&!Array.isArray(L)?[]:Z||z.isPlainObject(L)?L:{},Z=!1,ae[_]=z.extend(Ie,D,G)):void 0!==G&&(ae[_]=G));return ae},z.extend({expando:"jQuery"+("3.7.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(b){throw new Error(b)},noop:function(){},isPlainObject:function(b){var _,L;return!(!b||"[object Object]"!==Ft.call(b)||(_=F(b))&&("function"!=typeof(L=cn.call(_,"constructor")&&_.constructor)||dn.call(L)!==ar))},isEmptyObject:function(b){var _;for(_ in b)return!1;return!0},globalEval:function(b,_,L){On(b,{nonce:_&&_.nonce},L)},each:function(b,_){var L,G=0;if(Mn(b))for(L=b.length;G<L&&!1!==_.call(b[G],G,b[G]);G++);else for(G in b)if(!1===_.call(b[G],G,b[G]))break;return b},text:function(b){var _,L="",G=0,Z=b.nodeType;if(!Z)for(;_=b[G++];)L+=z.text(_);return 1===Z||11===Z?b.textContent:9===Z?b.documentElement.textContent:3===Z||4===Z?b.nodeValue:L},makeArray:function(b,_){var L=_||[];return null!=b&&(Mn(Object(b))?z.merge(L,"string"==typeof b?[b]:b):st.call(L,b)),L},inArray:function(b,_,L){return null==_?-1:_e.call(_,b,L)},isXMLDoc:function(b){var L=b&&(b.ownerDocument||b).documentElement;return!ue.test(b&&b.namespaceURI||L&&L.nodeName||"HTML")},merge:function(b,_){for(var L=+_.length,G=0,Z=b.length;G<L;G++)b[Z++]=_[G];return b.length=Z,b},grep:function(b,_,L){for(var G=[],Z=0,D=b.length,ae=!L;Z<D;Z++)!_(b[Z],Z)!==ae&&G.push(b[Z]);return G},map:function(b,_,L){var G,Z,D=0,ae=[];if(Mn(b))for(G=b.length;D<G;D++)null!=(Z=_(b[D],D,L))&&ae.push(Z);else for(D in b)null!=(Z=_(b[D],D,L))&&ae.push(Z);return me(ae)},guid:1,support:gt}),"function"==typeof Symbol&&(z.fn[Symbol.iterator]=ut[Symbol.iterator]),z.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(b,_){kt["[object "+_+"]"]=_.toLowerCase()});var mt=ut.pop,or=ut.sort,Qn=ut.splice,Cn="[\\x20\\t\\r\\n\\f]",Lr=new RegExp("^"+Cn+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Cn+"+$","g");z.contains=function(b,_){var L=_&&_.parentNode;return b===L||!(!L||1!==L.nodeType||!(b.contains?b.contains(L):b.compareDocumentPosition&&16&b.compareDocumentPosition(L)))};var ji=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function sa(b,_){return _?"\0"===b?"\ufffd":b.slice(0,-1)+"\\"+b.charCodeAt(b.length-1).toString(16)+" ":"\\"+b}z.escapeSelector=function(b){return(b+"").replace(ji,sa)};var ri=pe,Nn=st;!function(){var b,_,L,G,Z,D,ae,ke,we,Ie,Oe=Nn,Ye=z.expando,Ne=0,et=0,Ct=ur(),Xt=ur(),zt=ur(),ye=ur(),an=function(fe,xe){return fe===xe&&(Z=!0),0},ir="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",gr="(?:\\\\[\\da-fA-F]{1,6}"+Cn+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",Wt="\\["+Cn+"*("+gr+")(?:"+Cn+"*([*^$|!~]?=)"+Cn+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+gr+"))|)"+Cn+"*\\]",oi=":("+gr+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+Wt+")*)|.*)\\)|)",nt=new RegExp(Cn+"+","g"),tn=new RegExp("^"+Cn+"*,"+Cn+"*"),vi=new RegExp("^"+Cn+"*([>+~]|"+Cn+")"+Cn+"*"),Wa=new RegExp(Cn+"|>"),er=new RegExp(oi),ro=new RegExp("^"+gr+"$"),Kr={ID:new RegExp("^#("+gr+")"),CLASS:new RegExp("^\\.("+gr+")"),TAG:new RegExp("^("+gr+"|[*])"),ATTR:new RegExp("^"+Wt),PSEUDO:new RegExp("^"+oi),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Cn+"*(even|odd|(([+-]|)(\\d*)n|)"+Cn+"*(?:([+-]|)"+Cn+"*(\\d+)|))"+Cn+"*\\)|)","i"),bool:new RegExp("^(?:"+ir+")$","i"),needsContext:new RegExp("^"+Cn+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Cn+"*((?:-\\d)?\\d*)"+Cn+"*\\)|)(?=[^-]|$)","i")},Zr=/^(?:input|select|textarea|button)$/i,_i=/^h\d$/i,sn=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Wn=/[+~]/,fr=new RegExp("\\\\[\\da-fA-F]{1,6}"+Cn+"?|\\\\([^\\r\\n\\f])","g"),Ar=function(fe,xe){var ze="0x"+fe.slice(1)-65536;return xe||(ze<0?String.fromCharCode(ze+65536):String.fromCharCode(ze>>10|55296,1023&ze|56320))},ea=function(){fa()},Vt=Xi(function(fe){return!0===fe.disabled&&Qt(fe,"fieldset")},{dir:"parentNode",next:"legend"});try{Oe.apply(ut=de.call(ri.childNodes),ri.childNodes)}catch{Oe={apply:function(xe,ze){Nn.apply(xe,de.call(ze))},call:function(xe){Nn.apply(xe,de.call(arguments,1))}}}function vt(fe,xe,ze,je){var Qe,bt,yt,Pt,wt,An,Bt,Kt=xe&&xe.ownerDocument,mn=xe?xe.nodeType:9;if(ze=ze||[],"string"!=typeof fe||!fe||1!==mn&&9!==mn&&11!==mn)return ze;if(!je&&(fa(xe),xe=xe||D,ke)){if(11!==mn&&(wt=sn.exec(fe)))if(Qe=wt[1]){if(9===mn){if(!(yt=xe.getElementById(Qe)))return ze;if(yt.id===Qe)return Oe.call(ze,yt),ze}else if(Kt&&(yt=Kt.getElementById(Qe))&&vt.contains(xe,yt)&&yt.id===Qe)return Oe.call(ze,yt),ze}else{if(wt[2])return Oe.apply(ze,xe.getElementsByTagName(fe)),ze;if((Qe=wt[3])&&xe.getElementsByClassName)return Oe.apply(ze,xe.getElementsByClassName(Qe)),ze}if(!(ye[fe+" "]||we&&we.test(fe))){if(Bt=fe,Kt=xe,1===mn&&(Wa.test(fe)||vi.test(fe))){for((Kt=Wn.test(fe)&&Ns(xe.parentNode)||xe)==xe&&gt.scope||((Pt=xe.getAttribute("id"))?Pt=z.escapeSelector(Pt):xe.setAttribute("id",Pt=Ye)),bt=(An=_o(fe)).length;bt--;)An[bt]=(Pt?"#"+Pt:":scope")+" "+as(An[bt]);Bt=An.join(",")}try{return Oe.apply(ze,Kt.querySelectorAll(Bt)),ze}catch{ye(fe,!0)}finally{Pt===Ye&&xe.removeAttribute("id")}}}return Xa(fe.replace(Lr,"$1"),xe,ze,je)}function ur(){var fe=[];return function xe(ze,je){return fe.push(ze+" ")>_.cacheLength&&delete xe[fe.shift()],xe[ze+" "]=je}}function hr(fe){return fe[Ye]=!0,fe}function pn(fe){var xe=D.createElement("fieldset");try{return!!fe(xe)}catch{return!1}finally{xe.parentNode&&xe.parentNode.removeChild(xe),xe=null}}function Ii(fe){return function(xe){return Qt(xe,"input")&&xe.type===fe}}function ta(fe){return function(xe){return(Qt(xe,"input")||Qt(xe,"button"))&&xe.type===fe}}function Hi(fe){return function(xe){return"form"in xe?xe.parentNode&&!1===xe.disabled?"label"in xe?"label"in xe.parentNode?xe.parentNode.disabled===fe:xe.disabled===fe:xe.isDisabled===fe||xe.isDisabled!==!fe&&Vt(xe)===fe:xe.disabled===fe:"label"in xe&&xe.disabled===fe}}function Ha(fe){return hr(function(xe){return xe=+xe,hr(function(ze,je){for(var Qe,bt=fe([],ze.length,xe),yt=bt.length;yt--;)ze[Qe=bt[yt]]&&(ze[Qe]=!(je[Qe]=ze[Qe]))})})}function Ns(fe){return fe&&typeof fe.getElementsByTagName<"u"&&fe}function fa(fe){var xe,ze=fe?fe.ownerDocument||fe:ri;return ze!=D&&9===ze.nodeType&&ze.documentElement&&(ae=(D=ze).documentElement,ke=!z.isXMLDoc(D),Ie=ae.matches||ae.webkitMatchesSelector||ae.msMatchesSelector,ae.msMatchesSelector&&ri!=D&&(xe=D.defaultView)&&xe.top!==xe&&xe.addEventListener("unload",ea),gt.getById=pn(function(je){return ae.appendChild(je).id=z.expando,!D.getElementsByName||!D.getElementsByName(z.expando).length}),gt.disconnectedMatch=pn(function(je){return Ie.call(je,"*")}),gt.scope=pn(function(){return D.querySelectorAll(":scope")}),gt.cssHas=pn(function(){try{return D.querySelector(":has(*,:jqfake)"),!1}catch{return!0}}),gt.getById?(_.filter.ID=function(je){var Qe=je.replace(fr,Ar);return function(bt){return bt.getAttribute("id")===Qe}},_.find.ID=function(je,Qe){if(typeof Qe.getElementById<"u"&&ke){var bt=Qe.getElementById(je);return bt?[bt]:[]}}):(_.filter.ID=function(je){var Qe=je.replace(fr,Ar);return function(bt){var yt=typeof bt.getAttributeNode<"u"&&bt.getAttributeNode("id");return yt&&yt.value===Qe}},_.find.ID=function(je,Qe){if(typeof Qe.getElementById<"u"&&ke){var bt,yt,Pt,wt=Qe.getElementById(je);if(wt){if((bt=wt.getAttributeNode("id"))&&bt.value===je)return[wt];for(Pt=Qe.getElementsByName(je),yt=0;wt=Pt[yt++];)if((bt=wt.getAttributeNode("id"))&&bt.value===je)return[wt]}return[]}}),_.find.TAG=function(je,Qe){return typeof Qe.getElementsByTagName<"u"?Qe.getElementsByTagName(je):Qe.querySelectorAll(je)},_.find.CLASS=function(je,Qe){if(typeof Qe.getElementsByClassName<"u"&&ke)return Qe.getElementsByClassName(je)},we=[],pn(function(je){var Qe;ae.appendChild(je).innerHTML="<a id='"+Ye+"' href='' disabled='disabled'></a><select id='"+Ye+"-\r\\' disabled='disabled'><option selected=''></option></select>",je.querySelectorAll("[selected]").length||we.push("\\["+Cn+"*(?:value|"+ir+")"),je.querySelectorAll("[id~="+Ye+"-]").length||we.push("~="),je.querySelectorAll("a#"+Ye+"+*").length||we.push(".#.+[+~]"),je.querySelectorAll(":checked").length||we.push(":checked"),(Qe=D.createElement("input")).setAttribute("type","hidden"),je.appendChild(Qe).setAttribute("name","D"),ae.appendChild(je).disabled=!0,2!==je.querySelectorAll(":disabled").length&&we.push(":enabled",":disabled"),(Qe=D.createElement("input")).setAttribute("name",""),je.appendChild(Qe),je.querySelectorAll("[name='']").length||we.push("\\["+Cn+"*name"+Cn+"*="+Cn+"*(?:''|\"\")")}),gt.cssHas||we.push(":has"),we=we.length&&new RegExp(we.join("|")),an=function(je,Qe){if(je===Qe)return Z=!0,0;var bt=!je.compareDocumentPosition-!Qe.compareDocumentPosition;return bt||(1&(bt=(je.ownerDocument||je)==(Qe.ownerDocument||Qe)?je.compareDocumentPosition(Qe):1)||!gt.sortDetached&&Qe.compareDocumentPosition(je)===bt?je===D||je.ownerDocument==ri&&vt.contains(ri,je)?-1:Qe===D||Qe.ownerDocument==ri&&vt.contains(ri,Qe)?1:G?_e.call(G,je)-_e.call(G,Qe):0:4&bt?-1:1)}),D}for(b in vt.matches=function(fe,xe){return vt(fe,null,null,xe)},vt.matchesSelector=function(fe,xe){if(fa(fe),ke&&!ye[xe+" "]&&(!we||!we.test(xe)))try{var ze=Ie.call(fe,xe);if(ze||gt.disconnectedMatch||fe.document&&11!==fe.document.nodeType)return ze}catch{ye(xe,!0)}return 0<vt(xe,D,null,[fe]).length},vt.contains=function(fe,xe){return(fe.ownerDocument||fe)!=D&&fa(fe),z.contains(fe,xe)},vt.attr=function(fe,xe){(fe.ownerDocument||fe)!=D&&fa(fe);var ze=_.attrHandle[xe.toLowerCase()],je=ze&&cn.call(_.attrHandle,xe.toLowerCase())?ze(fe,xe,!ke):void 0;return void 0!==je?je:fe.getAttribute(xe)},vt.error=function(fe){throw new Error("Syntax error, unrecognized expression: "+fe)},z.uniqueSort=function(fe){var xe,ze=[],je=0,Qe=0;if(Z=!gt.sortStable,G=!gt.sortStable&&de.call(fe,0),or.call(fe,an),Z){for(;xe=fe[Qe++];)xe===fe[Qe]&&(je=ze.push(Qe));for(;je--;)Qn.call(fe,ze[je],1)}return G=null,fe},z.fn.uniqueSort=function(){return this.pushStack(z.uniqueSort(de.apply(this)))},(_=z.expr={cacheLength:50,createPseudo:hr,match:Kr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(fe){return fe[1]=fe[1].replace(fr,Ar),fe[3]=(fe[3]||fe[4]||fe[5]||"").replace(fr,Ar),"~="===fe[2]&&(fe[3]=" "+fe[3]+" "),fe.slice(0,4)},CHILD:function(fe){return fe[1]=fe[1].toLowerCase(),"nth"===fe[1].slice(0,3)?(fe[3]||vt.error(fe[0]),fe[4]=+(fe[4]?fe[5]+(fe[6]||1):2*("even"===fe[3]||"odd"===fe[3])),fe[5]=+(fe[7]+fe[8]||"odd"===fe[3])):fe[3]&&vt.error(fe[0]),fe},PSEUDO:function(fe){var xe,ze=!fe[6]&&fe[2];return Kr.CHILD.test(fe[0])?null:(fe[3]?fe[2]=fe[4]||fe[5]||"":ze&&er.test(ze)&&(xe=_o(ze,!0))&&(xe=ze.indexOf(")",ze.length-xe)-ze.length)&&(fe[0]=fe[0].slice(0,xe),fe[2]=ze.slice(0,xe)),fe.slice(0,3))}},filter:{TAG:function(fe){var xe=fe.replace(fr,Ar).toLowerCase();return"*"===fe?function(){return!0}:function(ze){return Qt(ze,xe)}},CLASS:function(fe){var xe=Ct[fe+" "];return xe||(xe=new RegExp("(^|"+Cn+")"+fe+"("+Cn+"|$)"))&&Ct(fe,function(ze){return xe.test("string"==typeof ze.className&&ze.className||typeof ze.getAttribute<"u"&&ze.getAttribute("class")||"")})},ATTR:function(fe,xe,ze){return function(je){var Qe=vt.attr(je,fe);return null==Qe?"!="===xe:!xe||(Qe+="","="===xe?Qe===ze:"!="===xe?Qe!==ze:"^="===xe?ze&&0===Qe.indexOf(ze):"*="===xe?ze&&-1<Qe.indexOf(ze):"$="===xe?ze&&Qe.slice(-ze.length)===ze:"~="===xe?-1<(" "+Qe.replace(nt," ")+" ").indexOf(ze):"|="===xe&&(Qe===ze||Qe.slice(0,ze.length+1)===ze+"-"))}},CHILD:function(fe,xe,ze,je,Qe){var bt="nth"!==fe.slice(0,3),yt="last"!==fe.slice(-4),Pt="of-type"===xe;return 1===je&&0===Qe?function(wt){return!!wt.parentNode}:function(wt,An,Bt){var Kt,mn,Ht,Vn,Sr,Er=bt!==yt?"nextSibling":"previousSibling",Jr=wt.parentNode,vr=Pt&&wt.nodeName.toLowerCase(),mr=!Bt&&!Pt,Yn=!1;if(Jr){if(bt){for(;Er;){for(Ht=wt;Ht=Ht[Er];)if(Pt?Qt(Ht,vr):1===Ht.nodeType)return!1;Sr=Er="only"===fe&&!Sr&&"nextSibling"}return!0}if(Sr=[yt?Jr.firstChild:Jr.lastChild],yt&&mr){for(Yn=(Vn=(Kt=(mn=Jr[Ye]||(Jr[Ye]={}))[fe]||[])[0]===Ne&&Kt[1])&&Kt[2],Ht=Vn&&Jr.childNodes[Vn];Ht=++Vn&&Ht&&Ht[Er]||(Yn=Vn=0)||Sr.pop();)if(1===Ht.nodeType&&++Yn&&Ht===wt){mn[fe]=[Ne,Vn,Yn];break}}else if(mr&&(Yn=Vn=(Kt=(mn=wt[Ye]||(wt[Ye]={}))[fe]||[])[0]===Ne&&Kt[1]),!1===Yn)for(;(Ht=++Vn&&Ht&&Ht[Er]||(Yn=Vn=0)||Sr.pop())&&(!(Pt?Qt(Ht,vr):1===Ht.nodeType)||!++Yn||(mr&&((mn=Ht[Ye]||(Ht[Ye]={}))[fe]=[Ne,Yn]),Ht!==wt)););return(Yn-=Qe)===je||Yn%je==0&&0<=Yn/je}}},PSEUDO:function(fe,xe){var ze,je=_.pseudos[fe]||_.setFilters[fe.toLowerCase()]||vt.error("unsupported pseudo: "+fe);return je[Ye]?je(xe):1<je.length?(ze=[fe,fe,"",xe],_.setFilters.hasOwnProperty(fe.toLowerCase())?hr(function(Qe,bt){for(var yt,Pt=je(Qe,xe),wt=Pt.length;wt--;)Qe[yt=_e.call(Qe,Pt[wt])]=!(bt[yt]=Pt[wt])}):function(Qe){return je(Qe,0,ze)}):je}},pseudos:{not:hr(function(fe){var xe=[],ze=[],je=oo(fe.replace(Lr,"$1"));return je[Ye]?hr(function(Qe,bt,yt,Pt){for(var wt,An=je(Qe,null,Pt,[]),Bt=Qe.length;Bt--;)(wt=An[Bt])&&(Qe[Bt]=!(bt[Bt]=wt))}):function(Qe,bt,yt){return xe[0]=Qe,je(xe,null,yt,ze),xe[0]=null,!ze.pop()}}),has:hr(function(fe){return function(xe){return 0<vt(fe,xe).length}}),contains:hr(function(fe){return fe=fe.replace(fr,Ar),function(xe){return-1<(xe.textContent||z.text(xe)).indexOf(fe)}}),lang:hr(function(fe){return ro.test(fe||"")||vt.error("unsupported lang: "+fe),fe=fe.replace(fr,Ar).toLowerCase(),function(xe){var ze;do{if(ze=ke?xe.lang:xe.getAttribute("xml:lang")||xe.getAttribute("lang"))return(ze=ze.toLowerCase())===fe||0===ze.indexOf(fe+"-")}while((xe=xe.parentNode)&&1===xe.nodeType);return!1}}),target:function(fe){var xe=Ce.location&&Ce.location.hash;return xe&&xe.slice(1)===fe.id},root:function(fe){return fe===ae},focus:function(fe){return fe===function(){try{return D.activeElement}catch{}}()&&D.hasFocus()&&!!(fe.type||fe.href||~fe.tabIndex)},enabled:Hi(!1),disabled:Hi(!0),checked:function(fe){return Qt(fe,"input")&&!!fe.checked||Qt(fe,"option")&&!!fe.selected},selected:function(fe){return!0===fe.selected},empty:function(fe){for(fe=fe.firstChild;fe;fe=fe.nextSibling)if(fe.nodeType<6)return!1;return!0},parent:function(fe){return!_.pseudos.empty(fe)},header:function(fe){return _i.test(fe.nodeName)},input:function(fe){return Zr.test(fe.nodeName)},button:function(fe){return Qt(fe,"input")&&"button"===fe.type||Qt(fe,"button")},text:function(fe){var xe;return Qt(fe,"input")&&"text"===fe.type&&(null==(xe=fe.getAttribute("type"))||"text"===xe.toLowerCase())},first:Ha(function(){return[0]}),last:Ha(function(fe,xe){return[xe-1]}),eq:Ha(function(fe,xe,ze){return[ze<0?ze+xe:ze]}),even:Ha(function(fe,xe){for(var ze=0;ze<xe;ze+=2)fe.push(ze);return fe}),odd:Ha(function(fe,xe){for(var ze=1;ze<xe;ze+=2)fe.push(ze);return fe}),lt:Ha(function(fe,xe,ze){var je;for(je=ze<0?ze+xe:xe<ze?xe:ze;0<=--je;)fe.push(je);return fe}),gt:Ha(function(fe,xe,ze){for(var je=ze<0?ze+xe:ze;++je<xe;)fe.push(je);return fe})}}).pseudos.nth=_.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})_.pseudos[b]=Ii(b);for(b in{submit:!0,reset:!0})_.pseudos[b]=ta(b);function Eo(){}function _o(fe,xe){var ze,je,Qe,bt,yt,Pt,wt,An=Xt[fe+" "];if(An)return xe?0:An.slice(0);for(yt=fe,Pt=[],wt=_.preFilter;yt;){for(bt in ze&&!(je=tn.exec(yt))||(je&&(yt=yt.slice(je[0].length)||yt),Pt.push(Qe=[])),ze=!1,(je=vi.exec(yt))&&(ze=je.shift(),Qe.push({value:ze,type:je[0].replace(Lr," ")}),yt=yt.slice(ze.length)),_.filter)!(je=Kr[bt].exec(yt))||wt[bt]&&!(je=wt[bt](je))||(ze=je.shift(),Qe.push({value:ze,type:bt,matches:je}),yt=yt.slice(ze.length));if(!ze)break}return xe?yt.length:yt?vt.error(fe):Xt(fe,Pt).slice(0)}function as(fe){for(var xe=0,ze=fe.length,je="";xe<ze;xe++)je+=fe[xe].value;return je}function Xi(fe,xe,ze){var je=xe.dir,Qe=xe.next,bt=Qe||je,yt=ze&&"parentNode"===bt,Pt=et++;return xe.first?function(wt,An,Bt){for(;wt=wt[je];)if(1===wt.nodeType||yt)return fe(wt,An,Bt);return!1}:function(wt,An,Bt){var Kt,mn,Ht=[Ne,Pt];if(Bt){for(;wt=wt[je];)if((1===wt.nodeType||yt)&&fe(wt,An,Bt))return!0}else for(;wt=wt[je];)if(1===wt.nodeType||yt)if(mn=wt[Ye]||(wt[Ye]={}),Qe&&Qt(wt,Qe))wt=wt[je]||wt;else{if((Kt=mn[bt])&&Kt[0]===Ne&&Kt[1]===Pt)return Ht[2]=Kt[2];if((mn[bt]=Ht)[2]=fe(wt,An,Bt))return!0}return!1}}function io(fe){return 1<fe.length?function(xe,ze,je){for(var Qe=fe.length;Qe--;)if(!fe[Qe](xe,ze,je))return!1;return!0}:fe[0]}function ao(fe,xe,ze,je,Qe){for(var bt,yt=[],Pt=0,wt=fe.length,An=null!=xe;Pt<wt;Pt++)(bt=fe[Pt])&&(ze&&!ze(bt,je,Qe)||(yt.push(bt),An&&xe.push(Pt)));return yt}function os(fe,xe,ze,je,Qe,bt){return je&&!je[Ye]&&(je=os(je)),Qe&&!Qe[Ye]&&(Qe=os(Qe,bt)),hr(function(yt,Pt,wt,An){var Bt,Kt,mn,Ht,Vn=[],Sr=[],Er=Pt.length,Jr=yt||function(mr,Yn,Ea){for(var si=0,Gr=Yn.length;si<Gr;si++)vt(mr,Yn[si],Ea);return Ea}(xe||"*",wt.nodeType?[wt]:wt,[]),vr=!fe||!yt&&xe?Jr:ao(Jr,Vn,fe,wt,An);if(ze?ze(vr,Ht=Qe||(yt?fe:Er||je)?[]:Pt,wt,An):Ht=vr,je)for(Bt=ao(Ht,Sr),je(Bt,[],wt,An),Kt=Bt.length;Kt--;)(mn=Bt[Kt])&&(Ht[Sr[Kt]]=!(vr[Sr[Kt]]=mn));if(yt){if(Qe||fe){if(Qe){for(Bt=[],Kt=Ht.length;Kt--;)(mn=Ht[Kt])&&Bt.push(vr[Kt]=mn);Qe(null,Ht=[],Bt,An)}for(Kt=Ht.length;Kt--;)(mn=Ht[Kt])&&-1<(Bt=Qe?_e.call(yt,mn):Vn[Kt])&&(yt[Bt]=!(Pt[Bt]=mn))}}else Ht=ao(Ht===Pt?Ht.splice(Er,Ht.length):Ht),Qe?Qe(null,Pt,Ht,An):Oe.apply(Pt,Ht)})}function ss(fe){for(var xe,ze,je,Qe=fe.length,bt=_.relative[fe[0].type],yt=bt||_.relative[" "],Pt=bt?1:0,wt=Xi(function(Kt){return Kt===xe},yt,!0),An=Xi(function(Kt){return-1<_e.call(xe,Kt)},yt,!0),Bt=[function(Kt,mn,Ht){var Vn=!bt&&(Ht||mn!=L)||((xe=mn).nodeType?wt(Kt,mn,Ht):An(Kt,mn,Ht));return xe=null,Vn}];Pt<Qe;Pt++)if(ze=_.relative[fe[Pt].type])Bt=[Xi(io(Bt),ze)];else{if((ze=_.filter[fe[Pt].type].apply(null,fe[Pt].matches))[Ye]){for(je=++Pt;je<Qe&&!_.relative[fe[je].type];je++);return os(1<Pt&&io(Bt),1<Pt&&as(fe.slice(0,Pt-1).concat({value:" "===fe[Pt-2].type?"*":""})).replace(Lr,"$1"),ze,Pt<je&&ss(fe.slice(Pt,je)),je<Qe&&ss(fe=fe.slice(je)),je<Qe&&as(fe))}Bt.push(ze)}return io(Bt)}function oo(fe,xe){var ze,je,Qe,bt,yt,Pt,wt=[],An=[],Bt=zt[fe+" "];if(!Bt){for(xe||(xe=_o(fe)),ze=xe.length;ze--;)(Bt=ss(xe[ze]))[Ye]?wt.push(Bt):An.push(Bt);(Bt=zt(fe,(je=An,bt=0<(Qe=wt).length,yt=0<je.length,Pt=function(Kt,mn,Ht,Vn,Sr){var Er,Jr,vr,mr=0,Yn="0",Ea=Kt&&[],si=[],Gr=L,Io=Kt||yt&&_.find.TAG("*",Sr),To=Ne+=null==Gr?1:Math.random()||.1,li=Io.length;for(Sr&&(L=mn==D||mn||Sr);Yn!==li&&null!=(Er=Io[Yn]);Yn++){if(yt&&Er){for(Jr=0,mn||Er.ownerDocument==D||(fa(Er),Ht=!ke);vr=je[Jr++];)if(vr(Er,mn||D,Ht)){Oe.call(Vn,Er);break}Sr&&(Ne=To)}bt&&((Er=!vr&&Er)&&mr--,Kt&&Ea.push(Er))}if(mr+=Yn,bt&&Yn!==mr){for(Jr=0;vr=Qe[Jr++];)vr(Ea,si,mn,Ht);if(Kt){if(0<mr)for(;Yn--;)Ea[Yn]||si[Yn]||(si[Yn]=mt.call(Vn));si=ao(si)}Oe.apply(Vn,si),Sr&&!Kt&&0<si.length&&1<mr+Qe.length&&z.uniqueSort(Vn)}return Sr&&(Ne=To,L=Gr),Ea},bt?hr(Pt):Pt))).selector=fe}return Bt}function Xa(fe,xe,ze,je){var Qe,bt,yt,Pt,wt,An="function"==typeof fe&&fe,Bt=!je&&_o(fe=An.selector||fe);if(ze=ze||[],1===Bt.length){if(2<(bt=Bt[0]=Bt[0].slice(0)).length&&"ID"===(yt=bt[0]).type&&9===xe.nodeType&&ke&&_.relative[bt[1].type]){if(!(xe=(_.find.ID(yt.matches[0].replace(fr,Ar),xe)||[])[0]))return ze;An&&(xe=xe.parentNode),fe=fe.slice(bt.shift().value.length)}for(Qe=Kr.needsContext.test(fe)?0:bt.length;Qe--&&!_.relative[Pt=(yt=bt[Qe]).type];)if((wt=_.find[Pt])&&(je=wt(yt.matches[0].replace(fr,Ar),Wn.test(bt[0].type)&&Ns(xe.parentNode)||xe))){if(bt.splice(Qe,1),!(fe=je.length&&as(bt)))return Oe.apply(ze,je),ze;break}}return(An||oo(fe,Bt))(je,xe,!ke,ze,!xe||Wn.test(fe)&&Ns(xe.parentNode)||xe),ze}Eo.prototype=_.filters=_.pseudos,_.setFilters=new Eo,gt.sortStable=Ye.split("").sort(an).join("")===Ye,fa(),gt.sortDetached=pn(function(fe){return 1&fe.compareDocumentPosition(D.createElement("fieldset"))}),z.find=vt,z.expr[":"]=z.expr.pseudos,z.unique=z.uniqueSort,vt.compile=oo,vt.select=Xa,vt.setDocument=fa,vt.tokenize=_o,vt.escape=z.escapeSelector,vt.getText=z.text,vt.isXML=z.isXMLDoc,vt.selectors=z.expr,vt.support=z.support,vt.uniqueSort=z.uniqueSort}();var Je=function(b,_,L){for(var G=[],Z=void 0!==L;(b=b[_])&&9!==b.nodeType;)if(1===b.nodeType){if(Z&&z(b).is(L))break;G.push(b)}return G},Ai=function(b,_){for(var L=[];b;b=b.nextSibling)1===b.nodeType&&b!==_&&L.push(b);return L},la=z.expr.match.needsContext,Fr=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function Rr(b,_,L){return Et(_)?z.grep(b,function(G,Z){return!!_.call(G,Z,G)!==L}):_.nodeType?z.grep(b,function(G){return G===_!==L}):"string"!=typeof _?z.grep(b,function(G){return-1<_e.call(_,G)!==L}):z.filter(_,b,L)}z.filter=function(b,_,L){var G=_[0];return L&&(b=":not("+b+")"),1===_.length&&1===G.nodeType?z.find.matchesSelector(G,b)?[G]:[]:z.find.matches(b,z.grep(_,function(Z){return 1===Z.nodeType}))},z.fn.extend({find:function(b){var _,L,G=this.length,Z=this;if("string"!=typeof b)return this.pushStack(z(b).filter(function(){for(_=0;_<G;_++)if(z.contains(Z[_],this))return!0}));for(L=this.pushStack([]),_=0;_<G;_++)z.find(b,Z[_],L);return 1<G?z.uniqueSort(L):L},filter:function(b){return this.pushStack(Rr(this,b||[],!1))},not:function(b){return this.pushStack(Rr(this,b||[],!0))},is:function(b){return!!Rr(this,"string"==typeof b&&la.test(b)?z(b):b||[],!1).length}});var Ui,wn=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(z.fn.init=function(b,_,L){var G,Z;if(!b)return this;if(L=L||Ui,"string"==typeof b){if(!(G="<"===b[0]&&">"===b[b.length-1]&&3<=b.length?[null,b,null]:wn.exec(b))||!G[1]&&_)return!_||_.jquery?(_||L).find(b):this.constructor(_).find(b);if(G[1]){if(z.merge(this,z.parseHTML(G[1],(_=_ instanceof z?_[0]:_)&&_.nodeType?_.ownerDocument||_:pe,!0)),Fr.test(G[1])&&z.isPlainObject(_))for(G in _)Et(this[G])?this[G](_[G]):this.attr(G,_[G]);return this}return(Z=pe.getElementById(G[2]))&&(this[0]=Z,this.length=1),this}return b.nodeType?(this[0]=b,this.length=1,this):Et(b)?void 0!==L.ready?L.ready(b):b(z):z.makeArray(b,this)}).prototype=z.fn,Ui=z(pe);var Dr=/^(?:parents|prev(?:Until|All))/,Ot={children:!0,contents:!0,next:!0,prev:!0};function Or(b,_){for(;(b=b[_])&&1!==b.nodeType;);return b}z.fn.extend({has:function(b){var _=z(b,this),L=_.length;return this.filter(function(){for(var G=0;G<L;G++)if(z.contains(this,_[G]))return!0})},closest:function(b,_){var L,G=0,Z=this.length,D=[],ae="string"!=typeof b&&z(b);if(!la.test(b))for(;G<Z;G++)for(L=this[G];L&&L!==_;L=L.parentNode)if(L.nodeType<11&&(ae?-1<ae.index(L):1===L.nodeType&&z.find.matchesSelector(L,b))){D.push(L);break}return this.pushStack(1<D.length?z.uniqueSort(D):D)},index:function(b){return b?"string"==typeof b?_e.call(z(b),this[0]):_e.call(this,b.jquery?b[0]:b):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(b,_){return this.pushStack(z.uniqueSort(z.merge(this.get(),z(b,_))))},addBack:function(b){return this.add(null==b?this.prevObject:this.prevObject.filter(b))}}),z.each({parent:function(b){var _=b.parentNode;return _&&11!==_.nodeType?_:null},parents:function(b){return Je(b,"parentNode")},parentsUntil:function(b,_,L){return Je(b,"parentNode",L)},next:function(b){return Or(b,"nextSibling")},prev:function(b){return Or(b,"previousSibling")},nextAll:function(b){return Je(b,"nextSibling")},prevAll:function(b){return Je(b,"previousSibling")},nextUntil:function(b,_,L){return Je(b,"nextSibling",L)},prevUntil:function(b,_,L){return Je(b,"previousSibling",L)},siblings:function(b){return Ai((b.parentNode||{}).firstChild,b)},children:function(b){return Ai(b.firstChild)},contents:function(b){return null!=b.contentDocument&&F(b.contentDocument)?b.contentDocument:(Qt(b,"template")&&(b=b.content||b),z.merge([],b.childNodes))}},function(b,_){z.fn[b]=function(L,G){var Z=z.map(this,_,L);return"Until"!==b.slice(-5)&&(G=L),G&&"string"==typeof G&&(Z=z.filter(G,Z)),1<this.length&&(Ot[b]||z.uniqueSort(Z),Dr.test(b)&&Z.reverse()),this.pushStack(Z)}});var Pr=/[^\x20\t\r\n\f]+/g;function qi(b){return b}function Si(b){throw b}function Br(b,_,L,G){var Z;try{b&&Et(Z=b.promise)?Z.call(b).done(_).fail(L):b&&Et(Z=b.then)?Z.call(b,_,L):_.apply(void 0,[b].slice(G))}catch(D){L.apply(void 0,[D])}}z.Callbacks=function(b){var L;b="string"==typeof b?(L={},z.each(b.match(Pr)||[],function(Ne,et){L[et]=!0}),L):z.extend({},b);var G,Z,D,ae,ke=[],we=[],Ie=-1,Oe=function(){for(ae=ae||b.once,D=G=!0;we.length;Ie=-1)for(Z=we.shift();++Ie<ke.length;)!1===ke[Ie].apply(Z[0],Z[1])&&b.stopOnFalse&&(Ie=ke.length,Z=!1);b.memory||(Z=!1),G=!1,ae&&(ke=Z?[]:"")},Ye={add:function(){return ke&&(Z&&!G&&(Ie=ke.length-1,we.push(Z)),function Ne(et){z.each(et,function(Ct,Xt){Et(Xt)?b.unique&&Ye.has(Xt)||ke.push(Xt):Xt&&Xt.length&&"string"!==Ke(Xt)&&Ne(Xt)})}(arguments),Z&&!G&&Oe()),this},remove:function(){return z.each(arguments,function(Ne,et){for(var Ct;-1<(Ct=z.inArray(et,ke,Ct));)ke.splice(Ct,1),Ct<=Ie&&Ie--}),this},has:function(Ne){return Ne?-1<z.inArray(Ne,ke):0<ke.length},empty:function(){return ke&&(ke=[]),this},disable:function(){return ae=we=[],ke=Z="",this},disabled:function(){return!ke},lock:function(){return ae=we=[],Z||G||(ke=Z=""),this},locked:function(){return!!ae},fireWith:function(Ne,et){return ae||(et=[Ne,(et=et||[]).slice?et.slice():et],we.push(et),G||Oe()),this},fire:function(){return Ye.fireWith(this,arguments),this},fired:function(){return!!D}};return Ye},z.extend({Deferred:function(b){var _=[["notify","progress",z.Callbacks("memory"),z.Callbacks("memory"),2],["resolve","done",z.Callbacks("once memory"),z.Callbacks("once memory"),0,"resolved"],["reject","fail",z.Callbacks("once memory"),z.Callbacks("once memory"),1,"rejected"]],L="pending",G={state:function(){return L},always:function(){return Z.done(arguments).fail(arguments),this},catch:function(D){return G.then(null,D)},pipe:function(){var D=arguments;return z.Deferred(function(ae){z.each(_,function(ke,we){var Ie=Et(D[we[4]])&&D[we[4]];Z[we[1]](function(){var Oe=Ie&&Ie.apply(this,arguments);Oe&&Et(Oe.promise)?Oe.promise().progress(ae.notify).done(ae.resolve).fail(ae.reject):ae[we[0]+"With"](this,Ie?[Oe]:arguments)})}),D=null}).promise()},then:function(D,ae,ke){var we=0;function Ie(Oe,Ye,Ne,et){return function(){var Ct=this,Xt=arguments,zt=function(){var an,ir;if(!(Oe<we)){if((an=Ne.apply(Ct,Xt))===Ye.promise())throw new TypeError("Thenable self-resolution");Et(ir=an&&("object"==typeof an||"function"==typeof an)&&an.then)?et?ir.call(an,Ie(we,Ye,qi,et),Ie(we,Ye,Si,et)):(we++,ir.call(an,Ie(we,Ye,qi,et),Ie(we,Ye,Si,et),Ie(we,Ye,qi,Ye.notifyWith))):(Ne!==qi&&(Ct=void 0,Xt=[an]),(et||Ye.resolveWith)(Ct,Xt))}},ye=et?zt:function(){try{zt()}catch(an){z.Deferred.exceptionHook&&z.Deferred.exceptionHook(an,ye.error),we<=Oe+1&&(Ne!==Si&&(Ct=void 0,Xt=[an]),Ye.rejectWith(Ct,Xt))}};Oe?ye():(z.Deferred.getErrorHook?ye.error=z.Deferred.getErrorHook():z.Deferred.getStackHook&&(ye.error=z.Deferred.getStackHook()),Ce.setTimeout(ye))}}return z.Deferred(function(Oe){_[0][3].add(Ie(0,Oe,Et(ke)?ke:qi,Oe.notifyWith)),_[1][3].add(Ie(0,Oe,Et(D)?D:qi)),_[2][3].add(Ie(0,Oe,Et(ae)?ae:Si))}).promise()},promise:function(D){return null!=D?z.extend(D,G):G}},Z={};return z.each(_,function(D,ae){var ke=ae[2],we=ae[5];G[ae[1]]=ke.add,we&&ke.add(function(){L=we},_[3-D][2].disable,_[3-D][3].disable,_[0][2].lock,_[0][3].lock),ke.add(ae[3].fire),Z[ae[0]]=function(){return Z[ae[0]+"With"](this===Z?void 0:this,arguments),this},Z[ae[0]+"With"]=ke.fireWith}),G.promise(Z),b&&b.call(Z,Z),Z},when:function(b){var _=arguments.length,L=_,G=Array(L),Z=de.call(arguments),D=z.Deferred(),ae=function(ke){return function(we){G[ke]=this,Z[ke]=1<arguments.length?de.call(arguments):we,--_||D.resolveWith(G,Z)}};if(_<=1&&(Br(b,D.done(ae(L)).resolve,D.reject,!_),"pending"===D.state()||Et(Z[L]&&Z[L].then)))return D.then();for(;L--;)Br(Z[L],ae(L),D.reject);return D.promise()}});var ca=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;z.Deferred.exceptionHook=function(b,_){Ce.console&&Ce.console.warn&&b&&ca.test(b.name)&&Ce.console.warn("jQuery.Deferred exception: "+b.message,b.stack,_)},z.readyException=function(b){Ce.setTimeout(function(){throw b})};var yr=z.Deferred();function di(){pe.removeEventListener("DOMContentLoaded",di),Ce.removeEventListener("load",di),z.ready()}z.fn.ready=function(b){return yr.then(b).catch(function(_){z.readyException(_)}),this},z.extend({isReady:!1,readyWait:1,ready:function(b){(!0===b?--z.readyWait:z.isReady)||(z.isReady=!0)!==b&&0<--z.readyWait||yr.resolveWith(pe,[z])}}),z.ready.then=yr.then,"complete"===pe.readyState||"loading"!==pe.readyState&&!pe.documentElement.doScroll?Ce.setTimeout(z.ready):(pe.addEventListener("DOMContentLoaded",di),Ce.addEventListener("load",di));var fi=function(b,_,L,G,Z,D,ae){var ke=0,we=b.length,Ie=null==L;if("object"===Ke(L))for(ke in Z=!0,L)fi(b,_,ke,L[ke],!0,D,ae);else if(void 0!==G&&(Z=!0,Et(G)||(ae=!0),Ie&&(ae?(_.call(b,G),_=null):(Ie=_,_=function(Oe,Ye,Ne){return Ie.call(z(Oe),Ne)})),_))for(;ke<we;ke++)_(b[ke],L,ae?G:G.call(b[ke],ke,_(b[ke],L)));return Z?b:Ie?_.call(b):we?_(b[0],L):D},Da=/^-ms-/,wa=/-([a-z])/g;function pi(b,_){return _.toUpperCase()}function ii(b){return b.replace(Da,"ms-").replace(wa,pi)}var Ca=function(b){return 1===b.nodeType||9===b.nodeType||!+b.nodeType};function Pi(){this.expando=z.expando+Pi.uid++}Pi.uid=1,Pi.prototype={cache:function(b){var _=b[this.expando];return _||(_={},Ca(b)&&(b.nodeType?b[this.expando]=_:Object.defineProperty(b,this.expando,{value:_,configurable:!0}))),_},set:function(b,_,L){var G,Z=this.cache(b);if("string"==typeof _)Z[ii(_)]=L;else for(G in _)Z[ii(G)]=_[G];return Z},get:function(b,_){return void 0===_?this.cache(b):b[this.expando]&&b[this.expando][ii(_)]},access:function(b,_,L){return void 0===_||_&&"string"==typeof _&&void 0===L?this.get(b,_):(this.set(b,_,L),void 0!==L?L:_)},remove:function(b,_){var L,G=b[this.expando];if(void 0!==G){if(void 0!==_)for((L=(_=Array.isArray(_)?_.map(ii):(_=ii(_))in G?[_]:_.match(Pr)||[]).length);L--;)delete G[_[L]];(void 0===_||z.isEmptyObject(G))&&(b.nodeType?b[this.expando]=void 0:delete b[this.expando])}},hasData:function(b){var _=b[this.expando];return void 0!==_&&!z.isEmptyObject(_)}};var Tt=new Pi,nr=new Pi,Pa=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Ma=/[A-Z]/g;function Mi(b,_,L){var G,Z;if(void 0===L&&1===b.nodeType)if(G="data-"+_.replace(Ma,"-$&").toLowerCase(),"string"==typeof(L=b.getAttribute(G))){try{L="true"===(Z=L)||"false"!==Z&&("null"===Z?null:Z===+Z+""?+Z:Pa.test(Z)?JSON.parse(Z):Z)}catch{}nr.set(b,_,L)}else L=void 0;return L}z.extend({hasData:function(b){return nr.hasData(b)||Tt.hasData(b)},data:function(b,_,L){return nr.access(b,_,L)},removeData:function(b,_){nr.remove(b,_)},_data:function(b,_,L){return Tt.access(b,_,L)},_removeData:function(b,_){Tt.remove(b,_)}}),z.fn.extend({data:function(b,_){var L,G,Z,D=this[0],ae=D&&D.attributes;if(void 0===b){if(this.length&&(Z=nr.get(D),1===D.nodeType&&!Tt.get(D,"hasDataAttrs"))){for(L=ae.length;L--;)ae[L]&&0===(G=ae[L].name).indexOf("data-")&&(G=ii(G.slice(5)),Mi(D,G,Z[G]));Tt.set(D,"hasDataAttrs",!0)}return Z}return"object"==typeof b?this.each(function(){nr.set(this,b)}):fi(this,function(ke){var we;if(D&&void 0===ke)return void 0!==(we=nr.get(D,b))||void 0!==(we=Mi(D,b))?we:void 0;this.each(function(){nr.set(this,b,ke)})},null,_,1<arguments.length,null,!0)},removeData:function(b){return this.each(function(){nr.remove(this,b)})}}),z.extend({queue:function(b,_,L){var G;if(b)return G=Tt.get(b,_=(_||"fx")+"queue"),L&&(!G||Array.isArray(L)?G=Tt.access(b,_,z.makeArray(L)):G.push(L)),G||[]},dequeue:function(b,_){var L=z.queue(b,_=_||"fx"),G=L.length,Z=L.shift(),D=z._queueHooks(b,_);"inprogress"===Z&&(Z=L.shift(),G--),Z&&("fx"===_&&L.unshift("inprogress"),delete D.stop,Z.call(b,function(){z.dequeue(b,_)},D)),!G&&D&&D.empty.fire()},_queueHooks:function(b,_){var L=_+"queueHooks";return Tt.get(b,L)||Tt.access(b,L,{empty:z.Callbacks("once memory").add(function(){Tt.remove(b,[_+"queue",L])})})}}),z.fn.extend({queue:function(b,_){var L=2;return"string"!=typeof b&&(_=b,b="fx",L--),arguments.length<L?z.queue(this[0],b):void 0===_?this:this.each(function(){var G=z.queue(this,b,_);z._queueHooks(this,b),"fx"===b&&"inprogress"!==G[0]&&z.dequeue(this,b)})},dequeue:function(b){return this.each(function(){z.dequeue(this,b)})},clearQueue:function(b){return this.queue(b||"fx",[])},promise:function(b,_){var L,G=1,Z=z.Deferred(),D=this,ae=this.length,ke=function(){--G||Z.resolveWith(D,[D])};for("string"!=typeof b&&(_=b,b=void 0),b=b||"fx";ae--;)(L=Tt.get(D[ae],b+"queueHooks"))&&L.empty&&(G++,L.empty.add(ke));return ke(),Z.promise(_)}});var $i=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ni=new RegExp("^(?:([+-])=|)("+$i+")([a-z%]*)$","i"),ai=["Top","Right","Bottom","Left"],Ur=pe.documentElement,Ki=function(b){return z.contains(b.ownerDocument,b)},Na={composed:!0};Ur.getRootNode&&(Ki=function(b){return z.contains(b.ownerDocument,b)||b.getRootNode(Na)===b.ownerDocument});var Li=function(b,_){return"none"===(b=_||b).style.display||""===b.style.display&&Ki(b)&&"none"===z.css(b,"display")};function gi(b,_,L,G){var Z,D,ae=20,ke=G?function(){return G.cur()}:function(){return z.css(b,_,"")},we=ke(),Ie=L&&L[3]||(z.cssNumber[_]?"":"px"),Oe=b.nodeType&&(z.cssNumber[_]||"px"!==Ie&&+we)&&Ni.exec(z.css(b,_));if(Oe&&Oe[3]!==Ie){for(Ie=Ie||Oe[3],Oe=+(we/=2)||1;ae--;)z.style(b,_,Oe+Ie),(1-D)*(1-(D=ke()/we||.5))<=0&&(ae=0),Oe/=D;z.style(b,_,(Oe*=2)+Ie),L=L||[]}return L&&(Oe=+Oe||+we||0,Z=L[1]?Oe+(L[1]+1)*L[2]:+L[2],G&&(G.unit=Ie,G.start=Oe,G.end=Z)),Z}var Ve={};function ua(b,_){for(var L,G,Z,D,ae,ke,we,Ie=[],Oe=0,Ye=b.length;Oe<Ye;Oe++)(G=b[Oe]).style&&(L=G.style.display,_?("none"===L&&(Ie[Oe]=Tt.get(G,"display")||null,Ie[Oe]||(G.style.display="")),""===G.style.display&&Li(G)&&(Ie[Oe]=(we=ae=D=void 0,ae=(Z=G).ownerDocument,(we=Ve[ke=Z.nodeName])||(D=ae.body.appendChild(ae.createElement(ke)),we=z.css(D,"display"),D.parentNode.removeChild(D),"none"===we&&(we="block"),Ve[ke]=we)))):"none"!==L&&(Ie[Oe]="none",Tt.set(G,"display",L)));for(Oe=0;Oe<Ye;Oe++)null!=Ie[Oe]&&(b[Oe].style.display=Ie[Oe]);return b}z.fn.extend({show:function(){return ua(this,!0)},hide:function(){return ua(this)},toggle:function(b){return"boolean"==typeof b?b?this.show():this.hide():this.each(function(){Li(this)?z(this).show():z(this).hide()})}});var Wr,rn,Me=/^(?:checkbox|radio)$/i,ha=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,La=/^$|^module$|\/(?:java|ecma)script/i;Wr=pe.createDocumentFragment().appendChild(pe.createElement("div")),(rn=pe.createElement("input")).setAttribute("type","radio"),rn.setAttribute("checked","checked"),rn.setAttribute("name","t"),Wr.appendChild(rn),gt.checkClone=Wr.cloneNode(!0).cloneNode(!0).lastChild.checked,Wr.innerHTML="<textarea>x</textarea>",gt.noCloneChecked=!!Wr.cloneNode(!0).lastChild.defaultValue,Wr.innerHTML="<option></option>",gt.option=!!Wr.lastChild;var Hr={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function wr(b,_){var L;return L=typeof b.getElementsByTagName<"u"?b.getElementsByTagName(_||"*"):typeof b.querySelectorAll<"u"?b.querySelectorAll(_||"*"):[],void 0===_||_&&Qt(b,_)?z.merge([b],L):L}function ka(b,_){for(var L=0,G=b.length;L<G;L++)Tt.set(b[L],"globalEval",!_||Tt.get(_[L],"globalEval"))}Hr.tbody=Hr.tfoot=Hr.colgroup=Hr.caption=Hr.thead,Hr.th=Hr.td,gt.option||(Hr.optgroup=Hr.option=[1,"<select multiple='multiple'>","</select>"]);var da=/<|&#?\w+;/;function Fi(b,_,L,G,Z){for(var D,ae,ke,we,Ie,Oe,Ye=_.createDocumentFragment(),Ne=[],et=0,Ct=b.length;et<Ct;et++)if((D=b[et])||0===D)if("object"===Ke(D))z.merge(Ne,D.nodeType?[D]:D);else if(da.test(D)){for(ae=ae||Ye.appendChild(_.createElement("div")),ke=(ha.exec(D)||["",""])[1].toLowerCase(),ae.innerHTML=(we=Hr[ke]||Hr._default)[1]+z.htmlPrefilter(D)+we[2],Oe=we[0];Oe--;)ae=ae.lastChild;z.merge(Ne,ae.childNodes),(ae=Ye.firstChild).textContent=""}else Ne.push(_.createTextNode(D));for(Ye.textContent="",et=0;D=Ne[et++];)if(G&&-1<z.inArray(D,G))Z&&Z.push(D);else if(Ie=Ki(D),ae=wr(Ye.appendChild(D),"script"),Ie&&ka(ae),L)for(Oe=0;D=ae[Oe++];)La.test(D.type||"")&&L.push(D);return Ye}var Fa=/^([^.]*)(?:\.(.+)|)/;function Oi(){return!0}function Bi(){return!1}function zi(b,_,L,G,Z,D){var ae,ke;if("object"==typeof _){for(ke in"string"!=typeof L&&(G=G||L,L=void 0),_)zi(b,ke,L,G,_[ke],D);return b}if(null==G&&null==Z?(Z=L,G=L=void 0):null==Z&&("string"==typeof L?(Z=G,G=void 0):(Z=G,G=L,L=void 0)),!1===Z)Z=Bi;else if(!Z)return b;return 1===D&&(ae=Z,(Z=function(we){return z().off(we),ae.apply(this,arguments)}).guid=ae.guid||(ae.guid=z.guid++)),b.each(function(){z.event.add(this,_,Z,G,L)})}function Ei(b,_,L){L?(Tt.set(b,_,!1),z.event.add(b,_,{namespace:!1,handler:function(G){var Z,D=Tt.get(this,_);if(1&G.isTrigger&&this[_]){if(D)(z.event.special[_]||{}).delegateType&&G.stopPropagation();else if(D=de.call(arguments),Tt.set(this,_,D),this[_](),Z=Tt.get(this,_),Tt.set(this,_,!1),D!==Z)return G.stopImmediatePropagation(),G.preventDefault(),Z}else D&&(Tt.set(this,_,z.event.trigger(D[0],D.slice(1),this)),G.stopPropagation(),G.isImmediatePropagationStopped=Oi)}})):void 0===Tt.get(b,_)&&z.event.add(b,_,Oi)}z.event={global:{},add:function(b,_,L,G,Z){var D,ae,ke,we,Ie,Oe,Ye,Ne,et,Ct,Xt,zt=Tt.get(b);if(Ca(b))for(L.handler&&(L=(D=L).handler,Z=D.selector),Z&&z.find.matchesSelector(Ur,Z),L.guid||(L.guid=z.guid++),(we=zt.events)||(we=zt.events=Object.create(null)),(ae=zt.handle)||(ae=zt.handle=function(ye){return typeof z<"u"&&z.event.triggered!==ye.type?z.event.dispatch.apply(b,arguments):void 0}),Ie=(_=(_||"").match(Pr)||[""]).length;Ie--;)et=Xt=(ke=Fa.exec(_[Ie])||[])[1],Ct=(ke[2]||"").split(".").sort(),et&&(Ye=z.event.special[et]||{},Ye=z.event.special[et=(Z?Ye.delegateType:Ye.bindType)||et]||{},Oe=z.extend({type:et,origType:Xt,data:G,handler:L,guid:L.guid,selector:Z,needsContext:Z&&z.expr.match.needsContext.test(Z),namespace:Ct.join(".")},D),(Ne=we[et])||((Ne=we[et]=[]).delegateCount=0,Ye.setup&&!1!==Ye.setup.call(b,G,Ct,ae)||b.addEventListener&&b.addEventListener(et,ae)),Ye.add&&(Ye.add.call(b,Oe),Oe.handler.guid||(Oe.handler.guid=L.guid)),Z?Ne.splice(Ne.delegateCount++,0,Oe):Ne.push(Oe),z.event.global[et]=!0)},remove:function(b,_,L,G,Z){var D,ae,ke,we,Ie,Oe,Ye,Ne,et,Ct,Xt,zt=Tt.hasData(b)&&Tt.get(b);if(zt&&(we=zt.events)){for(Ie=(_=(_||"").match(Pr)||[""]).length;Ie--;)if(et=Xt=(ke=Fa.exec(_[Ie])||[])[1],Ct=(ke[2]||"").split(".").sort(),et){for(Ye=z.event.special[et]||{},Ne=we[et=(G?Ye.delegateType:Ye.bindType)||et]||[],ke=ke[2]&&new RegExp("(^|\\.)"+Ct.join("\\.(?:.*\\.|)")+"(\\.|$)"),ae=D=Ne.length;D--;)Oe=Ne[D],!Z&&Xt!==Oe.origType||L&&L.guid!==Oe.guid||ke&&!ke.test(Oe.namespace)||G&&G!==Oe.selector&&("**"!==G||!Oe.selector)||(Ne.splice(D,1),Oe.selector&&Ne.delegateCount--,Ye.remove&&Ye.remove.call(b,Oe));ae&&!Ne.length&&(Ye.teardown&&!1!==Ye.teardown.call(b,Ct,zt.handle)||z.removeEvent(b,et,zt.handle),delete we[et])}else for(et in we)z.event.remove(b,et+_[Ie],L,G,!0);z.isEmptyObject(we)&&Tt.remove(b,"handle events")}},dispatch:function(b){var _,L,G,Z,D,ae,ke=new Array(arguments.length),we=z.event.fix(b),Ie=(Tt.get(this,"events")||Object.create(null))[we.type]||[],Oe=z.event.special[we.type]||{};for(ke[0]=we,_=1;_<arguments.length;_++)ke[_]=arguments[_];if(we.delegateTarget=this,!Oe.preDispatch||!1!==Oe.preDispatch.call(this,we)){for(ae=z.event.handlers.call(this,we,Ie),_=0;(Z=ae[_++])&&!we.isPropagationStopped();)for(we.currentTarget=Z.elem,L=0;(D=Z.handlers[L++])&&!we.isImmediatePropagationStopped();)we.rnamespace&&!1!==D.namespace&&!we.rnamespace.test(D.namespace)||(we.handleObj=D,we.data=D.data,void 0!==(G=((z.event.special[D.origType]||{}).handle||D.handler).apply(Z.elem,ke))&&!1===(we.result=G)&&(we.preventDefault(),we.stopPropagation()));return Oe.postDispatch&&Oe.postDispatch.call(this,we),we.result}},handlers:function(b,_){var L,G,Z,D,ae,ke=[],we=_.delegateCount,Ie=b.target;if(we&&Ie.nodeType&&!("click"===b.type&&1<=b.button))for(;Ie!==this;Ie=Ie.parentNode||this)if(1===Ie.nodeType&&("click"!==b.type||!0!==Ie.disabled)){for(D=[],ae={},L=0;L<we;L++)void 0===ae[Z=(G=_[L]).selector+" "]&&(ae[Z]=G.needsContext?-1<z(Z,this).index(Ie):z.find(Z,this,null,[Ie]).length),ae[Z]&&D.push(G);D.length&&ke.push({elem:Ie,handlers:D})}return Ie=this,we<_.length&&ke.push({elem:Ie,handlers:_.slice(we)}),ke},addProp:function(b,_){Object.defineProperty(z.Event.prototype,b,{enumerable:!0,configurable:!0,get:Et(_)?function(){if(this.originalEvent)return _(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[b]},set:function(L){Object.defineProperty(this,b,{enumerable:!0,configurable:!0,writable:!0,value:L})}})},fix:function(b){return b[z.expando]?b:new z.Event(b)},special:{load:{noBubble:!0},click:{setup:function(b){var _=this||b;return Me.test(_.type)&&_.click&&Qt(_,"input")&&Ei(_,"click",!0),!1},trigger:function(b){var _=this||b;return Me.test(_.type)&&_.click&&Qt(_,"input")&&Ei(_,"click"),!0},_default:function(b){var _=b.target;return Me.test(_.type)&&_.click&&Qt(_,"input")&&Tt.get(_,"click")||Qt(_,"a")}},beforeunload:{postDispatch:function(b){void 0!==b.result&&b.originalEvent&&(b.originalEvent.returnValue=b.result)}}}},z.removeEvent=function(b,_,L){b.removeEventListener&&b.removeEventListener(_,L)},z.Event=function(b,_){if(!(this instanceof z.Event))return new z.Event(b,_);b&&b.type?(this.originalEvent=b,this.type=b.type,this.isDefaultPrevented=b.defaultPrevented||void 0===b.defaultPrevented&&!1===b.returnValue?Oi:Bi,this.target=b.target&&3===b.target.nodeType?b.target.parentNode:b.target,this.currentTarget=b.currentTarget,this.relatedTarget=b.relatedTarget):this.type=b,_&&z.extend(this,_),this.timeStamp=b&&b.timeStamp||Date.now(),this[z.expando]=!0},z.Event.prototype={constructor:z.Event,isDefaultPrevented:Bi,isPropagationStopped:Bi,isImmediatePropagationStopped:Bi,isSimulated:!1,preventDefault:function(){var b=this.originalEvent;this.isDefaultPrevented=Oi,b&&!this.isSimulated&&b.preventDefault()},stopPropagation:function(){var b=this.originalEvent;this.isPropagationStopped=Oi,b&&!this.isSimulated&&b.stopPropagation()},stopImmediatePropagation:function(){var b=this.originalEvent;this.isImmediatePropagationStopped=Oi,b&&!this.isSimulated&&b.stopImmediatePropagation(),this.stopPropagation()}},z.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},z.event.addProp),z.each({focus:"focusin",blur:"focusout"},function(b,_){function L(G){if(pe.documentMode){var Z=Tt.get(this,"handle"),D=z.event.fix(G);D.type="focusin"===G.type?"focus":"blur",D.isSimulated=!0,Z(G),D.target===D.currentTarget&&Z(D)}else z.event.simulate(_,G.target,z.event.fix(G))}z.event.special[b]={setup:function(){var G;if(Ei(this,b,!0),!pe.documentMode)return!1;(G=Tt.get(this,_))||this.addEventListener(_,L),Tt.set(this,_,(G||0)+1)},trigger:function(){return Ei(this,b),!0},teardown:function(){var G;if(!pe.documentMode)return!1;(G=Tt.get(this,_)-1)?Tt.set(this,_,G):(this.removeEventListener(_,L),Tt.remove(this,_))},_default:function(G){return Tt.get(G.target,b)},delegateType:_},z.event.special[_]={setup:function(){var G=this.ownerDocument||this.document||this,Z=pe.documentMode?this:G,D=Tt.get(Z,_);D||(pe.documentMode?this.addEventListener(_,L):G.addEventListener(b,L,!0)),Tt.set(Z,_,(D||0)+1)},teardown:function(){var G=this.ownerDocument||this.document||this,Z=pe.documentMode?this:G,D=Tt.get(Z,_)-1;D?Tt.set(Z,_,D):(pe.documentMode?this.removeEventListener(_,L):G.removeEventListener(b,L,!0),Tt.remove(Z,_))}}}),z.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(b,_){z.event.special[b]={delegateType:_,bindType:_,handle:function(L){var G,Z=L.relatedTarget,D=L.handleObj;return Z&&(Z===this||z.contains(this,Z))||(L.type=D.origType,G=D.handler.apply(this,arguments),L.type=_),G}}}),z.fn.extend({on:function(b,_,L,G){return zi(this,b,_,L,G)},one:function(b,_,L,G){return zi(this,b,_,L,G,1)},off:function(b,_,L){var G,Z;if(b&&b.preventDefault&&b.handleObj)return G=b.handleObj,z(b.delegateTarget).off(G.namespace?G.origType+"."+G.namespace:G.origType,G.selector,G.handler),this;if("object"==typeof b){for(Z in b)this.off(Z,_,b[Z]);return this}return!1!==_&&"function"!=typeof _||(L=_,_=void 0),!1===L&&(L=Bi),this.each(function(){z.event.remove(this,b,L,_)})}});var Zi=/<script|<style|<link/i,Ji=/checked\s*(?:[^=]|=\s*.checked.)/i,Dn=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Wi(b,_){return Qt(b,"table")&&Qt(11!==_.nodeType?_:_.firstChild,"tr")&&z(b).children("tbody")[0]||b}function Bn(b){return b.type=(null!==b.getAttribute("type"))+"/"+b.type,b}function ns(b){return"true/"===(b.type||"").slice(0,5)?b.type=b.type.slice(5):b.removeAttribute("type"),b}function no(b,_){var L,G,Z,D,ae,ke;if(1===_.nodeType){if(Tt.hasData(b)&&(ke=Tt.get(b).events))for(Z in Tt.remove(_,"handle events"),ke)for(L=0,G=ke[Z].length;L<G;L++)z.event.add(_,Z,ke[Z][L]);nr.hasData(b)&&(D=nr.access(b),ae=z.extend({},D),nr.set(_,ae))}}function qr(b,_,L,G){_=me(_);var Z,D,ae,ke,we,Ie,Oe=0,Ye=b.length,Ne=Ye-1,et=_[0],Ct=Et(et);if(Ct||1<Ye&&"string"==typeof et&&!gt.checkClone&&Ji.test(et))return b.each(function(Xt){var zt=b.eq(Xt);Ct&&(_[0]=et.call(this,Xt,zt.html())),qr(zt,_,L,G)});if(Ye&&(D=(Z=Fi(_,b[0].ownerDocument,!1,b,G)).firstChild,1===Z.childNodes.length&&(Z=D),D||G)){for(ke=(ae=z.map(wr(Z,"script"),Bn)).length;Oe<Ye;Oe++)we=Z,Oe!==Ne&&(we=z.clone(we,!0,!0),ke&&z.merge(ae,wr(we,"script"))),L.call(b[Oe],we,Oe);if(ke)for(Ie=ae[ae.length-1].ownerDocument,z.map(ae,ns),Oe=0;Oe<ke;Oe++)La.test((we=ae[Oe]).type||"")&&!Tt.access(we,"globalEval")&&z.contains(Ie,we)&&(we.src&&"module"!==(we.type||"").toLowerCase()?z._evalUrl&&!we.noModule&&z._evalUrl(we.src,{nonce:we.nonce||we.getAttribute("nonce")},Ie):On(we.textContent.replace(Dn,""),we,Ie))}return b}function Mr(b,_,L){for(var G,Z=_?z.filter(_,b):b,D=0;null!=(G=Z[D]);D++)L||1!==G.nodeType||z.cleanData(wr(G)),G.parentNode&&(L&&Ki(G)&&ka(wr(G,"script")),G.parentNode.removeChild(G));return b}z.extend({htmlPrefilter:function(b){return b},clone:function(b,_,L){var G,Z,D,ae,ke,we,Ie,Oe=b.cloneNode(!0),Ye=Ki(b);if(!(gt.noCloneChecked||1!==b.nodeType&&11!==b.nodeType||z.isXMLDoc(b)))for(ae=wr(Oe),G=0,Z=(D=wr(b)).length;G<Z;G++)ke=D[G],"input"===(Ie=(we=ae[G]).nodeName.toLowerCase())&&Me.test(ke.type)?we.checked=ke.checked:"input"!==Ie&&"textarea"!==Ie||(we.defaultValue=ke.defaultValue);if(_)if(L)for(D=D||wr(b),ae=ae||wr(Oe),G=0,Z=D.length;G<Z;G++)no(D[G],ae[G]);else no(b,Oe);return 0<(ae=wr(Oe,"script")).length&&ka(ae,!Ye&&wr(b,"script")),Oe},cleanData:function(b){for(var _,L,G,Z=z.event.special,D=0;void 0!==(L=b[D]);D++)if(Ca(L)){if(_=L[Tt.expando]){if(_.events)for(G in _.events)Z[G]?z.event.remove(L,G):z.removeEvent(L,G,_.handle);L[Tt.expando]=void 0}L[nr.expando]&&(L[nr.expando]=void 0)}}}),z.fn.extend({detach:function(b){return Mr(this,b,!0)},remove:function(b){return Mr(this,b)},text:function(b){return fi(this,function(_){return void 0===_?z.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=_)})},null,b,arguments.length)},append:function(){return qr(this,arguments,function(b){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Wi(this,b).appendChild(b)})},prepend:function(){return qr(this,arguments,function(b){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var _=Wi(this,b);_.insertBefore(b,_.firstChild)}})},before:function(){return qr(this,arguments,function(b){this.parentNode&&this.parentNode.insertBefore(b,this)})},after:function(){return qr(this,arguments,function(b){this.parentNode&&this.parentNode.insertBefore(b,this.nextSibling)})},empty:function(){for(var b,_=0;null!=(b=this[_]);_++)1===b.nodeType&&(z.cleanData(wr(b,!1)),b.textContent="");return this},clone:function(b,_){return b=null!=b&&b,_=_??b,this.map(function(){return z.clone(this,b,_)})},html:function(b){return fi(this,function(_){var L=this[0]||{},G=0,Z=this.length;if(void 0===_&&1===L.nodeType)return L.innerHTML;if("string"==typeof _&&!Zi.test(_)&&!Hr[(ha.exec(_)||["",""])[1].toLowerCase()]){_=z.htmlPrefilter(_);try{for(;G<Z;G++)1===(L=this[G]||{}).nodeType&&(z.cleanData(wr(L,!1)),L.innerHTML=_);L=0}catch{}}L&&this.empty().append(_)},null,b,arguments.length)},replaceWith:function(){var b=[];return qr(this,arguments,function(_){var L=this.parentNode;z.inArray(this,b)<0&&(z.cleanData(wr(this)),L&&L.replaceChild(_,this))},b)}}),z.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(b,_){z.fn[b]=function(L){for(var G,Z=[],D=z(L),ae=D.length-1,ke=0;ke<=ae;ke++)G=ke===ae?this:this.clone(!0),z(D[ke])[_](G),st.apply(Z,G.get());return this.pushStack(Z)}});var Cr=new RegExp("^("+$i+")(?!px)[a-z%]+$","i"),Nr=/^--/,dt=function(b){var _=b.ownerDocument.defaultView;return _&&_.opener||(_=Ce),_.getComputedStyle(b)},Aa=function(b,_,L){var G,Z,D={};for(Z in _)D[Z]=b.style[Z],b.style[Z]=_[Z];for(Z in G=L.call(b),_)b.style[Z]=D[Z];return G},P=new RegExp(ai.join("|"),"i");function r(b,_,L){var G,Z,D,ae,ke=Nr.test(_),we=b.style;return(L=L||dt(b))&&(ae=L.getPropertyValue(_)||L[_],ke&&ae&&(ae=ae.replace(Lr,"$1")||void 0),""!==ae||Ki(b)||(ae=z.style(b,_)),!gt.pixelBoxStyles()&&Cr.test(ae)&&P.test(_)&&(G=we.width,Z=we.minWidth,D=we.maxWidth,we.minWidth=we.maxWidth=we.width=ae,ae=L.width,we.width=G,we.minWidth=Z,we.maxWidth=D)),void 0!==ae?ae+"":ae}function i(b,_){return{get:function(){if(!b())return(this.get=_).apply(this,arguments);delete this.get}}}!function(){function b(){if(Ie){we.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",Ie.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",Ur.appendChild(we).appendChild(Ie);var Oe=Ce.getComputedStyle(Ie);L="1%"!==Oe.top,ke=12===_(Oe.marginLeft),Ie.style.right="60%",D=36===_(Oe.right),G=36===_(Oe.width),Ie.style.position="absolute",Z=12===_(Ie.offsetWidth/3),Ur.removeChild(we),Ie=null}}function _(Oe){return Math.round(parseFloat(Oe))}var L,G,Z,D,ae,ke,we=pe.createElement("div"),Ie=pe.createElement("div");Ie.style&&(Ie.style.backgroundClip="content-box",Ie.cloneNode(!0).style.backgroundClip="",gt.clearCloneStyle="content-box"===Ie.style.backgroundClip,z.extend(gt,{boxSizingReliable:function(){return b(),G},pixelBoxStyles:function(){return b(),D},pixelPosition:function(){return b(),L},reliableMarginLeft:function(){return b(),ke},scrollboxSize:function(){return b(),Z},reliableTrDimensions:function(){var Oe,Ye,Ne,et;return null==ae&&(Oe=pe.createElement("table"),Ye=pe.createElement("tr"),Ne=pe.createElement("div"),Oe.style.cssText="position:absolute;left:-11111px;border-collapse:separate",Ye.style.cssText="box-sizing:content-box;border:1px solid",Ye.style.height="1px",Ne.style.height="9px",Ne.style.display="block",Ur.appendChild(Oe).appendChild(Ye).appendChild(Ne),et=Ce.getComputedStyle(Ye),ae=parseInt(et.height,10)+parseInt(et.borderTopWidth,10)+parseInt(et.borderBottomWidth,10)===Ye.offsetHeight,Ur.removeChild(Oe)),ae}}))}();var o=["Webkit","Moz","ms"],l=pe.createElement("div").style,u={};function h(b){return z.cssProps[b]||u[b]||(b in l?b:u[b]=function(L){for(var G=L[0].toUpperCase()+L.slice(1),Z=o.length;Z--;)if((L=o[Z]+G)in l)return L}(b)||b)}var p=/^(none|table(?!-c[ea]).+)/,v={position:"absolute",visibility:"hidden",display:"block"},y={letterSpacing:"0",fontWeight:"400"};function C(b,_,L){var G=Ni.exec(_);return G?Math.max(0,G[2]-(L||0))+(G[3]||"px"):_}function k(b,_,L,G,Z,D){var ae="width"===_?1:0,ke=0,we=0,Ie=0;if(L===(G?"border":"content"))return 0;for(;ae<4;ae+=2)"margin"===L&&(Ie+=z.css(b,L+ai[ae],!0,Z)),G?("content"===L&&(we-=z.css(b,"padding"+ai[ae],!0,Z)),"margin"!==L&&(we-=z.css(b,"border"+ai[ae]+"Width",!0,Z))):(we+=z.css(b,"padding"+ai[ae],!0,Z),"padding"!==L?we+=z.css(b,"border"+ai[ae]+"Width",!0,Z):ke+=z.css(b,"border"+ai[ae]+"Width",!0,Z));return!G&&0<=D&&(we+=Math.max(0,Math.ceil(b["offset"+_[0].toUpperCase()+_.slice(1)]-D-we-ke-.5))||0),we+Ie}function S(b,_,L){var G=dt(b),Z=(!gt.boxSizingReliable()||L)&&"border-box"===z.css(b,"boxSizing",!1,G),D=Z,ae=r(b,_,G),ke="offset"+_[0].toUpperCase()+_.slice(1);if(Cr.test(ae)){if(!L)return ae;ae="auto"}return(!gt.boxSizingReliable()&&Z||!gt.reliableTrDimensions()&&Qt(b,"tr")||"auto"===ae||!parseFloat(ae)&&"inline"===z.css(b,"display",!1,G))&&b.getClientRects().length&&(Z="border-box"===z.css(b,"boxSizing",!1,G),(D=ke in b)&&(ae=b[ke])),(ae=parseFloat(ae)||0)+k(b,_,L||(Z?"border":"content"),D,G,ae)+"px"}function R(b,_,L,G,Z){return new R.prototype.init(b,_,L,G,Z)}z.extend({cssHooks:{opacity:{get:function(b,_){if(_){var L=r(b,"opacity");return""===L?"1":L}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(b,_,L,G){if(b&&3!==b.nodeType&&8!==b.nodeType&&b.style){var Z,D,ae,ke=ii(_),we=Nr.test(_),Ie=b.style;if(we||(_=h(ke)),ae=z.cssHooks[_]||z.cssHooks[ke],void 0===L)return ae&&"get"in ae&&void 0!==(Z=ae.get(b,!1,G))?Z:Ie[_];"string"==(D=typeof L)&&(Z=Ni.exec(L))&&Z[1]&&(L=gi(b,_,Z),D="number"),null!=L&&L==L&&("number"!==D||we||(L+=Z&&Z[3]||(z.cssNumber[ke]?"":"px")),gt.clearCloneStyle||""!==L||0!==_.indexOf("background")||(Ie[_]="inherit"),ae&&"set"in ae&&void 0===(L=ae.set(b,L,G))||(we?Ie.setProperty(_,L):Ie[_]=L))}},css:function(b,_,L,G){var Z,D,ae,ke=ii(_);return Nr.test(_)||(_=h(ke)),(ae=z.cssHooks[_]||z.cssHooks[ke])&&"get"in ae&&(Z=ae.get(b,!0,L)),void 0===Z&&(Z=r(b,_,G)),"normal"===Z&&_ in y&&(Z=y[_]),""===L||L?(D=parseFloat(Z),!0===L||isFinite(D)?D||0:Z):Z}}),z.each(["height","width"],function(b,_){z.cssHooks[_]={get:function(L,G,Z){if(G)return!p.test(z.css(L,"display"))||L.getClientRects().length&&L.getBoundingClientRect().width?S(L,_,Z):Aa(L,v,function(){return S(L,_,Z)})},set:function(L,G,Z){var D,ae=dt(L),ke=!gt.scrollboxSize()&&"absolute"===ae.position,we=(ke||Z)&&"border-box"===z.css(L,"boxSizing",!1,ae),Ie=Z?k(L,_,Z,we,ae):0;return we&&ke&&(Ie-=Math.ceil(L["offset"+_[0].toUpperCase()+_.slice(1)]-parseFloat(ae[_])-k(L,_,"border",!1,ae)-.5)),Ie&&(D=Ni.exec(G))&&"px"!==(D[3]||"px")&&(L.style[_]=G,G=z.css(L,_)),C(0,G,Ie)}}}),z.cssHooks.marginLeft=i(gt.reliableMarginLeft,function(b,_){if(_)return(parseFloat(r(b,"marginLeft"))||b.getBoundingClientRect().left-Aa(b,{marginLeft:0},function(){return b.getBoundingClientRect().left}))+"px"}),z.each({margin:"",padding:"",border:"Width"},function(b,_){z.cssHooks[b+_]={expand:function(L){for(var G=0,Z={},D="string"==typeof L?L.split(" "):[L];G<4;G++)Z[b+ai[G]+_]=D[G]||D[G-2]||D[0];return Z}},"margin"!==b&&(z.cssHooks[b+_].set=C)}),z.fn.extend({css:function(b,_){return fi(this,function(L,G,Z){var D,ae,ke={},we=0;if(Array.isArray(G)){for(D=dt(L),ae=G.length;we<ae;we++)ke[G[we]]=z.css(L,G[we],!1,D);return ke}return void 0!==Z?z.style(L,G,Z):z.css(L,G)},b,_,1<arguments.length)}}),((z.Tween=R).prototype={constructor:R,init:function(b,_,L,G,Z,D){this.elem=b,this.prop=L,this.easing=Z||z.easing._default,this.options=_,this.start=this.now=this.cur(),this.end=G,this.unit=D||(z.cssNumber[L]?"":"px")},cur:function(){var b=R.propHooks[this.prop];return b&&b.get?b.get(this):R.propHooks._default.get(this)},run:function(b){var _,L=R.propHooks[this.prop];return this.pos=_=this.options.duration?z.easing[this.easing](b,this.options.duration*b,0,1,this.options.duration):b,this.now=(this.end-this.start)*_+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),L&&L.set?L.set(this):R.propHooks._default.set(this),this}}).init.prototype=R.prototype,(R.propHooks={_default:{get:function(b){var _;return 1!==b.elem.nodeType||null!=b.elem[b.prop]&&null==b.elem.style[b.prop]?b.elem[b.prop]:(_=z.css(b.elem,b.prop,""))&&"auto"!==_?_:0},set:function(b){z.fx.step[b.prop]?z.fx.step[b.prop](b):1!==b.elem.nodeType||!z.cssHooks[b.prop]&&null==b.elem.style[h(b.prop)]?b.elem[b.prop]=b.now:z.style(b.elem,b.prop,b.now+b.unit)}}}).scrollTop=R.propHooks.scrollLeft={set:function(b){b.elem.nodeType&&b.elem.parentNode&&(b.elem[b.prop]=b.now)}},z.easing={linear:function(b){return b},swing:function(b){return.5-Math.cos(b*Math.PI)/2},_default:"swing"},z.fx=R.prototype.init,z.fx.step={};var N,B,U,j,K=/^(?:toggle|show|hide)$/,x=/queueHooks$/;function I(){B&&(!1===pe.hidden&&Ce.requestAnimationFrame?Ce.requestAnimationFrame(I):Ce.setTimeout(I,z.fx.interval),z.fx.tick())}function W(){return Ce.setTimeout(function(){N=void 0}),N=Date.now()}function q(b,_){var L,G=0,Z={height:b};for(_=_?1:0;G<4;G+=2-_)Z["margin"+(L=ai[G])]=Z["padding"+L]=b;return _&&(Z.opacity=Z.width=b),Z}function J(b,_,L){for(var G,Z=(ne.tweeners[_]||[]).concat(ne.tweeners["*"]),D=0,ae=Z.length;D<ae;D++)if(G=Z[D].call(L,_,b))return G}function ne(b,_,L){var G,Z,D=0,ae=ne.prefilters.length,ke=z.Deferred().always(function(){delete we.elem}),we=function(){if(Z)return!1;for(var Ye=N||W(),Ne=Math.max(0,Ie.startTime+Ie.duration-Ye),et=1-(Ne/Ie.duration||0),Ct=0,Xt=Ie.tweens.length;Ct<Xt;Ct++)Ie.tweens[Ct].run(et);return ke.notifyWith(b,[Ie,et,Ne]),et<1&&Xt?Ne:(Xt||ke.notifyWith(b,[Ie,1,0]),ke.resolveWith(b,[Ie]),!1)},Ie=ke.promise({elem:b,props:z.extend({},_),opts:z.extend(!0,{specialEasing:{},easing:z.easing._default},L),originalProperties:_,originalOptions:L,startTime:N||W(),duration:L.duration,tweens:[],createTween:function(Ye,Ne){var et=z.Tween(b,Ie.opts,Ye,Ne,Ie.opts.specialEasing[Ye]||Ie.opts.easing);return Ie.tweens.push(et),et},stop:function(Ye){var Ne=0,et=Ye?Ie.tweens.length:0;if(Z)return this;for(Z=!0;Ne<et;Ne++)Ie.tweens[Ne].run(1);return Ye?(ke.notifyWith(b,[Ie,1,0]),ke.resolveWith(b,[Ie,Ye])):ke.rejectWith(b,[Ie,Ye]),this}}),Oe=Ie.props;for(function(Ye,Ne){var et,Ct,Xt,zt,ye;for(et in Ye)if(Xt=Ne[Ct=ii(et)],zt=Ye[et],Array.isArray(zt)&&(Xt=zt[1],zt=Ye[et]=zt[0]),et!==Ct&&(Ye[Ct]=zt,delete Ye[et]),(ye=z.cssHooks[Ct])&&"expand"in ye)for(et in zt=ye.expand(zt),delete Ye[Ct],zt)et in Ye||(Ye[et]=zt[et],Ne[et]=Xt);else Ne[Ct]=Xt}(Oe,Ie.opts.specialEasing);D<ae;D++)if(G=ne.prefilters[D].call(Ie,b,Oe,Ie.opts))return Et(G.stop)&&(z._queueHooks(Ie.elem,Ie.opts.queue).stop=G.stop.bind(G)),G;return z.map(Oe,J,Ie),Et(Ie.opts.start)&&Ie.opts.start.call(b,Ie),Ie.progress(Ie.opts.progress).done(Ie.opts.done,Ie.opts.complete).fail(Ie.opts.fail).always(Ie.opts.always),z.fx.timer(z.extend(we,{elem:b,anim:Ie,queue:Ie.opts.queue})),Ie}z.Animation=z.extend(ne,{tweeners:{"*":[function(b,_){var L=this.createTween(b,_);return gi(L.elem,b,Ni.exec(_),L),L}]},tweener:function(b,_){Et(b)?(_=b,b=["*"]):b=b.match(Pr);for(var L,G=0,Z=b.length;G<Z;G++)(ne.tweeners[L=b[G]]=ne.tweeners[L]||[]).unshift(_)},prefilters:[function(b,_,L){var G,Z,D,ae,ke,we,Ie,Oe,Ye="width"in _||"height"in _,Ne=this,et={},Ct=b.style,Xt=b.nodeType&&Li(b),zt=Tt.get(b,"fxshow");for(G in L.queue||(null==(ae=z._queueHooks(b,"fx")).unqueued&&(ae.unqueued=0,ke=ae.empty.fire,ae.empty.fire=function(){ae.unqueued||ke()}),ae.unqueued++,Ne.always(function(){Ne.always(function(){ae.unqueued--,z.queue(b,"fx").length||ae.empty.fire()})})),_)if(K.test(Z=_[G])){if(delete _[G],D=D||"toggle"===Z,Z===(Xt?"hide":"show")){if("show"!==Z||!zt||void 0===zt[G])continue;Xt=!0}et[G]=zt&&zt[G]||z.style(b,G)}if((we=!z.isEmptyObject(_))||!z.isEmptyObject(et))for(G in Ye&&1===b.nodeType&&(L.overflow=[Ct.overflow,Ct.overflowX,Ct.overflowY],null==(Ie=zt&&zt.display)&&(Ie=Tt.get(b,"display")),"none"===(Oe=z.css(b,"display"))&&(Ie?Oe=Ie:(ua([b],!0),Ie=b.style.display||Ie,Oe=z.css(b,"display"),ua([b]))),("inline"===Oe||"inline-block"===Oe&&null!=Ie)&&"none"===z.css(b,"float")&&(we||(Ne.done(function(){Ct.display=Ie}),null==Ie&&(Ie="none"===(Oe=Ct.display)?"":Oe)),Ct.display="inline-block")),L.overflow&&(Ct.overflow="hidden",Ne.always(function(){Ct.overflow=L.overflow[0],Ct.overflowX=L.overflow[1],Ct.overflowY=L.overflow[2]})),we=!1,et)we||(zt?"hidden"in zt&&(Xt=zt.hidden):zt=Tt.access(b,"fxshow",{display:Ie}),D&&(zt.hidden=!Xt),Xt&&ua([b],!0),Ne.done(function(){for(G in Xt||ua([b]),Tt.remove(b,"fxshow"),et)z.style(b,G,et[G])})),we=J(Xt?zt[G]:0,G,Ne),G in zt||(zt[G]=we.start,Xt&&(we.end=we.start,we.start=0))}],prefilter:function(b,_){_?ne.prefilters.unshift(b):ne.prefilters.push(b)}}),z.speed=function(b,_,L){var G=b&&"object"==typeof b?z.extend({},b):{complete:L||!L&&_||Et(b)&&b,duration:b,easing:L&&_||_&&!Et(_)&&_};return z.fx.off?G.duration=0:"number"!=typeof G.duration&&(G.duration=G.duration in z.fx.speeds?z.fx.speeds[G.duration]:z.fx.speeds._default),null!=G.queue&&!0!==G.queue||(G.queue="fx"),G.old=G.complete,G.complete=function(){Et(G.old)&&G.old.call(this),G.queue&&z.dequeue(this,G.queue)},G},z.fn.extend({fadeTo:function(b,_,L,G){return this.filter(Li).css("opacity",0).show().end().animate({opacity:_},b,L,G)},animate:function(b,_,L,G){var Z=z.isEmptyObject(b),D=z.speed(_,L,G),ae=function(){var ke=ne(this,z.extend({},b),D);(Z||Tt.get(this,"finish"))&&ke.stop(!0)};return ae.finish=ae,Z||!1===D.queue?this.each(ae):this.queue(D.queue,ae)},stop:function(b,_,L){var G=function(Z){var D=Z.stop;delete Z.stop,D(L)};return"string"!=typeof b&&(L=_,_=b,b=void 0),_&&this.queue(b||"fx",[]),this.each(function(){var Z=!0,D=null!=b&&b+"queueHooks",ae=z.timers,ke=Tt.get(this);if(D)ke[D]&&ke[D].stop&&G(ke[D]);else for(D in ke)ke[D]&&ke[D].stop&&x.test(D)&&G(ke[D]);for(D=ae.length;D--;)ae[D].elem!==this||null!=b&&ae[D].queue!==b||(ae[D].anim.stop(L),Z=!1,ae.splice(D,1));!Z&&L||z.dequeue(this,b)})},finish:function(b){return!1!==b&&(b=b||"fx"),this.each(function(){var _,L=Tt.get(this),G=L[b+"queue"],Z=L[b+"queueHooks"],D=z.timers,ae=G?G.length:0;for(L.finish=!0,z.queue(this,b,[]),Z&&Z.stop&&Z.stop.call(this,!0),_=D.length;_--;)D[_].elem===this&&D[_].queue===b&&(D[_].anim.stop(!0),D.splice(_,1));for(_=0;_<ae;_++)G[_]&&G[_].finish&&G[_].finish.call(this);delete L.finish})}}),z.each(["toggle","show","hide"],function(b,_){var L=z.fn[_];z.fn[_]=function(G,Z,D){return null==G||"boolean"==typeof G?L.apply(this,arguments):this.animate(q(_,!0),G,Z,D)}}),z.each({slideDown:q("show"),slideUp:q("hide"),slideToggle:q("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(b,_){z.fn[b]=function(L,G,Z){return this.animate(_,L,G,Z)}}),z.timers=[],z.fx.tick=function(){var b,_=0,L=z.timers;for(N=Date.now();_<L.length;_++)(b=L[_])()||L[_]!==b||L.splice(_--,1);L.length||z.fx.stop(),N=void 0},z.fx.timer=function(b){z.timers.push(b),z.fx.start()},z.fx.interval=13,z.fx.start=function(){B||(B=!0,I())},z.fx.stop=function(){B=null},z.fx.speeds={slow:600,fast:200,_default:400},z.fn.delay=function(b,_){return b=z.fx&&z.fx.speeds[b]||b,this.queue(_=_||"fx",function(L,G){var Z=Ce.setTimeout(L,b);G.stop=function(){Ce.clearTimeout(Z)}})},U=pe.createElement("input"),j=pe.createElement("select").appendChild(pe.createElement("option")),U.type="checkbox",gt.checkOn=""!==U.value,gt.optSelected=j.selected,(U=pe.createElement("input")).value="t",U.type="radio",gt.radioValue="t"===U.value;var ve,ge=z.expr.attrHandle;z.fn.extend({attr:function(b,_){return fi(this,z.attr,b,_,1<arguments.length)},removeAttr:function(b){return this.each(function(){z.removeAttr(this,b)})}}),z.extend({attr:function(b,_,L){var G,Z,D=b.nodeType;if(3!==D&&8!==D&&2!==D)return typeof b.getAttribute>"u"?z.prop(b,_,L):(1===D&&z.isXMLDoc(b)||(Z=z.attrHooks[_.toLowerCase()]||(z.expr.match.bool.test(_)?ve:void 0)),void 0!==L?null===L?void z.removeAttr(b,_):Z&&"set"in Z&&void 0!==(G=Z.set(b,L,_))?G:(b.setAttribute(_,L+""),L):Z&&"get"in Z&&null!==(G=Z.get(b,_))?G:null==(G=z.find.attr(b,_))?void 0:G)},attrHooks:{type:{set:function(b,_){if(!gt.radioValue&&"radio"===_&&Qt(b,"input")){var L=b.value;return b.setAttribute("type",_),L&&(b.value=L),_}}}},removeAttr:function(b,_){var L,G=0,Z=_&&_.match(Pr);if(Z&&1===b.nodeType)for(;L=Z[G++];)b.removeAttribute(L)}}),ve={set:function(b,_,L){return!1===_?z.removeAttr(b,L):b.setAttribute(L,L),L}},z.each(z.expr.match.bool.source.match(/\w+/g),function(b,_){var L=ge[_]||z.find.attr;ge[_]=function(G,Z,D){var ae,ke,we=Z.toLowerCase();return D||(ke=ge[we],ge[we]=ae,ae=null!=L(G,Z,D)?we:null,ge[we]=ke),ae}});var Le=/^(?:input|select|textarea|button)$/i,qe=/^(?:a|area)$/i;function Pe(b){return(b.match(Pr)||[]).join(" ")}function Ue(b){return b.getAttribute&&b.getAttribute("class")||""}function lt(b){return Array.isArray(b)?b:"string"==typeof b&&b.match(Pr)||[]}z.fn.extend({prop:function(b,_){return fi(this,z.prop,b,_,1<arguments.length)},removeProp:function(b){return this.each(function(){delete this[z.propFix[b]||b]})}}),z.extend({prop:function(b,_,L){var G,Z,D=b.nodeType;if(3!==D&&8!==D&&2!==D)return 1===D&&z.isXMLDoc(b)||(Z=z.propHooks[_=z.propFix[_]||_]),void 0!==L?Z&&"set"in Z&&void 0!==(G=Z.set(b,L,_))?G:b[_]=L:Z&&"get"in Z&&null!==(G=Z.get(b,_))?G:b[_]},propHooks:{tabIndex:{get:function(b){var _=z.find.attr(b,"tabindex");return _?parseInt(_,10):Le.test(b.nodeName)||qe.test(b.nodeName)&&b.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),gt.optSelected||(z.propHooks.selected={get:function(b){return null},set:function(b){}}),z.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){z.propFix[this.toLowerCase()]=this}),z.fn.extend({addClass:function(b){var _,L,G,Z,D,ae;return Et(b)?this.each(function(ke){z(this).addClass(b.call(this,ke,Ue(this)))}):(_=lt(b)).length?this.each(function(){if(G=Ue(this),L=1===this.nodeType&&" "+Pe(G)+" "){for(D=0;D<_.length;D++)L.indexOf(" "+(Z=_[D])+" ")<0&&(L+=Z+" ");ae=Pe(L),G!==ae&&this.setAttribute("class",ae)}}):this},removeClass:function(b){var _,L,G,Z,D,ae;return Et(b)?this.each(function(ke){z(this).removeClass(b.call(this,ke,Ue(this)))}):arguments.length?(_=lt(b)).length?this.each(function(){if(G=Ue(this),L=1===this.nodeType&&" "+Pe(G)+" "){for(D=0;D<_.length;D++)for(Z=_[D];-1<L.indexOf(" "+Z+" ");)L=L.replace(" "+Z+" "," ");ae=Pe(L),G!==ae&&this.setAttribute("class",ae)}}):this:this.attr("class","")},toggleClass:function(b,_){var L,G,Z,D,ae=typeof b,ke="string"===ae||Array.isArray(b);return Et(b)?this.each(function(we){z(this).toggleClass(b.call(this,we,Ue(this),_),_)}):"boolean"==typeof _&&ke?_?this.addClass(b):this.removeClass(b):(L=lt(b),this.each(function(){if(ke)for(D=z(this),Z=0;Z<L.length;Z++)D.hasClass(G=L[Z])?D.removeClass(G):D.addClass(G);else void 0!==b&&"boolean"!==ae||((G=Ue(this))&&Tt.set(this,"__className__",G),this.setAttribute&&this.setAttribute("class",G||!1===b?"":Tt.get(this,"__className__")||""))}))},hasClass:function(b){var _,L,G=0;for(_=" "+b+" ";L=this[G++];)if(1===L.nodeType&&-1<(" "+Pe(Ue(L))+" ").indexOf(_))return!0;return!1}});var ft=/\r/g;z.fn.extend({val:function(b){var _,L,G,Z=this[0];return arguments.length?(G=Et(b),this.each(function(D){var ae;1===this.nodeType&&(null==(ae=G?b.call(this,D,z(this).val()):b)?ae="":"number"==typeof ae?ae+="":Array.isArray(ae)&&(ae=z.map(ae,function(ke){return null==ke?"":ke+""})),(_=z.valHooks[this.type]||z.valHooks[this.nodeName.toLowerCase()])&&"set"in _&&void 0!==_.set(this,ae,"value")||(this.value=ae))})):Z?(_=z.valHooks[Z.type]||z.valHooks[Z.nodeName.toLowerCase()])&&"get"in _&&void 0!==(L=_.get(Z,"value"))?L:"string"==typeof(L=Z.value)?L.replace(ft,""):L??"":void 0}}),z.extend({valHooks:{option:{get:function(b){return z.find.attr(b,"value")??Pe(z.text(b))}},select:{get:function(b){var _,L,G,Z=b.options,D=b.selectedIndex,ae="select-one"===b.type,ke=ae?null:[],we=ae?D+1:Z.length;for(G=D<0?we:ae?D:0;G<we;G++)if(((L=Z[G]).selected||G===D)&&!L.disabled&&(!L.parentNode.disabled||!Qt(L.parentNode,"optgroup"))){if(_=z(L).val(),ae)return _;ke.push(_)}return ke},set:function(b,_){for(var L,G,Z=b.options,D=z.makeArray(_),ae=Z.length;ae--;)((G=Z[ae]).selected=-1<z.inArray(z.valHooks.option.get(G),D))&&(L=!0);return L||(b.selectedIndex=-1),D}}}}),z.each(["radio","checkbox"],function(){z.valHooks[this]={set:function(b,_){if(Array.isArray(_))return b.checked=-1<z.inArray(z(b).val(),_)}},gt.checkOn||(z.valHooks[this].get=function(b){return null===b.getAttribute("value")?"on":b.value})});var At=Ce.location,St={guid:Date.now()},Gt=/\?/;z.parseXML=function(b){var _,L;if(!b||"string"!=typeof b)return null;try{_=(new Ce.DOMParser).parseFromString(b,"text/xml")}catch{}return L=_&&_.getElementsByTagName("parsererror")[0],_&&!L||z.error("Invalid XML: "+(L?z.map(L.childNodes,function(G){return G.textContent}).join("\n"):b)),_};var Lt=/^(?:focusinfocus|focusoutblur)$/,$t=function(b){b.stopPropagation()};z.extend(z.event,{trigger:function(b,_,L,G){var Z,D,ae,ke,we,Ie,Oe,Ye,Ne=[L||pe],et=cn.call(b,"type")?b.type:b,Ct=cn.call(b,"namespace")?b.namespace.split("."):[];if(D=Ye=ae=L=L||pe,3!==L.nodeType&&8!==L.nodeType&&!Lt.test(et+z.event.triggered)&&(-1<et.indexOf(".")&&(et=(Ct=et.split(".")).shift(),Ct.sort()),we=et.indexOf(":")<0&&"on"+et,(b=b[z.expando]?b:new z.Event(et,"object"==typeof b&&b)).isTrigger=G?2:3,b.namespace=Ct.join("."),b.rnamespace=b.namespace?new RegExp("(^|\\.)"+Ct.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=L),_=null==_?[b]:z.makeArray(_,[b]),Oe=z.event.special[et]||{},G||!Oe.trigger||!1!==Oe.trigger.apply(L,_))){if(!G&&!Oe.noBubble&&!bn(L)){for(Lt.test((ke=Oe.delegateType||et)+et)||(D=D.parentNode);D;D=D.parentNode)Ne.push(D),ae=D;ae===(L.ownerDocument||pe)&&Ne.push(ae.defaultView||ae.parentWindow||Ce)}for(Z=0;(D=Ne[Z++])&&!b.isPropagationStopped();)Ye=D,b.type=1<Z?ke:Oe.bindType||et,(Ie=(Tt.get(D,"events")||Object.create(null))[b.type]&&Tt.get(D,"handle"))&&Ie.apply(D,_),(Ie=we&&D[we])&&Ie.apply&&Ca(D)&&(b.result=Ie.apply(D,_),!1===b.result&&b.preventDefault());return b.type=et,G||b.isDefaultPrevented()||Oe._default&&!1!==Oe._default.apply(Ne.pop(),_)||!Ca(L)||we&&Et(L[et])&&!bn(L)&&((ae=L[we])&&(L[we]=null),z.event.triggered=et,b.isPropagationStopped()&&Ye.addEventListener(et,$t),L[et](),b.isPropagationStopped()&&Ye.removeEventListener(et,$t),z.event.triggered=void 0,ae&&(L[we]=ae)),b.result}},simulate:function(b,_,L){var G=z.extend(new z.Event,L,{type:b,isSimulated:!0});z.event.trigger(G,null,_)}}),z.fn.extend({trigger:function(b,_){return this.each(function(){z.event.trigger(b,_,this)})},triggerHandler:function(b,_){var L=this[0];if(L)return z.event.trigger(b,_,L,!0)}});var zn=/\[\]$/,En=/\r?\n/g,_n=/^(?:submit|button|image|reset|file)$/i,sr=/^(?:input|select|textarea|keygen)/i;function fn(b,_,L,G){var Z;if(Array.isArray(_))z.each(_,function(D,ae){L||zn.test(b)?G(b,ae):fn(b+"["+("object"==typeof ae&&null!=ae?D:"")+"]",ae,L,G)});else if(L||"object"!==Ke(_))G(b,_);else for(Z in _)fn(b+"["+Z+"]",_[Z],L,G)}z.param=function(b,_){var L,G=[],Z=function(D,ae){var ke=Et(ae)?ae():ae;G[G.length]=encodeURIComponent(D)+"="+encodeURIComponent(ke??"")};if(null==b)return"";if(Array.isArray(b)||b.jquery&&!z.isPlainObject(b))z.each(b,function(){Z(this.name,this.value)});else for(L in b)fn(L,b[L],_,Z);return G.join("&")},z.fn.extend({serialize:function(){return z.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var b=z.prop(this,"elements");return b?z.makeArray(b):this}).filter(function(){var b=this.type;return this.name&&!z(this).is(":disabled")&&sr.test(this.nodeName)&&!_n.test(b)&&(this.checked||!Me.test(b))}).map(function(b,_){var L=z(this).val();return null==L?null:Array.isArray(L)?z.map(L,function(G){return{name:_.name,value:G.replace(En,"\r\n")}}):{name:_.name,value:L.replace(En,"\r\n")}}).get()}});var en=/%20/g,kn=/#.*$/,Gn=/([?&])_=[^&]*/,cr=/^(.*?):[ \t]*([^\r\n]*)$/gm,Xr=/^(?:GET|HEAD)$/,Qi=/^\/\//,rr={},kr={},ko="*/".concat("*"),Oa=pe.createElement("a");function Ms(b){return function(_,L){"string"!=typeof _&&(L=_,_="*");var G,Z=0,D=_.toLowerCase().match(Pr)||[];if(Et(L))for(;G=D[Z++];)"+"===G[0]?(G=G.slice(1)||"*",(b[G]=b[G]||[]).unshift(L)):(b[G]=b[G]||[]).push(L)}}function $r(b,_,L,G){var Z={},D=b===kr;function ae(ke){var we;return Z[ke]=!0,z.each(b[ke]||[],function(Ie,Oe){var Ye=Oe(_,L,G);return"string"!=typeof Ye||D||Z[Ye]?D?!(we=Ye):void 0:(_.dataTypes.unshift(Ye),ae(Ye),!1)}),we}return ae(_.dataTypes[0])||!Z["*"]&&ae("*")}function Ba(b,_){var L,G,Z=z.ajaxSettings.flatOptions||{};for(L in _)void 0!==_[L]&&((Z[L]?b:G||(G={}))[L]=_[L]);return G&&z.extend(!0,b,G),b}Oa.href=At.href,z.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:At.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(At.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ko,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":z.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(b,_){return _?Ba(Ba(b,z.ajaxSettings),_):Ba(z.ajaxSettings,b)},ajaxPrefilter:Ms(rr),ajaxTransport:Ms(kr),ajax:function(b,_){"object"==typeof b&&(_=b,b=void 0);var L,G,Z,D,ae,ke,we,Ie,Oe,Ye,Ne=z.ajaxSetup({},_=_||{}),et=Ne.context||Ne,Ct=Ne.context&&(et.nodeType||et.jquery)?z(et):z.event,Xt=z.Deferred(),zt=z.Callbacks("once memory"),ye=Ne.statusCode||{},an={},ir={},gr="canceled",Wt={readyState:0,getResponseHeader:function(nt){var tn;if(we){if(!D)for(D={};tn=cr.exec(Z);)D[tn[1].toLowerCase()+" "]=(D[tn[1].toLowerCase()+" "]||[]).concat(tn[2]);tn=D[nt.toLowerCase()+" "]}return null==tn?null:tn.join(", ")},getAllResponseHeaders:function(){return we?Z:null},setRequestHeader:function(nt,tn){return null==we&&(nt=ir[nt.toLowerCase()]=ir[nt.toLowerCase()]||nt,an[nt]=tn),this},overrideMimeType:function(nt){return null==we&&(Ne.mimeType=nt),this},statusCode:function(nt){var tn;if(nt)if(we)Wt.always(nt[Wt.status]);else for(tn in nt)ye[tn]=[ye[tn],nt[tn]];return this},abort:function(nt){var tn=nt||gr;return L&&L.abort(tn),oi(0,tn),this}};if(Xt.promise(Wt),Ne.url=((b||Ne.url||At.href)+"").replace(Qi,At.protocol+"//"),Ne.type=_.method||_.type||Ne.method||Ne.type,Ne.dataTypes=(Ne.dataType||"*").toLowerCase().match(Pr)||[""],null==Ne.crossDomain){ke=pe.createElement("a");try{ke.href=Ne.url,ke.href=ke.href,Ne.crossDomain=Oa.protocol+"//"+Oa.host!=ke.protocol+"//"+ke.host}catch{Ne.crossDomain=!0}}if(Ne.data&&Ne.processData&&"string"!=typeof Ne.data&&(Ne.data=z.param(Ne.data,Ne.traditional)),$r(rr,Ne,_,Wt),we)return Wt;for(Oe in(Ie=z.event&&Ne.global)&&0==z.active++&&z.event.trigger("ajaxStart"),Ne.type=Ne.type.toUpperCase(),Ne.hasContent=!Xr.test(Ne.type),G=Ne.url.replace(kn,""),Ne.hasContent?Ne.data&&Ne.processData&&0===(Ne.contentType||"").indexOf("application/x-www-form-urlencoded")&&(Ne.data=Ne.data.replace(en,"+")):(Ye=Ne.url.slice(G.length),Ne.data&&(Ne.processData||"string"==typeof Ne.data)&&(G+=(Gt.test(G)?"&":"?")+Ne.data,delete Ne.data),!1===Ne.cache&&(G=G.replace(Gn,"$1"),Ye=(Gt.test(G)?"&":"?")+"_="+St.guid+++Ye),Ne.url=G+Ye),Ne.ifModified&&(z.lastModified[G]&&Wt.setRequestHeader("If-Modified-Since",z.lastModified[G]),z.etag[G]&&Wt.setRequestHeader("If-None-Match",z.etag[G])),(Ne.data&&Ne.hasContent&&!1!==Ne.contentType||_.contentType)&&Wt.setRequestHeader("Content-Type",Ne.contentType),Wt.setRequestHeader("Accept",Ne.dataTypes[0]&&Ne.accepts[Ne.dataTypes[0]]?Ne.accepts[Ne.dataTypes[0]]+("*"!==Ne.dataTypes[0]?", "+ko+"; q=0.01":""):Ne.accepts["*"]),Ne.headers)Wt.setRequestHeader(Oe,Ne.headers[Oe]);if(Ne.beforeSend&&(!1===Ne.beforeSend.call(et,Wt,Ne)||we))return Wt.abort();if(gr="abort",zt.add(Ne.complete),Wt.done(Ne.success),Wt.fail(Ne.error),L=$r(kr,Ne,_,Wt)){if(Wt.readyState=1,Ie&&Ct.trigger("ajaxSend",[Wt,Ne]),we)return Wt;Ne.async&&0<Ne.timeout&&(ae=Ce.setTimeout(function(){Wt.abort("timeout")},Ne.timeout));try{we=!1,L.send(an,oi)}catch(nt){if(we)throw nt;oi(-1,nt)}}else oi(-1,"No Transport");function oi(nt,tn,vi,Wa){var er,ro,Kr,Zr,_i,sn=tn;we||(we=!0,ae&&Ce.clearTimeout(ae),L=void 0,Z=Wa||"",Wt.readyState=0<nt?4:0,er=200<=nt&&nt<300||304===nt,vi&&(Zr=function(Wn,fr,Ar){for(var ea,Vt,vt,ur,hr=Wn.contents,pn=Wn.dataTypes;"*"===pn[0];)pn.shift(),void 0===ea&&(ea=Wn.mimeType||fr.getResponseHeader("Content-Type"));if(ea)for(Vt in hr)if(hr[Vt]&&hr[Vt].test(ea)){pn.unshift(Vt);break}if(pn[0]in Ar)vt=pn[0];else{for(Vt in Ar){if(!pn[0]||Wn.converters[Vt+" "+pn[0]]){vt=Vt;break}ur||(ur=Vt)}vt=vt||ur}if(vt)return vt!==pn[0]&&pn.unshift(vt),Ar[vt]}(Ne,Wt,vi)),!er&&-1<z.inArray("script",Ne.dataTypes)&&z.inArray("json",Ne.dataTypes)<0&&(Ne.converters["text script"]=function(){}),Zr=function(Wn,fr,Ar,ea){var Vt,vt,ur,hr,pn,Ii={},ta=Wn.dataTypes.slice();if(ta[1])for(ur in Wn.converters)Ii[ur.toLowerCase()]=Wn.converters[ur];for(vt=ta.shift();vt;)if(Wn.responseFields[vt]&&(Ar[Wn.responseFields[vt]]=fr),!pn&&ea&&Wn.dataFilter&&(fr=Wn.dataFilter(fr,Wn.dataType)),pn=vt,vt=ta.shift())if("*"===vt)vt=pn;else if("*"!==pn&&pn!==vt){if(!(ur=Ii[pn+" "+vt]||Ii["* "+vt]))for(Vt in Ii)if((hr=Vt.split(" "))[1]===vt&&(ur=Ii[pn+" "+hr[0]]||Ii["* "+hr[0]])){!0===ur?ur=Ii[Vt]:!0!==Ii[Vt]&&(vt=hr[0],ta.unshift(hr[1]));break}if(!0!==ur)if(ur&&Wn.throws)fr=ur(fr);else try{fr=ur(fr)}catch(Hi){return{state:"parsererror",error:ur?Hi:"No conversion from "+pn+" to "+vt}}}return{state:"success",data:fr}}(Ne,Zr,Wt,er),er?(Ne.ifModified&&((_i=Wt.getResponseHeader("Last-Modified"))&&(z.lastModified[G]=_i),(_i=Wt.getResponseHeader("etag"))&&(z.etag[G]=_i)),204===nt||"HEAD"===Ne.type?sn="nocontent":304===nt?sn="notmodified":(sn=Zr.state,ro=Zr.data,er=!(Kr=Zr.error))):(Kr=sn,!nt&&sn||(sn="error",nt<0&&(nt=0))),Wt.status=nt,Wt.statusText=(tn||sn)+"",er?Xt.resolveWith(et,[ro,sn,Wt]):Xt.rejectWith(et,[Wt,sn,Kr]),Wt.statusCode(ye),ye=void 0,Ie&&Ct.trigger(er?"ajaxSuccess":"ajaxError",[Wt,Ne,er?ro:Kr]),zt.fireWith(et,[Wt,sn]),Ie&&(Ct.trigger("ajaxComplete",[Wt,Ne]),--z.active||z.event.trigger("ajaxStop")))}return Wt},getJSON:function(b,_,L){return z.get(b,_,L,"json")},getScript:function(b,_){return z.get(b,void 0,_,"script")}}),z.each(["get","post"],function(b,_){z[_]=function(L,G,Z,D){return Et(G)&&(D=D||Z,Z=G,G=void 0),z.ajax(z.extend({url:L,type:_,dataType:D,data:G,success:Z},z.isPlainObject(L)&&L))}}),z.ajaxPrefilter(function(b){var _;for(_ in b.headers)"content-type"===_.toLowerCase()&&(b.contentType=b.headers[_]||"")}),z._evalUrl=function(b,_,L){return z.ajax({url:b,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(G){z.globalEval(G,_,L)}})},z.fn.extend({wrapAll:function(b){var _;return this[0]&&(Et(b)&&(b=b.call(this[0])),_=z(b,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&_.insertBefore(this[0]),_.map(function(){for(var L=this;L.firstElementChild;)L=L.firstElementChild;return L}).append(this)),this},wrapInner:function(b){return Et(b)?this.each(function(_){z(this).wrapInner(b.call(this,_))}):this.each(function(){var _=z(this),L=_.contents();L.length?L.wrapAll(b):_.append(b)})},wrap:function(b){var _=Et(b);return this.each(function(L){z(this).wrapAll(_?b.call(this,L):b)})},unwrap:function(b){return this.parent(b).not("body").each(function(){z(this).replaceWith(this.childNodes)}),this}}),z.expr.pseudos.hidden=function(b){return!z.expr.pseudos.visible(b)},z.expr.pseudos.visible=function(b){return!!(b.offsetWidth||b.offsetHeight||b.getClientRects().length)},z.ajaxSettings.xhr=function(){try{return new Ce.XMLHttpRequest}catch{}};var rs={0:200,1223:204},Sa=z.ajaxSettings.xhr();gt.cors=!!Sa&&"withCredentials"in Sa,gt.ajax=Sa=!!Sa,z.ajaxTransport(function(b){var _,L;if(gt.cors||Sa&&!b.crossDomain)return{send:function(G,Z){var D,ae=b.xhr();if(ae.open(b.type,b.url,b.async,b.username,b.password),b.xhrFields)for(D in b.xhrFields)ae[D]=b.xhrFields[D];for(D in b.mimeType&&ae.overrideMimeType&&ae.overrideMimeType(b.mimeType),b.crossDomain||G["X-Requested-With"]||(G["X-Requested-With"]="XMLHttpRequest"),G)ae.setRequestHeader(D,G[D]);_=function(ke){return function(){_&&(_=L=ae.onload=ae.onerror=ae.onabort=ae.ontimeout=ae.onreadystatechange=null,"abort"===ke?ae.abort():"error"===ke?"number"!=typeof ae.status?Z(0,"error"):Z(ae.status,ae.statusText):Z(rs[ae.status]||ae.status,ae.statusText,"text"!==(ae.responseType||"text")||"string"!=typeof ae.responseText?{binary:ae.response}:{text:ae.responseText},ae.getAllResponseHeaders()))}},ae.onload=_(),L=ae.onerror=ae.ontimeout=_("error"),void 0!==ae.onabort?ae.onabort=L:ae.onreadystatechange=function(){4===ae.readyState&&Ce.setTimeout(function(){_&&L()})},_=_("abort");try{ae.send(b.hasContent&&b.data||null)}catch(ke){if(_)throw ke}},abort:function(){_&&_()}}}),z.ajaxPrefilter(function(b){b.crossDomain&&(b.contents.script=!1)}),z.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(b){return z.globalEval(b),b}}}),z.ajaxPrefilter("script",function(b){void 0===b.cache&&(b.cache=!1),b.crossDomain&&(b.type="GET")}),z.ajaxTransport("script",function(b){var _,L;if(b.crossDomain||b.scriptAttrs)return{send:function(G,Z){_=z("<script>").attr(b.scriptAttrs||{}).prop({charset:b.scriptCharset,src:b.url}).on("load error",L=function(D){_.remove(),L=null,D&&Z("error"===D.type?404:200,D.type)}),pe.head.appendChild(_[0])},abort:function(){L&&L()}}});var Ao,za=[],So=/(=)\?(?=&|$)|\?\?/;z.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var b=za.pop()||z.expando+"_"+St.guid++;return this[b]=!0,b}}),z.ajaxPrefilter("json jsonp",function(b,_,L){var G,Z,D,ae=!1!==b.jsonp&&(So.test(b.url)?"url":"string"==typeof b.data&&0===(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&So.test(b.data)&&"data");if(ae||"jsonp"===b.dataTypes[0])return G=b.jsonpCallback=Et(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,ae?b[ae]=b[ae].replace(So,"$1"+G):!1!==b.jsonp&&(b.url+=(Gt.test(b.url)?"&":"?")+b.jsonp+"="+G),b.converters["script json"]=function(){return D||z.error(G+" was not called"),D[0]},b.dataTypes[0]="json",Z=Ce[G],Ce[G]=function(){D=arguments},L.always(function(){void 0===Z?z(Ce).removeProp(G):Ce[G]=Z,b[G]&&(b.jsonpCallback=_.jsonpCallback,za.push(G)),D&&Et(Z)&&Z(D[0]),D=Z=void 0}),"script"}),gt.createHTMLDocument=((Ao=pe.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Ao.childNodes.length),z.parseHTML=function(b,_,L){return"string"!=typeof b?[]:("boolean"==typeof _&&(L=_,_=!1),_||(gt.createHTMLDocument?((G=(_=pe.implementation.createHTMLDocument("")).createElement("base")).href=pe.location.href,_.head.appendChild(G)):_=pe),D=!L&&[],(Z=Fr.exec(b))?[_.createElement(Z[1])]:(Z=Fi([b],_,D),D&&D.length&&z(D).remove(),z.merge([],Z.childNodes)));var G,Z,D},z.fn.load=function(b,_,L){var G,Z,D,ae=this,ke=b.indexOf(" ");return-1<ke&&(G=Pe(b.slice(ke)),b=b.slice(0,ke)),Et(_)?(L=_,_=void 0):_&&"object"==typeof _&&(Z="POST"),0<ae.length&&z.ajax({url:b,type:Z||"GET",dataType:"html",data:_}).done(function(we){D=arguments,ae.html(G?z("<div>").append(z.parseHTML(we)).find(G):we)}).always(L&&function(we,Ie){ae.each(function(){L.apply(this,D||[we.responseText,Ie,we])})}),this},z.expr.pseudos.animated=function(b){return z.grep(z.timers,function(_){return b===_.elem}).length},z.offset={setOffset:function(b,_,L){var G,Z,D,ae,ke,we,Ie=z.css(b,"position"),Oe=z(b),Ye={};"static"===Ie&&(b.style.position="relative"),ke=Oe.offset(),D=z.css(b,"top"),we=z.css(b,"left"),("absolute"===Ie||"fixed"===Ie)&&-1<(D+we).indexOf("auto")?(ae=(G=Oe.position()).top,Z=G.left):(ae=parseFloat(D)||0,Z=parseFloat(we)||0),Et(_)&&(_=_.call(b,L,z.extend({},ke))),null!=_.top&&(Ye.top=_.top-ke.top+ae),null!=_.left&&(Ye.left=_.left-ke.left+Z),"using"in _?_.using.call(b,Ye):Oe.css(Ye)}},z.fn.extend({offset:function(b){if(arguments.length)return void 0===b?this:this.each(function(Z){z.offset.setOffset(this,b,Z)});var _,L,G=this[0];return G?G.getClientRects().length?{top:(_=G.getBoundingClientRect()).top+(L=G.ownerDocument.defaultView).pageYOffset,left:_.left+L.pageXOffset}:{top:0,left:0}:void 0},position:function(){if(this[0]){var b,_,L,G=this[0],Z={top:0,left:0};if("fixed"===z.css(G,"position"))_=G.getBoundingClientRect();else{for(_=this.offset(),L=G.ownerDocument,b=G.offsetParent||L.documentElement;b&&(b===L.body||b===L.documentElement)&&"static"===z.css(b,"position");)b=b.parentNode;b&&b!==G&&1===b.nodeType&&((Z=z(b).offset()).top+=z.css(b,"borderTopWidth",!0),Z.left+=z.css(b,"borderLeftWidth",!0))}return{top:_.top-Z.top-z.css(G,"marginTop",!0),left:_.left-Z.left-z.css(G,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var b=this.offsetParent;b&&"static"===z.css(b,"position");)b=b.offsetParent;return b||Ur})}}),z.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,_){var L="pageYOffset"===_;z.fn[b]=function(G){return fi(this,function(Z,D,ae){var ke;if(bn(Z)?ke=Z:9===Z.nodeType&&(ke=Z.defaultView),void 0===ae)return ke?ke[_]:Z[D];ke?ke.scrollTo(L?ke.pageXOffset:ae,L?ae:ke.pageYOffset):Z[D]=ae},b,G,arguments.length)}}),z.each(["top","left"],function(b,_){z.cssHooks[_]=i(gt.pixelPosition,function(L,G){if(G)return G=r(L,_),Cr.test(G)?z(L).position()[_]+"px":G})}),z.each({Height:"height",Width:"width"},function(b,_){z.each({padding:"inner"+b,content:_,"":"outer"+b},function(L,G){z.fn[G]=function(Z,D){var ae=arguments.length&&(L||"boolean"!=typeof Z),ke=L||(!0===Z||!0===D?"margin":"border");return fi(this,function(we,Ie,Oe){var Ye;return bn(we)?0===G.indexOf("outer")?we["inner"+b]:we.document.documentElement["client"+b]:9===we.nodeType?(Ye=we.documentElement,Math.max(we.body["scroll"+b],Ye["scroll"+b],we.body["offset"+b],Ye["offset"+b],Ye["client"+b])):void 0===Oe?z.css(we,Ie,ke):z.style(we,Ie,Oe,ke)},_,ae?Z:void 0,ae)}})}),z.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(b,_){z.fn[_]=function(L){return this.on(_,L)}}),z.fn.extend({bind:function(b,_,L){return this.on(b,null,_,L)},unbind:function(b,_){return this.off(b,null,_)},delegate:function(b,_,L,G){return this.on(_,b,L,G)},undelegate:function(b,_,L){return 1===arguments.length?this.off(b,"**"):this.off(_,b||"**",L)},hover:function(b,_){return this.on("mouseenter",b).on("mouseleave",_||b)}}),z.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(b,_){z.fn[_]=function(L,G){return 0<arguments.length?this.on(_,null,L,G):this.trigger(_)}});var Yt=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;z.proxy=function(b,_){var L,G,Z;if("string"==typeof _&&(L=b[_],_=b,b=L),Et(b))return G=de.call(arguments,2),(Z=function(){return b.apply(_||this,G.concat(de.call(arguments)))}).guid=b.guid=b.guid||z.guid++,Z},z.holdReady=function(b){b?z.readyWait++:z.ready(!0)},z.isArray=Array.isArray,z.parseJSON=JSON.parse,z.nodeName=Qt,z.isFunction=Et,z.isWindow=bn,z.camelCase=ii,z.type=Ke,z.now=Date.now,z.isNumeric=function(b){var _=z.type(b);return("number"===_||"string"===_)&&!isNaN(b-parseFloat(b))},z.trim=function(b){return null==b?"":(b+"").replace(Yt,"$1")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return z});var is=Ce.jQuery,ht=Ce.$;return z.noConflict=function(b){return Ce.$===z&&(Ce.$=ht),b&&Ce.jQuery===z&&(Ce.jQuery=is),z},typeof Ze>"u"&&(Ce.jQuery=Ce.$=z),z});var pJS=function(Ce,Ze){var ut=document.querySelector("#"+Ce+" > .particles-js-canvas-el");this.pJS={canvas:{el:ut,w:ut.offsetWidth,h:ut.offsetHeight},particles:{number:{value:400,density:{enable:!0,value_area:800}},color:{value:"#fff"},shape:{type:"circle",stroke:{width:0,color:"#ff0000"},polygon:{nb_sides:5},image:{src:"",width:100,height:100}},opacity:{value:1,random:!1,anim:{enable:!1,speed:2,opacity_min:0,sync:!1}},size:{value:20,random:!1,anim:{enable:!1,speed:20,size_min:0,sync:!1}},line_linked:{enable:!0,distance:100,color:"#fff",opacity:1,width:1},move:{enable:!0,speed:2,direction:"none",random:!1,straight:!1,out_mode:"out",bounce:!1,attract:{enable:!1,rotateX:3e3,rotateY:3e3}},array:[]},interactivity:{detect_on:"canvas",events:{onhover:{enable:!0,mode:"grab"},onclick:{enable:!0,mode:"push"},resize:!0},modes:{grab:{distance:100,line_linked:{opacity:1}},bubble:{distance:200,size:80,duration:.4},repulse:{distance:200,duration:.4},push:{particles_nb:4},remove:{particles_nb:2}},mouse:{}},retina_detect:!1,fn:{interact:{},modes:{},vendors:{}},tmp:{}};var F=this.pJS;Ze&&Object.deepExtend(F,Ze),F.tmp.obj={size_value:F.particles.size.value,size_anim_speed:F.particles.size.anim.speed,move_speed:F.particles.move.speed,line_linked_distance:F.particles.line_linked.distance,line_linked_width:F.particles.line_linked.width,mode_grab_distance:F.interactivity.modes.grab.distance,mode_bubble_distance:F.interactivity.modes.bubble.distance,mode_bubble_size:F.interactivity.modes.bubble.size,mode_repulse_distance:F.interactivity.modes.repulse.distance},F.fn.retinaInit=function(){F.retina_detect&&window.devicePixelRatio>1?(F.canvas.pxratio=window.devicePixelRatio,F.tmp.retina=!0):(F.canvas.pxratio=1,F.tmp.retina=!1),F.canvas.w=F.canvas.el.offsetWidth*F.canvas.pxratio,F.canvas.h=F.canvas.el.offsetHeight*F.canvas.pxratio,F.particles.size.value=F.tmp.obj.size_value*F.canvas.pxratio,F.particles.size.anim.speed=F.tmp.obj.size_anim_speed*F.canvas.pxratio,F.particles.move.speed=F.tmp.obj.move_speed*F.canvas.pxratio,F.particles.line_linked.distance=F.tmp.obj.line_linked_distance*F.canvas.pxratio,F.interactivity.modes.grab.distance=F.tmp.obj.mode_grab_distance*F.canvas.pxratio,F.interactivity.modes.bubble.distance=F.tmp.obj.mode_bubble_distance*F.canvas.pxratio,F.particles.line_linked.width=F.tmp.obj.line_linked_width*F.canvas.pxratio,F.interactivity.modes.bubble.size=F.tmp.obj.mode_bubble_size*F.canvas.pxratio,F.interactivity.modes.repulse.distance=F.tmp.obj.mode_repulse_distance*F.canvas.pxratio},F.fn.canvasInit=function(){F.canvas.ctx=F.canvas.el.getContext("2d")},F.fn.canvasSize=function(){F.canvas.el.width=F.canvas.w,F.canvas.el.height=F.canvas.h,F&&F.interactivity.events.resize&&window.addEventListener("resize",function(){F.canvas.w=F.canvas.el.offsetWidth,F.canvas.h=F.canvas.el.offsetHeight,F.tmp.retina&&(F.canvas.w*=F.canvas.pxratio,F.canvas.h*=F.canvas.pxratio),F.canvas.el.width=F.canvas.w,F.canvas.el.height=F.canvas.h,F.particles.move.enable||(F.fn.particlesEmpty(),F.fn.particlesCreate(),F.fn.particlesDraw(),F.fn.vendors.densityAutoParticles()),F.fn.vendors.densityAutoParticles()})},F.fn.canvasPaint=function(){F.canvas.ctx.fillRect(0,0,F.canvas.w,F.canvas.h)},F.fn.canvasClear=function(){F.canvas.ctx.clearRect(0,0,F.canvas.w,F.canvas.h)},F.fn.particle=function(de,me,st){if(this.radius=(F.particles.size.random?Math.random():1)*F.particles.size.value,F.particles.size.anim.enable&&(this.size_status=!1,this.vs=F.particles.size.anim.speed/100,F.particles.size.anim.sync||(this.vs=this.vs*Math.random())),this.x=st?st.x:Math.random()*F.canvas.w,this.y=st?st.y:Math.random()*F.canvas.h,this.x>F.canvas.w-2*this.radius?this.x=this.x-this.radius:this.x<2*this.radius&&(this.x=this.x+this.radius),this.y>F.canvas.h-2*this.radius?this.y=this.y-this.radius:this.y<2*this.radius&&(this.y=this.y+this.radius),F.particles.move.bounce&&F.fn.vendors.checkOverlap(this,st),this.color={},"object"==typeof de.value)if(de.value instanceof Array){var _e=de.value[Math.floor(Math.random()*F.particles.color.value.length)];this.color.rgb=hexToRgb(_e)}else null!=de.value.r&&null!=de.value.g&&null!=de.value.b&&(this.color.rgb={r:de.value.r,g:de.value.g,b:de.value.b}),null!=de.value.h&&null!=de.value.s&&null!=de.value.l&&(this.color.hsl={h:de.value.h,s:de.value.s,l:de.value.l});else"random"==de.value?this.color.rgb={r:Math.floor(256*Math.random())+0,g:Math.floor(256*Math.random())+0,b:Math.floor(256*Math.random())+0}:"string"==typeof de.value&&(this.color=de,this.color.rgb=hexToRgb(this.color.value));this.opacity=(F.particles.opacity.random?Math.random():1)*F.particles.opacity.value,F.particles.opacity.anim.enable&&(this.opacity_status=!1,this.vo=F.particles.opacity.anim.speed/100,F.particles.opacity.anim.sync||(this.vo=this.vo*Math.random()));var kt={};switch(F.particles.move.direction){case"top":kt={x:0,y:-1};break;case"top-right":kt={x:.5,y:-.5};break;case"right":kt={x:1,y:-0};break;case"bottom-right":kt={x:.5,y:.5};break;case"bottom":kt={x:0,y:1};break;case"bottom-left":kt={x:-.5,y:1};break;case"left":kt={x:-1,y:0};break;case"top-left":kt={x:-.5,y:-.5};break;default:kt={x:0,y:0}}F.particles.move.straight?(this.vx=kt.x,this.vy=kt.y,F.particles.move.random&&(this.vx=this.vx*Math.random(),this.vy=this.vy*Math.random())):(this.vx=kt.x+Math.random()-.5,this.vy=kt.y+Math.random()-.5),this.vx_i=this.vx,this.vy_i=this.vy;var Ft=F.particles.shape.type;if("object"==typeof Ft){if(Ft instanceof Array){var cn=Ft[Math.floor(Math.random()*Ft.length)];this.shape=cn}}else this.shape=Ft;if("image"==this.shape){var dn=F.particles.shape;this.img={src:dn.image.src,ratio:dn.image.width/dn.image.height},this.img.ratio||(this.img.ratio=1),"svg"==F.tmp.img_type&&null!=F.tmp.source_svg&&(F.fn.vendors.createSvgImg(this),F.tmp.pushing&&(this.img.loaded=!1))}},F.fn.particle.prototype.draw=function(){var de=this;if(null!=de.radius_bubble)var me=de.radius_bubble;else me=de.radius;if(null!=de.opacity_bubble)var st=de.opacity_bubble;else st=de.opacity;if(de.color.rgb)var _e="rgba("+de.color.rgb.r+","+de.color.rgb.g+","+de.color.rgb.b+","+st+")";else _e="hsla("+de.color.hsl.h+","+de.color.hsl.s+"%,"+de.color.hsl.l+"%,"+st+")";switch(F.canvas.ctx.fillStyle=_e,F.canvas.ctx.beginPath(),de.shape){case"circle":F.canvas.ctx.arc(de.x,de.y,me,0,2*Math.PI,!1);break;case"edge":F.canvas.ctx.rect(de.x-me,de.y-me,2*me,2*me);break;case"triangle":F.fn.vendors.drawShape(F.canvas.ctx,de.x-me,de.y+me/1.66,2*me,3,2);break;case"polygon":F.fn.vendors.drawShape(F.canvas.ctx,de.x-me/(F.particles.shape.polygon.nb_sides/3.5),de.y-me/.76,2.66*me/(F.particles.shape.polygon.nb_sides/3),F.particles.shape.polygon.nb_sides,1);break;case"star":F.fn.vendors.drawShape(F.canvas.ctx,de.x-2*me/(F.particles.shape.polygon.nb_sides/4),de.y-me/1.52,2*me*2.66/(F.particles.shape.polygon.nb_sides/3),F.particles.shape.polygon.nb_sides,2);break;case"image":let cn=function(){F.canvas.ctx.drawImage(kt,de.x-me,de.y-me,2*me,2*me/de.img.ratio)};if("svg"==F.tmp.img_type)var kt=de.img.obj;else kt=F.tmp.img_obj;kt&&cn()}F.canvas.ctx.closePath(),F.particles.shape.stroke.width>0&&(F.canvas.ctx.strokeStyle=F.particles.shape.stroke.color,F.canvas.ctx.lineWidth=F.particles.shape.stroke.width,F.canvas.ctx.stroke()),F.canvas.ctx.fill()},F.fn.particlesCreate=function(){for(var de=0;de<F.particles.number.value;de++)F.particles.array.push(new F.fn.particle(F.particles.color,F.particles.opacity.value))},F.fn.particlesUpdate=function(){for(var de=0;de<F.particles.array.length;de++){var me=F.particles.array[de];if(F.particles.move.enable){var st=F.particles.move.speed/2;me.x+=me.vx*st,me.y+=me.vy*st}if(F.particles.opacity.anim.enable&&(1==me.opacity_status?(me.opacity>=F.particles.opacity.value&&(me.opacity_status=!1),me.opacity+=me.vo):(me.opacity<=F.particles.opacity.anim.opacity_min&&(me.opacity_status=!0),me.opacity-=me.vo),me.opacity<0&&(me.opacity=0)),F.particles.size.anim.enable&&(1==me.size_status?(me.radius>=F.particles.size.value&&(me.size_status=!1),me.radius+=me.vs):(me.radius<=F.particles.size.anim.size_min&&(me.size_status=!0),me.radius-=me.vs),me.radius<0&&(me.radius=0)),"bounce"==F.particles.move.out_mode)var _e={x_left:me.radius,x_right:F.canvas.w,y_top:me.radius,y_bottom:F.canvas.h};else _e={x_left:-me.radius,x_right:F.canvas.w+me.radius,y_top:-me.radius,y_bottom:F.canvas.h+me.radius};if("bounce"===(me.x-me.radius>F.canvas.w?(me.x=_e.x_left,me.y=Math.random()*F.canvas.h):me.x+me.radius<0&&(me.x=_e.x_right,me.y=Math.random()*F.canvas.h),me.y-me.radius>F.canvas.h?(me.y=_e.y_top,me.x=Math.random()*F.canvas.w):me.y+me.radius<0&&(me.y=_e.y_bottom,me.x=Math.random()*F.canvas.w),F.particles.move.out_mode)&&((me.x+me.radius>F.canvas.w||me.x-me.radius<0)&&(me.vx=-me.vx),(me.y+me.radius>F.canvas.h||me.y-me.radius<0)&&(me.vy=-me.vy)),isInArray("grab",F.interactivity.events.onhover.mode)&&F.fn.modes.grabParticle(me),(isInArray("bubble",F.interactivity.events.onhover.mode)||isInArray("bubble",F.interactivity.events.onclick.mode))&&F.fn.modes.bubbleParticle(me),(isInArray("repulse",F.interactivity.events.onhover.mode)||isInArray("repulse",F.interactivity.events.onclick.mode))&&F.fn.modes.repulseParticle(me),F.particles.line_linked.enable||F.particles.move.attract.enable)for(var kt=de+1;kt<F.particles.array.length;kt++){var Ft=F.particles.array[kt];F.particles.line_linked.enable&&F.fn.interact.linkParticles(me,Ft),F.particles.move.attract.enable&&F.fn.interact.attractParticles(me,Ft),F.particles.move.bounce&&F.fn.interact.bounceParticles(me,Ft)}}},F.fn.particlesDraw=function(){F.canvas.ctx.clearRect(0,0,F.canvas.w,F.canvas.h),F.fn.particlesUpdate();for(var de=0;de<F.particles.array.length;de++)F.particles.array[de].draw()},F.fn.particlesEmpty=function(){F.particles.array=[]},F.fn.particlesRefresh=function(){cancelRequestAnimFrame(F.fn.checkAnimFrame),cancelRequestAnimFrame(F.fn.drawAnimFrame),F.tmp.source_svg=void 0,F.tmp.img_obj=void 0,F.tmp.count_svg=0,F.fn.particlesEmpty(),F.fn.canvasClear(),F.fn.vendors.start()},F.fn.interact.linkParticles=function(de,me){var st=de.x-me.x,_e=de.y-me.y,kt=Math.sqrt(st*st+_e*_e);if(kt<=F.particles.line_linked.distance){var Ft=F.particles.line_linked.opacity-kt/(1/F.particles.line_linked.opacity)/F.particles.line_linked.distance;if(Ft>0){var cn=F.particles.line_linked.color_rgb_line;F.canvas.ctx.strokeStyle="rgba("+cn.r+","+cn.g+","+cn.b+","+Ft+")",F.canvas.ctx.lineWidth=F.particles.line_linked.width,F.canvas.ctx.beginPath(),F.canvas.ctx.moveTo(de.x,de.y),F.canvas.ctx.lineTo(me.x,me.y),F.canvas.ctx.stroke(),F.canvas.ctx.closePath()}}},F.fn.interact.attractParticles=function(de,me){var st=de.x-me.x,_e=de.y-me.y;if(Math.sqrt(st*st+_e*_e)<=F.particles.line_linked.distance){var Ft=st/(1e3*F.particles.move.attract.rotateX),cn=_e/(1e3*F.particles.move.attract.rotateY);de.vx-=Ft,de.vy-=cn,me.vx+=Ft,me.vy+=cn}},F.fn.interact.bounceParticles=function(de,me){var st=de.x-me.x,_e=de.y-me.y;Math.sqrt(st*st+_e*_e)<=de.radius+me.radius&&(de.vx=-de.vx,de.vy=-de.vy,me.vx=-me.vx,me.vy=-me.vy)},F.fn.modes.pushParticles=function(de,me){F.tmp.pushing=!0;for(var st=0;st<de;st++)F.particles.array.push(new F.fn.particle(F.particles.color,F.particles.opacity.value,{x:me?me.pos_x:Math.random()*F.canvas.w,y:me?me.pos_y:Math.random()*F.canvas.h})),st==de-1&&(F.particles.move.enable||F.fn.particlesDraw(),F.tmp.pushing=!1)},F.fn.modes.removeParticles=function(de){F.particles.array.splice(0,de),F.particles.move.enable||F.fn.particlesDraw()},F.fn.modes.bubbleParticle=function(de){if(F.interactivity.events.onhover.enable&&isInArray("bubble",F.interactivity.events.onhover.mode)){let bn=function(){de.opacity_bubble=de.opacity,de.radius_bubble=de.radius};var me=de.x-F.interactivity.mouse.pos_x,st=de.y-F.interactivity.mouse.pos_y,kt=1-(_e=Math.sqrt(me*me+st*st))/F.interactivity.modes.bubble.distance;if(_e<=F.interactivity.modes.bubble.distance){if(kt>=0&&"mousemove"==F.interactivity.status){if(F.interactivity.modes.bubble.size!=F.particles.size.value)if(F.interactivity.modes.bubble.size>F.particles.size.value)(Ft=de.radius+F.interactivity.modes.bubble.size*kt)>=0&&(de.radius_bubble=Ft);else{var Ft;de.radius_bubble=(Ft=de.radius-(de.radius-F.interactivity.modes.bubble.size)*kt)>0?Ft:0}if(F.interactivity.modes.bubble.opacity!=F.particles.opacity.value)if(F.interactivity.modes.bubble.opacity>F.particles.opacity.value)(dn=F.interactivity.modes.bubble.opacity*kt)>de.opacity&&dn<=F.interactivity.modes.bubble.opacity&&(de.opacity_bubble=dn);else{var dn;(dn=de.opacity-(F.particles.opacity.value-F.interactivity.modes.bubble.opacity)*kt)<de.opacity&&dn>=F.interactivity.modes.bubble.opacity&&(de.opacity_bubble=dn)}}}else bn();"mouseleave"==F.interactivity.status&&bn()}else if(F.interactivity.events.onclick.enable&&isInArray("bubble",F.interactivity.events.onclick.mode)){let bn=function(pe,hi,On,Ke,yn){if(pe!=hi)if(F.tmp.bubble_duration_end)null!=On&&(z=pe+(pe-(Ke-ar*(Ke-pe)/F.interactivity.modes.bubble.duration)),"size"==yn&&(de.radius_bubble=z),"opacity"==yn&&(de.opacity_bubble=z));else if(_e<=F.interactivity.modes.bubble.distance){if(null!=On)var ue=On;else ue=Ke;if(ue!=pe){var z=Ke-ar*(Ke-pe)/F.interactivity.modes.bubble.duration;"size"==yn&&(de.radius_bubble=z),"opacity"==yn&&(de.opacity_bubble=z)}}else"size"==yn&&(de.radius_bubble=void 0),"opacity"==yn&&(de.opacity_bubble=void 0)};if(F.tmp.bubble_clicking){me=de.x-F.interactivity.mouse.click_pos_x,st=de.y-F.interactivity.mouse.click_pos_y;var _e=Math.sqrt(me*me+st*st),ar=((new Date).getTime()-F.interactivity.mouse.click_time)/1e3;ar>F.interactivity.modes.bubble.duration&&(F.tmp.bubble_duration_end=!0),ar>2*F.interactivity.modes.bubble.duration&&(F.tmp.bubble_clicking=!1,F.tmp.bubble_duration_end=!1)}F.tmp.bubble_clicking&&(bn(F.interactivity.modes.bubble.size,F.particles.size.value,de.radius_bubble,de.radius,"size"),bn(F.interactivity.modes.bubble.opacity,F.particles.opacity.value,de.opacity_bubble,de.opacity,"opacity"))}},F.fn.modes.repulseParticle=function(de){if(F.interactivity.events.onhover.enable&&isInArray("repulse",F.interactivity.events.onhover.mode)&&"mousemove"==F.interactivity.status){var me=de.x-F.interactivity.mouse.pos_x,st=de.y-F.interactivity.mouse.pos_y,_e=Math.sqrt(me*me+st*st),kt={x:me/_e,y:st/_e},dn=clamp(1/(Ft=F.interactivity.modes.repulse.distance)*(-1*Math.pow(_e/Ft,2)+1)*Ft*100,0,50),ar={x:de.x+kt.x*dn,y:de.y+kt.y*dn};"bounce"==F.particles.move.out_mode?(ar.x-de.radius>0&&ar.x+de.radius<F.canvas.w&&(de.x=ar.x),ar.y-de.radius>0&&ar.y+de.radius<F.canvas.h&&(de.y=ar.y)):(de.x=ar.x,de.y=ar.y)}else if(F.interactivity.events.onclick.enable&&isInArray("repulse",F.interactivity.events.onclick.mode))if(F.tmp.repulse_finish||(F.tmp.repulse_count++,F.tmp.repulse_count==F.particles.array.length&&(F.tmp.repulse_finish=!0)),F.tmp.repulse_clicking){let Ke=function(){var yn=Math.atan2(Et,gt);if(de.vx=pe*Math.cos(yn),de.vy=pe*Math.sin(yn),"bounce"==F.particles.move.out_mode){var ue={x:de.x+de.vx,y:de.y+de.vy};(ue.x+de.radius>F.canvas.w||ue.x-de.radius<0)&&(de.vx=-de.vx),(ue.y+de.radius>F.canvas.h||ue.y-de.radius<0)&&(de.vy=-de.vy)}};var Ft=Math.pow(F.interactivity.modes.repulse.distance/6,3),gt=F.interactivity.mouse.click_pos_x-de.x,Et=F.interactivity.mouse.click_pos_y-de.y,bn=gt*gt+Et*Et,pe=-Ft/bn*1;bn<=Ft&&Ke()}else 0==F.tmp.repulse_clicking&&(de.vx=de.vx_i,de.vy=de.vy_i)},F.fn.modes.grabParticle=function(de){if(F.interactivity.events.onhover.enable&&"mousemove"==F.interactivity.status){var me=de.x-F.interactivity.mouse.pos_x,st=de.y-F.interactivity.mouse.pos_y,_e=Math.sqrt(me*me+st*st);if(_e<=F.interactivity.modes.grab.distance){var kt=F.interactivity.modes.grab.line_linked.opacity-_e/(1/F.interactivity.modes.grab.line_linked.opacity)/F.interactivity.modes.grab.distance;if(kt>0){var Ft=F.particles.line_linked.color_rgb_line;F.canvas.ctx.strokeStyle="rgba("+Ft.r+","+Ft.g+","+Ft.b+","+kt+")",F.canvas.ctx.lineWidth=F.particles.line_linked.width,F.canvas.ctx.beginPath(),F.canvas.ctx.moveTo(de.x,de.y),F.canvas.ctx.lineTo(F.interactivity.mouse.pos_x,F.interactivity.mouse.pos_y),F.canvas.ctx.stroke(),F.canvas.ctx.closePath()}}}},F.fn.vendors.eventsListeners=function(){F.interactivity.el="window"==F.interactivity.detect_on?window:F.canvas.el,(F.interactivity.events.onhover.enable||F.interactivity.events.onclick.enable)&&(F.interactivity.el.addEventListener("mousemove",function(de){if(F.interactivity.el==window)var me=de.clientX,st=de.clientY;else me=de.offsetX||de.clientX,st=de.offsetY||de.clientY;F.interactivity.mouse.pos_x=me,F.interactivity.mouse.pos_y=st,F.tmp.retina&&(F.interactivity.mouse.pos_x*=F.canvas.pxratio,F.interactivity.mouse.pos_y*=F.canvas.pxratio),F.interactivity.status="mousemove"}),F.interactivity.el.addEventListener("mouseleave",function(de){F.interactivity.mouse.pos_x=null,F.interactivity.mouse.pos_y=null,F.interactivity.status="mouseleave"})),F.interactivity.events.onclick.enable&&F.interactivity.el.addEventListener("click",function(){if(F.interactivity.mouse.click_pos_x=F.interactivity.mouse.pos_x,F.interactivity.mouse.click_pos_y=F.interactivity.mouse.pos_y,F.interactivity.mouse.click_time=(new Date).getTime(),F.interactivity.events.onclick.enable)switch(F.interactivity.events.onclick.mode){case"push":F.particles.move.enable||1==F.interactivity.modes.push.particles_nb?F.fn.modes.pushParticles(F.interactivity.modes.push.particles_nb,F.interactivity.mouse):F.interactivity.modes.push.particles_nb>1&&F.fn.modes.pushParticles(F.interactivity.modes.push.particles_nb);break;case"remove":F.fn.modes.removeParticles(F.interactivity.modes.remove.particles_nb);break;case"bubble":F.tmp.bubble_clicking=!0;break;case"repulse":F.tmp.repulse_clicking=!0,F.tmp.repulse_count=0,F.tmp.repulse_finish=!1,setTimeout(function(){F.tmp.repulse_clicking=!1},1e3*F.interactivity.modes.repulse.duration)}})},F.fn.vendors.densityAutoParticles=function(){if(F.particles.number.density.enable){var de=F.canvas.el.width*F.canvas.el.height/1e3;F.tmp.retina&&(de/=2*F.canvas.pxratio);var st=F.particles.array.length-de*F.particles.number.value/F.particles.number.density.value_area;st<0?F.fn.modes.pushParticles(Math.abs(st)):F.fn.modes.removeParticles(st)}},F.fn.vendors.checkOverlap=function(de,me){for(var st=0;st<F.particles.array.length;st++){var _e=F.particles.array[st],kt=de.x-_e.x,Ft=de.y-_e.y;Math.sqrt(kt*kt+Ft*Ft)<=de.radius+_e.radius&&(de.x=me?me.x:Math.random()*F.canvas.w,de.y=me?me.y:Math.random()*F.canvas.h,F.fn.vendors.checkOverlap(de))}},F.fn.vendors.createSvgImg=function(de){var _e=F.tmp.source_svg.replace(/#([0-9A-F]{3,6})/gi,function(ar,gt,Et,bn){if(de.color.rgb)var pe="rgba("+de.color.rgb.r+","+de.color.rgb.g+","+de.color.rgb.b+","+de.opacity+")";else pe="hsla("+de.color.hsl.h+","+de.color.hsl.s+"%,"+de.color.hsl.l+"%,"+de.opacity+")";return pe}),kt=new Blob([_e],{type:"image/svg+xml;charset=utf-8"}),Ft=window.URL||window.webkitURL||window,cn=Ft.createObjectURL(kt),dn=new Image;dn.addEventListener("load",function(){de.img.obj=dn,de.img.loaded=!0,Ft.revokeObjectURL(cn),F.tmp.count_svg++}),dn.src=cn},F.fn.vendors.destroypJS=function(){cancelAnimationFrame(F.fn.drawAnimFrame),ut.remove(),pJSDom=null},F.fn.vendors.drawShape=function(de,me,st,_e,kt,Ft){var cn=kt*Ft,dn=kt/Ft,gt=Math.PI-Math.PI*(180*(dn-2)/dn)/180;de.save(),de.beginPath(),de.translate(me,st),de.moveTo(0,0);for(var Et=0;Et<cn;Et++)de.lineTo(_e,0),de.translate(_e,0),de.rotate(gt);de.fill(),de.restore()},F.fn.vendors.exportImg=function(){window.open(F.canvas.el.toDataURL("image/png"),"_blank")},F.fn.vendors.loadImg=function(de){if(F.tmp.img_error=void 0,""!=F.particles.shape.image.src)if("svg"==de){var me=new XMLHttpRequest;me.open("GET",F.particles.shape.image.src),me.onreadystatechange=function(_e){4==me.readyState&&(200==me.status?(F.tmp.source_svg=_e.currentTarget.response,F.fn.vendors.checkBeforeDraw()):(console.log("Error pJS - Image not found"),F.tmp.img_error=!0))},me.send()}else{var st=new Image;st.addEventListener("load",function(){F.tmp.img_obj=st,F.fn.vendors.checkBeforeDraw()}),st.src=F.particles.shape.image.src}else console.log("Error pJS - No image.src"),F.tmp.img_error=!0},F.fn.vendors.draw=function(){"image"==F.particles.shape.type?"svg"==F.tmp.img_type?F.tmp.count_svg>=F.particles.number.value?(F.fn.particlesDraw(),F.particles.move.enable?F.fn.drawAnimFrame=requestAnimFrame(F.fn.vendors.draw):cancelRequestAnimFrame(F.fn.drawAnimFrame)):F.tmp.img_error||(F.fn.drawAnimFrame=requestAnimFrame(F.fn.vendors.draw)):null!=F.tmp.img_obj?(F.fn.particlesDraw(),F.particles.move.enable?F.fn.drawAnimFrame=requestAnimFrame(F.fn.vendors.draw):cancelRequestAnimFrame(F.fn.drawAnimFrame)):F.tmp.img_error||(F.fn.drawAnimFrame=requestAnimFrame(F.fn.vendors.draw)):(F.fn.particlesDraw(),F.particles.move.enable?F.fn.drawAnimFrame=requestAnimFrame(F.fn.vendors.draw):cancelRequestAnimFrame(F.fn.drawAnimFrame))},F.fn.vendors.checkBeforeDraw=function(){"image"==F.particles.shape.type?"svg"==F.tmp.img_type&&null==F.tmp.source_svg?F.tmp.checkAnimFrame=requestAnimFrame(check):(cancelRequestAnimFrame(F.tmp.checkAnimFrame),F.tmp.img_error||(F.fn.vendors.init(),F.fn.vendors.draw())):(F.fn.vendors.init(),F.fn.vendors.draw())},F.fn.vendors.init=function(){F.fn.retinaInit(),F.fn.canvasInit(),F.fn.canvasSize(),F.fn.canvasPaint(),F.fn.particlesCreate(),F.fn.vendors.densityAutoParticles(),F.particles.line_linked.color_rgb_line=hexToRgb(F.particles.line_linked.color)},F.fn.vendors.start=function(){isInArray("image",F.particles.shape.type)?(F.tmp.img_type=F.particles.shape.image.src.substr(F.particles.shape.image.src.length-3),F.fn.vendors.loadImg(F.tmp.img_type)):F.fn.vendors.checkBeforeDraw()},F.fn.vendors.eventsListeners(),F.fn.vendors.start()};function hexToRgb(Ce){Ce=Ce.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(F,de,me,st){return de+de+me+me+st+st});var ut=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(Ce);return ut?{r:parseInt(ut[1],16),g:parseInt(ut[2],16),b:parseInt(ut[3],16)}:null}function clamp(Ce,Ze,ut){return Math.min(Math.max(Ce,Ze),ut)}function isInArray(Ce,Ze){return Ze.indexOf(Ce)>-1}Object.deepExtend=function(Ce,Ze){for(var ut in Ze)Ze[ut]&&Ze[ut].constructor&&Ze[ut].constructor===Object?(Ce[ut]=Ce[ut]||{},arguments.callee(Ce[ut],Ze[ut])):Ce[ut]=Ze[ut];return Ce},window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(Ce){window.setTimeout(Ce,1e3/60)},window.cancelRequestAnimFrame=window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout,window.pJSDom=[],window.particlesJS=function(Ce,Ze){"string"!=typeof Ce&&(Ze=Ce,Ce="particles-js"),Ce||(Ce="particles-js");var ut=document.getElementById(Ce),F="particles-js-canvas-el",de=ut.getElementsByClassName(F);if(de.length)for(;de.length>0;)ut.removeChild(de[0]);var me=document.createElement("canvas");me.className=F,me.style.width="100%",me.style.height="100%",null!=document.getElementById(Ce).appendChild(me)&&pJSDom.push(new pJS(Ce,Ze))},window.particlesJS.load=function(Ce,Ze,ut){var F=new XMLHttpRequest;F.open("GET",Ze),F.onreadystatechange=function(de){if(4==F.readyState)if(200==F.status){var me=JSON.parse(de.currentTarget.response);window.particlesJS(Ce,me),ut&&ut()}else console.log("Error pJS - XMLHttpRequest status: "+F.status),console.log("Error pJS - File config not found")},F.send()},function(Ce,Ze){"object"==typeof exports&&typeof module<"u"?Ze(exports):"function"==typeof define&&define.amd?define(["exports"],Ze):Ze((Ce=Ce||self).faceapi=Ce.faceapi||{})}(this,function(Ce){"use strict";var Ze=function(e,t){return(Ze=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])})(e,t)};function ut(e,t){function n(){this.constructor=e}Ze(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function F(e,t,n,a){return new(n=n||Promise)(function(s,c){function d(m){try{g(a.next(m))}catch(w){c(w)}}function f(m){try{g(a.throw(m))}catch(w){c(w)}}function g(m){m.done?s(m.value):new n(function(w){w(m.value)}).then(d,f)}g((a=a.apply(e,t||[])).next())})}function de(e,t){var n,a,s,c,d={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return c={next:f(0),throw:f(1),return:f(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function f(g){return function(m){return function(w){if(n)throw new TypeError("Generator is already executing.");for(;d;)try{if(n=1,a&&(s=2&w[0]?a.return:w[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,w[1])).done)return s;switch(a=0,s&&(w=[2&w[0],s.value]),w[0]){case 0:case 1:s=w;break;case 4:return d.label++,{value:w[1],done:!1};case 5:d.label++,a=w[1],w=[0];continue;case 7:w=d.ops.pop(),d.trys.pop();continue;default:if(!(s=0<(s=d.trys).length&&s[s.length-1])&&(6===w[0]||2===w[0])){d=0;continue}if(3===w[0]&&(!s||w[1]>s[0]&&w[1]<s[3])){d.label=w[1];break}if(6===w[0]&&d.label<s[1]){d.label=s[1],s=w;break}if(s&&d.label<s[2]){d.label=s[2],d.ops.push(w);break}s[2]&&d.ops.pop(),d.trys.pop();continue}w=t.call(e,d)}catch(A){w=[6,A],a=0}finally{n=s=0}if(5&w[0])throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}([g,m])}}}var me=(st.prototype.setPlatform=function(e,t){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+t+"."),this.platformName=e,this.platform=t},st.prototype.registerFlag=function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var a=this.urlFlags[e];console.warn("Setting feature override from URL "+e+": "+a+"."),this.set(e,a)}},st.prototype.get=function(e){return e in this.flags||(this.flags[e]=this.evaluateFlag(e)),this.flags[e]},st.prototype.getNumber=function(e){return this.get(e)},st.prototype.getBool=function(e){return this.get(e)},st.prototype.getFlags=function(){return this.flags},Object.defineProperty(st.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),st.prototype.set=function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)},st.prototype.evaluateFlag=function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},st.prototype.setFlags=function(e){this.flags=Object.assign({},e)},st.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},st.prototype.populateURLFlags=function(){var e=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var n,a=(n={},this.global.location.search.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(s){for(var c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];return m=c[1],n[decodeURIComponent(c[0])]=decodeURIComponent(m||""),c.join("=");var m}),n);"tfjsflags"in a&&a.tfjsflags.split(",").forEach(function(s){var c=s.split(":"),d=c[0];e.urlFlags[d]=function(g,m){if("true"===(m=m.toLowerCase())||"false"===m)return"true"===m;if(""+ +m===m)return+m;throw new Error("Could not parse value flag value "+m+" for flag "+g+".")}(d,c[1])})}},st);function st(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}function _e(){return kt}var kt=null,Ft=new Map,cn=new Map;function dn(e,t){var n=pe(e,t);return Ft.get(n)}function ar(e){return cn.get(e)}function gt(e){for(var t=Ft.entries(),n=[];;){var a=t.next(),c=a.value;if(a.done)break;var f=c[1];c[0].split("_")[0]===e&&n.push(f)}return n}function Et(e){var t=e.kernelName,n=e.backendName,a=pe(t,n);if(Ft.has(a))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");Ft.set(a,e)}function bn(e){var t=e.kernelName;cn.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),cn.set(t,e)}function pe(e,t){return t+"_"+e}function hi(e){for(var t=e.length,n=0,a=0;0<t;)a=Math.random()*t|0,n=e[--t],e[t]=e[a],e[a]=n}function On(e,t,n){return Math.max(e,Math.min(t,n))}function Ke(e){return e%2==0?e:e+1}function yn(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function ue(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function z(e,t,n){void 0===n&&(n=""),ue(or(e,t),function(){return n+" Shapes "+e+" and "+t+" must match"})}function Mn(e){ue(null!=e,function(){return"The input to the tensor constructor must be a non-null value."})}function Qt(e,t,n){if(void 0===t&&(t=[]),void 0===n&&(n=!1),null==t&&(t=[]),Array.isArray(e)||wn(e)&&!n)for(var a=0;a<e.length;++a)Qt(e[a],t,n);else t.push(e);return t}function mt(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function or(e,t){if(e===t)return!0;if(null==e||null==t||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Qn(e){return e%1==0}function Cn(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function Lr(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function ji(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function sa(e,t,n){return void 0===t&&(t=function(a){return 0}),new Promise(function(a,s){var c=0,d=function(){if(e())a();else{var f=t(++c);null!=n&&n<=c?s():setTimeout(d,f)}};d()})}function ri(e,t){for(var n=1,a=-1,s=0;s<e.length;++s)if(0<=e[s])n*=e[s];else if(-1===e[s]){if(-1!==a)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+a+" and dim "+s);a=s}else if(e[s]<0)throw Error("Shapes can not be < 0. Found "+e[s]+" at dim "+s);if(-1===a){if(0<t&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(0===n)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var c=e.slice();return c[a]=t/n,c}function Nn(e,t){var n=t.length;return ue((e=null==e?t.map(function(a,s){return s}):[].concat(e)).every(function(a){return-n<=a&&a<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e}),ue(e.every(function(a){return Qn(a)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(a){return a<0?n+a:a})}function Je(e,t){for(var n=[],a=[],s=null!=t&&Array.isArray(t)&&0===t.length,c=null==t||s?null:Nn(t,e).sort(),d=0,f=0;f<e.length;++f){if(null!=c){if(c[d]===f&&1!==e[f])throw new Error("Can't squeeze axis "+f+" since its dim '"+e[f]+"' is not 1");(null==c[d]||c[d]>f)&&1===e[f]&&(n.push(e[f]),a.push(f)),c[d]<=f&&d++}1!==e[f]&&(n.push(e[f]),a.push(f))}return{newShape:n,keptDims:a}}function Ai(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function la(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type "+e);n=new Array(t)}return n}function Fr(e,t){for(var n=0;n<e.length;n++){var a=e[n];if(isNaN(a)||!isFinite(a))throw Error("A tensor of type "+t+" being uploaded contains "+a+".")}}function Rr(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function Ui(e,t){return!("complex64"===t||"float32"===t&&"complex64"!==e||"int32"===t&&"float32"!==e&&"complex64"!==e||"bool"===t&&"bool"===e)}function wn(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function Dr(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype "+e)}function Ot(e){if(null==e)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}function Or(e){return"string"==typeof e||e instanceof String}function Pr(e){return"boolean"==typeof e}function qi(e){return"number"==typeof e}function Si(e){return Array.isArray(e)?Si(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":qi(e)?"float32":Or(e)?"string":Pr(e)?"bool":"float32"}function Br(e){return!!(e&&e.constructor&&e.call&&e.apply)}function ca(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function yr(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var a=t-3;0<=a;--a)n[a]=n[a+1]*e[a+1];return n}function di(e,t,n){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Qt(e)),n&&Fr(e,t),e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t)return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"!==t)throw new Error("Unknown data type "+t);for(var a=new Uint8Array(e.length),s=0;s<a.length;++s)0!==Math.round(e[s])&&(a[s]=1);return a}function fi(e,t){if(0===e.length)return t[0];var n=e.reduce(function(a,s){return a*s});if(0===n)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function a(s,c,d){var f=new Array;if(1===c.length)for(var g=c[0],m=0;m<g;m++)f[m]=d[s+m];else{g=c[0];var w=c.slice(1),A=w.reduce(function(T,M){return T*M});for(m=0;m<g;m++)f[m]=a(s+m*A,w,d)}return f}(0,e,t)}function Da(e,t){for(var n=wa(e,t),a=0;a<n.length;a++)n[a]=1;return n}function wa(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type "+t)}function pi(){return _e().platform.now()}function ii(e){e.forEach(function(t){ue(Number.isInteger(t)&&0<=t,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function Ca(e,t){return void 0===t&&(t="utf-8"),t=t||"utf-8",_e().platform.encode(e,t)}function Pi(e,t){return void 0===t&&(t="utf-8"),t=t||"utf-8",_e().platform.decode(e,t)}function Tt(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var a=e[e.length-1],s=0;s<e.length-1;++s)a+=n[s]*e[s];return a}function nr(e,t,n){if(0===t)return[];if(1===t)return[e];for(var a=new Array(t),s=0;s<a.length-1;++s)a[s]=Math.floor(e/n[s]),e-=a[s]*n[s];return a[a.length-1]=e,a}var Pa=Object.freeze({shuffle:hi,clamp:On,nearestLargerEven:Ke,sum:yn,randUniform:function(e,t){var n=Math.random();return t*n+(1-n)*e},distSquared:function(e,t){for(var n=0,a=0;a<e.length;a++){var s=Number(e[a])-Number(t[a]);n+=s*s}return n},assert:ue,assertShapesMatch:z,assertNonNull:Mn,flatten:Qt,sizeFromShape:mt,isScalarShape:function(e){return 0===e.length},arraysEqual:or,isInt:Qn,tanh:Cn,sizeToSquarishShape:Lr,createShuffledIndices:function(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return hi(t),t},rightPad:ji,repeatedTry:sa,inferFromImplicitShape:ri,parseAxisParam:Nn,squeezeShape:Je,getTypedArrayFromDType:Ai,getArrayFromDType:la,checkConversionForErrors:Fr,isValidDtype:Rr,hasEncodingLoss:Ui,isTypedArray:wn,bytesPerElement:Dr,bytesFromStringArray:Ot,isString:Or,isBoolean:Pr,isNumber:qi,inferDtype:Si,isFunction:Br,nearestDivisor:ca,computeStrides:yr,toTypedArray:di,toNestedArray:fi,makeOnesTypedArray:Da,makeZerosTypedArray:wa,now:pi,assertNonNegativeIntegerDimensions:ii,fetch:function(e,t){return _e().platform.fetch(e,t)},encodeString:Ca,decodeString:Pi,locToIndex:Tt,indexToLoc:nr}),Ma=(Mi.prototype.profileKernel=function(e,t,n){var a,s=this,c=this.backendTimer.time(function(){a=n()});return a.forEach(function(d){d.data().then(function(f){(function(g,m,w){if("float32"===m)for(var A=0;A<g.length;A++){var T=g[A];if(isNaN(T)||!isFinite(T))return console.warn("Found "+T+" in the result of '"+w+"'")}})(f,d.dtype,e),c.then(function(g){var m="";null!=g.getExtraProfileInfo&&(m=g.getExtraProfileInfo()),s.logger.logKernelProfile(e,d,f,g.kernelMs,t,m)})})}),a},Mi);function Mi(e,t){this.backendTimer=e,null==(this.logger=t)&&(this.logger=new $i)}var $i=(Ni.prototype.logKernelProfile=function(e,t,n,a,s,c){var d="number"==typeof a?ji(a+"ms",9):a.error,f=ji(e,25),g=t.rank,m=t.size,w=ji(t.shape.toString(),14),A="";for(var T in s){var M=s[T].shape||t.shape,O=M.length;A+=T+": "+O+"D "+(0<O?M:"")+" "}console.log("%c"+f+"\t%c"+d+"\t%c"+g+"D "+w+"\t%c"+m+"\t%c"+A+"\t%c"+c,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},Ni);function Ni(){}function Ur(e,t,n){return ji(Array.isArray(e)?parseFloat(e[0].toFixed(7))+" + "+parseFloat(e[1].toFixed(7))+"j":Or(e)?"'"+e+"'":"bool"===n?Ki(e):parseFloat(e.toFixed(7)).toString(),t)}function Ki(e){return 0===e?"false":"true"}function Na(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var Li=(Wr.prototype.set=function(e){for(var t=this,n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];0===n.length&&(n=[0]),ue(n.length===this.rank,function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+t.rank+")"});var s=this.locToIndex(n);this.values[s]=e},Wr.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];0===e.length&&(e=[0]);for(var n=0,a=0,s=e;a<s.length;a++){var c=s[a];if(c<0||c>=this.shape[n])throw new Error("Requested out of range element at "+e+".   Buffer shape="+this.shape);n++}for(var f=e[e.length-1],g=0;g<e.length-1;++g)f+=this.strides[g]*e[g];return this.values[f]},Wr.prototype.locToIndex=function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t},Wr.prototype.indexToLoc=function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t},Object.defineProperty(Wr.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),Wr.prototype.toTensor=function(){return gi().makeTensor(this.values,this.shape,this.dtype)},Wr),gi=null,Ve=null,ua=null;function Wr(e,t,n){var a=this;if(this.dtype=t,this.shape=e.slice(),this.size=mt(e),null!=n){var s=n.length;ue(s===this.size,function(){return"Length of values '"+s+"' does not match the size inferred by the shape '"+a.size+"'."})}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||la(t,this.size),this.strides=yr(e)}var rn=(Me.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},Me.prototype.asScalar=function(){return this.throwIfDisposed(),ue(1===this.size,function(){return"The array must have only 1 element."}),this.reshape([])},Me.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},Me.prototype.as2D=function(e,t){return this.throwIfDisposed(),this.reshape([e,t])},Me.prototype.as3D=function(e,t,n){return this.throwIfDisposed(),this.reshape([e,t,n])},Me.prototype.as4D=function(e,t,n,a){return this.throwIfDisposed(),this.reshape([e,t,n,a])},Me.prototype.as5D=function(e,t,n,a,s){return this.throwIfDisposed(),this.reshape([e,t,n,a,s])},Me.prototype.asType=function(e){return this.throwIfDisposed(),Ve.cast(this,e)},Object.defineProperty(Me.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),Me.prototype.buffer=function(){return F(this,void 0,void 0,function(){var e;return de(this,function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,Ve.buffer(this.shape,this.dtype,e)]}})})},Me.prototype.bufferSync=function(){return Ve.buffer(this.shape,this.dtype,this.dataSync())},Me.prototype.array=function(){return F(this,void 0,void 0,function(){var e;return de(this,function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,fi(this.shape,e)]}})})},Me.prototype.arraySync=function(){return fi(this.shape,this.dataSync())},Me.prototype.data=function(){return F(this,void 0,void 0,function(){var e,t;return de(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),e=gi().read(this.dataId),"string"!==this.dtype?[3,2]:[4,e];case 1:t=n.sent();try{return[2,t.map(function(a){return Pi(a)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,e]}})})},Me.prototype.dataSync=function(){this.throwIfDisposed();var e=gi().readSync(this.dataId);if("string"===this.dtype)try{return e.map(function(t){return Pi(t)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},Me.prototype.bytes=function(){return F(this,void 0,void 0,function(){var e;return de(this,function(t){switch(t.label){case 0:return this.throwIfDisposed(),[4,gi().read(this.dataId)];case 1:return e=t.sent(),"string"===this.dtype?[2,e]:[2,new Uint8Array(e.buffer)]}})})},Me.prototype.dispose=function(){this.isDisposed||(gi().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(Me.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),Me.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},Me.prototype.toFloat=function(){return this.asType("float32")},Me.prototype.toInt=function(){return this.asType("int32")},Me.prototype.toBool=function(){return this.asType("bool")},Me.prototype.print=function(e){return void 0===e&&(e=!1),Ve.print(this,e)},Me.prototype.reshape=function(e){return this.throwIfDisposed(),Ve.reshape(this,e)},Me.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},Me.prototype.expandDims=function(e){return void 0===e&&(e=0),Ve.expandDims(this,e)},Me.prototype.cumsum=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=!1),void 0===n&&(n=!1),Ve.cumsum(this,e,t,n)},Me.prototype.squeeze=function(e){return this.throwIfDisposed(),Ve.squeeze(this,e)},Me.prototype.clone=function(){return this.throwIfDisposed(),Ve.clone(this)},Me.prototype.oneHot=function(e,t,n){return this.throwIfDisposed(),Ve.oneHot(this,e,t,n)},Me.prototype.toString=function(e){return void 0===e&&(e=!1),t=this.dataSync(),a=this.dtype,s=e,c=yr(n=this.shape),d=function(w,A,T,M){var O=mt(A),V=M[M.length-1],H=new Array(V).fill(0),X=A.length,$="complex64"===T?Na(w):w;if(1<X)for(var ee=0;ee<O/V;ee++)for(var re=ee*V,te=0;te<V;te++)H[te]=Math.max(H[te],Ur($[re+te],0,T).length);return H}(t,n,a,c),f=n.length,g=function w(A,T,M,O,V,H){void 0===H&&(H=!0);var X="complex64"===M?2:1,$=T[0],ee=T.length;if(0===ee)return"complex64"===M?[Ur(Na(A)[0],0,M)]:"bool"===M?[Ki(A[0])]:[A[0].toString()];if(1===ee){if(20<$){var te=Array.from(A.slice(0,3*X)),le=Array.from(A.slice(($-3)*X,$*X));return"complex64"===M&&(te=Na(te),le=Na(le)),["["+te.map(function(Ee,He){return Ur(Ee,V[He],M)}).join(", ")+", ..., "+le.map(function(Ee,He){return Ur(Ee,V[$-3+He],M)}).join(", ")+"]"]}return["["+("complex64"===M?Na(A):Array.from(A)).map(function(Ee,He){return Ur(Ee,V[He],M)}).join(", ")+"]"]}var se=T.slice(1),ie=O.slice(1),ce=O[0]*X,he=[];if(20<$){for(var be=0;be<3;be++){var Ae=(Te=be*ce)+ce;he.push.apply(he,w(A.slice(Te,Ae),se,M,ie,V,!1))}for(he.push("..."),be=$-3;be<$;be++)Ae=(Te=be*ce)+ce,he.push.apply(he,w(A.slice(Te,Ae),se,M,ie,V,be===$-1))}else for(be=0;be<$;be++){var Te;Ae=(Te=be*ce)+ce,he.push.apply(he,w(A.slice(Te,Ae),se,M,ie,V,be===$-1))}var We=2===ee?",":"";for(he[0]="["+he[0]+We,be=1;be<he.length-1;be++)he[be]=" "+he[be]+We;var Fe=",\n";for(be=2;be<ee;be++)Fe+="\n";return he[he.length-1]=" "+he[he.length-1]+"]"+(H?"":Fe),he}(t,n,a,c,d),m=["Tensor"],s&&(m.push("  dtype: "+a),m.push("  rank: "+f),m.push("  shape: ["+n+"]"),m.push("  values:")),m.push(g.map(function(w){return"    "+w}).join("\n")),m.join("\n");var t,n,a,s,c,d,f,g,m},Me.prototype.tile=function(e){return this.throwIfDisposed(),Ve.tile(this,e)},Me.prototype.gather=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),Ve.gather(this,e,t)},Me.prototype.matMul=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),this.throwIfDisposed(),Ve.matMul(this,e,t,n)},Me.prototype.dot=function(e){return this.throwIfDisposed(),Ve.dot(this,e)},Me.prototype.norm=function(e,t,n){return void 0===e&&(e="euclidean"),void 0===t&&(t=null),void 0===n&&(n=!1),this.throwIfDisposed(),Ve.norm(this,e,t,n)},Me.prototype.slice=function(e,t){return this.throwIfDisposed(),Ve.slice(this,e,t)},Me.prototype.reverse=function(e){return this.throwIfDisposed(),Ve.reverse(this,e)},Me.prototype.concat=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),e instanceof Me&&(e=[e]),Ve.concat([this].concat(e),t)},Me.prototype.split=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),Ve.split(this,e,t)},Me.prototype.stack=function(e,t){return void 0===t&&(t=0),Ve.stack([this,e],t)},Me.prototype.unstack=function(e){return void 0===e&&(e=0),Ve.unstack(this,e)},Me.prototype.pad=function(e,t){return void 0===t&&(t=0),Ve.pad(this,e,t)},Me.prototype.batchNormalization=function(e,t,n,a,s){return void 0===n&&(n=.001),ua("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(e,t,s,a,n)},Me.prototype.batchNorm=function(e,t,n,a,s){return void 0===s&&(s=.001),this.throwIfDisposed(),Ve.batchNorm(this,e,t,n,a,s)},Me.prototype.all=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),Ve.all(this,e,t)},Me.prototype.any=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),Ve.any(this,e,t)},Me.prototype.logSumExp=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),Ve.logSumExp(this,e,t)},Me.prototype.sum=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),Ve.sum(this,e,t)},Me.prototype.prod=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),Ve.prod(this,e,t)},Me.prototype.mean=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),Ve.mean(this,e,t)},Me.prototype.min=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),Ve.min(this,e,t)},Me.prototype.max=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),Ve.max(this,e,t)},Me.prototype.argMin=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),Ve.argMin(this,e)},Me.prototype.argMax=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),Ve.argMax(this,e)},Me.prototype.cast=function(e){return this.throwIfDisposed(),Ve.cast(this,e)},Me.prototype.add=function(e){return this.throwIfDisposed(),Ve.add(this,e)},Me.prototype.addStrict=function(e){return this.throwIfDisposed(),Ve.addStrict(this,e)},Me.prototype.atan2=function(e){return this.throwIfDisposed(),Ve.atan2(this,e)},Me.prototype.sub=function(e){return this.throwIfDisposed(),Ve.sub(this,e)},Me.prototype.subStrict=function(e){return this.throwIfDisposed(),Ve.subStrict(this,e)},Me.prototype.pow=function(e){return this.throwIfDisposed(),Ve.pow(this,e)},Me.prototype.powStrict=function(e){return this.throwIfDisposed(),Ve.powStrict(this,e)},Me.prototype.mul=function(e){return this.throwIfDisposed(),Ve.mul(this,e)},Me.prototype.mulStrict=function(e){return this.throwIfDisposed(),Ve.mulStrict(this,e)},Me.prototype.div=function(e){return this.throwIfDisposed(),Ve.div(this,e)},Me.prototype.divNoNan=function(e){return this.throwIfDisposed(),Ve.divNoNan(this,e)},Me.prototype.floorDiv=function(e){return this.throwIfDisposed(),Ve.floorDiv(this,e)},Me.prototype.divStrict=function(e){return this.throwIfDisposed(),Ve.divStrict(this,e)},Me.prototype.minimum=function(e){return this.throwIfDisposed(),Ve.minimum(this,e)},Me.prototype.minimumStrict=function(e){return this.throwIfDisposed(),Ve.minimumStrict(this,e)},Me.prototype.maximum=function(e){return this.throwIfDisposed(),Ve.maximum(this,e)},Me.prototype.maximumStrict=function(e){return this.throwIfDisposed(),Ve.maximumStrict(this,e)},Me.prototype.mod=function(e){return this.throwIfDisposed(),Ve.mod(this,e)},Me.prototype.modStrict=function(e){return this.throwIfDisposed(),Ve.modStrict(this,e)},Me.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),Ve.squaredDifferenceStrict(this,e)},Me.prototype.transpose=function(e){return this.throwIfDisposed(),Ve.transpose(this,e)},Me.prototype.notEqual=function(e){return this.throwIfDisposed(),Ve.notEqual(this,e)},Me.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),Ve.notEqualStrict(this,e)},Me.prototype.less=function(e){return this.throwIfDisposed(),Ve.less(this,e)},Me.prototype.lessStrict=function(e){return this.throwIfDisposed(),Ve.lessStrict(this,e)},Me.prototype.equal=function(e){return this.throwIfDisposed(),Ve.equal(this,e)},Me.prototype.equalStrict=function(e){return this.throwIfDisposed(),Ve.equalStrict(this,e)},Me.prototype.lessEqual=function(e){return this.throwIfDisposed(),Ve.lessEqual(this,e)},Me.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),Ve.lessEqualStrict(this,e)},Me.prototype.greater=function(e){return this.throwIfDisposed(),Ve.greater(this,e)},Me.prototype.greaterStrict=function(e){return this.throwIfDisposed(),Ve.greaterStrict(this,e)},Me.prototype.greaterEqual=function(e){return this.throwIfDisposed(),Ve.greaterEqual(this,e)},Me.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),Ve.greaterEqualStrict(this,e)},Me.prototype.logicalAnd=function(e){return this.throwIfDisposed(),Ve.logicalAnd(this,e)},Me.prototype.logicalOr=function(e){return this.throwIfDisposed(),Ve.logicalOr(this,e)},Me.prototype.logicalNot=function(){return this.throwIfDisposed(),Ve.logicalNot(this)},Me.prototype.logicalXor=function(e){return this.throwIfDisposed(),Ve.logicalXor(this,e)},Me.prototype.where=function(e,t){return this.throwIfDisposed(),Ve.where(e,this,t)},Me.prototype.neg=function(){return this.throwIfDisposed(),Ve.neg(this)},Me.prototype.ceil=function(){return this.throwIfDisposed(),Ve.ceil(this)},Me.prototype.floor=function(){return this.throwIfDisposed(),Ve.floor(this)},Me.prototype.sign=function(){return this.throwIfDisposed(),Ve.sign(this)},Me.prototype.isNaN=function(){return this.throwIfDisposed(),Ve.isNaN(this)},Me.prototype.isInf=function(){return this.throwIfDisposed(),Ve.isInf(this)},Me.prototype.isFinite=function(){return this.throwIfDisposed(),Ve.isFinite(this)},Me.prototype.exp=function(){return this.throwIfDisposed(),Ve.exp(this)},Me.prototype.expm1=function(){return this.throwIfDisposed(),Ve.expm1(this)},Me.prototype.log=function(){return this.throwIfDisposed(),Ve.log(this)},Me.prototype.log1p=function(){return this.throwIfDisposed(),Ve.log1p(this)},Me.prototype.sqrt=function(){return this.throwIfDisposed(),Ve.sqrt(this)},Me.prototype.rsqrt=function(){return this.throwIfDisposed(),Ve.rsqrt(this)},Me.prototype.square=function(){return this.throwIfDisposed(),Ve.square(this)},Me.prototype.reciprocal=function(){return this.throwIfDisposed(),Ve.reciprocal(this)},Me.prototype.abs=function(){return this.throwIfDisposed(),Ve.abs(this)},Me.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),Ve.clipByValue(this,e,t)},Me.prototype.relu=function(){return this.throwIfDisposed(),Ve.relu(this)},Me.prototype.relu6=function(){return this.throwIfDisposed(),Ve.relu6(this)},Me.prototype.elu=function(){return this.throwIfDisposed(),Ve.elu(this)},Me.prototype.selu=function(){return this.throwIfDisposed(),Ve.selu(this)},Me.prototype.leakyRelu=function(e){return void 0===e&&(e=.2),this.throwIfDisposed(),Ve.leakyRelu(this,e)},Me.prototype.prelu=function(e){return this.throwIfDisposed(),Ve.prelu(this,e)},Me.prototype.sigmoid=function(){return this.throwIfDisposed(),Ve.sigmoid(this)},Me.prototype.logSigmoid=function(){return this.throwIfDisposed(),Ve.logSigmoid(this)},Me.prototype.softplus=function(){return this.throwIfDisposed(),Ve.softplus(this)},Me.prototype.zerosLike=function(){return this.throwIfDisposed(),Ve.zerosLike(this)},Me.prototype.onesLike=function(){return this.throwIfDisposed(),Ve.onesLike(this)},Me.prototype.sin=function(){return this.throwIfDisposed(),Ve.sin(this)},Me.prototype.cos=function(){return this.throwIfDisposed(),Ve.cos(this)},Me.prototype.tan=function(){return this.throwIfDisposed(),Ve.tan(this)},Me.prototype.asin=function(){return this.throwIfDisposed(),Ve.asin(this)},Me.prototype.acos=function(){return this.throwIfDisposed(),Ve.acos(this)},Me.prototype.atan=function(){return this.throwIfDisposed(),Ve.atan(this)},Me.prototype.sinh=function(){return this.throwIfDisposed(),Ve.sinh(this)},Me.prototype.cosh=function(){return this.throwIfDisposed(),Ve.cosh(this)},Me.prototype.tanh=function(){return this.throwIfDisposed(),Ve.tanh(this)},Me.prototype.asinh=function(){return this.throwIfDisposed(),Ve.asinh(this)},Me.prototype.acosh=function(){return this.throwIfDisposed(),Ve.acosh(this)},Me.prototype.atanh=function(){return this.throwIfDisposed(),Ve.atanh(this)},Me.prototype.erf=function(){return this.throwIfDisposed(),Ve.erf(this)},Me.prototype.round=function(){return this.throwIfDisposed(),Ve.round(this)},Me.prototype.step=function(e){return void 0===e&&(e=0),this.throwIfDisposed(),Ve.step(this,e)},Me.prototype.softmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),Ve.softmax(this,e)},Me.prototype.logSoftmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),Ve.logSoftmax(this,e)},Me.prototype.resizeBilinear=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),Ve.image.resizeBilinear(this,e,t)},Me.prototype.resizeNearestNeighbor=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),Ve.image.resizeNearestNeighbor(this,e,t)},Me.prototype.conv1d=function(e,t,n,a,s,c){return void 0===a&&(a="NWC"),void 0===s&&(s=1),this.throwIfDisposed(),Ve.conv1d(this,e,t,n,a,s,c)},Me.prototype.conv2d=function(e,t,n,a,s,c){return void 0===a&&(a="NHWC"),void 0===s&&(s=[1,1]),this.throwIfDisposed(),Ve.conv2d(this,e,t,n,a,s,c)},Me.prototype.conv2dTranspose=function(e,t,n,a,s){return this.throwIfDisposed(),Ve.conv2dTranspose(this,e,t,n,a,s)},Me.prototype.depthwiseConv2D=function(e,t,n,a,s,c){return void 0===a&&(a="NHWC"),void 0===s&&(s=[1,1]),this.throwIfDisposed(),Ve.depthwiseConv2d(this,e,t,n,a,s,c)},Me.prototype.separableConv2d=function(e,t,n,a,s,c){return void 0===s&&(s=[1,1]),void 0===c&&(c="NHWC"),this.throwIfDisposed(),Ve.separableConv2d(this,e,t,n,a,s,c)},Me.prototype.avgPool=function(e,t,n,a){return this.throwIfDisposed(),Ve.avgPool(this,e,t,n,a)},Me.prototype.maxPool=function(e,t,n,a){return this.throwIfDisposed(),Ve.maxPool(this,e,t,n,a)},Me.prototype.localResponseNormalization=function(e,t,n,a){return void 0===e&&(e=5),void 0===t&&(t=1),void 0===n&&(n=1),void 0===a&&(a=.5),Ve.localResponseNormalization(this,e,t,n,a)},Me.prototype.pool=function(e,t,n,a,s){return this.throwIfDisposed(),Ve.pool(this,e,t,n,a,s)},Me.prototype.variable=function(e,t,n){return void 0===e&&(e=!0),this.throwIfDisposed(),gi().makeVariable(this,e,t,n)},Me.prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),Ve.unsortedSegmentSum(this,e,t)},Me.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),Ve.batchToSpaceND(this,e,t)},Me.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),Ve.spaceToBatchND(this,e,t)},Me.prototype.topk=function(e,t){return void 0===e&&(e=1),void 0===t&&(t=!0),this.throwIfDisposed(),Ve.topk(this,e,t)},Me.prototype.stridedSlice=function(e,t,n,a,s,c,d,f){return void 0===a&&(a=0),void 0===s&&(s=0),void 0===c&&(c=0),void 0===d&&(d=0),void 0===f&&(f=0),this.throwIfDisposed(),Ve.stridedSlice(this,e,t,n,a,s,c,d,f)},Me.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),Ve.depthToSpace(this,e,t)},Me.prototype.fft=function(){return this.throwIfDisposed(),Ve.spectral.fft(this)},Me.prototype.ifft=function(){return this.throwIfDisposed(),Ve.spectral.ifft(this)},Me.prototype.rfft=function(){return this.throwIfDisposed(),Ve.spectral.rfft(this)},Me.prototype.irfft=function(){return this.throwIfDisposed(),Ve.spectral.irfft(this)},Me);function Me(e,t,n,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=mt(e),this.strides=yr(e),this.dataId=n,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}Object.defineProperty(rn,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.dataId&&null!=e.shape&&null!=e.dtype}});var ha,La,Hr,wr,ka,da,Fi,Fa,Oi,Bi,zi,Ei=(ut(Zi,da=rn),Zi.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!or(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");gi().disposeTensor(this),this.dataId=e.dataId,gi().incRef(this,null)},Zi.prototype.dispose=function(){gi().disposeVariable(this),this.isDisposedInternal=!0},Zi);function Zi(e,t,n,a){var s=da.call(this,e.shape,e.dtype,e.dataId,a)||this;return s.trainable=t,s.name=n,s}Object.defineProperty(Ei,Symbol.hasInstance,{value:function(e){return e instanceof rn&&null!=e.assign&&e.assign instanceof Function}}),(zi=ha=ha||{}).R0="R0",zi.R1="R1",zi.R2="R2",zi.R3="R3",zi.R4="R4",zi.R5="R5",zi.R6="R6",(Bi=La=La||{}).float32="float32",Bi.int32="int32",Bi.bool="int32",Bi.complex64="complex64",(Oi=Hr=Hr||{}).float32="float32",Oi.int32="int32",Oi.bool="bool",Oi.complex64="complex64",(Fa=wr=wr||{}).float32="float32",Fa.int32="float32",Fa.bool="float32",Fa.complex64="complex64",(Fi=ka=ka||{}).float32="complex64",Fi.int32="complex64",Fi.bool="complex64",Fi.complex64="complex64";var Ji={float32:wr,int32:La,bool:Hr,complex64:ka};function Dn(e,t){if("string"!==e&&"string"!==t)return Ji[e][t];if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast "+e+" with "+t)}function Wi(e){return Dn(e,"int32")}function Bn(e,t){if(e.dtype===t.dtype)return[e,t];var n=Dn(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function ns(e,t){ue(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"})}function no(e){var t=[];return function n(a,s,c){if(null!=a)if(a instanceof rn)s.push(a);else if(d=a,Array.isArray(d)||"object"==typeof d){var d,f=a;for(var g in f){var m=f[g];c.has(m)||(c.add(m),n(m,s,c))}}}(e,t,new Set),t}var qr,Mr=Object.freeze({makeTypesMatch:Bn,assertTypesMatch:ns,isTensorInList:function(e,t){return t.some(function(n){return n.id===e.id})},getTensorsInContainer:no}),Cr=(Aa.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},Aa),Nr=(dt.prototype.ready=function(){return F(this,void 0,void 0,function(){var e,t,n;return de(this,function(a){switch(a.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then(function(){})];if(null!=this.backendInstance)return[2];e=this.getSortedBackends(),t=0,a.label=1;case 1:return t<e.length?[4,this.initializeBackend(n=e[t]).success]:[3,5];case 2:return a.sent()?[4,this.setBackend(n)]:[3,4];case 3:return a.sent(),[2];case 4:return t++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(dt.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '"+t+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance},enumerable:!0,configurable:!0}),dt.prototype.backendNames=function(){return Object.keys(this.registryFactory)},dt.prototype.findBackend=function(e){return e in this.registry||e in this.registryFactory&&!this.initializeBackend(e).asyncInit?this.registry[e]:null},dt.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},dt.prototype.registerBackend=function(e,t,n){return void 0===n&&(n=1),e in this.registryFactory?(console.warn(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)},dt.prototype.setBackend=function(e){return F(this,void 0,void 0,function(){var t,n,a;return de(this,function(s){switch(s.label){case 0:if(null==this.registryFactory[e])throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,null!=this.registry[e]?[3,4]:(this.backendInstance=null,t=this.initializeBackend(e),n=t.success,t.asyncInit?[4,n]:[3,2]);case 1:return a=s.sent(),[3,3];case 2:a=n,s.label=3;case 3:if(!a)return[2,!1];s.label=4;case 4:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new Ma(this.backendInstance),[2,!0]}})})},dt.prototype.setupRegisteredKernels=function(){var e=this;gt(this.backendName).forEach(function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)})},dt.prototype.disposeRegisteredKernels=function(e){var t=this;gt(e).forEach(function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])})},dt.prototype.initializeBackend=function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var a=n.factory();if(Promise.resolve(a)!==a)return this.registry[e]=a,{success:!0,asyncInit:!1};var s=++this.pendingBackendInitId,c=a.then(function(d){return!(s<t.pendingBackendInitId||(t.registry[e]=d,t.pendingBackendInit=null))}).catch(function(d){return!(s<t.pendingBackendInitId||(t.pendingBackendInit=null,console.warn("Initialization of backend "+e+" failed"),console.warn(d.stack||d.message),1))});return{success:this.pendingBackendInit=c,asyncInit:!0}}catch(d){return console.warn("Initialization of backend "+e+" failed"),console.warn(d.stack||d.message),{success:!1,asyncInit:!1}}},dt.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},dt.prototype.getSortedBackends=function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority})},dt.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],a=this.initializeBackend(n),c=a.asyncInit;if(c||a.success)return{name:n,asyncInit:c}}throw new Error("Could not initialize any backends, all backend initializations failed.")},dt.prototype.moveData=function(e,t){var n=this.state.tensorInfo.get(t),a=n.backend,s=this.readSync(t);a.disposeData(t),(n.backend=e).move(t,s,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},dt.prototype.tidy=function(e,t){var n,a=this,s=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}return this.scopedRun(function(){return a.startScope(s)},function(){return a.endScope(n)},function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n})},dt.prototype.scopedRun=function(e,t,n){e();try{var a=n();return t(),a}catch(s){throw t(),s}},dt.prototype.nextTensorId=function(){return dt.nextTensorId++},dt.prototype.nextVariableId=function(){return dt.nextVariableId++},dt.prototype.clone=function(e){var t=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype);return this.addTapeNode(this.state.activeScope.name,{x:e},[t],function(a){return{x:function(){return a.toFloat()}}},[]),t},dt.prototype.runKernel=function(e,t,n,a,s){return this.runKernelFunc(null,t,null,e,n,a,s)},dt.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},dt.prototype.checkKernelForMemLeak=function(e,t,n){var a=this.backend.numDataIds(),s=0;n.forEach(function(f){s+="complex64"===f.dtype?3:1});var d=a-t-s-this.state.numDataMovesStack[this.state.numDataMovesStack.length-1];if(0<d)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+d+" data ids) after running '"+e+"'")},dt.prototype.runKernelFunc=function(e,t,n,a,s,c,d){var f,g=this;void 0===c&&(c=[]),void 0===d&&(d=[]);var m=[],w=this.isTapeOn();function A(X){w&&(m=X.map(function($){return g.keep(g.clone($))}))}null==a&&(a=null!=this.state.activeScope?this.state.activeScope.name:"");var T,M=this.state.numBytes,O=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var V,H=dn(a,this.backendName);return T=null!=H?function(){var X=g.backend.numDataIds();V=H.kernelFunc({inputs:t,attrs:s,backend:g.backend});var $=Array.isArray(V)?V:[V];g.shouldCheckForMemLeaks()&&g.checkKernelForMemLeak(a,X,$);var ee=$.map(function(te){return g.makeTensorFromDataId(te.dataId,te.shape,te.dtype)}),re=ee.filter(function(te,le){return d[le]});return A((c||[]).slice().concat(re)),ee}:function(){var X=g.backend.numDataIds();V=g.tidy(function(){return e(g.backend,A)});var $=Array.isArray(V)?V:[V];return g.shouldCheckForMemLeaks()&&g.checkKernelForMemLeak(a,X,$),$},this.scopedRun(function(){return g.state.kernelDepth++},function(){return g.state.kernelDepth--},function(){f=g.ENV.getBool("DEBUG")?g.profiler.profileKernel(a,t,function(){return T()}):T()}),w&&this.addTapeNode(a,t,f,n,m),this.state.profiling&&this.state.activeProfile.kernels.push({name:a,bytesAdded:this.state.numBytes-M,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-O,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(t).map(function(X){return t[X].shape}),outputShapes:f.map(function(X){return X.shape})}),Array.isArray(V)?f:f[0]},dt.prototype.makeTensor=function(e,t,n,a){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");a=a||this.backend;var s=e;"string"===(n=n||"float32")&&Or(e[0])&&(s=e.map(function(m){return Ca(m)}));var c=a.write(s,t,n),d=new rn(t,n,c,this.nextTensorId());if(this.incRef(d,a),"string"===n){var f=this.state.tensorInfo.get(c),g=Ot(s);this.state.numBytes+=g-f.bytes,f.bytes=g}return d},dt.prototype.makeTensorFromDataId=function(e,t,n,a){var s=new rn(t,n=n||"float32",e,this.nextTensorId());return this.incRef(s,a),s},dt.prototype.makeVariable=function(e,t,n,a){void 0===t&&(t=!0),n=n||this.nextVariableId().toString(),null!=a&&a!==e.dtype&&(e=e.asType(a));var s=new Ei(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[s.name])throw new Error("Variable with name "+s.name+" was already registered");return this.state.registeredVariables[s.name]=s,this.incRef(s,this.backend),s},dt.prototype.incRef=function(e,t){var n=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var a=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(a=e.size*Dr(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:a,refCount:0}),this.state.numBytes+=a}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof Ei||this.track(e)},dt.prototype.disposeTensor=function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,"string"===e.dtype&&this.state.numStringTensors--;var t=this.state.tensorInfo.get(e.dataId);t.refCount<=1?("complex64"!==e.dtype&&(this.state.numBytes-=t.bytes),this.state.numDataBuffers--,t.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}},dt.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables)this.disposeVariable(this.state.registeredVariables[e])},dt.prototype.disposeVariable=function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]},dt.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,0<this.state.numStringTensors&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},dt.prototype.profile=function(e){return F(this,void 0,void 0,function(){var t,n;return de(this,function(a){return this.state.profiling=!0,t=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(s){return s.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]})})},dt.prototype.isTapeOn=function(){return 0<this.state.gradientDepth&&0===this.state.kernelDepth},dt.prototype.addTapeNode=function(e,t,n,a,s){var c=this,d={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:s},f=ar(e);null!=f&&(a=f.gradFunc),null!=a&&(d.gradient=function(g){return g=g.map(function(m,w){if(null!=m)return m;var A=n[w],T=wa(A.size,A.dtype);return c.makeTensor(T,A.shape,A.dtype)}),a(1<g.length?g:g[0],s)}),this.state.activeTape.push(d)},dt.prototype.keep=function(e){return e.kept=!0,e},dt.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},dt.prototype.endTape=function(){this.state.gradientDepth--},dt.prototype.startScope=function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t},dt.prototype.endScope=function(e){for(var t=this,n=no(e),a=new Set(n.map(function(f){return f.id})),s=0;s<this.state.activeScope.track.length;s++){var c=this.state.activeScope.track[s];c.kept||a.has(c.id)||c.dispose()}var d=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(function(f){f.kept||f.scopeId!==d.id||t.track(f)})},dt.prototype.gradients=function(e,t,n,a){var s=this;if(void 0===a&&(a=!1),ue(0<t.length,function(){return"gradients() received an empty list of xs."}),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var c=this.scopedRun(function(){return s.startTape()},function(){return s.endTape()},function(){return s.tidy("forward",e)});ue(c instanceof rn,function(){return"The result y returned by f() must be a tensor."});var d=function(f,g,m){for(var w={},A={},T=0;T<g.length;T++)w[g[T].id]=!0;for(T=0;T<f.length;T++){var M=(te=f[T]).inputs;for(var O in M){for(var V=M[O],H=!1,X=0;X<g.length;X++)if(w[V.id]){te.outputs.forEach(function(ce){return w[ce.id]=!0}),H=!0,A[te.id]=!0;break}if(H)break}}var $={};$[m.id]=!0;var ee={};for(T=f.length-1;0<=T;T--)for(M=(te=f[T]).inputs,X=0;X<te.outputs.length;X++)if($[te.outputs[X].id]){for(var O in M)$[M[O].id]=!0,ee[te.id]=!0;break}var re=[];for(T=0;T<f.length;T++){var te;if(A[(te=f[T]).id]&&ee[te.id]){var le={};for(var O in te.inputs){var se=te.inputs[O];w[se.id]&&(le[O]=se)}var ie=Object.assign({},te);ie.inputs=le,ie.outputs=te.outputs,re.push(ie)}}return re}(this.state.activeTape,t,c);if(!a&&0===d.length&&0<t.length)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var f,g,m={};m[c.id]=n??(g=Da(mt(f=c.shape),"float32"),P.makeTensor(g,f,"float32")),function(A,T){for(var M=function(V){var H=T[V],X=[];if(H.outputs.forEach(function(te){var le=A[te.id];X.push(null!=le?le:null)}),null==H.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+H.kernelName+".");function $(te){if(!(te in ee))throw new Error("Cannot backprop through input "+te+". Available gradients found: "+Object.keys(ee)+".");var le=s.tidy(function(){return ee[te]()});if("float32"!==le.dtype)throw new Error("Error in gradient for op "+H.kernelName+". The gradient of input "+te+" must have 'float32' dtype, but has '"+le.dtype+"'");var se=H.inputs[te];if(!or(le.shape,se.shape))throw new Error("Error in gradient for op "+H.kernelName+". The gradient of input '"+te+"' has shape '"+le.shape+"', which does not match the shape of the input '"+se.shape+"'");if(null==A[se.id])A[se.id]=le;else{var ie=A[se.id];A[se.id]=ie.add(le),ie.dispose()}}var ee=H.gradient(X);for(var re in H.inputs)$(re)},O=T.length-1;0<=O;O--)M(O)}(m,d);var w=t.map(function(A){return m[A.id]});return 0===s.state.gradientDepth&&(s.state.activeTape.forEach(function(A){for(var T=0,M=A.saved;T<M.length;T++)M[T].dispose()}),s.state.activeTape=null),{value:c,grads:w}})},dt.prototype.customGrad=function(e){var t=this;return ue(Br(e),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var n,a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];ue(a.every(function(d){return d instanceof rn}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var c={};return a.forEach(function(d,f){c[f]=d}),t.runKernelFunc(function(d,f){return ue((n=e.apply(void 0,a.concat([f]))).value instanceof rn,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),ue(Br(n.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),n.value},c,function(d,f){var g=n.gradFunc(d,f),m=Array.isArray(g)?g:[g];ue(m.length===a.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),ue(m.every(function(A){return A instanceof rn}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var w={};return m.forEach(function(A,T){w[T]=function(){return A}}),w})}},dt.prototype.readSync=function(e){return this.state.tensorInfo.get(e).backend.readSync(e)},dt.prototype.read=function(e){return this.state.tensorInfo.get(e).backend.read(e)},dt.prototype.time=function(e){return F(this,void 0,void 0,function(){var t,n;return de(this,function(a){switch(a.label){case 0:return t=pi(),[4,this.backend.time(e)];case 1:return(n=a.sent()).wallMs=pi()-t,[2,n]}})})},dt.prototype.track=function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(dt.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),dt.prototype.reset=function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Cr,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},dt.nextTensorId=0,dt.nextVariableId=0,dt);function dt(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Cr}function Aa(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}var P=function(){var t=function(){if(null==qr){var a=void 0;if(typeof window<"u")a=window;else if(typeof global<"u")a=global;else if(typeof process<"u")a=process;else{if(typeof self>"u")throw new Error("Could not find a global object");a=self}qr=a}return qr}();if(null==t._tfengine){var n=new me(t);t._tfengine=new Nr(n)}return kt=t._tfengine.ENV,gi=function(){return t._tfengine},t._tfengine}();function r(){return typeof window<"u"&&null!=window.document||typeof WorkerGlobalScope<"u"}var i=_e();i.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),i.registerFlag("IS_BROWSER",function(){return r()}),i.registerFlag("IS_NODE",function(){return typeof process<"u"&&void 0!==process.versions&&void 0!==process.versions.node}),i.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),i.registerFlag("PROD",function(){return!1}),i.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return i.getBool("DEBUG")}),i.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),i.registerFlag("IS_TEST",function(){return!1});var o,l,u,h,p,v,y={},C={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function k(e,t){y[e]=t}function S(e){e in y||(y[e]=function(n){if(1!==n&&2!==n)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var a=function(){if(typeof OffscreenCanvas<"u"&&2===n)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}();return a.addEventListener("webglcontextlost",function(s){s.preventDefault(),delete y[n]},!1),1===n?a.getContext("webgl",C)||a.getContext("experimental-webgl",C):a.getContext("webgl2",C)}(e));var t=y[e];return t.isContextLost()?(delete y[e],S(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),y[e])}function R(e,t){return[t,e]}function N(e){var t=mt(e);return Lr(Math.ceil(t/4))}function B(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function U(e,t){var n,a,s,c,d,f,g,m,w,A=e;return w=2===_e().getNumber("WEBGL_VERSION")?(n=A.R32F,a=A.R16F,s=A.RGBA16F,c=A.RGBA32F,d=A.RED,f=4,g=1,m=A.HALF_FLOAT,A.FLOAT):(n=e.RGBA,a=e.RGBA,s=e.RGBA,c=A.RGBA,d=e.RGBA,g=f=4,m=null!=t?t.HALF_FLOAT_OES:null,e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:s,internalFormatPackedFloat:c,textureFormatFloat:d,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:f,defaultNumChannels:g,textureTypeHalfFloat:m,textureTypeFloat:w}}function j(e,t,n){var a=n();return t&&function(s){var c=s.getError();if(c!==s.NO_ERROR)throw new Error("WebGL Error: "+x(s,c))}(e),a}function K(e){return!!(_e().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function x(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function I(e,t,n){return en(e,t,function(){return e.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function W(e,t,n){var a=en(e,t,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(j(e,t,function(){return e.shaderSource(a,n)}),j(e,t,function(){return e.compileShader(a)}),!1===e.getShaderParameter(a,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(a)),new Error("Failed to compile vertex shader.");return a}function q(e,t,n){var a=en(e,t,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(j(e,t,function(){return e.shaderSource(a,n)}),j(e,t,function(){return e.compileShader(a)}),!1===e.getShaderParameter(a,e.COMPILE_STATUS))throw function(s,c){var d=ve.exec(c);if(null==d)return console.log("Couldn't parse line number in error: "+c),console.log(s);for(var f=+d[1],g=s.split("\n"),m=g.length.toString().length+2,w=g.map(function(H,X){return ji((X+1).toString(),m)+H}),A=0,T=0;T<w.length;T++)A=Math.max(w[T].length,A);var M=w.slice(0,f-1),O=w.slice(f-1,f),V=w.slice(f);console.log(M.join("\n")),console.log(c.split("\n")[0]),console.log("%c "+ji(O[0],A),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(V.join("\n"))}(n,e.getShaderInfoLog(a)),new Error("Failed to compile fragment shader.");return a}(v=o=o||{})[v.DENSE=0]="DENSE",v[v.SHARED_BATCH=1]="SHARED_BATCH",(p=l=l||{})[p.RENDER=0]="RENDER",p[p.UPLOAD=1]="UPLOAD",p[p.PIXELS=2]="PIXELS",p[p.DOWNLOAD=3]="DOWNLOAD",(h=u=u||{})[h.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",h[h.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",h[h.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",h[h.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",h[h.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16";var J,ne,ve=/ERROR: [0-9]+:([0-9]+):/g;function ge(e,t){return en(e,t,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function Le(e,t,n){if(j(e,t,function(){return e.linkProgram(n)}),!1===e.getProgramParameter(n,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function qe(e,t,n){if(j(e,t,function(){return e.validateProgram(n)}),!1===e.getProgramParameter(n,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function Pe(e,t,n){var a=en(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return j(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,a)}),j(e,t,function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}),a}function Ue(e,t,n){var a=en(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return j(e,t,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,a)}),j(e,t,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)}),a}function lt(e,t){return en(e,t,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function ft(e,t){var n=_e().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var a="["+e+"x"+t+"]";throw new Error("Requested texture size "+a+" is invalid.")}if(n<e||n<t)throw a="["+e+"x"+t+"]",new Error("Requested texture size "+a+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")}function At(e,t){return en(e,t,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function St(e,t,n,a,s,c,d,f){var g=e.getAttribLocation(n,a);return-1!==g&&(j(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,s)}),j(e,t,function(){return e.vertexAttribPointer(g,c,e.FLOAT,!1,d,f)}),j(e,t,function(){return e.enableVertexAttribArray(g)}),!0)}function Gt(e,t,n,a){kn(e,a),j(e,t,function(){return e.activeTexture(e.TEXTURE0+a)}),j(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)})}function Lt(e,t,n,a){return en(e,t,function(){return e.getUniformLocation(n,a)},'uniform "'+a+'" not present in program.')}function $t(e,t,n){return e.getUniformLocation(t,n)}function zn(e,t,n,a,s,c){j(e,t,function(){return Gt(e,t,a,c)}),j(e,t,function(){return e.uniform1i(s,c)})}function En(e,t,n,a){j(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,a)}),j(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)})}function _n(e,t,n){j(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),j(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function sr(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+fn(e,t))}function fn(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function en(e,t,n,a){var s=j(e,t,function(){return n()});if(null==s)throw new Error(a);return s}function kn(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,a=t+e.TEXTURE0;if(a<e.TEXTURE0||n<a)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}function Gn(e,t){return void 0===t&&(t=2),mt(e.slice(0,e.length-t))}function cr(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[1<e.length?e[e.length-2]:1,e[e.length-1]]}function Xr(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[Gn(e)].concat(cr(e))),t}function Qi(e,t){var n;void 0===t&&(t=!1);var a=_e().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(a*=2,1===(e=e.map(function(m,w){return w>=e.length-2?Ke(e[w]):e[w]})).length&&(e=[2,e[0]])),2!==e.length){var s=Je(e);e=s.newShape}var c=mt(e);if(e.length<=1&&c<=a)return[1,c];if(2===e.length&&e[0]<=a&&e[1]<=a)return e;if(3===e.length&&e[0]*e[1]<=a&&e[2]<=a)return[e[0]*e[1],e[2]];if(3===e.length&&e[0]<=a&&e[1]*e[2]<=a)return[e[0],e[1]*e[2]];if(4===e.length&&e[0]*e[1]*e[2]<=a&&e[3]<=a)return[e[0]*e[1]*e[2],e[3]];if(4===e.length&&e[0]<=a&&e[1]*e[2]*e[3]<=a)return[e[0],e[1]*e[2]*e[3]];if(t){var d=Gn(e),f=2,g=2;return e.length&&(f=(n=cr(e))[0],g=n[1]),Lr(c=d*(f/2)*(g/2)).map(function(m){return 2*m})}return Lr(c)}function rr(e){return e%2==0}function kr(e,t){if(or(e=e.slice(-2),t=t.slice(-2))||!e.length||!t.length||0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],a=t.slice(-1)[0];if(n===a||rr(n)&&rr(a)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&rr(e[0])&&rr(t[0])}function ko(e){if(null==J){var t=S(e);J=t.getParameter(t.MAX_TEXTURE_SIZE)}return J}function Oa(e){if(null==ne){var t=S(e);ne=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,ne)}function Ms(e){if(0===e)return 0;var t=S(e);return $r(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:$r(t,"EXT_disjoint_timer_query")?1:0}function $r(e,t){return null!=e.getExtension(t)}function Ba(e){try{if(null!=S(e))return!0}catch{return!1}return!1}function rs(e){if(0===e)return!1;var t=S(e);if(1===e){if(!$r(t,"OES_texture_float"))return!1}else if(!$r(t,"EXT_color_buffer_float"))return!1;return Ao(t)}function Sa(e){if(0===e)return!1;var t=S(e);if(1===e)return!!$r(t,"OES_texture_float")&&!!$r(t,"WEBGL_color_buffer_float")&&Ao(t);if($r(t,"EXT_color_buffer_float"))return Ao(t);if($r(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(a){var s=U(a,n),c=a.createTexture();a.bindTexture(a.TEXTURE_2D,c),a.texImage2D(a.TEXTURE_2D,0,s.internalFormatHalfFloat,1,1,0,s.textureFormatFloat,s.textureTypeHalfFloat,null);var d=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,d),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,c,0);var f=a.checkFramebufferStatus(a.FRAMEBUFFER)===a.FRAMEBUFFER_COMPLETE;return a.bindTexture(a.TEXTURE_2D,null),a.bindFramebuffer(a.FRAMEBUFFER,null),a.deleteTexture(c),a.deleteFramebuffer(d),f}(t)}return!1}function Ao(e){var t=U(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var a=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(a),s}function za(e){return 2===e&&null!=S(e).fenceSync}var So=Object.freeze({callAndCheck:j,canBeRepresented:K,getWebGLErrorMessage:x,getExtensionOrThrow:I,createVertexShader:W,createFragmentShader:q,createProgram:ge,linkProgram:Le,validateProgram:qe,createStaticVertexBuffer:Pe,createStaticIndexBuffer:Ue,getNumChannels:function(){return 2===_e().getNumber("WEBGL_VERSION")?1:4},createTexture:lt,validateTextureSize:ft,createFramebuffer:At,bindVertexBufferToProgramAttribute:St,bindTextureUnit:Gt,unbindTextureUnit:function(e,t,n){kn(e,n),j(e,t,function(){return e.activeTexture(e.TEXTURE0+n)}),j(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})},getProgramUniformLocationOrThrow:Lt,getProgramUniformLocation:$t,bindTextureToProgramUniformSampler:zn,bindCanvasToFramebuffer:function(e,t){j(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),j(e,t,function(){return e.viewport(0,0,e.canvas.width,e.canvas.height)}),j(e,t,function(){return e.scissor(0,0,e.canvas.width,e.canvas.height)})},bindColorTextureToFramebuffer:En,unbindColorTextureFromFramebuffer:_n,validateFramebuffer:sr,getFramebufferErrorMessage:fn,getBatchDim:Gn,getRowsCols:cr,getShapeAs3D:Xr,getTextureShapeFromLogicalShape:Qi,isReshapeFree:kr,getWebGLMaxTextureSize:ko,resetMaxTextureSize:function(){J=null},resetMaxTexturesInShader:function(){ne=null},getMaxTexturesInShader:Oa,getWebGLDisjointQueryTimerVersion:Ms,hasExtension:$r,isWebGLVersionEnabled:Ba,isCapableOfRenderingToFloatTexture:rs,isDownloadFloatTextureEnabled:Sa,isWebGLFenceEnabled:za}),Yt=_e();function is(e){_e().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function ht(e,t){return P.tidy(e,t)}function b(e){no(e).forEach(function(t){return t.dispose()})}function _(e){return P.keep(e)}function L(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];_e().getBool("IS_TEST")||console.warn.apply(console,e)}function G(e,t){var n=e;if(wn(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];for(var a=[];Array.isArray(n)||wn(n)&&"string"!==t;)a.push(n.length),n=n[0];return Array.isArray(e)&&_e().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function s(c,d,f){if(f=f||[],Array.isArray(c)||wn(c)){ue(0<d.length,function(){return"Element arr["+f.join("][")+"] should be a primitive, but is an array of "+c.length+" elements"}),ue(c.length===d[0],function(){return"Element arr["+f.join("][")+"] should have "+d[0]+" elements, but has "+c.length+" elements"});for(var g=d.slice(1),m=0;m<c.length;++m)s(c[m],g,f.concat(m))}else ue(0===d.length,function(){return"Element arr["+f.join("][")+"] is a primitive, but should be an array/TypedArray of "+d[0]+" elements"})}(e,a,[]),a}function Z(e,t,n,a){if(null!=e&&("numeric"!==e&&e!==t||"numeric"===e&&"string"===t))throw new Error("Argument '"+n+"' passed to '"+a+"' must be "+e+" tensor, but got "+t+" tensor")}function D(e,t,n,a){if(void 0===a&&(a="numeric"),e instanceof rn)return Z(a,e.dtype,t,n),e;var s=Si(e);if("string"!==s&&0<=["bool","int32","float32"].indexOf(a)&&(s=a),Z(a,s,t,n),null==e||!wn(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+(null==e?"null":e.constructor.name)+"'");var d=G(e,s);wn(e)||Array.isArray(e)||(e=[e]);var f="string"!==s?di(e,s,_e().getBool("DEBUG")):Qt(e,[],!0);return P.makeTensor(f,d,s)}function ae(e,t,n,a){if(void 0===a&&(a="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(s,c){return D(s,t+"["+c+"]",n)},a)}function ke(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function we(e,t,n){for(var a=e.length+t.length,s=[],c=0,d=0,f=0;f<a;f++)-1===n.indexOf(f)?s.push(e[c++]):s.push(t[d++]);return s}function Ie(e,t){for(var n=[],a=e.length,s=0;s<a;s++)-1===t.indexOf(s)&&n.push(e[s]);return[n,t.map(function(c){return e[c]})]}function Oe(e,t){return we(e,t.map(function(n){return 1}),t)}function Ye(e,t,n){ue(ke(t,n),function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."})}function Ne(e,t){if(ke(e,t))return null;for(var n=[],a=0;a<t;++a)-1===e.indexOf(a)&&n.push(a);return e.forEach(function(s){return n.push(s)}),n}function et(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}function Ct(e,t){for(var n=[],a=t-e;a<t;++a)n.push(a);return n}function Xt(e,t){var n=e[0].length;e.forEach(function(s,c){ue(s.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+c+"] must be the same as the rank of the rest ("+n+")"})}),ue(0<=t&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var a=e[0];e.forEach(function(s,c){for(var d=0;d<n;d++)ue(d===t||s[d]===a[d],function(){return"Error in concat"+n+"D: Shape of tensors["+c+"] ("+s+") does not match the shape of the rest ("+a+") along the non-concatenated axis "+c+"."})})}function zt(e,t){for(var n=e[0].slice(),a=1;a<e.length;a++)n[t]+=e[a][t];return n}function ye(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],a=e[n];function s(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];P.startScope(n);try{var f=a.apply(void 0,c);return f instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),P.endScope(f),f}catch(g){throw P.endScope(null),g}}return n.endsWith("_")&&(n=n.substring(0,n.length-1)),Object.defineProperty(s,"name",{value:n,configurable:!0}),s}Yt.registerFlag("HAS_WEBGL",function(){return 0<Yt.getNumber("WEBGL_VERSION")}),Yt.registerFlag("WEBGL_VERSION",function(){return Ba(2)?2:Ba(1)?1:0}),Yt.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return 2===Yt.get("WEBGL_VERSION")}),Yt.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),Yt.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),Yt.registerFlag("WEBGL_PACK",function(){return Yt.getBool("HAS_WEBGL")}),Yt.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return Yt.getBool("WEBGL_PACK")}),Yt.registerFlag("WEBGL_PACK_CLIP",function(){return Yt.getBool("WEBGL_PACK")}),Yt.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),Yt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return Yt.getBool("WEBGL_PACK")}),Yt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return Yt.getBool("WEBGL_PACK")}),Yt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return Yt.getBool("WEBGL_PACK")}),Yt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return Yt.getBool("WEBGL_PACK")}),Yt.registerFlag("WEBGL_PACK_REDUCE",function(){return Yt.getBool("WEBGL_PACK")}),Yt.registerFlag("WEBGL_LAZILY_UNPACK",function(){return Yt.getBool("WEBGL_PACK")}),Yt.registerFlag("WEBGL_CONV_IM2COL",function(){return Yt.getBool("WEBGL_PACK")}),Yt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return ko(Yt.getNumber("WEBGL_VERSION"))}),Yt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return Oa(Yt.getNumber("WEBGL_VERSION"))}),Yt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=Yt.getNumber("WEBGL_VERSION");return 0===e?0:Ms(e)}),Yt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return 0<Yt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),Yt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return rs(Yt.getNumber("WEBGL_VERSION"))}),Yt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!Yt.getBool("WEBGL_FORCE_F16_TEXTURES")&&Yt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),Yt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return Sa(Yt.getNumber("WEBGL_VERSION"))}),Yt.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return za(Yt.getNumber("WEBGL_VERSION"))}),Yt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return Yt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),ua=is;var an=ye({complex_:function(e,t){var n=D(e,"real","complex"),a=D(t,"imag","complex");return z(n.shape,a.shape,"real and imag shapes, "+n.shape+" and "+a.shape+", must match in call to tf.complex()."),P.runKernelFunc(function(s){return s.complex(n,a)},{$real:n,$imag:a})}}),ir=ye({real_:function(e){var t=D(e,"input","real");return P.runKernelFunc(function(n){return n.real(t)},{$input:t})}}),gr=ye({imag_:function(e){var t=D(e,"input","imag");return P.runKernelFunc(function(n){return n.imag(t)},{$input:t})}});function Wt(e,t,n){return oi(e,t,G(e,n),n)}function oi(e,t,n,a){if(null==a&&(a=Si(e)),"complex64"===a)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!wn(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){ii(t);var s=mt(t),c=mt(n);ue(s===c,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+s+" values but has "+c});for(var d=0;d<n.length;++d){var g=d!==n.length-1||n[d]!==mt(t.slice(d));ue(n[d]===t[d]||!g,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "})}}return wn(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==a?di(e,a,_e().getBool("DEBUG")):Qt(e,[],!0),P.makeTensor(e,t,a)}function nt(e,t){if((wn(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&wn(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return oi(e,[],[],t)}function tn(e,t){Mn(e);var n=G(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return oi(e,null,n,t)}function vi(e,t,n){if(Mn(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var a=G(e,n);if(2!==a.length&&1!==a.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===a.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return oi(e,t,a,n)}function Wa(e,t,n){if(Mn(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var a=G(e,n);if(3!==a.length&&1!==a.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===a.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return oi(e,t,a,n)}function er(e,t,n){if(Mn(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");var a=G(e,n);if(4!==a.length&&1!==a.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===a.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return oi(e,t,a,n)}function ro(e,t,n){if(Mn(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");var a=G(e,n);if(5!==a.length&&1!==a.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===a.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return oi(e,t,a,n)}function Kr(e,t,n){if(Mn(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");var a=G(e,n);if(6!==a.length&&1!==a.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===a.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return oi(e,t=t||a,a,n)}function Zr(e,t,n,a){return void 0===t&&(t=!0),P.makeVariable(e,t,n,a)}function _i(e,t){if(void 0===t&&(t="float32"),"complex64"===t){var n=_i(e,"float32"),a=sn(e,"float32");return an(n,a)}var s=Da(mt(e),t);return P.makeTensor(s,e,t)}function sn(e,t){if(void 0===t&&(t="float32"),"complex64"===t){var n=sn(e,"float32"),a=sn(e,"float32");return an(n,a)}var s=wa(mt(e),t);return P.makeTensor(s,e,t)}function Wn(e,t,n){return P.runKernelFunc(function(a){return a.fill(e,t,n)},{})}function fr(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return P.runKernelFunc(function(a){return a.linspace(e,t,n)},{})}function Ar(e,t,n,a){if(void 0===n&&(n=1),void 0===a&&(a="float32"),0===n)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&1<n)return sn([0],a);var s=wa(Math.abs(Math.ceil((t-e)/n)),a);t<e&&1===n&&(n=-1),s[0]=e;for(var c=1;c<s.length;c++)s[c]=s[c-1]+n;return tn(s,a)}var ea=ye({onesLike_:function(e){var t=D(e,"x","onesLike");if("complex64"!==t.dtype)return P.runKernelFunc(function(s){return s.onesLike(t)},{$x:t},function(s,c){return{$x:function(){return Vt(s)}}});var n=ea(ir(t)),a=Vt(gr(t));return an(n,a)}}),Vt=ye({zerosLike_:function(e){var t=D(e,"x","zerosLike");return P.runKernelFunc(function(n){return n.zerosLike(t)},{$x:t},function(n,a){return{$x:function(){return Vt(n)}}})}}),vt=ye({concat_:function(e,t){void 0===t&&(t=0),ue(1<=e.length,function(){return"Pass at least one tensor to concat"});var n=ae(e,"tensors","concat");"complex64"===n[0].dtype&&n.forEach(function(f){if("complex64"!==f.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype "+f.dtype+". ")}),t=Nn(t,n[0].shape)[0];var a=zt(n.map(function(f){return f.shape}),t);if(0===mt(a))return Wt([],a);if(1===(n=n.filter(function(f){return 0<f.size})).length)return n[0];var s=n.map(function(f){return f.shape});return Xt(s,t),P.runKernelFunc(function(f){return f.concat(n,t)},n,function(f){var g=s.map(function(m){return m[t]});return ta(f,g,t).map(function(m){return function(){return m}})},"Concat",{axis:t})}}),ur=ye({concat1d_:function(e){return vt(e,0)}}),hr=ye({concat2d_:function(e,t){return vt(e,t)}}),pn=ye({concat3d_:function(e,t){return vt(e,t)}}),Ii=ye({concat4d_:function(e,t){return vt(e,t)}}),ta=ye({split_:function(e,t,n){void 0===n&&(n=0);var a,s=D(e,"x","split");return n=Nn(n,s.shape)[0],a="number"==typeof t?(ue(s.shape[n]%t==0,function(){return"Number of splits must evenly divide the axis."}),new Array(t).fill(s.shape[n]/t)):(ue(s.shape[n]===t.reduce(function(c,d){return c+d}),function(){return"The sum of sizes must match the size of the axis dimension."}),t),P.runKernelFunc(function(c){return c.split(s,a,n)},{$x:s},function(c){return{$x:function(){return vt(c,n)}}})}});function Hi(e,t){return e(t={exports:{}},t.exports),t.exports}var Ha=Hi(function(e){!function(t,n){function a(d){var f,g=this,m=(f=4022871197,function(w){w=w.toString();for(var A=0;A<w.length;A++){var T=.02519603282416938*(f+=w.charCodeAt(A));T-=f=T>>>0,f=(T*=f)>>>0,f+=4294967296*(T-=f)}return 2.3283064365386963e-10*(f>>>0)});g.next=function(){var w=2091639*g.s0+2.3283064365386963e-10*g.c;return g.s0=g.s1,g.s1=g.s2,g.s2=w-(g.c=0|w)},g.c=1,g.s0=m(" "),g.s1=m(" "),g.s2=m(" "),g.s0-=m(d),g.s0<0&&(g.s0+=1),g.s1-=m(d),g.s1<0&&(g.s1+=1),g.s2-=m(d),g.s2<0&&(g.s2+=1),m=null}function s(d,f){return f.c=d.c,f.s0=d.s0,f.s1=d.s1,f.s2=d.s2,f}function c(d,f){var g=new a(d),m=f&&f.state,w=g.next;return w.int32=function(){return 4294967296*g.next()|0},w.double=function(){return w()+11102230246251565e-32*(2097152*w()|0)},w.quick=w,m&&("object"==typeof m&&s(m,g),w.state=function(){return s(g,{})}),w}n&&n.exports?n.exports=c:this.alea=c}(0,e)}),Ns=Hi(function(e){!function(t,n){function a(d){var f=this,g="";f.x=0,f.y=0,f.z=0,f.w=0,f.next=function(){var w=f.x^f.x<<11;return f.x=f.y,f.y=f.z,f.z=f.w,f.w^=f.w>>>19^w^w>>>8},d===(0|d)?f.x=d:g+=d;for(var m=0;m<g.length+64;m++)f.x^=0|g.charCodeAt(m),f.next()}function s(d,f){return f.x=d.x,f.y=d.y,f.z=d.z,f.w=d.w,f}function c(d,f){function g(){return(m.next()>>>0)/4294967296}var m=new a(d),w=f&&f.state;return g.double=function(){do{var A=((m.next()>>>11)+(m.next()>>>0)/4294967296)/2097152}while(0===A);return A},g.int32=m.next,g.quick=g,w&&("object"==typeof w&&s(w,m),g.state=function(){return s(m,{})}),g}n&&n.exports?n.exports=c:this.xor128=c}(0,e)}),fa=Hi(function(e){!function(t,n){function a(d){var f=this,g="";f.next=function(){var w=f.x^f.x>>>2;return f.x=f.y,f.y=f.z,f.z=f.w,f.w=f.v,(f.d=f.d+362437|0)+(f.v=f.v^f.v<<4^w^w<<1)|0},f.x=0,f.y=0,f.z=0,f.w=0,d===((f.v=0)|d)?f.x=d:g+=d;for(var m=0;m<g.length+64;m++)f.x^=0|g.charCodeAt(m),m==g.length&&(f.d=f.x<<10^f.x>>>4),f.next()}function s(d,f){return f.x=d.x,f.y=d.y,f.z=d.z,f.w=d.w,f.v=d.v,f.d=d.d,f}function c(d,f){function g(){return(m.next()>>>0)/4294967296}var m=new a(d),w=f&&f.state;return g.double=function(){do{var A=((m.next()>>>11)+(m.next()>>>0)/4294967296)/2097152}while(0===A);return A},g.int32=m.next,g.quick=g,w&&("object"==typeof w&&s(w,m),g.state=function(){return s(m,{})}),g}n&&n.exports?n.exports=c:this.xorwow=c}(0,e)}),Eo=Hi(function(e){!function(t,n){function a(d){var f=this;f.next=function(){var g,m,w=f.x,A=f.i;return g=w[A],m=(g^=g>>>7)^g<<24,m^=(g=w[A+1&7])^g>>>10,m^=(g=w[A+3&7])^g>>>3,m^=(g=w[A+4&7])^g<<7,g=w[A+7&7],m^=(g^=g<<13)^g<<9,w[A]=m,f.i=A+1&7,m},function(g,m){var w,A=[];if(m===(0|m))A[0]=m;else for(m=""+m,w=0;w<m.length;++w)A[7&w]=A[7&w]<<15^m.charCodeAt(w)+A[w+1&7]<<13;for(;A.length<8;)A.push(0);for(w=0;w<8&&0===A[w];++w);for(8==w&&(A[7]=-1),g.x=A,g.i=0,w=256;0<w;--w)g.next()}(f,d)}function s(d,f){return f.x=d.x.slice(),f.i=d.i,f}function c(d,f){function g(){return(m.next()>>>0)/4294967296}null==d&&(d=+new Date);var m=new a(d),w=f&&f.state;return g.double=function(){do{var A=((m.next()>>>11)+(m.next()>>>0)/4294967296)/2097152}while(0===A);return A},g.int32=m.next,g.quick=g,w&&(w.x&&s(w,m),g.state=function(){return s(m,{})}),g}n&&n.exports?n.exports=c:this.xorshift7=c}(0,e)}),_o=Hi(function(e){!function(t,n){function a(d){var f=this;f.next=function(){var g,m,w=f.w,A=f.X,T=f.i;return f.w=w=w+1640531527|0,m=A[T+34&127],g=A[T=T+1&127],m^=m<<13,g^=g<<17,m=A[T]=(m^=m>>>15)^(g^=g>>>12),f.i=T,m+(w^w>>>16)|0},function(g,m){var w,A,T,M,O,V=[],H=128;for(m===(0|m)?(A=m,m=null):(m+="\0",A=0,H=Math.max(H,m.length)),T=0,M=-32;M<H;++M)m&&(A^=m.charCodeAt((M+32)%m.length)),0===M&&(O=A),A^=A<<10,A^=A>>>15,A^=A<<4,A^=A>>>13,0<=M&&(T=0==(w=V[127&M]^=A+(O=O+1640531527|0))?T+1:0);for(128<=T&&(V[127&(m&&m.length||0)]=-1),T=127,M=512;0<M;--M)A=V[T+34&127],w=V[T=T+1&127],A^=A<<13,w^=w<<17,V[T]=(A^=A>>>15)^(w^=w>>>12);g.w=O,g.X=V,g.i=T}(f,d)}function s(d,f){return f.i=d.i,f.w=d.w,f.X=d.X.slice(),f}function c(d,f){function g(){return(m.next()>>>0)/4294967296}null==d&&(d=+new Date);var m=new a(d),w=f&&f.state;return g.double=function(){do{var A=((m.next()>>>11)+(m.next()>>>0)/4294967296)/2097152}while(0===A);return A},g.int32=m.next,g.quick=g,w&&(w.X&&s(w,m),g.state=function(){return s(m,{})}),g}n&&n.exports?n.exports=c:this.xor4096=c}(0,e)}),as=Hi(function(e){!function(t,n){function a(d){var f=this,g="";f.next=function(){var w=f.b,A=f.c,T=f.d,M=f.a;return w=w<<25^w>>>7^A,A=A-T|0,T=T<<24^T>>>8^M,M=M-w|0,f.b=w=w<<20^w>>>12^A,f.c=A=A-T|0,f.d=T<<16^A>>>16^M,f.a=M-w|0},f.a=0,f.b=0,f.c=-1640531527,f.d=1367130551,d===Math.floor(d)?(f.a=d/4294967296|0,f.b=0|d):g+=d;for(var m=0;m<g.length+20;m++)f.b^=0|g.charCodeAt(m),f.next()}function s(d,f){return f.a=d.a,f.b=d.b,f.c=d.c,f.d=d.d,f}function c(d,f){function g(){return(m.next()>>>0)/4294967296}var m=new a(d),w=f&&f.state;return g.double=function(){do{var A=((m.next()>>>11)+(m.next()>>>0)/4294967296)/2097152}while(0===A);return A},g.int32=m.next,g.quick=g,w&&("object"==typeof w&&s(w,m),g.state=function(){return s(m,{})}),g}n&&n.exports?n.exports=c:this.tychei=c}(0,e)}),Xi=Hi(function(e){!function(t,n){var a,s=this,c=256,f="random",g=n.pow(c,6),m=n.pow(2,52),w=2*m,A=c-1;function T(X,$,ee){function re(){for(var ie=se.g(6),ce=g,he=0;ie<m;)ie=(ie+he)*c,ce*=c,he=se.g(1);for(;w<=ie;)ie/=2,ce/=2,he>>>=1;return(ie+he)/ce}var te=[],le=V(function ie(ce,he){var be,Ae=[],Te=typeof ce;if(he&&"object"==Te)for(be in ce)try{Ae.push(ie(ce[be],he-1))}catch{}return Ae.length?Ae:"string"==Te?ce:ce+"\0"}(($=1==$?{entropy:!0}:$||{}).entropy?[X,H(t)]:X??function(){try{var ie;return a&&(ie=a.randomBytes)?ie=ie(c):(ie=new Uint8Array(c),(s.crypto||s.msCrypto).getRandomValues(ie)),H(ie)}catch{var ce=s.navigator,he=ce&&ce.plugins;return[+new Date,s,he,s.screen,H(t)]}}(),3),te),se=new M(te);return re.int32=function(){return 0|se.g(4)},re.quick=function(){return se.g(4)/4294967296},re.double=re,V(H(se.S),t),($.pass||ee||function(ie,ce,he,be){return be&&(be.S&&O(be,se),ie.state=function(){return O(se,{})}),he?(n[f]=ie,ce):ie})(re,le,"global"in $?$.global:this==n,$.state)}function M(X){var $,ee=X.length,re=this,te=0,le=re.i=re.j=0,se=re.S=[];for(ee||(X=[ee++]);te<c;)se[te]=te++;for(te=0;te<c;te++)se[te]=se[le=A&le+X[te%ee]+($=se[te])],se[le]=$;(re.g=function(ie){for(var ce,he=0,be=re.i,Ae=re.j,Te=re.S;ie--;)ce=Te[be=A&be+1],he=he*c+Te[A&(Te[be]=Te[Ae=A&Ae+ce])+(Te[Ae]=ce)];return re.i=be,re.j=Ae,he})(c)}function O(X,$){return $.i=X.i,$.j=X.j,$.S=X.S.slice(),$}function V(X,$){for(var ee,re=X+"",te=0;te<re.length;)$[A&te]=A&(ee^=19*$[A&te])+re.charCodeAt(te++);return H($)}function H(X){return String.fromCharCode.apply(0,X)}if(n["seed"+f]=T,V(n.random(),t),e.exports){e.exports=T;try{a=require("crypto")}catch{}}}([],Math)});Xi.alea=Ha,Xi.xor128=Ns,Xi.xorwow=fa,Xi.xorshift7=Eo,Xi.xor4096=_o,Xi.tychei=as;var io=Xi.alea,ao=(fe.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,a=!1;!a;){for(var s=void 0,c=void 0,d=void 0;1<=(d=(s=2*this.random()-1)*s+(c=2*this.random()-1)*c)||0===d;);var f=Math.sqrt(-2*Math.log(d)/d);t=this.mean+this.stdDev*s*f,n=this.mean+this.stdDev*c*f,this.truncated&&!this.isValidTruncated(t)||(a=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)},fe.prototype.convertValue=function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)},fe.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},fe),os=(Xa.prototype.nextValue=function(){for(var e,t,n,a,s,c;;){for(;a=this.randn.nextValue(),(c=1+this.c*a)<=0;);if(t=1-.331*(e=a*a)*e,n=.5*e+this.d*(1-(c*=c*c)+Math.log(c)),(s=this.randu())<t||Math.log(s)<n)break}return c*=1/this.beta*this.d,this.alpha<1&&(c*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(c)},Xa.prototype.convertValue=function(e){return"float32"===this.dtype?e:Math.round(e)},Xa),ss=(oo.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},oo.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},oo);function oo(e,t,n,a){var s=this;if(void 0===e&&(e=0),void 0===t&&(t=1),this.canReturnFloat=function(){return null==s.dtype||"float32"===s.dtype},this.min=e,this.range=t-e,this.dtype=n,null==a&&(a=Math.random()),"number"==typeof a&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+t+" <= 1 and dtype is not float");this.random=io(a)}function Xa(e,t,n,a){this.alpha=e,this.beta=1/t,this.dtype=n;var s=a||Math.random();this.randu=io(s.toString()),this.randn=new ao(0,1,n,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}function fe(e,t,n,a,s){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var c=s||Math.random();this.random=io(c.toString())}function xe(e,t,n){return void 0===t&&(t="float32"),t=t||"float32",ii(e),new Li(e,t,n)}function ze(e,t){void 0===t&&(t=!1),console.log(e.toString(t))}function je(e,t){return F(this,void 0,void 0,function(){var n,a,s,c,d,f,g,m,w,A;return de(this,function(T){switch(T.label){case 0:return n=D(e,"x","setdiff1d"),a=D(t,"y","setdiff1d"),ue(n.dtype===a.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+a.dtype+")."}),ue(1===n.rank,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),ue(1===a.rank,function(){return"y should be 1D tensor, but got y ("+a.shape+")."}),[4,n.data()];case 1:return s=T.sent(),[4,a.data()];case 2:for(c=T.sent(),d=new Set(c),w=f=0;w<s.length;w++)d.has(s[w])||f++;for(g=new Li([f],n.dtype),m=new Li([f],"int32"),A=w=0;w<s.length;w++)d.has(s[w])||(g.values[A]=s[w],m.values[A]=w,A++);return[2,[g.toTensor(),m.toTensor()]]}})})}var Qe=ye({batchToSpaceND_:function(e,t,n){var a=D(e,"x","batchToSpaceND"),s=t.reduce(function(c,d){return c*d});return ue(a.rank>=1+t.length,function(){return"input rank is "+a.rank+" but should be > than blockShape.length "+t.length}),ue(n.length===t.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length}),ue(a.shape[0]%s==0,function(){return"input tensor batch is "+a.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+s}),P.runKernelFunc(function(c){return c.batchToSpaceND(a,t,n)},{$x:a},function(c){return{$x:function(){return c.spaceToBatchND(t,n)}}})}}),bt=ye({broadcastTo_:function(e,t){var n=D(e,"broadcastTo","x"),a=n.shape;if(t.some(function(g){return!(0<g)||g%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var s=n.shape.slice();s.length<t.length;)s.unshift(1);n=n.reshape(s)}for(var c=Array.from(t),d=t.length-1;0<=d;d--)if(n.shape[d]===t[d])c[d]=1;else if(1!==n.shape[d])throw new Error("broadcastTo(): ["+a+"] cannot be broadcast to ["+t+"].");var f=c.map(function(g,m){return 1<g?m:-1}).filter(function(g){return 0<=g});return 0===f.length?n.clone():P.runKernelFunc(function(g){return g.tile(n,c)},{input:n},function(g){return{input:function(){return g.sum(f,!0)}}})}}),yt=ye({cast_:function(e,t){var n=D(e,"x","cast");if(!Rr(t))throw new Error("Failed to cast to unknown dtype "+t);if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");return P.runKernelFunc(function(s){return s.cast(n,t)},{x:n},function(s){return{x:function(){return s.clone()}}},"Cast",{dtype:t})}}),Pt=ye({clone_:function(e){var t=D(e,"x","clone",null);return P.runKernelFunc(function(){return P.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(n){return{$x:function(){return n.toFloat()}}})}}),wt=ye({cumsum_:function(e,t,n,a){void 0===t&&(t=0),void 0===n&&(n=!1),void 0===a&&(a=!1);var s=D(e,"x","cumsum"),c=Ne([t|=0],s.rank),d=s;null!=c&&(d=s.transpose(c));var f=Ct(1,s.rank)[0],g=P.runKernelFunc(function(m){return m.cumsum(d,f,n,a)},{permutedX:d},function(m){return{permutedX:function(){return m.cumsum(t,n,!a)}}});return null!=c&&(g=g.transpose(c)),g}}),An=ye({depthToSpace_:function(e,t,n){void 0===n&&(n="NHWC");var a=D(e,"x","depthToSpace"),s="NHWC"===n?a.shape[1]:a.shape[2],c="NHWC"===n?a.shape[2]:a.shape[3],d="NHWC"===n?a.shape[3]:a.shape[1];return ue(0<=s*t,function(){return"Negative dimension size caused by overflow when multiplying\n      "+s+" and "+t+"  for depthToSpace with input shape\n      "+a.shape}),ue(0<=c*t,function(){return"Negative dimension size caused by overflow when multiplying\n      "+c+" and "+t+" for depthToSpace with input shape\n          "+a.shape}),ue(d%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+d+" for depthToSpace with input shape "+a.shape}),P.runKernelFunc(function(f){return f.depthToSpace(a,t,n)},{$x:a})}}),Bt=ye({expandDims_:function(e,t){void 0===t&&(t=0);var n=D(e,"x","expandDims",null);ue(t<=n.rank,function(){return"Axis must be <= rank of the tensor"});var a=n.shape.slice();return t<0&&(ue(-(n.rank+1)<=t,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),t=n.rank+t+1),a.splice(t,0,1),Gr(n,a)}}),Kt=ye({eye_:function(e,t,n,a){void 0===a&&(a="float32"),null==t&&(t=e);for(var s=xe([e,t],a),c=e<=t?e:t,d=0;d<c;++d)s.set(1,d,d);var f=s.toTensor().as2D(e,t);if(null==n)return f;if(1===n.length)return Ro(Bt(f,0),[n[0],1,1]);if(2===n.length)return Ro(Bt(Bt(f,0),0),[n[0],n[1],1,1]);if(3===n.length)return Ro(Bt(Bt(Bt(f,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),mn=ye({multinomial_:function(e,t,n,a){void 0===a&&(a=!1);var s=D(e,"logits","multinomial"),c=s.size,d=s.rank;if(c<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+c+".");if(2<d)throw new Error("Rank of probabilities must be 1 or 2, but is "+d);n=n||Math.random();var f=1===d?s.as2D(1,-1):s,g=P.runKernelFunc(function(m){return m.multinomial(f,a,t,n)},{logits2D:f});return 1===d?g.as1D():g}}),Ht=ye({oneHot_:function(e,t,n,a){if(void 0===n&&(n=1),void 0===a&&(a=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var s=D(e,"indices","oneHot","int32"),c=s.shape.concat([t]);return s=s.flatten(),P.runKernelFunc(function(d){return d.oneHot(s,t,n,a)},{$indices:s},function(d){return{$indices:function(){return sn(s.shape,"float32")}}}).reshape(c)}}),Vn=ye({pad_:function(e,t,n){void 0===n&&(n=0);var a=D(e,"x","pad");if(0===a.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");return P.runKernelFunc(function(c){return c.pad(a,t,n)},{x:a},function(c){var d=t.map(function(f){return f[0]});return{x:function(){return c.slice(d,a.shape)}}},"PadV2",{paddings:t,constantValue:n})}}),Sr=ye({pad1d_:function(e,t,n){return void 0===n&&(n=0),ue(2===t.length,function(){return"Invalid number of paddings. Must be length of 2."}),Vn(e,[t],n)}}),Er=ye({pad2d_:function(e,t,n){return void 0===n&&(n=0),ue(2===t.length&&2===t[0].length&&2===t[1].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Vn(e,t,n)}}),Jr=ye({pad3d_:function(e,t,n){return void 0===n&&(n=0),ue(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Vn(e,t,n)}}),vr=ye({pad4d_:function(e,t,n){return void 0===n&&(n=0),ue(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Vn(e,t,n)}}),mr=ye({rand_:function(e,t,n){var a=mt(e),s=null;if(null==n||"float32"===n)s=new Float32Array(a);else if("int32"===n)s=new Int32Array(a);else{if("bool"!==n)throw new Error("Unknown data type "+n);s=new Uint8Array(a)}for(var c=0;c<a;c++)s[c]=t();return P.makeTensor(s,e,n)}}),Yn=ye({randomNormal_:function(e,t,n,a,s){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=a&&"bool"===a)throw new Error("Unsupported data type "+a);for(var c=new ao(t,n,a,!1,s),d=xe(e,a),f=0;f<d.values.length;f++)d.values[f]=c.nextValue();return d.toTensor()}}),Ea=ye({randomGamma_:function(e,t,n,a,s){if(void 0===n&&(n=1),void 0===a&&(a="float32"),null==n&&(n=1),null==a&&(a="float32"),"float32"!==a&&"int32"!==a)throw new Error("Unsupported data type "+a);for(var c=new os(t,n,a,s),d=xe(e,a),f=0;f<d.values.length;f++)d.values[f]=c.nextValue();return d.toTensor()}}),si=ye({randomUniform_:function(e,t,n,a,s){void 0===t&&(t=0),void 0===n&&(n=1),void 0===a&&(a="float32");for(var c=xe(e,a),d=new ss(t,n,null,s),f=0;f<c.values.length;f++)c.values[f]=d.nextValue();return c.toTensor()}}),Gr=ye({reshape_:function(e,t){var n=D(e,"x","reshape",null);return t=ri(t,n.size),ue(n.size===mt(t),function(){return"new shape and old shape must have the same number of elements."}),P.runKernelFunc(function(s){return s.reshape(n,t)},{x:n},function(s){return{x:function(){return s.reshape(n.shape)}}},"Reshape",{shape:t})}}),Io=ye({spaceToBatchND_:function(e,t,n){var a=D(e,"x","spaceToBatchND");return ue(a.rank>=1+t.length,function(){return"input rank "+a.rank+" should be > than [blockShape] "+t.length}),ue(n.length===t.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length}),ue(a.shape.reduce(function(s,c,d){return 0<d&&d<=t.length?s&&(c+n[d-1][0]+n[d-1][1])%t[d-1]==0:s},!0),function(){return"input spatial dimensions "+a.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()}),P.runKernelFunc(function(s){return s.spaceToBatchND(a,t,n)},{$x:a},function(s){return{$x:function(){return s.batchToSpaceND(t,n)}}})}}),To=ye({squeeze_:function(e,t){var n=D(e,"x","squeeze");return Gr(n,Je(n.shape,t).newShape)}}),li=ye({stack_:function(e,t){void 0===t&&(t=0);var n=ae(e,"tensors","stack");if(ue(1<=n.length,function(){return"Pass at least one tensor to tf.stack"}),1===n.length)return n[0].expandDims(t);var s=n[0].shape,c=n[0].dtype;ue(t<=n[0].rank,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(f){z(s,f.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(f){ue(c===f.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var d=n.map(function(f){return f.expandDims(t)});return vt(d,t)}}),Ro=ye({tile_:function(e,t){var n=D(e,"x","tile",null);return ue(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."}),P.runKernelFunc(function(c,d){var f=c.tile(n,t);return d([n]),f},{x:n},function(c,d){var f=d[0];return{x:function(){var g=Vt(f);if(1===f.rank)for(var m=0;m<t[0];++m)g=g.add(c.slice([m*f.shape[0]],[f.shape[0]]));else if(2===f.rank)for(m=0;m<t[0];++m)for(var w=0;w<t[1];++w)g=g.add(c.slice([m*f.shape[0],w*f.shape[1]],[f.shape[0],f.shape[1]]));else if(3===f.rank)for(m=0;m<t[0];++m)for(w=0;w<t[1];++w)for(var A=0;A<t[2];++A)g=g.add(c.slice([m*f.shape[0],w*f.shape[1],A*f.shape[2]],[f.shape[0],f.shape[1],f.shape[2]]));else{if(4!==f.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+f.rank+" tensors yet.");for(m=0;m<t[0];++m)for(w=0;w<t[1];++w)for(A=0;A<t[2];++A)for(var T=0;T<t[3];++T)g=g.add(c.slice([m*f.shape[0],w*f.shape[1],A*f.shape[2],T*f.shape[3]],[f.shape[0],f.shape[1],f.shape[2],f.shape[3]]))}return g}}},"Tile",{reps:t},[n])}}),Fc=ye({truncatedNormal_:function(e,t,n,a,s){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=a&&"bool"===a)throw new Error("Unsupported data type "+a);for(var c=new ao(t,n,a,!0,s),d=xe(e,a),f=0;f<d.values.length;f++)d.values[f]=c.nextValue();return d.toTensor()}}),_r=ye({unstack_:function(e,t){void 0===t&&(t=0),t=t||0;var n=D(e,"x","unstack");return ue(t>=-n.shape.length&&t<n.shape.length,function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),t<0&&(t+=n.shape.length),P.runKernelFunc(function(s){return s.unstack(n,t)},{x:n},function(s){return{x:function(){return li(s,t)}}},"Unpack",{axis:t})}});function Ls(e,t,n,a){void 0===a&&(a=!0);var s=[];if(a)(s=s.concat(t.slice(0))).push(e[0]/n),s=s.concat(e.slice(1));else{s=s.concat(e[0]);for(var c=t.length,d=0;d<c;++d)s=s.concat([e[d+1]/t[d],t[d]]);s=s.concat(e.slice(c+1))}return s}function rl(e,t,n){void 0===n&&(n=!0);var a=[];if(n){a.push(t);for(var s=t+1;s<e;++s)s<=2*t?(a.push(s),a.push(s-(t+1))):a.push(s)}else{var c=[],d=[];for(s=1;s<e;++s)2*t+1<=s||s%2==1?d.push(s):c.push(s);a.push.apply(a,c),a.push(0),a.push.apply(a,d)}return a}function il(e,t,n,a){void 0===a&&(a=!0);var s=[];s.push(a?e[0]/n:e[0]*n);for(var c=1;c<e.length;++c)s.push(c<=t.length?a?t[c-1]*e[c]:e[c]/t[c-1]:e[c]);return s}function Oc(e,t){for(var n=[0],a=0;a<t;++a)n.push(e[a][0]);return n}function Bc(e,t,n){for(var a=e.slice(0,1),s=0;s<n;++s)a.push(e[s+1]-t[s][0]-t[s][1]);return a}function Vl(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(0===e.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,a=n[n.length-1],s=1,c=0;c<n.length-1;++c)s*=n[c];var d=e.shape,f=n.slice();f.pop();var g=1;for(c=a;c<e.rank;++c)g*=d[c],f.push(d[c]);var m=yr(e.shape).map(function(w){return w/g}).concat([1]).slice(0,a);return[f,s,g,m]}var Ga=Object.freeze({prepareAndValidate:Vl});function Fs(e){return e<=30?e:ca(e,Math.floor(Math.sqrt(e)))}function zc(e,t,n){var a=1<t.rank?t.shape[t.rank-1]:1,s=1<t.rank?t.rank-1:1,c="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+a+", and batchDim: "+s+".";if(n.rank<s)throw new Error(c+" update.rank < "+s+". ");if(e.length<a+(n.rank-s))throw new Error(c+" Output shape length < "+(a+(n.rank-s)));if(n.rank!==s+e.length-a)throw new Error(c+" update.rank != "+(s+e.length-a));for(var d=0;d<s;++d)if(n.shape[d]!==t.shape[d])throw new Error(c+" updates.shape["+d+"] ("+n.shape[d]+") != indices.shape["+d+"] ("+t.shape[d]+").");for(d=0;d<n.rank-s;++d)if(n.shape[d+s]!==e[d+a])throw new Error(c+" updates.shape["+(d+s)+"] ("+n.shape[d+s]+") != shape["+(d+s)+"] ("+e[d+s]+")")}function Wc(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(0===e.size)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}zc(n,t,e)}function Os(e,t,n){for(var a=t.shape.length,s=1<a?t.shape[a-1]:1,c=n.length,d=1,f=s;f<c;++f)d*=n[f];var g=s<1?1:s;return{sliceRank:s,numUpdates:mt(t.shape)/g,sliceSize:d,strides:yr(n.slice(0,s)).concat([1]),outputSize:mt(n)}}var dh=Object.freeze({validateUpdateShape:zc,validateInput:Wc,calculateShapes:Os});function Hc(e,t,n){ue(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."}),ue(e.rank===n.length,function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."});for(var a=function(c){ue(t[c]+n[c]<=e.shape[c],function(){return"Error in slice"+e.rank+"D: begin["+c+"] + size["+c+"] ("+(t[c]+n[c])+") would overflow input.shape["+c+"] ("+e.shape[c]+")"})},s=0;s<e.rank;++s)a(s)}function Yl(e){for(var t=[],n=0;0<e;)1&e&&t.push(n),e/=2,n++;return t}function al(e,t,n){for(var a=[],s=0;s<e.length;s++)a[s]=Math.ceil((t[s]-e[s])/n[s]);return a}function Xc(e,t,n,a,s){var c=t[s];(e&1<<s||null==c)&&(c=0<(n[s]||1)?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var f=a[s];return c<0&&(c+=f),On(0,c,f-1)}function ol(e,t,n,a,s){var c=t[s],d=n[s]||1;(e&1<<s||null==c)&&(c=0<d?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var f=a[s];return c<0&&(c+=f),0<d?On(0,c,f):On(-1,c,f-1)}function ls(e,t,n){for(var a=n.length,s=0;s<n.length;s++)if(1<n[s]){a=s;break}for(s=a+1;s<n.length;s++)if(0<t[s]||n[s]!==e[s])return!1;return!0}function sl(e,t){for(var n=0<e.length?e[e.length-1]:1,a=0;a<e.length-1;a++)n+=e[a]*t[a];return n}var Gc=Object.freeze({assertParamsValid:Hc,maskToAxes:Yl,computeOutShape:al,startForAxis:Xc,stopForAxis:ol,isSliceContinous:ls,computeFlatOffset:sl});function cs(e,t){ue(Br(e),function(){return"The f passed in variableGrads(f) must be a function"}),ue(null==t||Array.isArray(t)&&t.every(function(w){return w instanceof Ei}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=null!=t;if(!n)for(var a in t=[],P.registeredVariables)t.push(P.registeredVariables[a]);var s=n?t.filter(function(w){return!w.trainable}):null,c=t.length;ue(0<(t=t.filter(function(w){return w.trainable})).length,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+c+" variables is trainable."});var d=P.gradients(e,t,null,!0),f=d.value,g=d.grads;ue(g.some(function(w){return null!=w}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),ue(0===f.rank,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+f.rank+" tensor"});var m={};return t.forEach(function(w,A){null!=g[A]&&(m[w.name]=g[A])}),s?.forEach(function(w){return m[w.name]=null}),{value:f,grads:m}}function Do(e){return P.customGrad(e)}function ll(e){if(0<e.filter(function(t){return null==t}).length)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}var _a=ye({softmax_:function(e,t){void 0===t&&(t=-1);var n=D(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return P.runKernelFunc(function(a,s){var c=a.softmax(n,t);return s([c]),c},{logits:n},function(a,s){var c=s[0],d=a.mul(c);return{logits:function(){return d.sub(d.sum([t],!0).mul(c))}}},"Softmax",{dim:t},[],[!0])}}),Vc=ye({logSoftmax_:function(e,t){void 0===t&&(t=-1);var n=D(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return Do(function(a,s){var c=a.max(t,!0),d=a.sub(c),f=d.toFloat().sub(d.exp().sum(t,!0).log());return s([f]),{value:f,gradFunc:function(g,m){var w=m[0].exp();return g.sub(g.sum(t,!0).mul(w))}}})(n)}}),Va=(Ya.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)},Ya.prototype.set=function(e,t){this.dataIdsCount++,this.data.set(e,t)},Ya.prototype.has=function(e){return this.data.has(e)},Ya.prototype.delete=function(e){return this.dataIdsCount--,this.data.delete(e)},Ya.prototype.numDataIds=function(){return this.dataIdsCount},Ya),jl=(Xe.prototype.time=function(e){return Ge("time")},Xe.prototype.read=function(e){return Ge("read")},Xe.prototype.readSync=function(e){return Ge("readSync")},Xe.prototype.numDataIds=function(){return Ge("numDataIds")},Xe.prototype.disposeData=function(e){return Ge("disposeData")},Xe.prototype.write=function(e,t,n){return Ge("write")},Xe.prototype.move=function(e,t,n,a){return Ge("move")},Xe.prototype.memory=function(){return Ge("memory")},Xe.prototype.floatPrecision=function(){return Ge("floatPrecision")},Xe.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},Xe.prototype.batchMatMul=function(e,t,n,a){return Ge("batchMatMul")},Xe.prototype.fusedBatchMatMul=function(e){return Ge("fusedBatchMatMul")},Xe.prototype.slice=function(e,t,n){return Ge("slice")},Xe.prototype.stridedSlice=function(e,t,n,a){return Ge("stridedSlice")},Xe.prototype.unstack=function(e,t){return Ge("unstack")},Xe.prototype.reverse=function(e,t){return Ge("reverse")},Xe.prototype.concat=function(e,t){return Ge("concat")},Xe.prototype.neg=function(e){return Ge("neg")},Xe.prototype.add=function(e,t){return Ge("add")},Xe.prototype.addN=function(e){return Ge("addN")},Xe.prototype.subtract=function(e,t){return Ge("subtract")},Xe.prototype.multiply=function(e,t){return Ge("multiply")},Xe.prototype.realDivide=function(e,t){return Ge("realDivide")},Xe.prototype.floorDiv=function(e,t){return Ge("floorDiv")},Xe.prototype.sum=function(e,t){return Ge("sum")},Xe.prototype.prod=function(e,t){return Ge("prod")},Xe.prototype.unsortedSegmentSum=function(e,t,n){return Ge("unsortedSegmentSum")},Xe.prototype.argMin=function(e,t){return Ge("argMin")},Xe.prototype.argMax=function(e,t){return Ge("argMax")},Xe.prototype.equal=function(e,t){return Ge("equal")},Xe.prototype.notEqual=function(e,t){return Ge("notEqual")},Xe.prototype.less=function(e,t){return Ge("less")},Xe.prototype.lessEqual=function(e,t){return Ge("lessEqual")},Xe.prototype.greater=function(e,t){return Ge("greater")},Xe.prototype.greaterEqual=function(e,t){return Ge("greaterEqual")},Xe.prototype.logicalNot=function(e){return Ge("logicalNot")},Xe.prototype.logicalAnd=function(e,t){return Ge("logicalAnd")},Xe.prototype.logicalOr=function(e,t){return Ge("logicalOr")},Xe.prototype.where=function(e){return Ge("where")},Xe.prototype.select=function(e,t,n){return Ge("select")},Xe.prototype.topk=function(e,t,n){return Ge("topk")},Xe.prototype.min=function(e,t){return Ge("min")},Xe.prototype.minimum=function(e,t){return Ge("minimum")},Xe.prototype.mod=function(e,t){return Ge("mod")},Xe.prototype.max=function(e,t){return Ge("max")},Xe.prototype.maximum=function(e,t){return Ge("maximum")},Xe.prototype.all=function(e,t){return Ge("all")},Xe.prototype.any=function(e,t){return Ge("any")},Xe.prototype.squaredDifference=function(e,t){return Ge("squaredDifference")},Xe.prototype.ceil=function(e){return Ge("ceil")},Xe.prototype.floor=function(e){return Ge("floor")},Xe.prototype.round=function(e){return Ge("round")},Xe.prototype.sign=function(e){return Ge("sign")},Xe.prototype.isNaN=function(e){return Ge("isNaN")},Xe.prototype.isInf=function(e){return Ge("isInf")},Xe.prototype.isFinite=function(e){return Ge("isFinite")},Xe.prototype.pow=function(e,t){return Ge("pow")},Xe.prototype.exp=function(e){return Ge("exp")},Xe.prototype.expm1=function(e){return Ge("expm1")},Xe.prototype.softmax=function(e,t){return Ge("softmax")},Xe.prototype.log=function(e){return Ge("log")},Xe.prototype.log1p=function(e){return Ge("log1p")},Xe.prototype.sqrt=function(e){return Ge("sqrt")},Xe.prototype.rsqrt=function(e){return Ge("rsqrt")},Xe.prototype.square=function(e){return Ge("square")},Xe.prototype.reciprocal=function(e){return Ge("reciprocal")},Xe.prototype.relu=function(e){return Ge("relu")},Xe.prototype.relu6=function(e){return Ge("relu6")},Xe.prototype.prelu=function(e,t){return Ge("prelu")},Xe.prototype.elu=function(e){return Ge("elu")},Xe.prototype.eluDer=function(e,t){return Ge("eluDer")},Xe.prototype.selu=function(e){return Ge("selu")},Xe.prototype.int=function(e){return Ge("int")},Xe.prototype.clip=function(e,t,n){return Ge("clip")},Xe.prototype.abs=function(e){return Ge("abs")},Xe.prototype.complexAbs=function(e){return Ge("complexAbs")},Xe.prototype.sigmoid=function(e){return Ge("sigmoid")},Xe.prototype.softplus=function(e){return Ge("softplus")},Xe.prototype.sin=function(e){return Ge("sin")},Xe.prototype.cos=function(e){return Ge("cos")},Xe.prototype.tan=function(e){return Ge("tan")},Xe.prototype.asin=function(e){return Ge("asin")},Xe.prototype.acos=function(e){return Ge("acos")},Xe.prototype.atan=function(e){return Ge("atan")},Xe.prototype.atan2=function(e,t){return Ge("atan2")},Xe.prototype.sinh=function(e){return Ge("sinh")},Xe.prototype.cosh=function(e){return Ge("cosh")},Xe.prototype.tanh=function(e){return Ge("tanh")},Xe.prototype.asinh=function(e){return Ge("asinh")},Xe.prototype.acosh=function(e){return Ge("acosh")},Xe.prototype.atanh=function(e){return Ge("atanh")},Xe.prototype.erf=function(e){return Ge("erf")},Xe.prototype.step=function(e,t){return Ge("step")},Xe.prototype.fusedConv2d=function(e){return Ge("fusedConv2d")},Xe.prototype.conv2d=function(e,t,n){return Ge("conv2d")},Xe.prototype.conv2dDerInput=function(e,t,n){return Ge("conv2dDerInput")},Xe.prototype.conv2dDerFilter=function(e,t,n){return Ge("conv2dDerFilter")},Xe.prototype.fusedDepthwiseConv2D=function(e){return Ge("fusedDepthwiseConv2D")},Xe.prototype.depthwiseConv2D=function(e,t,n){return Ge("depthwiseConv2D")},Xe.prototype.depthwiseConv2DDerInput=function(e,t,n){return Ge("depthwiseConv2DDerInput")},Xe.prototype.depthwiseConv2DDerFilter=function(e,t,n){return Ge("depthwiseConv2DDerFilter")},Xe.prototype.conv3d=function(e,t,n){return Ge("conv3d")},Xe.prototype.conv3dDerInput=function(e,t,n){return Ge("conv3dDerInput")},Xe.prototype.conv3dDerFilter=function(e,t,n){return Ge("conv3dDerFilter")},Xe.prototype.maxPool=function(e,t){return Ge("maxPool")},Xe.prototype.maxPoolBackprop=function(e,t,n,a){return Ge("maxPoolBackprop")},Xe.prototype.avgPool=function(e,t){return Ge("avgPool")},Xe.prototype.avgPoolBackprop=function(e,t,n){return Ge("avgPoolBackprop")},Xe.prototype.avgPool3d=function(e,t){return Ge("avgPool3d")},Xe.prototype.avgPool3dBackprop=function(e,t,n){return Ge("avgPool3dBackprop")},Xe.prototype.maxPool3d=function(e,t){return Ge("maxPool3d")},Xe.prototype.maxPool3dBackprop=function(e,t,n,a){return Ge("maxPool3dBackprop")},Xe.prototype.reshape=function(e,t){return Ge("reshape")},Xe.prototype.cast=function(e,t){return Ge("cast")},Xe.prototype.tile=function(e,t){return Ge("tile")},Xe.prototype.pad=function(e,t,n){return Ge("pad")},Xe.prototype.transpose=function(e,t){return Ge("transpose")},Xe.prototype.gather=function(e,t,n){return Ge("gather")},Xe.prototype.gatherND=function(e,t){return Ge("gatherND")},Xe.prototype.scatterND=function(e,t,n){return Ge("scatterND")},Xe.prototype.batchToSpaceND=function(e,t,n){return Ge("batchToSpaceND")},Xe.prototype.spaceToBatchND=function(e,t,n){return Ge("spaceToBatchND")},Xe.prototype.resizeBilinear=function(e,t,n,a){return Ge("resizeBilinear")},Xe.prototype.resizeBilinearBackprop=function(e,t,n){return Ge("resizeBilinearBackprop")},Xe.prototype.resizeNearestNeighbor=function(e,t,n,a){return Ge("resizeNearestNeighbor")},Xe.prototype.resizeNearestNeighborBackprop=function(e,t,n){return Ge("resizeNearestNeighborBackprop")},Xe.prototype.batchNormalization=function(e,t,n,a,s,c){return Ge("batchNormalization")},Xe.prototype.localResponseNormalization4D=function(e,t,n,a,s){return Ge("localResponseNormalization4D")},Xe.prototype.LRNGrad=function(e,t,n,a,s,c,d){return Ge("LRNGrad")},Xe.prototype.multinomial=function(e,t,n,a){return Ge("multinomial")},Xe.prototype.oneHot=function(e,t,n,a){return Ge("oneHot")},Xe.prototype.cumsum=function(e,t,n,a){return Ge("cumsum")},Xe.prototype.nonMaxSuppression=function(e,t,n,a,s){return Ge("nonMaxSuppression")},Xe.prototype.fft=function(e){return Ge("fft")},Xe.prototype.ifft=function(e){return Ge("ifft")},Xe.prototype.complex=function(e,t){return Ge("complex")},Xe.prototype.real=function(e){return Ge("real")},Xe.prototype.imag=function(e){return Ge("imag")},Xe.prototype.cropAndResize=function(e,t,n,a,s,c){return Ge("cropAndResize")},Xe.prototype.depthToSpace=function(e,t,n){return Ge("depthToSpace")},Xe.prototype.split=function(e,t,n){return Ge("split")},Xe.prototype.sparseToDense=function(e,t,n,a){return Ge("sparseToDense")},Xe.prototype.diag=function(e){return Ge("diag")},Xe.prototype.fill=function(e,t,n){return Ge("fill")},Xe.prototype.onesLike=function(e){return Ge("onesLike")},Xe.prototype.zerosLike=function(e){return Ge("zerosLike")},Xe.prototype.linspace=function(e,t,n){return Ge("linspace")},Xe.prototype.dispose=function(){return Ge("dispose")},Xe);function Xe(){}function Ya(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}function Ge(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function ja(e,t){for(var n=e.length,a=[],s=0;s<n;s++){var c=n-1-s;1<(t[t.length-1-s]||1)&&1===(e[c]||1)&&a.unshift(c)}return a}function Ir(e,t){for(var n=[],a=0;a<t.length;a++){var s=e[e.length-a-1],c=t.length-a-1;(null==s||1===s&&1<t[c])&&n.unshift(c)}return n}function gn(e,t){for(var n=[],a=Math.max(e.length,t.length),s=0;s<a;s++){var c=e[e.length-s-1];null==c&&(c=1);var d=t[t.length-s-1];if(null==d&&(d=1),1===c)n.unshift(d);else if(1===d)n.unshift(c);else{if(c!==d)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(c)}}return n}function pa(e,t,n,a,s,c,d){void 0===d&&(d="channelsLast");var f,g=cl(t),m=g[0],w=g[1];if("channelsLast"===d)f=[m,w,e[3],e[3]];else{if("channelsFirst"!==d)throw new Error("Unknown dataFormat "+d);f=[m,w,e[1],e[1]]}return Ua(e,f,n,a,s,c,!1,d)}function Po(e,t,n,a,s,c,d){void 0===d&&(d="NDHWC");var f,g,m=Mo(t),w=m[0],A=m[1],T=m[2];if("NDHWC"===d)g="channelsLast",f=[w,A,T,e[4],e[4]];else{if("NCDHW"!==d)throw new Error("Unknown dataFormat "+d);g="channelsFirst",f=[w,A,T,e[1],e[1]]}return Bs(e,f,n,a,s,!1,g,c)}function Ua(e,t,n,a,s,c,d,f){void 0===d&&(d=!1),void 0===f&&(f="channelsLast");var g=[-1,-1,-1,-1],m=g[0],w=g[1],A=g[2],T=g[3];if("channelsLast"===f)m=e[0],w=e[1],A=e[2],T=e[3];else{if("channelsFirst"!==f)throw new Error("Unknown dataFormat "+f);m=e[0],T=e[1],w=e[2],A=e[3]}var M,O=t[0],V=t[1],H=t[3],X=cl(n),$=X[0],ee=X[1],re=cl(a),te=re[0],le=re[1],se=na(O,te),ie=na(V,le),ce=function(We,Fe,Ee,He,tt,it,ot){var pt,Rt,Dt;if("number"==typeof We){pt={top:We,bottom:We,left:We,right:We,type:0===We?"VALID":"NUMBER"};var qt=function(lr,Jn,jr,dr,pr){null==dr&&(dr=Ul(lr,Jn,jr));var wo=lr[1],Co=zs((lr[0]-Jn+2*dr)/jr+1,pr);ue(Qn(Co),function(){return"The output # of rows ("+Co+") must be an integer. Change the stride and/or zero pad parameters"});var ya=zs((wo-Jn+2*dr)/jr+1,pr);return ue(Qn(ya),function(){return"The output # of columns ("+ya+") must be an integer. Change the stride and/or zero pad parameters"}),[Co,ya]}([Fe,Ee],it,He,We,c);Rt=qt[0],Dt=qt[1]}else if("same"===We){Rt=Math.ceil(Fe/He),Dt=Math.ceil(Ee/tt);var In=Math.max(0,(Rt-1)*He+it-Fe),Tn=Math.max(0,(Dt-1)*tt+ot-Ee),Rn=Math.floor(In/2),zr=In-Rn,Xn=Math.floor(Tn/2);pt={top:Rn,bottom:zr,left:Xn,right:Tn-Xn,type:"SAME"}}else{if("valid"!==We)throw Error("Unknown padding parameter: "+We);pt={top:0,bottom:0,left:0,right:0,type:"VALID"},Rt=Math.ceil((Fe-it+1)/He),Dt=Math.ceil((Ee-ot+1)/tt)}return{padInfo:pt,outHeight:Rt,outWidth:Dt}}(s,w,A,$,ee,se,ie),be=ce.outHeight,Ae=ce.outWidth,Te=d?H*T:H;return"channelsFirst"===f?M=[m,Te,be,Ae]:"channelsLast"===f&&(M=[m,be,Ae,Te]),{batchSize:m,dataFormat:f,inHeight:w,inWidth:A,inChannels:T,outHeight:be,outWidth:Ae,outChannels:Te,padInfo:ce.padInfo,strideHeight:$,strideWidth:ee,filterHeight:O,filterWidth:V,effectiveFilterHeight:se,effectiveFilterWidth:ie,dilationHeight:te,dilationWidth:le,inShape:e,outShape:M,filterShape:t}}function Bs(e,t,n,a,s,c,d,f){void 0===c&&(c=!1),void 0===d&&(d="channelsLast");var g=[-1,-1,-1,-1,-1],m=g[0],w=g[1],A=g[2],T=g[3],M=g[4];if("channelsLast"===d)m=e[0],w=e[1],A=e[2],T=e[3],M=e[4];else{if("channelsFirst"!==d)throw new Error("Unknown dataFormat "+d);m=e[0],M=e[1],w=e[2],A=e[3],T=e[4]}var O,V=t[0],H=t[1],X=t[2],$=t[4],ee=Mo(n),re=ee[0],te=ee[1],le=ee[2],se=Mo(a),ie=se[0],ce=se[1],he=se[2],be=na(V,ie),Ae=na(H,ce),Te=na(X,he),We=function(ot,pt,Rt,Dt,qt,In,Tn,Rn,zr,Xn){var lr,Jn,jr,dr;if("number"==typeof ot){lr={top:ot,bottom:ot,left:ot,right:ot,front:ot,back:ot,type:0===ot?"VALID":"NUMBER"};var pr=function(es,Gl,Wx,ts,Lc,jf){null==Lc&&(Lc=Ul(es,Gl,ts));var Hy=es[1],Xy=es[2],Uf=zs((es[0]-Gl+2*Lc)/ts+1,jf);ue(Qn(Uf),function(){return"The output # of depths ("+Uf+") must be an integer. Change the stride and/or zero pad parameters"});var qf=zs((Hy-Gl+2*Lc)/ts+1,jf);ue(Qn(qf),function(){return"The output # of rows ("+qf+") must be an integer. Change the stride and/or zero pad parameters"});var $f=zs((Xy-Gl+2*Lc)/ts+1,jf);return ue(Qn($f),function(){return"The output # of columns ("+$f+") must be an integer. Change the stride and/or zero pad parameters"}),[Uf,qf,$f,1]}([pt,Rt,Dt,1],Rn,0,qt,ot,f);Jn=pr[0],jr=pr[1],dr=pr[2]}else if("same"===ot){var wo=((Jn=Math.ceil(pt/qt))-1)*qt+Rn-pt,Co=((jr=Math.ceil(Rt/In))-1)*In+zr-Rt,ya=((dr=Math.ceil(Dt/Tn))-1)*Tn+Xn-Dt,nl=Math.floor(wo/2),Ds=wo-nl,Qo=Math.floor(Co/2),Ps=Co-Qo,hh=Math.floor(ya/2);lr={top:Qo,bottom:Ps,left:hh,right:ya-hh,front:nl,back:Ds,type:"SAME"}}else{if("valid"!==ot)throw Error("Unknown padding parameter: "+ot);lr={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},Jn=Math.ceil((pt-Rn+1)/qt),jr=Math.ceil((Rt-zr+1)/In),dr=Math.ceil((Dt-Xn+1)/Tn)}return{padInfo:lr,outDepth:Jn,outHeight:jr,outWidth:dr}}(s,w,A,T,re,te,le,be,Ae,Te),Ee=We.outDepth,He=We.outHeight,tt=We.outWidth,it=c?$*M:$;return"channelsFirst"===d?O=[m,it,Ee,He,tt]:"channelsLast"===d&&(O=[m,Ee,He,tt,it]),{batchSize:m,dataFormat:d,inDepth:w,inHeight:A,inWidth:T,inChannels:M,outDepth:Ee,outHeight:He,outWidth:tt,outChannels:it,padInfo:We.padInfo,strideDepth:re,strideHeight:te,strideWidth:le,filterDepth:V,filterHeight:H,filterWidth:X,effectiveFilterDepth:be,effectiveFilterHeight:Ae,effectiveFilterWidth:Te,dilationDepth:ie,dilationHeight:ce,dilationWidth:he,inShape:e,outShape:O,filterShape:t}}function Ul(e,t,n,a){void 0===a&&(a=1);var s=na(t,a);return Math.floor((e[0]*(n-1)-n+s)/2)}function cl(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function Mo(e){return"number"==typeof e?[e,e,e]:e}function na(e,t){return t<=1?e:e+(e-1)*(t-1)}function zs(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function No(e){var t=cl(e);return 1===t[0]&&1===t[1]&&1===t[2]}function mi(e,t){return No(e)||No(t)}function ul(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function ql(e,t,n){if("complex64"===t){if("complex64"===e.dtype)return e.clone();var a=sn(e.shape),s=e.toFloat(),c=n.complex(s,a);return a.dispose(),s.dispose(),c}if(!Ui(e.dtype,t))return P.makeTensorFromDataId(e.dataId,e.shape,t);if("complex64"===e.dtype){var d=n.real(e);return c=d.cast(t),d.dispose(),c}if("int32"===t)return n.int(e);if("bool"!==t)throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t);var f=nt(0,e.dtype);return c=n.notEqual(e,f),f.dispose(),c}function hl(e,t){return P.makeTensorFromDataId(e.dataId,t,e.dtype)}function $l(e,t,n){var a=(t-e)/(n-1),s=wa(n,"float32");s[0]=e;for(var c=1;c<s.length;c++)s[c]=s[c-1]+a;return tn(s,"float32")}var fh=Object.freeze({castTensor:ql,reshapeTensor:hl,linspaceImpl:$l,upcastType:Dn,axesAreInnerMostDims:ke,combineLocations:we,computeOutAndReduceShapes:Ie,expandShapeToKeepDim:Oe,assertAxesAreInnerMostDims:Ye,getAxesPermutation:Ne,getUndoAxesPermutation:et,getInnerMostAxes:Ct,getBroadcastDims:ja,getReductionAxes:Ir,assertAndGetBroadcastShape:gn,assertParamsConsistent:Xt,computeOutShape:zt,computePool2DInfo:pa,computePool3DInfo:Po,computeConv2DInfo:Ua,computeConv3DInfo:Bs,computeDefaultPad:Ul,tupleValuesAreOne:No,eitherStridesOrDilationsAreOne:mi,convertConv2DDataFormat:ul,PARALLELIZE_THRESHOLD:30,computeOptimalWindowSize:Fs});function dl(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),a=0;a<n.length;a+=2)n[a]=e[a/2],n[a+1]=t[a/2];return n}function Yc(e,t){return{real:e[2*t],imag:e[2*t+1]}}function jc(e,t){return t<e?1:e<t?-1:0}function Ws(e,t,n,a,s){return so(e,t,n,a,s,0).selectedIndices}function fl(e,t,n,a,s,c){var d=so(e,t,n,a,s,c);return d.numValidOutputs.dispose(),{selectedIndices:d.selectedIndices,selectedScores:d.selectedScores}}function so(e,t,n,a,s,c,d,f){void 0===f&&(f=!1);for(var g=Array.from(t).map(function(Ae,Te){return{score:Ae,boxIndex:Te,suppressBeginIndex:0}}).filter(function(Ae){return Ae.score>s}).sort(pl),m=0<c?-.5/c:0,w=[],A=[];w.length<n&&0<g.length;){var T=g.pop(),M=T.score,O=T.boxIndex,V=T.suppressBeginIndex;if(M<s)break;for(var H=!1,X=w.length-1;V<=X;--X){var $=Uc(e,O,w[X]);if(a<=$){H=!0;break}if(T.score=T.score*(se=a,ce=$,he=Math.exp(m*ce*ce),ce<=se?he:0),T.score<=s)break}T.suppressBeginIndex=w.length,H||(T.score===M?(w.push(O),A.push(T.score)):T.score>s&&(te=function(Ae,Te,We){for(var Fe=0,Ee=Ae.length,He=0,tt=!1;Fe<Ee;){var it=We(Te,Ae[He=Fe+(Ee-Fe>>>1)]);0<it?Fe=He+1:(Ee=He,tt=!it)}return tt?Fe:-Fe-1}(ee=g,re=T,pl||jc),ee.splice(te<0?-(te+1):te,0,re)))}var ee,re,te,se,ce,he,be=w.length;return f&&(w.fill(0,be),A.fill(0,be)),{selectedIndices:tn(w,"int32"),selectedScores:tn(A,"float32"),numValidOutputs:nt(be,"int32")}}function Uc(e,t,n){var a=e.subarray(4*t,4*t+4),s=e.subarray(4*n,4*n+4),c=Math.min(a[0],a[2]),d=Math.min(a[1],a[3]),f=Math.max(a[0],a[2]),g=Math.max(a[1],a[3]),m=Math.min(s[0],s[2]),w=Math.min(s[1],s[3]),A=Math.max(s[0],s[2]),T=Math.max(s[1],s[3]),M=(f-c)*(g-d),O=(A-m)*(T-w);if(M<=0||O<=0)return 0;var V=Math.max(c,m),H=Math.max(d,w),X=Math.min(f,A),$=Math.min(g,T),ee=Math.max(X-V,0)*Math.max($-H,0);return ee/(M+O-ee)}function pl(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function Kl(e,t,n){var a=new Array(e.rank).fill(0),s=e.shape.slice();return t.map(function(c){s[n]=c;var d=e.slice(a,s);return a[n]+=c,d})}function gl(e,t){for(var n=new Array(e.rank),a=0;a<n.length;a++)n[a]=e.shape[a]*t[a];var s=xe(n,e.dtype);for(a=0;a<s.values.length;++a){for(var c=s.indexToLoc(a),d=new Array(e.rank),f=0;f<d.length;f++)d[f]=c[f]%e.shape[f];var g=e.locToIndex(d);s.values[a]=e.values[g]}return s.toTensor()}function Zl(e,t,n,a){for(var s=t[t.length-1],c=[e.length/s,s],d=c[0],f=c[1],g=Ai(n,d*a),m=Ai("int32",d*a),w=0;w<d;w++){for(var A=w*f,T=e.subarray(A,A+f),M=[],O=0;O<T.length;O++)M.push({value:T[O],index:O});M.sort(function(ee,re){return re.value-ee.value});var V=w*a,H=g.subarray(V,V+a),X=m.subarray(V,V+a);for(O=0;O<a;O++)H[O]=M[O].value,X[O]=M[O].index}var $=t.slice();return $[$.length-1]=a,[Wt(g,$,n),Wt(m,$,"int32")]}function Hs(e,t){for(var n=[],a=0;a<t.length;a++)t[a]&&n.push(a);var s=xe(e,"int32"),c=xe([n.length,e.length],"int32");for(a=0;a<n.length;a++){var d=s.indexToLoc(n[a]);c.values.set(d,a*e.length)}return c.toTensor()}function ph(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(function(s,c){return"T"+c});var n=[];this.variableNames.forEach(function(s){n.push("float v"+s+" = get"+s+"AtOutCoords();")});var a=this.variableNames.map(function(s){return"v"+s}).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        float result = "+a+";\n        setOutput(result);\n      }\n    "}function Lo(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(function(s,c){return"T"+c});var n=[];this.variableNames.forEach(function(s){n.push("vec4 v"+s+" = get"+s+"AtOutCoords();")});var a=this.variableNames.map(function(s){return"v"+s}).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        vec4 result = "+a+";\n        setOutput(result);\n      }\n    "}function lo(e,t,n){this.variableNames=["A"];var a=e.windowSize,s=e.batchSize,d=Math.ceil(e.inSize/a);n||this.variableNames.push("bestIndicesA"),this.outputShape=[s,d],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+a+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+a+"; i++) {\n          int inIdx = "+(n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));")+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+("max"===t?">":"<")+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "}function qc(e,t){return["x","y","z","w","u","v"].slice(0,t).map(function(n){return e+"."+n})}function Ti(e,t){return 1===t?[e]:qc(e,t)}function ci(){var e,t,n,a,s,c,d,f,g,m;return m=2===_e().getNumber("WEBGL_VERSION")?(e="#version 300 es",n="out",a=t="in",s="texture",c="outputColor",d="out vec4 outputColor;",f="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",g="","\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="attribute",a=n="varying",s="texture2D",c="gl_FragColor",d=e="",f="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",g="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ","\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:a,texture2D:s,output:c,defineOutput:d,defineSpecialNaN:f,defineSpecialInf:g,defineRound:m}}function Fo(e,t,n){void 0===n&&(n="index");var a=yr(t);return a.map(function(s,c){return"int "+e[c]+" = "+n+" / "+s+"; "+(c===a.length-1?"int "+e[c+1]+" = "+n+" - "+e[c]+" * "+s:"index -= "+e[c]+" * "+s)+";"}).join("")}function Jl(e){var t=yr(e).map(function(n){return n.toString()});return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+t[0]+" + coords.y * "+t[1]+" + coords.z;\n  }\n"}var $c="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function Oo(e){return"offset"+e}function Bo(e){var t=e.name,n=mt(e.shapeInfo.logicalShape);return n<2?"return "+t+";":"\n    for (int i = 0; i < "+n+"; i++) {\n      if (i == index) {\n        return "+t+"[i];\n      }\n    }\n  "}function jn(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function qa(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function us(e,t){return t.map(function(n){return e[n]}).join(", ")}function vh(e,t,n,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,ue(2<e.length,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var c=Math.ceil(e[e.length-1]/t);this.outputShape=e.slice(0,-1),1<c&&this.outputShape.push(c),a||this.variableNames.push("bestIndicesA");var d,f,g=this.outputShape,m=g.length,w=jn(m),A=Ti("coords",m);if(1===c){var T=jn(f=m+1);d="\n        "+T+" sourceLocR = "+T+"("+A.join()+", 0);\n        ++"+A[m-1]+";\n        "+T+" sourceLocG = "+T+"("+A.join()+", 0);\n        ++"+A[m-2]+";\n        "+T+" sourceLocA = "+T+"("+A.join()+", 0);\n        --"+A[m-1]+";\n        "+T+" sourceLocB = "+T+"("+A.join()+", 0);\n        --"+A[m-2]+";"}else d="\n        "+w+" sourceLocR = coords;\n        ++"+A[(f=m)-1]+";\n        "+w+" sourceLocG = coords;\n        ++"+A[m-2]+";\n        "+w+" sourceLocA = coords;\n        --"+A[m-1]+";\n        "+w+" sourceLocB = coords;\n        --"+A[m-2]+";";var M=["x","y","z","w","u","v"].slice(0,f),O="."+M[f-1],V=M.map(function(ie){return"int "+ie}),H=Ti("sourceLocR",f-1).concat("inIdx.r"),X=Ti("sourceLocG",f-1).concat("inIdx.g"),$=Ti("sourceLocB",f-1).concat("inIdx.b"),ee=Ti("sourceLocA",f-1).concat("inIdx.a"),re="max"===n?"greaterThan":"lessThan",te=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+H.join()+"),\n                             getBestIndicesAChannel("+X.join()+"),\n                             getBestIndicesAChannel("+$.join()+"),\n                             getBestIndicesAChannel("+ee.join()+")));",le="vec4(\n            getAChannel("+H.join()+"),\n            hasNextCol ? getAChannel("+X.join()+") : 0.,\n            hasNextRow ? getAChannel("+$.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+ee.join()+") : 0.)",se=a?"":"\n      float getBestIndicesAChannel("+V.join()+") {\n        return getChannel(getBestIndicesA("+M.join()+"),\n                                          vec2("+M.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+V.join()+") {\n        return getChannel(getA("+M.join()+"),\n                               vec2("+M.slice(-2).join()+"));\n      }\n      "+se+"\n      void main() {\n        "+w+" coords = getOutputCoords();\n        bool hasNextCol = "+A[m-1]+" < "+(g[m-1]-1)+";\n        bool hasNextRow = "+A[m-2]+" < "+(g[m-2]-1)+";\n        "+d+"\n        ivec4 srcIdx = ivec4(sourceLocR"+O+", sourceLocG"+O+",\n          sourceLocB"+O+", sourceLocA"+O+") * "+t+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+le+";\n\n        for (int i = 0; i < "+t+"; i++) {\n          inIdx = srcIdx;\n          "+te+"\n          vec4 candidate = "+le+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+re+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "}function Xs(e){this.variableNames=["dy"],this.outputShape=e.inShape;var f=e.effectiveFilterHeight,g=e.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(f-1-e.padInfo.top)+", "+(g-1-e.padInfo.left)+");\n      const float avgMultiplier = float("+1/(e.filterHeight*e.filterWidth)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+f+";\n            wR += "+e.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+e.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+g+";\n            wC+= "+e.dilationWidth+") {\n            float dyC = float(dyCCorner + wC) / "+e.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}function Q(e){this.variableNames=["dy"],this.outputShape=e.inShape;var w=e.effectiveFilterDepth,A=e.effectiveFilterHeight,T=e.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(w-1-e.padInfo.front)+", "+(A-1-e.padInfo.top)+", "+(T-1-e.padInfo.left)+");\n      const float avgMultiplier = float("+1/(e.filterDepth*e.filterHeight*e.filterWidth)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+w+";\n            wD += "+e.dilationDepth+") {\n          float dyD = float(dyDCorner + wD) / "+e.strideDepth+".0;\n\n          if (dyD < 0.0 || dyD >= "+e.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+A+";\n              wR += "+e.dilationHeight+") {\n            float dyR = float(dyRCorner + wR) / "+e.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+T+";\n                wC += "+e.dilationWidth+") {\n              float dyC = float(dyCCorner + wC) / "+e.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}function E(e,t,n,a,s,c){this.outputShape=[],this.variableNames=["x","mean","variance"],gn(e,t),gn(e,n);var d="0.0";null!=a&&(gn(e,a),this.variableNames.push("offset"),d="getOffsetAtOutCoords()");var f="1.0";null!=s&&(gn(e,s),this.variableNames.push("scale"),f="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+d+";\n        float scale = "+f+";\n        float inv = scale * inversesqrt(variance + float("+c+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "}function Y(e,t,n,a,s,c){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],gn(e,t),gn(e,n);var d="vec4(0.0)";null!=a&&(gn(e,a),this.variableNames.push("offset"),d="getOffsetAtOutCoords()");var f="vec4(1.0)";null!=s&&(gn(e,s),this.variableNames.push("scale"),f="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = "+d+";\n        vec4 scale = "+f+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+c+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "}function oe(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=gn(t,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+e+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "}function Se(e,t,n){this.variableNames=["A","B"],this.outputShape=gn(t,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+e+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "}function Re(e,t,n,a){void 0===a&&(a=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=gn(t,n);var s=this.outputShape.length,c="";if(a)if(0===s||1===mt(this.outputShape))c="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(c="\n          "+jn(s)+" coords = getOutputCoords();\n        ",1===s)c+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var d=Ti("coords",s);c+="\n            bool nextRowOutOfBounds =\n              ("+d[s-2]+" + 1) >= "+this.outputShape[s-2]+";\n            bool nextColOutOfBounds =\n              ("+d[s-1]+" + 1) >= "+this.outputShape[s-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+e+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+c+"\n\n        setOutput(result);\n      }\n    "}function $e(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}function rt(e){this.outputShape=[],this.outputShape=zt(e,1),this.variableNames=e.map(function(f,g){return"T"+g});var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var a=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++)a.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+t[n-1]+"));");a.push("else setOutput(getT"+t.length+"(yR, yC-"+t[t.length-1]+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+a.join("\n        ")+"\n      }\n    "}function ct(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=zt(e,t);var n=this.outputShape,a=n.length,s=jn(a),c=Ti("coords",a),d=["x","y","z","w","u","v"].slice(0,a);this.variableNames=e.map(function(H,X){return"T"+X});var f=new Array(e.length-1);f[0]=e[0][t];for(var g=1;g<f.length;g++)f[g]=f[g-1]+e[g][t];var m=d[t],w=d.slice(-2),A=d.join(),T="if ("+m+" < "+f[0]+") {\n        return getChannel(\n            getT0("+A+"), vec2("+w.join()+"));\n        }";for(g=1;g<f.length;g++){var M=f[g-1];T+="\n        if ("+m+" < "+f[g]+"  && "+m+" >= "+f[g-1]+") {\n          return getChannel(\n            getT"+g+"("+qn(d,m,M)+"),\n            vec2("+qn(w,m,M)+"));\n        }"}var V=f[f.length-1];T+="\n        return getChannel(\n          getT"+f.length+"("+qn(d,m,V)+"),\n          vec2("+qn(w,m,V)+"));",this.userCode="\n      float getValue("+d.map(function(H){return"int "+H})+") {\n        "+T+"\n      }\n\n      void main() {\n        "+s+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+c+"), 0., 0., 0.);\n\n        "+c[a-1]+" = "+c[a-1]+" + 1;\n        if ("+c[a-1]+" < "+n[a-1]+") {\n          result.g = getValue("+c+");\n        }\n\n        "+c[a-2]+" = "+c[a-2]+" + 1;\n        if ("+c[a-2]+" < "+n[a-2]+") {\n          result.a = getValue("+c+");\n        }\n\n        "+c[a-1]+" = "+c[a-1]+" - 1;\n        if ("+c[a-2]+" < "+n[a-2]+" &&\n            "+c[a-1]+" < "+n[a-1]+") {\n          result.b = getValue("+c+");\n        }\n        setOutput(result);\n      }\n    "}var _t="return a + b;",It="return a - b;",xt="return a * b;",ln="return (a < 0.) ? b * a : a;",jt="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",nn=(Un.prototype.getCustomSetupFunc=function(e,t){var n=this;return function(a,s){null==n.minLoc&&(n.minLoc=a.getUniformLocationNoThrow(s,"minVal"),n.maxLoc=a.getUniformLocationNoThrow(s,"maxVal")),a.gl.uniform1f(n.minLoc,e),a.gl.uniform1f(n.maxLoc,t)}},Un),Zt=(Jt.prototype.getCustomSetupFunc=function(e,t){var n=this;return function(a,s){null==n.minLoc&&(n.minLoc=a.getUniformLocationNoThrow(s,"minVal"),n.maxLoc=a.getUniformLocationNoThrow(s,"maxVal")),a.gl.uniform1f(n.minLoc,e),a.gl.uniform1f(n.maxLoc,t)}},Jt);function Jt(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}function Un(e){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}function qn(e,t,n){var a=e.indexOf(t);return e.map(function(s,c){return c===a?s+" - "+n:s}).join()}function vn(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+e.strideHeight+" - "+e.padInfo.top+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+e.strideWidth+" - "+e.padInfo.left+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              if ("+("channelsLast"===e.dataFormat)+") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}function Ln(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,c="channelsLast"===e.dataFormat;this.userCode="\n      const ivec2 pads = ivec2("+(t-1-e.padInfo.top)+", "+(n-1-e.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords["+(c?3:1)+"];\n\n        ivec2 dyCorner = ivec2(coords["+(c?1:2)+"], coords["+(c?2:3)+"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+e.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+e.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n\n              if ("+c+") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}function un(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape,this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yF = 0; yF < "+e.outDepth+"; yF++) {\n            int xF = wF + yF * "+e.strideDepth+" - "+e.padInfo.front+";\n\n            if (xF < 0 || xF >= "+e.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n              int xR = wR + yR * "+e.strideHeight+" - "+e.padInfo.top+";\n\n              if (xR < 0 || xR >= "+e.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n                int xC = wC + yC * "+e.strideWidth+" - "+e.padInfo.left+";\n\n                if (xC < 0 || xC >= "+e.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}function Sn(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,a=e.filterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(t-1-e.padInfo.front)+", "+(n-1-e.padInfo.top)+", "+(a-1-e.padInfo.left)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+t+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+e.strideDepth+".0;\n\n          if (dyF < 0.0 || dyF >= "+e.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+t+" - 1 - wF;\n\n          for (int wR = 0; wR < "+n+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+e.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+n+" - 1 - wR;\n\n            for (int wC = 0; wC < "+a+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+e.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+a+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}function $n(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+e.outChannels/e.inChannels+" + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+e.strideHeight+" - "+e.padInfo.top+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+e.strideWidth+" - "+e.padInfo.left+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}function Zn(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,f=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+(t-1-e.padInfo.top)+", "+(n-1-e.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+e.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+e.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+f+"; dm++) {\n              int d2 = d1 * "+f+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}function Hn(e,t,n,a){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===a&&(a=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var s=e.padInfo.top,c=e.padInfo.left,d=e.strideHeight,f=e.strideWidth,g=e.dilationHeight,m=e.dilationWidth,w=e.filterHeight,A=e.filterWidth,T=4*Math.floor(e.inChannels/4),M=e.inChannels%4,O="channelsLast"===e.dataFormat,V=O?1:2,H=O?2:3,X=O?3:1,$="",ee="";n&&($=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",ee="result = activation(result);");var re=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+$+"\n\n      const ivec2 strides = ivec2("+d+", "+f+");\n      const ivec2 pads = ivec2("+s+", "+c+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords["+X+"];\n\n        ivec2 xRCCorner =\n            ivec2(coords["+V+"], coords["+H+"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+w+"; wR++) {\n          int xR = xRCorner + wR * "+g+";\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+A+"; wC++) {\n            int xC = xCCorner + wC * "+m+";\n\n            if (xC < 0 || xC >= "+e.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+T+"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if ("+O+") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if ("+(1==M)+") {\n\n              if ("+O+") {\n                dotProd +=\n                    getX(batch, xR, xC, "+T+") *\n                    getW(wR, wC, "+T+", d2);\n              } else {\n                dotProd +=\n                    getX(batch, "+T+", xR, xC) *\n                    getW(wR, wC, "+T+", d2);\n              }\n\n            } else if ("+(2==M)+") {\n              vec2 wValues = vec2(\n                getW(wR, wC, "+T+", d2),\n                getW(wR, wC, "+T+" + 1, d2)\n              );\n\n              if ("+O+") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, "+T+"),\n                  getX(batch, xR, xC, "+T+" + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, "+T+", xR, xC),\n                  getX(batch, "+T+" + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if ("+(3==M)+") {\n              vec3 wValues = vec3(\n                getW(wR, wC, "+T+", d2),\n                getW(wR, wC, "+T+" + 1, d2),\n                getW(wR, wC, "+T+" + 2, d2)\n              );\n\n              if ("+O+") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, "+T+"),\n                  getX(batch, xR, xC, "+T+" + 1),\n                  getX(batch, xR, xC, "+T+" + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, "+T+", xR, xC),\n                  getX(batch, "+T+" + 1, xR, xC),\n                  getX(batch, "+T+" + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        "+re+"\n        "+ee+"\n        setOutput(result);\n      }\n    "}function Tr(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,a=e.padInfo.left,s=e.strideDepth,c=e.strideHeight,d=e.strideWidth,f=e.dilationDepth,g=e.dilationHeight,m=e.dilationWidth,w=e.filterDepth,A=e.filterHeight,T=e.filterWidth,M=4*Math.floor(e.inChannels/4),O=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+s+", "+c+", "+d+");\n      const ivec3 pads = ivec3("+t+", "+n+", "+a+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+w+"; wF++) {\n          int xF = xFCorner + wF * "+f+";\n\n          if (xF < 0 || xF >= "+e.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+A+"; wR++) {\n            int xR = xRCorner + wR * "+g+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+T+"; wC++) {\n              int xC = xCCorner + wC * "+m+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+M+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1==O)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+M+") *\n                  getW(wF, wR, wC, "+M+", d2);\n              } else if ("+(2==O)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+M+"),\n                  getX(batch, xF, xR, xC, "+M+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+M+", d2),\n                  getW(wF, wR, wC, "+M+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3==O)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+M+"),\n                  getX(batch, xF, xR, xC, "+M+" + 1),\n                  getX(batch, xF, xR, xC, "+M+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+M+", d2),\n                  getW(wF, wR, wC, "+M+" + 1, d2),\n                  getW(wF, wR, wC, "+M+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}function Ri(e,t,n,a){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===a&&(a=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var s=e.inHeight,c=e.inWidth,d=e.padInfo.top,f=e.padInfo.left,g=e.strideHeight,m=e.strideWidth,w=e.dilationHeight,A=e.dilationWidth,T=e.filterHeight,M=e.filterWidth,O=e.outChannels/e.inChannels,V="",H="";n&&(V=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",H="result = activation(result);");var X=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+V+"\n\n      const ivec2 strides = ivec2("+g+", "+m+");\n      const ivec2 pads = ivec2("+d+", "+f+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+O+";\n        int q = d2 - d1 * "+O+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+T+"; wR++) {\n          int xR = xRCorner + wR * "+w+";\n\n          if (xR < 0 || xR >= "+s+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+M+"; wC++) {\n            int xC = xCCorner + wC * "+A+";\n\n            if (xC < 0 || xC >= "+c+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        "+X+"\n        "+H+"\n        setOutput(result);\n      }\n    "}function ra(e,t,n,a){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===a&&(a=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var s=e.inHeight,c=e.inWidth,d=e.padInfo.top,f=e.padInfo.left,g=e.strideHeight,m=e.strideWidth,w=e.dilationHeight,A=e.dilationWidth,T=e.filterHeight,M=e.filterWidth,O=M,V="int xR; int xC; int xCOffset;",H=0;H<T;H++)for(var X=0;X<M;X++)V+="\n          vec4 xTexelR"+H+"C"+2*X+" = vec4(0.);\n          vec4 wR"+H+"C"+X+" = vec4(0.);\n          vec4 xR"+H+"C"+X+" = vec4(0.);";for(H=0;H<T;H++)for(var $=0;$<O;$++){if(V+="\n          xR = xRCorner + "+H*w+";\n          xC = xCCorner + "+(X=2*$)*A+";\n        ",1===m){if(X<M&&(V+=f%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+s+" && xCOffset >= 0 && xCOffset < "+c+") {\n                  xTexelR"+H+"C"+X+" = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+c+") {\n                    xTexelR"+H+"C"+X+".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR"+H+"C"+X+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+s+" && xCOffset >= 0 && xCOffset < "+c+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+c+") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR"+H+"C"+X+" = vec4(previous.zw, xTexelR"+H+"C"+X+".xy);\n                } else {\n                  xR"+H+"C"+X+" = vec4(0, 0, xTexelR"+H+"C"+X+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+s+" && xC >= 0 && xC < "+c+") {\n                  xTexelR"+H+"C"+X+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+H+"C"+X+" = vec4(0.);\n                }\n\n                xR"+H+"C"+X+" = xTexelR"+H+"C"+X+";\n              ",X+1<M)){var ee=f%2==0?Ke(A):A;A%2==0&&f%2==1||A%2!=0&&f%2!=1?(V+="\n                  xCOffset = xC + "+f%2+" + "+ee+";\n\n                  if(xR >= 0 && xR < "+s+" &&\n                    xCOffset >= 0 && xCOffset < "+c+") {\n                    xTexelR"+H+"C"+(X+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",1<A&&(V+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+s+" &&\n                      xCOffset >= 0 && xCOffset < "+c+") {\n                      xTexelR"+H+"C"+X+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+H+"C"+X+" = vec4(0.);\n                    }\n                  "),V+="\n                  xR"+H+"C"+(X+1)+" = vec4(\n                    xTexelR"+H+"C"+X+".zw, xTexelR"+H+"C"+(X+2)+".xy);\n                "):V+="\n                  xCOffset = xC + "+ee+";\n\n                  if(xR >= 0 && xR < "+s+" &&\n                    xCOffset >= 0 && xCOffset < "+c+") {\n                    xTexelR"+H+"C"+(X+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+H+"C"+(X+1)+" = xTexelR"+H+"C"+(X+2)+";\n                "}}else X<M&&(V+="\n              if(xR >= 0 && xR < "+s+") {\n            ",f%2==1?(V+="\n                xCOffset = xC + 1 - "+m+";\n                if(xCOffset >= 0 && xCOffset < "+c+") {\n                  xTexelR"+H+"C"+X+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+H+"C"+X+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+c+") {\n                  xTexelR"+H+"C"+(X+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+H+"C"+(X+2)+" = vec4(0.);\n                }\n\n                xR"+H+"C"+X+" = vec4(\n                  xTexelR"+H+"C"+X+".zw, xTexelR"+H+"C"+(X+2)+".zw);\n              ",X+1<M&&(V+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+m+";\n                  if(xCOffset >= 0 && xCOffset < "+c+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+H+"C"+(X+1)+" = vec4(xTexelR"+H+"C"+(X+2)+".xy, final.xy);\n                ")):(V+="\n                if(xC >= 0 && xC < "+c+") {\n                  xTexelR"+H+"C"+X+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+H+"C"+X+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+m+";\n                if(xCOffset >= 0 && xCOffset < "+c+") {\n                  xTexelR"+H+"C"+(X+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+H+"C"+(X+2)+" = vec4(0.);\n                }\n\n                xR"+H+"C"+X+" = vec4(\n                  xTexelR"+H+"C"+X+".xy, xTexelR"+H+"C"+(X+2)+".xy);\n              ",X+1<M&&(V+="\n                  xR"+H+"C"+(X+1)+" = vec4(\n                    xTexelR"+H+"C"+X+".zw, xTexelR"+H+"C"+(X+2)+".zw);\n                ")),V+="}");X<M&&(V+="\n            vec4 wTexelR"+H+"C"+X+" = getW("+H+", "+X+", d1, q);\n            wR"+H+"C"+X+" = vec4(wTexelR"+H+"C"+X+".xz, wTexelR"+H+"C"+X+".xz);\n          ",X+1<M&&(V+="\n              vec4 wTexelR"+H+"C"+(X+1)+" = getW("+H+", "+(X+1)+", d1, q);\n              wR"+H+"C"+(X+1)+" =\n                vec4(wTexelR"+H+"C"+(X+1)+".xz, wTexelR"+H+"C"+(X+1)+".xz);"))}for(H=0;H<T;H++)for(X=0;X<M;X++)V+="dotProd += xR"+H+"C"+X+" * wR"+H+"C"+X+";";var re="",te="";n&&(re=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"vec4 activation(vec4 x) {\n          "+n+"\n        }",te="result = activation(result);");var le=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+re+"\n\n      const ivec2 strides = ivec2("+g+", "+m+");\n      const ivec2 pads = ivec2("+d+", "+f+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        "+V+"\n\n        vec4 result = dotProd;\n        "+le+"\n        "+te+"\n        setOutput(result);\n      }\n    "}function xi(e,t,n,a,s){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var c=e[0],d=e[1],f=e[2],w=n[0],A=n[1];this.outputShape=[t[0],w,A,e[3]];var M=[d-1+".0",f-1+".0"],O=M[0],V=M[1],H=1<w?[""+(d-1)/(w-1),"(y2-y1) * height_ratio","y1*"+O+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+O],re=1<A?[""+(f-1)/(A-1),"(x2-x1) * width_ratio","x1*"+V+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+V];this.userCode="\n      const float height_ratio = float("+H[0]+");\n      const float width_ratio = float("+re[0]+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+c+") {\n          return;\n        }\n\n        float height_scale = "+H[1]+";\n        float width_scale = "+re[1]+";\n\n        float in_y = "+H[2]+";\n        if( in_y < 0.0 || in_y > "+O+" ) {\n          setOutput(float("+s+"));\n          return;\n        }\n        float in_x = "+re[2]+";\n        if( in_x < 0.0 || in_x > "+V+" ) {\n          setOutput(float("+s+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+("bilinear"===a?1:0)+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "}function ia(e,t,n){this.variableNames=["x"];var a=(this.outputShape=e).length,s=e[e.length-1],c=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+s+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+jn(a)+" coords = getOutputCoords();\n        int end = "+Gi(a,"coords")+";\n        float val = 0.0;\n        for (int i = "+s+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+c+" end) {\n            continue;\n          }\n          if (idx == end && "+t+") {\n            continue;\n          }\n          "+Gi(a,"coords")+" = idx;\n          val += getX("+function(d,f){if(1===a)return f;if(2===a)return f+".x, "+f+".y";if(3===a)return"coords.x, coords.y, coords.z";if(4===a)return"coords.x, coords.y, coords.z, coords.w";throw Error("Cumulative sum for rank "+a+" is not yet supported")}(0,"coords")+");\n        }\n        setOutput(val);\n      }\n    "}function Gi(e,t){if(1===e)return""+t;if(2===e)return t+".y";if(3===e)return t+".z";if(4===e)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}function xr(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=o.DENSE;var t=N(e),n=ci();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+Fo(["r","c","d"],e)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+t[0]+", "+t[1]+"));\n        int index = 4 * (resTexRC.x * "+t[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+n.output+" = result;\n      }\n    "}function Ia(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=o.DENSE;var t=N(e),n=ci();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+Fo(["r","c","d"],e)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+t[0]+", "+t[1]+"));\n        int index = 4 * (resTexRC.x * "+t[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+n.output+" = result;\n      }\n    "}function Ta(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}function hs(e){this.variableNames=["A"],this.outTexUsage=l.DOWNLOAD;var t=ci();this.outputShape=e,this.userCode="\n      "+$c+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+t.output+" = encode_float(x);\n      }\n    "}function Vr(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=l.DOWNLOAD;var t=ci();this.outputShape=e,this.userCode="\n      "+$c+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+t.output+" = encode_float(x);\n      }\n    "}function tr(e,t,n){void 0===n&&(n=!1),this.variableNames=["A"];var a=ci(),s=t[0],c=t[1];this.outputShape=e;var d="result";n&&(d="floor(result * 255. + 0.5)"),this.userCode="\n      "+Jl(e)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+c+";\n        int c = imod(flatIndex, "+c+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+c+".0, "+s+".0);\n        vec4 values = "+a.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+a.output+" = vec4("+d+", 0., 0., 0.);\n      }\n    "}function bi(e,t,n){void 0===n&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var a=ci(),s=t[0],c=t[1];this.outputShape=e;var d="",f="result";n&&(f="floor(result * 255. + 0.5)");for(var g=0;g<=1;g++)for(var m=0;m<=1;m++){var w=2*g+m;d+="\n          localCoords = coords;\n          if(localCoords[2] + "+m+" < "+e[2]+") {\n            localCoords[2] += "+m+";\n            if(localCoords[1] + "+g+" < "+e[1]+") {\n              localCoords[1] += "+g+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+c+";\n              c = imod(flatIndex, "+c+");\n              uv = (vec2(c, r) + halfCR) / vec2("+c+".0, "+s+".0);\n              values = "+a.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+w+"] = values[0];\n              } else if(offset == 1) {\n                result["+w+"] = values[1];\n              } else if(offset == 2) {\n                result["+w+"] = values[2];\n              } else {\n                result["+w+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+Jl(e)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        "+d+"\n\n        "+a.output+" = "+f+";\n      }\n    "}function Vi(e,t,n){this.variableNames=["real","imag"];var a=t[1];this.outputShape=t;var s=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI;this.userCode="\n      const float exponentMultiplier = "+s+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+e+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+a+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+a+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+(n?a+".0":"1.0")+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "}function co(e,t,n){this.variableNames=["A","indices"];var a=e.slice();a[n]=t,this.outputShape=a,this.rank=a.length;var s=jn(this.rank),c=function(d,f){var g=d.length;if(4<g)throw Error("Gather for rank "+g+" is not yet supported");if(1===g)return"int(getIndices(resRC))";for(var m=["resRC.x","resRC.y","resRC.z","resRC.w"],w=[],A=0;A<d.length;A++)w.push(A===f?"int(getIndices("+m[A]+"))":""+m[A]);return w.join()}(e,n);this.userCode="\n      void main() {\n        "+s+" resRC = getOutputCoords();\n        setOutput(getA("+c+"));\n      }\n    "}var vl=($a.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},$a.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},$a.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},$a.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},$a.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},$a),Kc=(Ql.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,a){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(a,"value")),n.gl.uniform1f(t.valueLoc,e)}},Ql);function Ql(e,t){this.outputShape=[],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}function $a(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+t+";\n      int offset_h = imod(h, "+t+");\n      int in_w = w / "+t+";\n      int offset_w = imod(w, "+t+");\n      int offset_d = (offset_h * "+t+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}function mh(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var a=jn(t.length),s=jn(n.length);this.userCode="\n        "+a+" strides = "+a+"("+this.strides+");\n         void main() {\n          "+s+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+(1<this.sliceDim?"strides[j]":"strides")+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "}function Zc(e,t){var n=ci();return W(e,t,n.version+"\n    precision highp float;\n    "+n.attribute+" vec3 clipSpacePos;\n    "+n.attribute+" vec2 uv;\n    "+n.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function ml(e,t){return Pe(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function Jc(e,t){return Ue(e,t,new Uint16Array([0,1,2,2,1,3]))}function ds(e,t,n,a,s,c,d){ft(n,a);var f=lt(e,t),g=e.TEXTURE_2D;return j(e,t,function(){return e.bindTexture(g,f)}),j(e,t,function(){return e.texParameteri(g,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),j(e,t,function(){return e.texParameteri(g,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),j(e,t,function(){return e.texParameteri(g,e.TEXTURE_MIN_FILTER,e.NEAREST)}),j(e,t,function(){return e.texParameteri(g,e.TEXTURE_MAG_FILTER,e.NEAREST)}),j(e,t,function(){return e.texImage2D(g,0,s,n,a,0,c,d,null)}),j(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)}),f}function Qc(e,t,n,a,s){var c=R(n,a);return ds(e,t,c[0],c[1],s.internalFormatFloat,s.textureFormatFloat,e.FLOAT)}function ec(e,t,n,a,s){var c=R(n,a);return ds(e,t,c[0],c[1],s.internalFormatHalfFloat,s.textureFormatFloat,s.textureTypeHalfFloat)}function tc(e,t,n,a,s){var c=R(n,a);return ds(e,t,c[0],c[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function eu(e,t,n,a,s){var c=B(n,a);return ds(e,t,c[0],c[1],s.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function tu(e,t,n,a,s){var c=B(n,a);return ds(e,t,c[0],c[1],s.internalFormatPackedHalfFloat,e.RGBA,s.textureTypeHalfFloat)}function uo(e,t,n,a){return j(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,a)}),St(e,t,n,"clipSpacePos",a,3,20,0)&&St(e,t,n,"uv",a,2,20,12)}function Gs(e,t,n,a,s,c,d){var f,g,m;j(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),m=c instanceof Uint8Array?(f=new Uint8Array(a*s*4),g=e.UNSIGNED_BYTE,e.RGBA):(f=new Float32Array(a*s*4),g=e.FLOAT,d.internalFormatPackedFloat),f.set(c),j(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,m,a,s,0,e.RGBA,g,f)}),j(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function nc(e,t,n,a){j(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),a.data instanceof Uint8Array?j(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,a.width,a.height,0,e.RGBA,e.UNSIGNED_BYTE,a.data)}):j(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,a)}),j(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function rc(e,t,n,a,s){var c=e.createBuffer();j(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,c)});var d=16*n*a;return j(e,t,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,d,e.STREAM_READ)}),j(e,t,function(){return e.readPixels(0,0,a,n,e.RGBA,e.FLOAT,0)}),j(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),c}function xl(e,t,n){var a=e,s=new Float32Array(n);return a.bindBuffer(a.PIXEL_PACK_BUFFER,t),a.getBufferSubData(a.PIXEL_PACK_BUFFER,0,s),a.bindBuffer(a.PIXEL_PACK_BUFFER,null),s}function ic(e,t,n,a,s){var c=R(n,a),d=c[0],f=c[1],g=new Uint8Array(n*a*4);return j(e,t,function(){return e.readPixels(0,0,d,f,s.downloadTextureFormat,e.UNSIGNED_BYTE,g)}),new Float32Array(g.buffer)}function ac(e,t,n,a,s,c,d,f){var g,m=e,w=new Float32Array((g=B(c,d))[0]*g[1]*4);return m.bindBuffer(m.PIXEL_PACK_BUFFER,t),m.getBufferSubData(m.PIXEL_PACK_BUFFER,0,w),m.bindBuffer(m.PIXEL_PACK_BUFFER,null),w}function oc(e,t,n,a){var s=new Float32Array(n*a*4);return j(e,t,function(){return e.readPixels(0,0,a,n,e.RGBA,e.FLOAT,s)}),s}var nu=Object.freeze({createVertexShader:Zc,createVertexBuffer:ml,createIndexBuffer:Jc,createFloat32MatrixTexture:Qc,createFloat16MatrixTexture:ec,createUnsignedBytesMatrixTexture:tc,createPackedMatrixTexture:eu,createFloat16PackedMatrixTexture:tu,bindVertexProgramAttributeStreams:uo,uploadDenseMatrixToTexture:Gs,uploadPixelDataToTexture:nc,createBufferFromOutputTexture:rc,downloadFloat32MatrixFromBuffer:xl,downloadByteEncodedFloatMatrixFromOutputTexture:ic,downloadPackedMatrixFromBuffer:ac,downloadMatrixFromPackedOutputTexture:oc}),ru=(Object.defineProperty(Ut.prototype,"debug",{get:function(){return _e().getBool("DEBUG")},enumerable:!0,configurable:!0}),Ut.prototype.dispose=function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;j(t,this.debug,function(){return t.finish()}),j(t,this.debug,function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)}),j(t,this.debug,function(){return t.deleteFramebuffer(e.framebuffer)}),j(t,this.debug,function(){return t.bindBuffer(t.ARRAY_BUFFER,null)}),j(t,this.debug,function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}),j(t,this.debug,function(){return t.deleteBuffer(e.indexBuffer)}),this.disposed=!0}},Ut.prototype.createFloat32MatrixTexture=function(e,t){return this.throwIfDisposed(),Qc(this.gl,this.debug,e,t,this.textureConfig)},Ut.prototype.createFloat16MatrixTexture=function(e,t){return this.throwIfDisposed(),ec(this.gl,this.debug,e,t,this.textureConfig)},Ut.prototype.createUnsignedBytesMatrixTexture=function(e,t){return this.throwIfDisposed(),tc(this.gl,this.debug,e,t)},Ut.prototype.uploadPixelDataToTexture=function(e,t){this.throwIfDisposed(),nc(this.gl,this.debug,e,t)},Ut.prototype.uploadDenseMatrixToTexture=function(e,t,n,a){this.throwIfDisposed(),Gs(this.gl,this.debug,e,t,n,a,this.textureConfig)},Ut.prototype.createFloat16PackedMatrixTexture=function(e,t){return this.throwIfDisposed(),tu(this.gl,this.debug,e,t,this.textureConfig)},Ut.prototype.createPackedMatrixTexture=function(e,t){return this.throwIfDisposed(),eu(this.gl,this.debug,e,t,this.textureConfig)},Ut.prototype.deleteMatrixTexture=function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(_n(this.gl,this.debug,this.framebuffer),this.outputTexture=null),j(this.gl,this.debug,function(){return t.gl.deleteTexture(e)})},Ut.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(e,t,n){var a=this;return this.downloadMatrixDriver(e,function(){return ic(a.gl,a.debug,t,n,a.textureConfig)})},Ut.prototype.downloadPackedMatrixFromBuffer=function(e,t,n,a,s,c){return ac(this.gl,e,0,0,0,s,c)},Ut.prototype.downloadFloat32MatrixFromBuffer=function(e,t){return xl(this.gl,e,t)},Ut.prototype.createBufferFromTexture=function(e,t,n){this.bindTextureToFrameBuffer(e);var a=rc(this.gl,this.debug,t,n);return this.unbindTextureToFrameBuffer(),a},Ut.prototype.createAndWaitForFence=function(){var e=this.createFence(this.gl);return this.pollFence(e)},Ut.prototype.createFence=function(e){var t,n,a=this;if(_e().getBool("WEBGL_FENCE_API_ENABLED")){var s=e,c=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var d=s.clientWaitSync(c,0,0);return d===s.ALREADY_SIGNALED||d===s.CONDITION_SATISFIED},t=c}else n=0<_e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?(t=this.beginQuery(),this.endQuery(),function(){return a.isQueryAvailable(t,_e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):function(){return!0};return{query:t,isFencePassed:n}},Ut.prototype.downloadMatrixFromPackedTexture=function(e,t,n){var a=this;return this.downloadMatrixDriver(e,function(){return oc(a.gl,a.debug,t,n)})},Ut.prototype.createProgram=function(e){this.throwIfDisposed();var t=this.gl,n=q(t,this.debug,e),a=Zc(t,this.debug),s=ge(t,this.debug);return j(t,this.debug,function(){return t.attachShader(s,a)}),j(t,this.debug,function(){return t.attachShader(s,n)}),Le(t,this.debug,s),this.debug&&qe(t,this.debug,s),this.vertexAttrsAreBound||(this.setProgram(s),this.vertexAttrsAreBound=uo(t,this.debug,this.program,this.vertexBuffer)),s},Ut.prototype.deleteProgram=function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&j(this.gl,this.debug,function(){return t.gl.deleteProgram(e)})},Ut.prototype.setProgram=function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&qe(this.gl,this.debug,this.program),j(this.gl,this.debug,function(){return t.gl.useProgram(e)})},Ut.prototype.getUniformLocation=function(e,t,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?Lt(this.gl,this.debug,e,t):$t(this.gl,e,t)},Ut.prototype.getAttributeLocation=function(e,t){var n=this;return this.throwIfDisposed(),j(this.gl,this.debug,function(){return n.gl.getAttribLocation(e,t)})},Ut.prototype.getUniformLocationNoThrow=function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)},Ut.prototype.setInputMatrixTexture=function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),zn(this.gl,this.debug,0,e,t,n)},Ut.prototype.setOutputMatrixTexture=function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)},Ut.prototype.setOutputPackedMatrixTexture=function(e,t,n){this.throwIfDisposed();var a=B(t,n);this.setOutputMatrixTextureDriver(e,a[0],a[1])},Ut.prototype.setOutputMatrixWriteRegion=function(e,t,n,a){this.setOutputMatrixWriteRegionDriver(n,e,a,t)},Ut.prototype.setOutputPackedMatrixWriteRegion=function(e,t,n,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},Ut.prototype.debugValidate=function(){null!=this.program&&qe(this.gl,this.debug,this.program),sr(this.gl)},Ut.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),j(e,this.debug,function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)})},Ut.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),j(this.gl,this.debug,function(){return e.gl.finish()})},Ut.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=I(this.gl,this.debug,2===_e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},Ut.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},Ut.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},Ut.prototype.beginQuery=function(){if(2===_e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var a=this.getQueryTimerExtensionWebGL1(),s=a.createQueryEXT();return a.beginQueryEXT(a.TIME_ELAPSED_EXT,s),s},Ut.prototype.endQuery=function(){if(2!==_e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}},Ut.prototype.waitForQueryAndGetTime=function(e){return F(this,void 0,void 0,function(){var t=this;return de(this,function(n){switch(n.label){case 0:return[4,sa(function(){return t.disposed||t.isQueryAvailable(e,_e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return n.sent(),[2,this.getQueryTime(e,_e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},Ut.prototype.getQueryTime=function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var a=this.getQueryTimerExtensionWebGL1();return a.getQueryObjectEXT(e,a.QUERY_RESULT_EXT)/1e6},Ut.prototype.isQueryAvailable=function(e,t){if(0===t)return!0;if(2!==t)return s=(a=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,a.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),s&&!this.disjoint;var n=this.gl,a=this.getQueryTimerExtensionWebGL2(),s=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),s&&!this.disjoint},Ut.prototype.pollFence=function(e){var t=this;return new Promise(function(n){t.addItemToPoll(function(){return e.isFencePassed()},function(){return n()})})},Ut.prototype.pollItems=function(){for(var e=function(n){for(var a=0;a<n.length&&n[a]();++a);return a-1}(this.itemsToPoll.map(function(n){return n.isDoneFn})),t=0;t<=e;++t)(0,this.itemsToPoll[t].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(e+1)},Ut.prototype.addItemToPoll=function(e,t){var n=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),1<this.itemsToPoll.length||sa(function(){return n.pollItems(),0===n.itemsToPoll.length})},Ut.prototype.bindTextureToFrameBuffer=function(e){this.throwIfDisposed(),En(this.gl,this.debug,e,this.framebuffer),this.debug&&sr(this.gl)},Ut.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(En(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&sr(this.gl)):_n(this.gl,this.debug,this.framebuffer)},Ut.prototype.downloadMatrixDriver=function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n},Ut.prototype.setOutputMatrixTextureDriver=function(e,t,n){this.throwIfDisposed();var a=this.gl;En(a,this.debug,e,this.framebuffer),this.debug&&sr(a),this.outputTexture=e,j(a,this.debug,function(){return a.viewport(0,0,t,n)}),j(a,this.debug,function(){return a.scissor(0,0,t,n)})},Ut.prototype.setOutputMatrixWriteRegionDriver=function(e,t,n,a){var s=this;this.throwIfDisposed(),j(this.gl,this.debug,function(){return s.gl.scissor(e,t,n,a)})},Ut.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},Ut.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},Ut);function Ut(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var t=_e().getNumber("WEBGL_VERSION");null!=e?k(t,this.gl=e):this.gl=S(t);var n="WEBGL_color_buffer_float";if(1===_e().getNumber("WEBGL_VERSION")){if(this.textureFloatExtension=I(this.gl,this.debug,"OES_texture_float"),$r(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=I(this.gl,this.debug,"OES_texture_half_float");else if(_e().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),$r(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=I(this.gl,this.debug,"EXT_color_buffer_half_float");else if(_e().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if($r(this.gl,n="EXT_color_buffer_float"))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!$r(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=ml(this.gl,this.debug),this.indexBuffer=Jc(this.gl,this.debug),this.framebuffer=At(this.gl,this.debug),this.textureConfig=U(this.gl,this.textureHalfFloatExtension)}function bl(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(n,a){var s=n.logicalShape,c=t[a],d=c.shape;if(!or(s,d))throw Error("Binary was compiled with different shapes than the current args. Shapes "+s+" and "+d+" must match");if(!n.isUniform||!c.isUniform){var f=n.texShape,g=c.isUniform?null:c.texData.texShape;if(!or(f,g))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+f+" and "+g+" must match")}})}function iu(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var s=n.inChannels,c=n.strideWidth,d=n.strideHeight,f=n.padInfo,g=n.outWidth,m=n.dilationWidth,w=n.dilationHeight,A=n.dataFormat,T=f.left,M=f.top,O=s*n.filterWidth,V=ci(),H="channelsLast"===A,X=H?0:1,$=H?1:2,ee="",re=0;re<=1;re++)for(var te=0;te<=1;te++)ee+="\n          blockIndex = rc.y + "+te+";\n          pos = rc.x + "+re+";\n\n          if(blockIndex < "+e[1]+" && pos < "+e[0]+") {\n            offsetY = int(blockIndex / ("+g+")) * "+d+" - "+M+";\n            d0 = offsetY + "+w+" * (pos / "+O+");\n\n            if(d0 < "+t[X]+" && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), "+g+".) * "+c+". - "+T+".);\n              d1 = offsetX + "+m+" * (int(mod(float(pos), "+O+".) / "+s+".));\n\n              if(d1 < "+t[$]+" && d1 >= 0) {\n\n                ch = int(mod(float(pos), "+s+".));\n\n                if ("+H+") {\n                  innerDims = vec2(d1, ch);\n                  result["+(2*re+te)+"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result["+(2*re+te)+"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        "+ee+"\n\n        "+V.output+" = result;\n      }\n    "}function Hx(e,t,n,a,s){this.variableNames=["x"],this.outputShape=[];var d=t,f=e[3]-1;this.outputShape=e;var g="float("+n+") + float("+a+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+d+"; j <= "+d+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+f+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+(.5===s?"inversesqrt("+g+")":1===s?"1.0/("+g+")":"exp(log("+g+") * float(-"+s+"));")+";\n        setOutput(val);\n      }\n    "}function Xx(e,t,n,a,s){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=a,this.beta=s,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+t+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+t+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+a+") * norm + float("+n+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+a+")\n                * float("+s+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+s+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "}function Gx(e,t,n,a,s){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var d=t,f=e[3]-1;this.outputShape=e;var g="float("+n+") + float("+a+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+d+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+d+"; j <= "+d+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+f+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+(.5===s?"inversesqrt("+g+")":1===s?"1.0/("+g+")":"exp(log("+g+") * float(-"+s+"));")+";\n        setOutput(result);\n      }\n    "}function Vx(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var s=e.effectiveFilterHeight,c=e.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(s-1-e.padInfo.top)+", "+(c-1-e.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+s+";\n          wR += "+e.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+e.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+c+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+e.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+(s*c-1)+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+c+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}function Yx(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var f=e.effectiveFilterDepth,g=e.effectiveFilterHeight,m=e.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(f-1-e.padInfo.front)+", "+(g-1-e.padInfo.top)+", "+(m-1-e.padInfo.left)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+f+";\n           wD += "+e.dilationDepth+") {\n          float dyD = float(dyDCorner + wD) / "+e.strideDepth+".0;\n\n          if (dyD < 0.0 || dyD >= "+e.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+g+";\n              wR += "+e.dilationHeight+") {\n            float dyR = float(dyRCorner + wR) / "+e.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+m+";\n                wC += "+e.dilationWidth+") {\n              float dyC = float(dyCCorner + wC) / "+e.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = "+(f*g*m-1)+" -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * "+g+" * "+m+" +\n                  wR * "+m+" + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}function xh(e,t,n,a,s,c,d){void 0===n&&(n=!1),void 0===a&&(a=!1),void 0===s&&(s=!1),void 0===c&&(c=null),void 0===d&&(d=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var g=Math.ceil((n?e[1]:e[2])/2),m=n?"i * 2, rc.y":"rc.y, i * 2",w=a?"rc.z, i * 2":"i * 2, rc.z",A=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],T=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],M="",O="";c&&(M=d?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+c+"\n        }":"vec4 activation(vec4 x) {\n          "+c+"\n        }",O="result = activation(result);");var V=s?"result += getBiasAtOutCoords();":"";s&&this.variableNames.push("bias"),d&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+M+"\n\n      const float sharedDimension = "+g+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+g+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+m+");\n          vec4 b = getMatrixB(rc.x, "+w+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+A[0]+" * "+T[0]+");\n          result += ("+A[1]+" * "+T[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+V+"\n\n        "+O+"\n\n        setOutput(result);\n      }\n    "}function jx(e,t,n,a){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+a+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "}function Ux(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t,a,s,c=(this.outputShape=e).length;if(0===c)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var d=Ti("rc",c),f=jn(c),g=function(A,T,M){if(1===A)return"rc > "+T[0];for(var O="",V=A-2;V<A;V++)O+=M[V]+" >= "+T[V],V<A-1&&(O+="||");return O}(c,e,d),m=function(A,T,M){if(1===A)return"";var O=d.slice(-2);return"\n    int r = "+O[0]+";\n    int c = "+O[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+T+";\n    bool rEdge = rp1 >= "+M+";\n  "}(c,e[e.length-1],e[e.length-2]),w=(s=function(A,T){for(var M=[],O=0;O<=1;O++)for(var V=0;V<=1;V++){for(var H=(0===O?"r":"rp1")+", "+(0===V?"c":"cp1"),X=2;X<A;X++)H=T[T.length-1-X]+","+H;M.push(H)}return M}(a=(t=e).length,d),1===a?"getA(rc),\n            rc + 1 >= "+t[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+s[0]+"),\n          cEdge ? 0. : getA("+s[1]+"),\n          rEdge ? 0. : getA("+s[2]+"),\n          rEdge || cEdge ? 0. : getA("+s[3]+")");this.userCode="\n        void main() {\n          "+f+" rc = getOutputCoords();\n\n          if("+g+") {\n            setOutput(vec4(0));\n          } else {\n            "+m+"\n\n            setOutput(vec4("+w+"));\n          }\n        }\n      "}}var qx=(Kf.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,a){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(a,"seed")),n.gl.uniform1f(t.seedLoc,e)}},Kf);function Kf(e,t,n){this.variableNames=["probs"],this.outputShape=[e,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(t-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(t-1)+"));\n      }\n    "}function $x(e,t,n){this.variableNames=["x"],this.outputShape=t.map(function(g,m){return g[0]+e[m]+g[1]});var a=e.length,s=jn(a),c=t.map(function(g){return g[0]}).join(","),d=t.map(function(g,m){return g[0]+e[m]}).join(","),f=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=1!==a?"\n      "+s+" start = "+s+"("+c+");\n      "+s+" end = "+s+"("+d+");\n\n      void main() {\n        "+s+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+s+" coords = outC - start;\n          setOutput(getX("+f+"));\n        }\n      }\n    ":"\n        int start = "+c+";\n        int end = "+d+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "}function Kx(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(H,X){return H[0]+e[X]+H[1]});for(var a=e.length,s=jn(a),c=t.map(function(H){return H[0]}).join(","),d=t.map(function(H,X){return H[0]+e[X]}).join(","),f=Ti("rc",a),g=Ti("source",a),m=f[a-1]+" < "+this.outputShape[a-1],w=1===a?"source":"vec2("+g.slice(-2).join()+")",A=[s+" rc = outputLoc;",f[a-1]+" += 1;\n       if("+m+") {\n      ",1===a?"":"}\n       rc = outputLoc;\n       "+f[a-2]+" += 1;\n       if("+f[a-2]+" < "+this.outputShape[a-2]+") {",1===a?"":"  "+f[a-1]+" += 1;\n         if("+m+") {"],T=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",M="",O=0,V=1===a?2:4;O<V;O++)M+="\n        "+A[O]+"\n        if ("+T+") {\n          result["+O+"] = float("+n+");\n        } else {\n          "+s+" source = rc - start;\n          result["+O+"] = getChannel(getX("+g.join()+"), "+w+");\n        }\n      ";this.userCode="\n      const "+s+" start = "+s+"("+c+");\n      const "+s+" end = "+s+"("+d+");\n\n      void main() {\n        "+s+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+(M+=1===a?"} ":"}}")+"\n        setOutput(result);\n      }\n    "}function bh(e,t,n){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var a=e.filterWidth,s=e.strideHeight,c=e.strideWidth,d=e.dilationHeight,f=e.dilationWidth,g=e.effectiveFilterHeight,m=e.effectiveFilterWidth,w=e.padInfo.top,A=e.padInfo.left;this.outputShape=e.outShape;var T="avg"===t,M="0.0";if(T||(M="-1.0 / 1e-20"),n)this.userCode="\n        const ivec2 strides = ivec2("+s+", "+c+");\n        const ivec2 pads = ivec2("+w+", "+A+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+g+";\n              wR += "+d+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+m+";\n                wC += "+f+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+m+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var O=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(O="avgValue / count");var V=4*Math.floor(a/4),H=a%4,X="\n      if ("+T+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+s+", "+c+");\n      const ivec2 pads = ivec2("+w+", "+A+");\n      const float initializationValue = "+M+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+M+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+g+";\n            wR += "+d+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+V+"; wC += 4) {\n            int xC = xCCorner + wC * "+f+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+f+", d),\n              getValue(batch, xR, xC + 2 * "+f+", d),\n              getValue(batch, xR, xC + 3 * "+f+", d)\n            );\n\n            "+X+"\n          }\n\n          int xC = xCCorner + "+V+";\n          if ("+(1==H)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+X+"\n          } else if ("+(2==H)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+f+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+X+"\n          } else if ("+(3==H)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+f+", d),\n              getValue(batch, xR, xC + 2 * "+f+", d),\n              initializationValue\n            );\n\n            "+X+"\n          }\n        }\n        setOutput("+O+");\n      }\n    "}}function yh(e,t,n){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var a=e.filterWidth,s=e.strideDepth,c=e.strideHeight,d=e.strideWidth,f=e.dilationDepth,g=e.dilationHeight,m=e.dilationWidth,w=e.effectiveFilterDepth,A=e.effectiveFilterHeight,T=e.effectiveFilterWidth,M=e.padInfo.front,O=e.padInfo.top,V=e.padInfo.left;this.outputShape=e.outShape;var H="avg"===t,X="0.0";if(H||(X="-1.0 / 1e-20"),n)this.userCode="\n        const ivec3 strides =\n            ivec3("+s+", "+c+", "+d+");\n        const ivec3 pads = ivec3("+M+", "+O+", "+V+");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < "+w+";\n              wD += "+f+") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= "+e.inDepth+") {\n              continue;\n            }\n\n            for (int wR = 0; wR < "+A+";\n                wR += "+g+") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= "+e.inHeight+") {\n                continue;\n              }\n\n              for (int wC = 0; wC < "+T+";\n                  wC += "+m+") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= "+e.inWidth+") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition =\n                      wD * "+A+" * "+T+" +\n                      wR * "+T+" + wC;;\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var $=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&($="avgValue / count");var ee=4*Math.floor(a/4),re=a%4,te="\n      if ("+H+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec3 strides =\n        ivec3("+s+", "+c+", "+d+");\n      const ivec3 pads = ivec3("+M+", "+O+", "+V+");\n      const float initializationValue = "+X+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+X+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < "+w+";\n            wD += "+f+") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= "+e.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+A+";\n            wR += "+g+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+ee+"; wC += 4) {\n              int xC = xCCorner + wC * "+m+";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+m+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+m+", ch),\n                getValue(batch, xD, xR, xC + 3 * "+m+", ch)\n              );\n\n              "+te+"\n            }\n\n            int xC = xCCorner + "+ee+";\n            if ("+(1==re)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              "+te+"\n            } else if ("+(2==re)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+m+", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              "+te+"\n            } else if ("+(3==re)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+m+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+m+", ch),\n                initializationValue\n              );\n\n              "+te+"\n            }\n          }\n          setOutput("+$+");\n        }\n      }\n    "}}function Zx(e,t){this.variableNames=["x"];var n=e.windowSize,a=e.batchSize,s=e.inSize,c=Math.ceil(s/n);this.outputShape=[a,c];var d="0.0",f="";"prod"===t?d="1.0":"min"===t?(d="1.0 / 1e-20",f="min"):"max"===t&&(d="-1.0 / 1e-20",f="max");var g=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===t?g="sumValue":"prod"===t?g="prodValue":"all"===t?g="allValue":"any"===t&&(g="anyValue");var m=4*Math.floor(n/4),w=n%4,A="\n      if ("+("sum"===t)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===t)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+f+"(values, minMaxValue);\n      }\n    ",T="vec4";"all"===t?(d="1.0",A="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",T="bvec4"):"any"===t&&(d="0.0",A="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",T="bvec4");var M="";0<s%n&&(M="\n        if (inIdx < 0 || inIdx >= "+s+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+d+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+M+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+d+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+m+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+T+" values = "+T+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+A+"\n        }\n\n        int inIdx = inOffset + "+m+";\n        if ("+(1==w)+") {\n          "+T+" values = "+T+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+A+"\n        } else if ("+(2==w)+") {\n          "+T+" values = "+T+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+A+"\n        } else if ("+(3==w)+") {\n          "+T+" values = "+T+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+A+"\n        }\n        setOutput("+g+");\n      }\n    "}function Jx(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",a=0;a<4;a++){var s="thisRC = rc;";a%2==1&&(s+="thisRC.z += 1;"),1<a&&(s+="thisRC.y += 1;"),n+="\n        "+s+"\n        "+(0<a?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+a+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(0<a?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+Fo(["r","c","d"],t)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+Jl(e)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+e[1]+";\n        int cols = "+e[2]+";\n\n        "+n+"\n\n        setOutput(result);\n      }\n    "}function Qx(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var a=t.shape,s=a[1],c=a[2],d=e.shape,f=d[1],g=d[2],m=[n&&1<f?s-1:s,n&&1<g?c-1:c],w=[n&&1<f?f-1:f,n&&1<g?g-1:g],A=m[0]/w[0],T=m[1]/w[1],M=1/A,O=1/T,V=2*Math.ceil(M)+2,H=2*Math.ceil(O)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+A+");\n        const float widthScale = float("+T+");\n\n        const float invHeightScale = float("+M+");\n        const float invWidthScale = float("+O+");\n\n        const int winHeight = int("+V+");\n        const int winWidth = int("+H+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+f+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+g+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(s-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(c-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "}function eb(e,t,n,a){this.variableNames=["A"],this.outputShape=[];var c=e[1],d=e[2];this.outputShape=[e[0],t,n,e[3]];var g=[a&&1<t?c-1:c,a&&1<n?d-1:d],m=[a&&1<t?t-1:t,a&&1<n?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+g[0]/m[0]+",\n          "+g[1]/m[1]+");\n      const vec2 inputShapeRC = vec2("+c+".0, "+d+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "}function tb(e,t,n,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var c=e[1],d=e[2],f=e[3];this.outputShape=[e[0],t,n,f];var g=[a&&1<t?c-1:c,a&&1<n?d-1:d],m=[a&&1<t?t-1:t,a&&1<n?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+g[0]/m[0]+",\n          "+g[1]/m[1]+",\n          "+g[1]/m[1]+");\n      const vec3 inputShapeRC = vec3("+c+".0, "+d+".0,\n                                     "+d+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(f-1)+";\n        bool hasNextRow = coords.z < "+(n-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "}function nb(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var a=t.shape,s=a[1],c=a[2],d=e.shape,f=d[1],g=d[2],m=[n&&1<f?s-1:s,n&&1<g?c-1:c],w=[n&&1<f?f-1:f,n&&1<g?g-1:g],A=m[0]/w[0],T=m[1]/w[1],M=1/A,O=1/T,V=2*Math.ceil(M)+2,H=2*Math.ceil(O)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+A+");\n        const float widthScale = float("+T+");\n\n        const float invHeightScale = float("+M+");\n        const float invWidthScale = float("+O+");\n\n        const int winHeight = int("+V+");\n        const int winWidth = int("+H+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+f+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+g+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+m[0]+") *\n                (float(dyR) / float("+w[0]+"));\n\n            float sourceFracCol =\n                float("+m[1]+") *\n                  (float(dyC) / float("+w[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+s+") - 1),\n                "+n+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+c+") - 1),\n                "+n+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "}function rb(e,t,n,a){this.variableNames=["A"],this.outputShape=[];var c=e[1],d=e[2];this.outputShape=[e[0],t,n,e[3]];var g=[a&&1<t?c-1:c,a&&1<n?d-1:d],m=[a&&1<t?t-1:t,a&&1<n?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+g[0]/m[0]+",\n          "+g[1]/m[1]+");\n      const vec2 inputShapeRC = vec2("+c+".0, "+d+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+(a?"0.5":"0.0")+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "}function ib(e,t){this.variableNames=["x"];var n=e.length;if(4<n)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,1!==n){var a=e.map(function(c,d){return-1!==t.indexOf(f=d)&&1!==e[f]?e[f]+" - coords["+f+"] - 1":"coords["+f+"]";var f}).join(","),s=jn(n);this.userCode="\n      void main() {\n        "+s+" coords = getOutputCoords();\n        setOutput(getX("+a+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+e[0]+" - coord - 1));\n        }\n      "}function ab(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(4<n)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var a,s,c,d=Ti("rc",n),f=d[n-1]+" + 1 < "+this.outputShape[n-1],g=d[n-2]+" + 1 < "+this.outputShape[n-2],m=jn(n);function w(A){var T=e.map(function(M,O){return H=A,-1!==t.indexOf(V=O)&&1!==e[V]?e[V]+" - "+H[V]+" - 1":""+H[V];var V,H});return"getChannel(getX("+T.join(",")+"), vec2("+T.slice(-2).join(",")+"))"}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+e[0]+" - rc - 1),\n            "+e[0]+" - rc - 1);\n          if("+f+"){\n              result.g = getChannel(getX("+e[0]+" - (rc  + 1) - 1),\n                "+e[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+m+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+w(d.slice())+";\n          if("+f+"){\n            result.g = "+((c=d.slice())[n-1]="("+c[n-1]+" + 1)",w(c)+";\n          }\n          if(")+g+") {\n            result.b = "+((s=d.slice())[n-2]="("+s[n-2]+" + 1)",w(s)+";\n            if(")+f+") {\n              result.a = "+((a=d.slice())[n-1]="("+a[n-1]+" + 1)",a[n-2]="("+a[n-2]+" + 1)",w(a)+";\n            }\n          }\n          setOutput(result);\n        }\n    ")}function Zf(e,t,n,a,s,c,d){this.variableNames=["updates","indices","defaultValue"],this.outputShape=c;var f=jn(s.length),g=jn(c.length),m="";1===n?m="i":2===n&&(m="i, j");var A="";1===a?A="i":2===a&&(A="i, coords[1]"),this.userCode="\n        "+f+" strides = "+f+"("+s+");\n\n        void main() {\n          "+g+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+e+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+t+"; j++) {\n              int index = round(getIndices("+m+"));\n              flattenedIndex += index * "+(1<t?"strides[j]":"strides")+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += getUpdates("+A+");\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "}function ob(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,a=e.batchSize,s=e.inSize,c=e.numSegments,d=c*Math.ceil(s/n);this.outputShape=[a,d];var f=4*Math.floor(n/4),g=n%4,m="\n        sumValue += dot(values, segFilter);\n    ",w="";0<s%n&&(w="\n        if (inIdx < 0 || inIdx >= "+s+") {\n          return initializationValue;\n        }\n      ");var A="";0<s%n&&(A="\n        if (inIdx < 0 || inIdx >= "+s+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+w+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+A+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+c+")) * float("+n+"));\n        int currentSeg = int(mod(float(outIdx), float("+c+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+f+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+m+"\n        }\n\n        int inIdx = inOffset + "+f+";\n        if ("+(1==g)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+m+"\n        } else if ("+(2==g)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+m+"\n        } else if ("+(3==g)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+m+"\n        }\n        setOutput(sumValue);\n      }\n    "}function sb(e,t,n){var a,s;if(this.variableNames=["c","a","b"],this.outputShape=t,4<n)throw Error("Where for rank "+n+" is not yet supported");if(1===n)a=s="resRC";else{for(var c=["resRC.x","resRC.y","resRC.z","resRC.w"],d=[],f=[],g=0;g<t.length;g++)f.push(""+c[g]),g<e&&d.push(""+c[g]);a=d.join(),s=f.join()}var m=jn(n);this.userCode="\n      void main() {\n        "+m+" resRC = getOutputCoords();\n        float cVal = getC("+a+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+s+"));\n        } else {\n          setOutput(getB("+s+"));\n        }\n      }\n    "}var lb=(Jf.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,a){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(a,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}},Jf),wh=["x","y","z","w","u","v"];function Jf(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var t,n=jn(this.rank),a="uniform int start["+this.rank+"];",s=function(c){if(1===c)return"sourceLoc";if(c<=6)return wh.slice(0,c).map(function(d){return"sourceLoc."+d}).join(",");throw Error("Slicing for rank "+c+" is not yet supported")}(this.rank);t="\n        "+n+" sourceLoc;\n        "+n+" coords = getOutputCoords();\n        "+e.map(function(c,d){return"sourceLoc."+wh[d]+" = start["+d+"] + coords."+wh[d]+";"}).join("\n")+"\n      ",this.userCode="\n      "+a+"\n      void main() {\n        "+t+"\n        setOutput(getSource("+s+"));\n      }\n    "}function cb(e,t,n){this.variableNames=["x"];var a=(this.outputShape=n).length,s=jn(n.length),c=jn(n.length),d="";if(1===a)d="coords * strides + begin";else{var f=0;d=n.map(function(g,m){return f++,1===n.length?"coords * strides["+m+"] + begin["+m+"]":"coords["+(f-1)+"] * strides["+m+"] + begin["+m+"]"}).join(",")}this.userCode="\n      "+s+" begin = "+s+"("+e+");\n      "+s+" strides = "+s+"("+t+");\n\n      void main() {\n        "+c+" coords = getOutputCoords();\n        setOutput(getX("+d+"));\n      }\n    "}var ub=(Qf.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,a){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(a,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}},Qf),hb=(Vs.prototype.acquireTexture=function(e,t,n){var a,s=ep(t,n),c=tp(e,s,n);if(c in this.freeTextures||(this.freeTextures[c]=[]),c in this.usedTextures||(this.usedTextures[c]=[]),0<this.freeTextures[c].length){this.numFreeTextures--,this.numUsedTextures++,this.log();var d=this.freeTextures[c].shift();return this.usedTextures[c].push(d),d}return this.numUsedTextures++,this.log(),s===u.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):s===u.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):s===u.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):s===u.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):s===u.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[c].push(a),a},Vs.prototype.releaseTexture=function(e,t,n,a){if(null!=this.freeTextures){var s=tp(t,ep(n,a),a);s in this.freeTextures||(this.freeTextures[s]=[]),this.freeTextures[s].push(e),this.numFreeTextures++,this.numUsedTextures--;var c=this.usedTextures[s],d=c.indexOf(e);if(d<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c.splice(d,1),this.log()}},Vs.prototype.log=function(){this.logEnabled&&console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+(this.numFreeTextures+this.numUsedTextures)+")")},Vs.prototype.getNumUsedTextures=function(){return this.numUsedTextures},Vs.prototype.getNumFreeTextures=function(){return this.numFreeTextures},Vs.prototype.dispose=function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach(function(n){e.gpgpu.deleteMatrixTexture(n)});for(var t in this.usedTextures)this.usedTextures[t].forEach(function(a){e.gpgpu.deleteMatrixTexture(a)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},Vs);function Vs(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}function Qf(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length;var t=jn(this.rank),n=Ti("coords",this.rank),a=Ti("sourceLoc",this.rank),s=1===this.rank?"sourceLoc":"vec2("+a.slice(-2).join()+")",c="getChannel(getSource("+a.join()+"), "+s+")",d="\n      result.x = "+c+";\n      if (++"+n[this.rank-1]+" < "+e[this.rank-1]+") {\n        ++"+a[this.rank-1]+";\n        result.y = "+c+";\n        --"+a[this.rank-1]+";\n      }\n    ",f=1===this.rank?"":"\n      --"+n[this.rank-1]+";\n      if (++"+n[this.rank-2]+" < "+e[this.rank-2]+") {\n        ++"+a[this.rank-2]+";\n        result.z = "+c+";\n        if (++"+n[this.rank-1]+" < "+e[this.rank-1]+") {\n          ++"+a[this.rank-1]+";\n          result.w = "+c+";\n        }\n      }\n    ",g=this.rank<=4?"sourceLoc = coords +\n            "+t+"("+e.map(function(m,w){return"start["+w+"]"}).join()+");":e.map(function(m,w){return a[w]+" = "+n[w]+" + start["+w+"];"}).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+t+" coords = getOutputCoords();\n        "+t+" sourceLoc;\n        "+g+"\n        vec4 result = vec4(0.);\n        "+d+"\n        "+f+"\n        setOutput(result);\n      }\n    "}function ep(e,t){if(e===l.UPLOAD)return u.PACKED_2X2_FLOAT32;if(e===l.RENDER||null==e)return n=t,_e().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?u.PACKED_2X2_FLOAT32:u.UNPACKED_FLOAT32:n?u.PACKED_2X2_FLOAT16:u.UNPACKED_FLOAT16;var n;if(e===l.DOWNLOAD||e===l.PIXELS)return u.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function tp(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}function db(e,t){this.variableNames=["A"];for(var n=new Array(e.length),a=0;a<n.length;a++)n[a]=e[a]*t[a];this.outputShape=n,this.rank=n.length;var s=jn(this.rank),c=function(d){var f=d.length;if(5<f)throw Error("Tile for rank "+f+" is not yet supported");if(1===f)return"imod(resRC, "+d[0]+")";for(var g=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],m=[],w=0;w<d.length;w++)m.push("imod("+g[w]+", "+d[w]+")");return m.join()}(e);this.userCode="\n      void main() {\n        "+s+" resRC = getOutputCoords();\n        setOutput(getA("+c+"));\n      }\n    "}function fb(e,t){this.variableNames=["A"];for(var n=new Array(e.length),a=0;a<n.length;a++)n[a]=e[t[a]];this.outputShape=n,this.rank=n.length;var s=jn(this.rank),c=function(d){var f=d.length;if(6<f)throw Error("Transpose for rank "+f+" is not yet supported");for(var g=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],m=new Array(f),w=0;w<d.length;w++)m[d[w]]=g[w];return m.join()}(t);this.userCode="\n    void main() {\n      "+s+" resRC = getOutputCoords();\n      setOutput(getA("+c+"));\n    }\n    "}function pb(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),a=0;a<n.length;a++)n[a]=e[t[a]];if(this.outputShape=n,this.rank=n.length,6<this.rank)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var s=jn(this.rank),c=qc("rc",this.rank),d=new Array(this.rank);for(a=0;a<t.length;a++)d[t[a]]=c[a];var f="vec2("+d.slice(-2).join()+")",g="++"+c[this.rank-1]+" < "+n[this.rank-1],m="getChannel(getA("+d.join()+"), "+f+")";this.userCode="\n    void main() {\n      "+s+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+m+";\n      if("+g+") {\n        result[1] = "+m+";\n      }\n      --"+c[this.rank-1]+";\n      if(++"+c[this.rank-2]+" < "+n[this.rank-2]+") {\n        result[2] = "+m+";\n        if("+g+") {\n          result[3] = "+m+";\n        }\n      }\n      setOutput(result);\n    }\n    "}function hn(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      float unaryOperation(float x) {\n        "+t+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "}function sc(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "}function gb(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1;var t=(this.outputShape=e).length,n=Ti("rc",t),a=jn(t),s=function(f,g){if(1===f)return"rc";for(var m="",w=0;w<f;w++)m+=g[w],w<f-1&&(m+=",");return m}(t,n),c=n.slice(-2),d=t<=1?"rc":"vec2("+c.join(",")+")";this.userCode="\n      void main() {\n        "+a+" rc = getOutputCoords();\n        vec4 packedInput = getA("+s+");\n\n        setOutput(getChannel(packedInput, "+d+"));\n      }\n    "}var Ch="if (isnan(x)) return x;",np="return abs(x);",rp=Ch+"\n  return (x < 0.0) ? 0.0 : x;\n",ip=Ch+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",ap="return (x >= 0.0) ? x : (exp(x) - 1.0);",op="return -x;",sp="return ceil(x);",lp="return floor(x);",cp="return exp(x);",up="return exp(x) - 1.0;",au="return x;",hp="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",dp="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",fp="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",kh={};function ou(e,t){if(void 0===t&&(t=!1),"linear"===e)return"return x;";if("relu"===e)return t?hp:rp;if("elu"===e)return t?fp:ap;if("relu6"===e)return t?dp:ip;if("prelu"===e)return t?jt:ln;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var pp,gp=(ut(De,pp=jl),De.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},De.prototype.write=function(e,t,n){if(_e().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var a={};return this.texData.set(a,{shape:t,dtype:n,values:e,usage:l.UPLOAD}),a},De.prototype.move=function(e,t,n,a){if(_e().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===a)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:a,values:t,usage:l.UPLOAD})},De.prototype.readSync=function(e){var t=this.texData.get(e),n=t.values,a=t.dtype,s=t.complexTensors,d=t.shape;if(null!=t.slice){var g;g=t.isPacked?new sc(d,au):new hn(d,au);var m=this.runWebGLProgram(g,[{dataId:e,shape:d,dtype:a}],a),w=this.readSync(m.dataId);return this.disposeData(m.dataId),w}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===a)return n;var A,T,M=null!=this.activeTimers;return M&&(A=pi()),T="complex64"===a?dl(s.real.dataSync(),s.imag.dataSync()):this.getValuesFromTexture(e),M&&(this.downloadWaitMs+=pi()-A),this.convertAndCacheOnCPU(e,T)},De.prototype.read=function(e){return F(this,void 0,void 0,function(){var t,n,a,s,d,f,g,m,w,A,T,M,O,V,H,ee,re,te,le;return de(this,function(se){switch(se.label){case 0:if(this.pendingRead.has(e))return t=this.pendingRead.get(e),[2,new Promise(function(ie){return t.push(ie)})];if(n=this.texData.get(e),a=n.values,s=n.shape,d=n.dtype,f=n.complexTensors,g=n.isPacked,null!=n.slice)return m=g?new sc(s,au):new hn(s,au),w=this.runWebGLProgram(m,[{dataId:e,shape:s,dtype:d}],d),A=this.read(w.dataId),this.disposeData(w.dataId),[2,A];if(null!=a)return[2,this.convertAndCacheOnCPU(e)];if(!_e().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===_e().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return T=null,"complex64"!==d&&_e().get("WEBGL_BUFFER_SUPPORTED")&&(M=this.decode(e),O=this.texData.get(M.dataId),T=(le=this.gpgpu).createBufferFromTexture.apply(le,[O.texture].concat(N(s)))),this.pendingRead.set(e,[]),"complex64"===d?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:se.sent(),se.label=2;case 2:return"complex64"!==d?[3,4]:[4,Promise.all([f.real.data(),f.imag.data()])];case 3:return H=se.sent(),V=dl(H[0],H[1]),[3,5];case 4:V=null==T?this.getValuesFromTexture(e):(ee=mt(s),this.gpgpu.downloadFloat32MatrixFromBuffer(T,ee)),se.label=5;case 5:return null!=M&&this.disposeData(M.dataId),re=this.convertAndCacheOnCPU(e,V),te=this.pendingRead.get(e),this.pendingRead.delete(e),te.forEach(function(ie){return ie(re)}),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e),this.pendingDeletes--),[2,re]}})})},De.prototype.checkNumericalProblems=function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!K(n))throw _e().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+n+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+n+" cannot be represented on this device.")}},De.prototype.getValuesFromTexture=function(e){var t,n=this.texData.get(e),a=n.shape,s=n.dtype,c=n.isPacked,d=mt(a);if(_e().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var f=this.decode(e),g=this.texData.get(f.dataId),m=(t=this.gpgpu).downloadMatrixFromPackedTexture.apply(t,[g.texture].concat(N(a))).subarray(0,d);return this.disposeData(f.dataId),m}var w=_e().getBool("WEBGL_PACK")&&!0===c,A=w?Xr(a):a,T=w?new Vr(A):new hs(A),M=this.runWebGLProgram(T,[{shape:A,dtype:s,dataId:e}],"float32"),O=this.texData.get(M.dataId),V=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(O.texture,O.texShape[0],O.texShape[1]).subarray(0,d);return this.disposeData(M.dataId),V},De.prototype.time=function(e){return F(this,void 0,void 0,function(){var t,n,a,s,c,d,f;return de(this,function(g){switch(g.label){case 0:return t=this.activeTimers,a=!(n=[]),null==this.programTimersStack?(this.programTimersStack=n,a=!0):this.activeTimers.push(n),this.activeTimers=n,e(),s=Qt(this.activeTimers.map(function(m){return m.query})).filter(function(m){return null!=m}),c=Qt(this.activeTimers.map(function(m){return m.name})).filter(function(m){return null!=m}),this.activeTimers=t,a&&(this.programTimersStack=null),d={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},0<_e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")?[4,Promise.all(s)]:[3,2];case 1:return f=g.sent(),d.kernelMs=yn(f),d.getExtraProfileInfo=function(){return f.map(function(m,w){return{name:c[w],ms:m}}).map(function(m){return m.name+": "+m.ms}).join(", ")},[3,3];case 2:d.kernelMs={error:"WebGL query timers are not supported in this environment."},g.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,d]}})})},De.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},De.prototype.startTimer=function(){return 0<_e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")?this.gpgpu.beginQuery():{startMs:pi(),endMs:null}},De.prototype.endTimer=function(e){return 0<_e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")?this.gpgpu.endQuery():e.endMs=pi(),e},De.prototype.getQueryTime=function(e){return F(this,void 0,void 0,function(){var t;return de(this,function(n){return 0<_e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")?[2,this.gpgpu.waitForQueryAndGetTime(e)]:[2,(t=e).endMs-t.startMs]})})},De.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var t=this.texData.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.texData.delete(e)}}},De.prototype.releaseGPUData=function(e){var t=this.texData.get(e),n=t.texture,a=t.dtype,s=t.texShape,c=t.usage,d=t.isPacked,f=t.slice,g=f&&f.origDataId||e,m=this.dataRefCount.get(g);1<m?this.dataRefCount.set(g,m-1):(this.dataRefCount.delete(g),null!=n&&(this.numBytesInGPU-=this.computeBytes(s,a),this.textureManager.releaseTexture(n,s,c,d)));var w=this.texData.get(e);w.texture=null,w.texShape=null,w.isPacked=!1,w.slice=null},De.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},De.prototype.getDataInfo=function(e){return this.texData.get(e)},De.prototype.getCPUBackend=function(){return _e().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=P.findBackend("cpu")),this.cpuBackend):null},De.prototype.shouldExecuteOnCPU=function(e,t){var n=this;return void 0===t&&(t=128),null!=this.getCPUBackend()&&e.every(function(a){return null==n.texData.get(a.dataId).texture&&a.size<t})},De.prototype.getGPGPUContext=function(){return this.gpgpu},De.prototype.complex=function(e,t){var n=this.makeOutput(e.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:P.keep(e.clone()),imag:P.keep(t.clone())},n},De.prototype.real=function(e){return this.texData.get(e.dataId).complexTensors.real.clone()},De.prototype.imag=function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()},De.prototype.slice=function(e,t,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,t,n);if(0===mt(n))return Wt([],n,e.dtype);var a=this.texData.get(e.dataId).isPacked,s=ls(e.shape,t,n);if(!a&&s)return this.uploadToGPU(e.dataId),this.shallowSlice(e,t,n);var c=_e().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ub(n):new lb(n),d=c.getCustomSetupFunc(t);return this.compileAndRun(c,[e],null,d)},De.prototype.shallowSlice=function(e,t,n){var a=this.texData.get(e.dataId),s=this.makeOutput(n,e.dtype),c=this.texData.get(s.dataId);Object.assign(c,a),c.shape=n,c.dtype=e.dtype;var d=sl(t,e.strides);a.slice&&(d+=a.slice.flatOffset),c.slice={flatOffset:d,origDataId:a.slice&&a.slice.origDataId||e.dataId};var f=this.dataRefCount.get(c.slice.origDataId)||1;return this.dataRefCount.set(c.slice.origDataId,f+1),s},De.prototype.stridedSlice=function(e,t,n,a){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,t,n,a);var s=al(t,n,a);if(s.some(function(d){return 0===d}))return Wt([],s);var c=new cb(t,a,s);return this.compileAndRun(c,[e])},De.prototype.reverse=function(e,t){var n=_e().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ab(e.shape,t):new ib(e.shape,t);return this.compileAndRun(n,[e])},De.prototype.concat=function(e,t){if("complex64"===e[0].dtype){var n=e.map(function(A){return ir(A)}),a=e.map(function(A){return gr(A)});return an(this.concat(n,t),this.concat(a,t))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,t);if(1===e.length)return e[0];if(e.length>_e().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var s=Math.floor(e.length/2),c=this.concat(e.slice(0,s),t),d=this.concat(e.slice(s),t);return this.concat([c,d],t)}if(_e().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&1<e[0].rank){var f=new ct(e.map(function(A){return A.shape}),t);return this.compileAndRun(f,e)}var g=zt(e.map(function(A){return A.shape}),t),m=e.map(function(A){return A.as2D(-1,mt(A.shape.slice(t)))}),w=new rt(m.map(function(A){return A.shape}));return this.compileAndRun(w,m).reshape(g)},De.prototype.neg=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(_e().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,op,e.dtype);var t=new hn(e.shape,op);return this.compileAndRun(t,[e])},De.prototype.batchMatMul=function(e,t,n,a){var s=n?e.shape[2]:e.shape[1],c=a?t.shape[1]:t.shape[2],d=n?e.shape[1]:e.shape[2],f=e.shape[0];if((1===s||1===c)&&1e3<d){n&&(e=e.transpose([0,2,1])),a&&(t=t.transpose([0,2,1]));var g=1===c?e:e.as3D(f,d,1),m=1===c?2:1,w=1===c?t.as3D(f,1,d):t;return this.multiply(g,w).sum(m,!0)}var A=Dn(e.dtype,t.dtype),T=new xh(e.shape,[f,s,c],n,a);return this.compileAndRun(T,[e,t],A)},De.prototype.fusedBatchMatMul=function(e){var t=e.a,n=e.b,a=e.transposeA,s=e.transposeB,c=e.bias,d=e.activation,f=e.preluActivationWeights,g=a?t.shape[2]:t.shape[1],m=s?n.shape[1]:n.shape[2],w=t.shape[0],A=Dn(t.dtype,n.dtype),T=null!=c,M=null!=f,O=d?ou(d,!0):null,V=new xh(t.shape,[w,g,m],a,s,T,O,M),H=[t,n];return c&&H.push(c),f&&H.push(f),this.compileAndRun(V,H,A)},De.prototype.multiply=function(e,t){if("complex64"===e.dtype){var n=this.texData.get(e.dataId),a=this.texData.get(t.dataId),s=new oe("return areal * breal - aimag * bimag;",e.shape,t.shape),c=new oe("return areal * bimag + aimag * breal;",e.shape,t.shape),d=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag),this.makeComplexComponentTensorInfo(t,a.complexTensors.real),this.makeComplexComponentTensorInfo(t,a.complexTensors.imag)],f=this.compileAndRun(s,d),g=this.compileAndRun(c,d),m=this.complex(f,g);return f.dispose(),g.dispose(),m}if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.multiply(e,t);if(_e().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,xt,e.dtype);var w=new Se(xt,e.shape,t.shape);return this.compileAndRun(w,[e,t],e.dtype)},De.prototype.batchNormalization=function(e,t,n,a,s,c){var d=[e,t,n],f=null;null!=c&&(f=c.shape,d.push(c));var g=null;if(null!=s&&(g=s.shape,d.push(s)),_e().getBool("WEBGL_PACK_NORMALIZATION")){var m=new Y(e.shape,t.shape,n.shape,f,g,a);return this.compileAndRun(m,d)}var w=new E(e.shape,t.shape,n.shape,f,g,a);return this.compileAndRun(w,d)},De.prototype.localResponseNormalization4D=function(e,t,n,a,s){var c=_e().getBool("WEBGL_PACK_NORMALIZATION")?new Gx(e.shape,t,n,a,s):new Hx(e.shape,t,n,a,s);return this.compileAndRun(c,[e])},De.prototype.LRNGrad=function(e,t,n,a,s,c,d){var f=new Xx(t.shape,a,s,c,d);return this.compileAndRun(f,[t,n,e])},De.prototype.tile=function(e,t){if("string"===e.dtype){var n=this.readSync(e.dataId).map(function(s){return Pi(s)});return gl(xe(e.shape,e.dtype,n),t)}var a=new db(e.shape,t);return this.compileAndRun(a,[e])},De.prototype.pad=function(e,t,n){var a=_e().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Kx(e.shape,t,n):new $x(e.shape,t,n);return this.compileAndRun(a,[e])},De.prototype.transpose=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.transpose(e,t);var n=_e().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new pb(e.shape,t):new fb(e.shape,t);return this.compileAndRun(n,[e])},De.prototype.gather=function(e,t,n){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.gather(e,t,n);var a=new co(e.shape,t.size,n);return this.compileAndRun(a,[e,t])},De.prototype.batchToSpaceND=function(e,t,n){ue(e.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var a=t.reduce(function(m,w){return m*w}),s=Ls(e.shape,t,a),c=rl(s.length,t.length),d=il(e.shape,t,a),f=Oc(n,t.length),g=Bc(d,n,t.length);return e.reshape(s).transpose(c).reshape(d).slice(f,g)},De.prototype.spaceToBatchND=function(e,t,n){ue(e.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var a=t.reduce(function(w,A){return w*A}),s=[[0,0]];s.push.apply(s,n);for(var c=1+t.length;c<e.shape.length;++c)s.push([0,0]);var d=e.pad(s),f=Ls(d.shape,t,a,!1),g=rl(f.length,t.length,!1),m=il(d.shape,t,a,!1);return d.reshape(f).transpose(g).reshape(m)},De.prototype.reduce=function(e,t,n){var a=e.shape[0],s=e.shape[1],d=new Zx({windowSize:Fs(s),inSize:s,batchSize:a},t),f=this.compileAndRun(d,[e],n);return 1===f.shape[1]?f:this.reduce(f,t,n)},De.prototype.argReduce=function(e,t,n){void 0===n&&(n=null);var a=e.shape[0],s=e.shape[1];null!=n&&(a=n.shape[0],s=n.shape[1]);var d=new lo({windowSize:Fs(s),inSize:s,batchSize:a},t,null==n),f=[e];null!=n&&f.push(n);var g=this.compileAndRun(d,f,"int32");return 1===g.shape[1]?g:this.argReduce(e,t,g)},De.prototype.argReducePacked=function(e,t,n){void 0===n&&(n=null);var a=null!=n?n.shape:e.shape,c=new vh(a,Fs(a[a.length-1]),t,null==n),f=this.compileAndRun(c,null==n?[e]:[e,n],"int32");return f.rank===e.rank?this.argReducePacked(e,t,f):f},De.prototype.sum=function(e,t){Ye("sum",t,e.rank);var n=Ie(e.shape,t),a=n[0],s=mt(n[1]),c=e.as2D(-1,s),d=Wi(e.dtype);return this.reduce(c,"sum",d).reshape(a)},De.prototype.prod=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,t);var n=Ie(e.shape,t),a=n[0],s=mt(n[1]),c=e.as2D(-1,s),d=Wi(e.dtype);return this.reduce(c,"prod",d).reshape(a)},De.prototype.unsortedSegmentSum=function(e,t,n){var a=0,s=Ne([a],e.rank),c=e;null!=s&&(c=e.transpose(s),a=Ct(1,e.rank)[0]);var d=function(A,T,M){for(var O=[],V=A.length,H=0;H<V;H++)O.push(H!==T?A[H]:M);return O}(c.shape,a,n),f=mt([c.shape[a]]),g=c.as2D(-1,f),m=Wi(e.dtype),w=this.segOpCompute(g,"unsortedSegmentSum",t,m,n).reshape(d);return null!=s&&(w=w.transpose(et(s))),w},De.prototype.segOpCompute=function(e,t,n,a,s){var c=e.shape[0],d=e.shape[1],f=function(w,A){var T,M=!1;for(w<=30?(T=w,M=!0):T=ca(w,Math.floor(Math.sqrt(w)));!M;)A<T||T===w?M=!0:T=ca(w,T+1);return T}(d,s),g=new ob({windowSize:f,inSize:d,batchSize:c,numSegments:s},t),m=this.compileAndRun(g,[e,n],a);return m.shape[1]===s?m:(n=Ar(0,s).tile([d/f]),this.segOpCompute(m,t,n,a,s))},De.prototype.argMinMaxReduce=function(e,t,n){var a=[t];if(Ye("arg"+n.charAt(0).toUpperCase()+n.slice(1),a,e.rank),!_e().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var s=Ie(e.shape,a),c=s[0],d=mt(s[1]),f=e.as2D(-1,d);return this.argReduce(f,n).reshape(c)}return this.argReducePacked(e,n)},De.prototype.argMin=function(e,t){return this.argMinMaxReduce(e,t,"min")},De.prototype.argMax=function(e,t){return this.argMinMaxReduce(e,t,"max")},De.prototype.cumsum=function(e,t,n,a){if(t!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+t);var s=new ia(e.shape,n,a);return this.compileAndRun(s,[e])},De.prototype.equal=function(e,t){if(_e().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(equal(a, b));\n","bool");var n=new Se("return float(a == b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},De.prototype.notEqual=function(e,t){if(_e().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(notEqual(a, b));\n","bool");var n=new Se("return float(a != b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},De.prototype.less=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.less(e,t);if(_e().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThan(a, b));\n","bool");var n=new Se("return float(a < b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},De.prototype.lessEqual=function(e,t){if(_e().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new Se("return float(a <= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},De.prototype.greater=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.greater(e,t);if(_e().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new Se("return float(a > b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},De.prototype.greaterEqual=function(e,t){if(_e().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new Se("return float(a >= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},De.prototype.logicalNot=function(e){var t=new hn(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(t,[e])},De.prototype.logicalAnd=function(e,t){if(_e().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new Se("return float(a >= 1.0 && b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},De.prototype.logicalOr=function(e,t){if(_e().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new Se("return float(a >= 1.0 || b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},De.prototype.select=function(e,t,n){var a=new sb(e.rank,t.shape,t.rank);return this.compileAndRun(a,[e,t,n],Dn(t.dtype,n.dtype))},De.prototype.where=function(e){L("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return Hs(e.shape,t)},De.prototype.topk=function(e,t,n){return Zl(e.dataSync(),e.shape,e.dtype,t)},De.prototype.min=function(e,t){Ye("min",t,e.rank);var n=Ie(e.shape,t),a=n[0],s=mt(n[1]),c=e.as2D(-1,s);return this.reduce(c,"min",c.dtype).reshape(a)},De.prototype.minimum=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.minimum(e,t);var n=_e().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Re("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Se("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},De.prototype.mod=function(e,t){var n=_e().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Re("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Se("if (b == 0.0) return NAN;\n  return mod(a, b);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},De.prototype.max=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.max(e,t);Ye("max",t,e.rank);var n=Ie(e.shape,t),a=n[0],s=mt(n[1]),c=e.as2D(-1,s);return this.reduce(c,"max",c.dtype).reshape(a)},De.prototype.maximum=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.maximum(e,t);var n=_e().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Re("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Se("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},De.prototype.all=function(e,t){Ye("all",t,e.rank);var n=Ie(e.shape,t),a=n[0],s=mt(n[1]),c=e.as2D(-1,s);return this.reduce(c,"all",c.dtype).reshape(a)},De.prototype.any=function(e,t){Ye("any",t,e.rank);var n=Ie(e.shape,t),a=n[0],s=mt(n[1]),c=e.as2D(-1,s);return this.reduce(c,"any",c.dtype).reshape(a)},De.prototype.realDivide=function(e,t){if(_e().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n","float32",!0);var n=new Se("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",e.shape,t.shape);return this.compileAndRun(n,[e,t],"float32")},De.prototype.floorDiv=function(e,t){if(_e().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new Se("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",e.shape,t.shape);return this.compileAndRun(n,[e,t],"int32")},De.prototype.add=function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,_t);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.add(e,t);var n=Dn(e.dtype,t.dtype);if(_e().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,_t,n);var a=new Se(_t,e.shape,t.shape);return this.compileAndRun(a,[e,t],n)},De.prototype.packedUnaryOp=function(e,t,n){var a=new sc(e.shape,t);return this.compileAndRun(a,[e],n)},De.prototype.packedBinaryOp=function(e,t,n,a,s){void 0===s&&(s=!1);var c=new Re(n,e.shape,t.shape,s);return this.compileAndRun(c,[e,t],a)},De.prototype.complexSeparableBinaryOp=function(e,t,n){var a=this,s=this.texData.get(e.dataId),c=this.texData.get(t.dataId),d=[[s.complexTensors.real,c.complexTensors.real],[s.complexTensors.imag,c.complexTensors.imag]].map(function(w){var A=w[0],T=w[1],M=a.makeComplexComponentTensorInfo(e,A),O=a.makeComplexComponentTensorInfo(t,T),V=new Se(n,e.shape,t.shape);return a.compileAndRun(V,[M,O],Dn(A.dtype,T.dtype))}),f=d[0],g=d[1],m=this.complex(f,g);return f.dispose(),g.dispose(),m},De.prototype.makeComplexComponentTensorInfo=function(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}},De.prototype.addN=function(e){if(1===e.length)return e[0];if(e.length>_e().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var t=Math.floor(e.length/2),n=this.addN(e.slice(0,t)),a=this.addN(e.slice(t));return this.addN([n,a])}var s=e.map(function(f){return f.dtype}).reduce(function(f,g){return Dn(f,g)}),c=e.map(function(f){return f.shape}),d=_e().getBool("WEBGL_PACK")?new Lo(e[0].shape,c):new ph(e[0].shape,c);return this.compileAndRun(d,e,s)},De.prototype.subtract=function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,It);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.subtract(e,t);var n=Dn(e.dtype,t.dtype);if(_e().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,It,e.dtype);var a=new Se(It,e.shape,t.shape);return this.compileAndRun(a,[e,t],n)},De.prototype.pow=function(e,t){var n=_e().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Re("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Se("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",e.shape,t.shape),a=Dn(e.dtype,t.dtype);return this.compileAndRun(n,[e,t],a)},De.prototype.ceil=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(_e().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,sp,e.dtype);var t=new hn(e.shape,sp);return this.compileAndRun(t,[e])},De.prototype.floor=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(_e().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,lp,e.dtype);var t=new hn(e.shape,lp);return this.compileAndRun(t,[e])},De.prototype.sign=function(e){var t=new hn(e.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(t,[e])},De.prototype.isNaN=function(e){var t=new hn(e.shape,"return float(isnan(x));");return this.compileAndRun(t,[e],"bool")},De.prototype.isInf=function(e){var t=new hn(e.shape,"return float(isinf(x));");return this.compileAndRun(t,[e],"bool")},De.prototype.isFinite=function(e){var t=new hn(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(t,[e],"bool")},De.prototype.round=function(e){var t=new hn(e.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(t,[e])},De.prototype.exp=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(_e().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,cp,e.dtype);var t=new hn(e.shape,cp);return this.compileAndRun(t,[e])},De.prototype.expm1=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(_e().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,up,e.dtype);var t=new hn(e.shape,up);return this.compileAndRun(t,[e])},De.prototype.softmax=function(e,t){var n=Nn([t],e.shape),a=this.max(e,n),s=Oe(a.shape,n),c=this.subtract(e,a.reshape(s)),d=this.exp(c),f=this.sum(d,n).reshape(s);return this.realDivide(d,f)},De.prototype.log=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(_e().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",e.dtype);var t=new hn(e.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(t,[e])},De.prototype.log1p=function(e){var t=new hn(e.shape,"return log(1.0 + x);");return this.compileAndRun(t,[e])},De.prototype.sqrt=function(e){var t=new hn(e.shape,"return sqrt(x);");return this.compileAndRun(t,[e])},De.prototype.rsqrt=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var t=new hn(e.shape,"return inversesqrt(x);");return this.compileAndRun(t,[e])},De.prototype.reciprocal=function(e){var t=new hn(e.shape,"return 1.0 / x;");return this.compileAndRun(t,[e])},De.prototype.relu=function(e){var t;return t=_e().getBool("WEBGL_PACK")?new sc(e.shape,hp):new hn(e.shape,rp),this.compileAndRun(t,[e])},De.prototype.relu6=function(e){var t;return t=_e().getBool("WEBGL_PACK")?new sc(e.shape,dp):new hn(e.shape,ip),this.compileAndRun(t,[e])},De.prototype.prelu=function(e,t){var n=_e().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Re(jt,e.shape,t.shape):new Se(ln,e.shape,t.shape);return this.compileAndRun(n,[e,t])},De.prototype.elu=function(e){if(_e().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,fp,e.dtype);var t=new hn(e.shape,ap);return this.compileAndRun(t,[e])},De.prototype.eluDer=function(e,t){var n=_e().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Re("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",e.shape,t.shape):new Se("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},De.prototype.selu=function(e){var t=new hn(e.shape,"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = 1.7580993408473768;\n  float scale = 1.0507009873554805;\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n");return this.compileAndRun(t,[e])},De.prototype.int=function(e){var t=new hn(e.shape,"return float(int(x));");return this.compileAndRun(t,[e],"int32")},De.prototype.clip=function(e,t,n){var a,s=(a=_e().getBool("WEBGL_PACK_CLIP")?new Zt(e.shape):new nn(e.shape)).getCustomSetupFunc(t,n);return this.compileAndRun(a,[e],null,s)},De.prototype.abs=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(_e().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,np,e.dtype);var t=new hn(e.shape,np);return this.compileAndRun(t,[e])},De.prototype.complexAbs=function(e){var t=this.texData.get(e.dataId),n=new $e(e.shape),a=[this.makeComplexComponentTensorInfo(e,t.complexTensors.real),this.makeComplexComponentTensorInfo(e,t.complexTensors.imag)];return this.compileAndRun(n,a)},De.prototype.sigmoid=function(e){var t=new hn(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(t,[e])},De.prototype.softplus=function(e){var t=new hn(e.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(t,[e])},De.prototype.sin=function(e){var t=new hn(e.shape,"if (isnan(x)) return x;\n  return sin(x);\n");return this.compileAndRun(t,[e])},De.prototype.cos=function(e){var t=new hn(e.shape,"if (isnan(x)) return x;\n  return cos(x);\n");return this.compileAndRun(t,[e])},De.prototype.tan=function(e){var t=new hn(e.shape,"return tan(x);");return this.compileAndRun(t,[e])},De.prototype.asin=function(e){var t=new hn(e.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n");return this.compileAndRun(t,[e])},De.prototype.acos=function(e){var t=new hn(e.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n");return this.compileAndRun(t,[e])},De.prototype.atan=function(e){var t=new hn(e.shape,"if (isnan(x)) return x;\n  return atan(x);\n");return this.compileAndRun(t,[e])},De.prototype.atan2=function(e,t){var n=_e().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Re("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Se("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},De.prototype.sinh=function(e){var t=new hn(e.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])},De.prototype.cosh=function(e){var t=new hn(e.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])},De.prototype.tanh=function(e){var t=new hn(e.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(t,[e])},De.prototype.asinh=function(e){var t=new hn(e.shape,"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(t,[e])},De.prototype.acosh=function(e){var t=new hn(e.shape,"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));");return this.compileAndRun(t,[e])},De.prototype.atanh=function(e){var t=new hn(e.shape,"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;");return this.compileAndRun(t,[e])},De.prototype.erf=function(e){var t=new hn(e.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n');return this.compileAndRun(t,[e])},De.prototype.step=function(e,t){var n,a=new hn(e.shape,(void 0===(n=t)&&(n=0),Ch+"\n    return x > 0.0 ? 1.0 : float("+n+");\n  "));return this.compileAndRun(a,[e])},De.prototype.conv2dByMatMul=function(e,t,n,a,s,c){var d=e.shape,f=this.texData.get(e.dataId),A="channelsLast"===n.dataFormat,M=d[2]%2!=0&&!!f.isPacked;if((1==d[0]*d[1]*d[2]||1===n.outChannels)&&1e3<n.inChannels||!_e().getBool("WEBGL_LAZILY_UNPACK")||!_e().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!M){var V=this.reshape(e,[1,A?d[0]*d[1]*d[2]:d[0]*d[2]*d[3],n.inChannels]),H=this.reshape(t,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:V,b:H,transposeA:!1,transposeB:!1,bias:a,activation:s,preluActivationWeights:c}),n.outShape)}var $={dataId:e.dataId,shape:[1,A?d[0]*d[1]*(d[2]+1):d[0]*d[2]*(d[3]+1),n.inChannels],dtype:e.dtype},ee=f.shape;f.shape=f.shape.slice(),f.shape[f.shape.length-2]++,ue(kr(f.shape,$.shape),function(){return"packed reshape "+f.shape+" to "+$.shape+" isn't free"});var re=this.reshape(t,[1,n.inChannels,n.outChannels]),te=this.fusedBatchMatMul({a:$,b:re,transposeA:!1,transposeB:!1,bias:a,activation:s,preluActivationWeights:c}),le=this.texData.get(te.dataId);return ue(le.isPacked,function(){return"batchMatMul result is expected to be packed"}),f.shape=ee,le.shape=n.outShape,P.makeTensorFromDataId(te.dataId,n.outShape,te.dtype)},De.prototype.conv2dWithIm2Row=function(e,t,n,a,s,c){var m=n.outWidth,w=n.outHeight,A="channelsLast"===n.dataFormat,T=n.filterWidth*n.filterHeight*n.inChannels,M=w*m,O=[T,M],V=e.squeeze([0]),H=t.reshape([1,T,-1]),X=new iu(O,V.shape,n),$=this.compileAndRun(X,[V]).reshape([1,O[0],O[1]]),ee=null!=a,re=null!=c,te=s?ou(s,!0):null,le=new xh($.shape,[1,M,n.outChannels],!0,!1,ee,te,re),se=[$,H];return a&&se.push(a),re&&se.push(c),this.compileAndRun(le,se).reshape(A?[1,w,m,n.outChannels]:[1,n.outChannels,w,m])},De.prototype.fusedConv2d=function(e){var t=e.input,n=e.filter,a=e.convInfo,s=e.bias,c=e.activation,d=e.preluActivationWeights;if(1===a.filterHeight&&1===a.filterWidth&&1===a.dilationHeight&&1===a.dilationWidth&&1===a.strideHeight&&1===a.strideWidth&&("SAME"===a.padInfo.type||"VALID"===a.padInfo.type))return this.conv2dByMatMul(t,n,a,s,c,d);if(_e().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,n,a,s,c,d);var g=null!=d,w=new Hn(a,null!=s,c?ou(c,!1):null,g),A=[t,n];return s&&A.push(s),d&&A.push(d),this.compileAndRun(w,A)},De.prototype.conv2d=function(e,t,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(e,t,n);if(_e().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,t,n);var a=new Hn(n);return this.compileAndRun(a,[e,t])},De.prototype.conv2dDerInput=function(e,t,n){var a=new Ln(n);return this.compileAndRun(a,[e,t])},De.prototype.conv2dDerFilter=function(e,t,n){var a=new vn(n);return this.compileAndRun(a,[e,t])},De.prototype.fusedDepthwiseConv2D=function(e){var t,n=e.input,a=e.filter,s=e.convInfo,c=e.bias,d=e.activation,f=e.preluActivationWeights,g=_e().getBool("WEBGL_PACK_DEPTHWISECONV")&&s.strideWidth<=2&&s.outChannels/s.inChannels==1,m=d?ou(d,g):null,w=[n,a],A=null!=c,T=null!=f;return A&&w.push(c),T&&w.push(f),t=g?new ra(s,A,m,T):new Ri(s,A,m,T),this.compileAndRun(t,w)},De.prototype.depthwiseConv2D=function(e,t,n){var a;return a=_e().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?new ra(n):new Ri(n),this.compileAndRun(a,[e,t])},De.prototype.depthwiseConv2DDerInput=function(e,t,n){var a=new Zn(n);return this.compileAndRun(a,[e,t])},De.prototype.depthwiseConv2DDerFilter=function(e,t,n){var a=new $n(n);return this.compileAndRun(a,[e,t])},De.prototype.conv3d=function(e,t,n){var a=new Tr(n);return this.compileAndRun(a,[e,t])},De.prototype.conv3dDerInput=function(e,t,n){var a=new Sn(n);return this.compileAndRun(a,[e,t])},De.prototype.conv3dDerFilter=function(e,t,n){var a=new un(n);return this.compileAndRun(a,[e,t])},De.prototype.maxPool=function(e,t){var n=new bh(t,"max",!1);return this.compileAndRun(n,[e])},De.prototype.avgPool=function(e,t){var n=new bh(t,"avg",!1);return this.compileAndRun(n,[e],"float32")},De.prototype.maxPoolBackprop=function(e,t,n,a){var s=new bh(a,"max",!0),c=this.compileAndRun(s,[t]),d=new Vx(a),f=this.compileAndRun(d,[e,c],t.dtype);return c.dispose(),f},De.prototype.avgPoolBackprop=function(e,t,n){var a=new Xs(n);return this.compileAndRun(a,[e],t.dtype)},De.prototype.cast=function(e,t){return ql(e,t,this)},De.prototype.unstack=function(e,t){for(var n=e.shape[t],a=new Array(e.rank-1),s=0,c=0;c<e.rank;c++)c!==t&&(a[s++]=e.shape[c]);var d=new Array(e.rank).fill(0),f=e.shape.slice();f[t]=1;var g=new Array(n);for(c=0;c<g.length;c++)g[d[t]=c]=this.slice(e,d,f).reshape(a);return g},De.prototype.avgPool3d=function(e,t){var n=new yh(t,"avg",!1);return this.compileAndRun(n,[e],"float32")},De.prototype.avgPool3dBackprop=function(e,t,n){var a=new Q(n);return this.compileAndRun(a,[e],t.dtype)},De.prototype.maxPool3d=function(e,t){var n=new yh(t,"max",!1);return this.compileAndRun(n,[e],"float32")},De.prototype.maxPool3dBackprop=function(e,t,n,a){var s=new yh(a,"max",!0),c=this.compileAndRun(s,[t]),d=new Yx(a),f=this.compileAndRun(d,[e,c],t.dtype);return c.dispose(),f},De.prototype.reshape=function(e,t){var n=this.texData.get(e.dataId);if(!n.isPacked||kr(e.shape,t)||null!==n.texture&&kr(n.shape,t))return hl(e,t);var a=this.packedReshape(e,t);return P.makeTensorFromDataId(a.dataId,a.shape,a.dtype)},De.prototype.resizeBilinear=function(e,t,n,a){var s=_e().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new tb(e.shape,t,n,a):new eb(e.shape,t,n,a);return this.compileAndRun(s,[e],"float32")},De.prototype.resizeBilinearBackprop=function(e,t,n){var a=new Qx(e,t,n);return this.compileAndRun(a,[e])},De.prototype.resizeNearestNeighbor=function(e,t,n,a){var s=new rb(e.shape,t,n,a);return this.compileAndRun(s,[e])},De.prototype.resizeNearestNeighborBackprop=function(e,t,n){var a=new nb(e,t,n);return this.compileAndRun(a,[e])},De.prototype.multinomial=function(e,t,n,a){var s=t?e:_a(e),f=new qx(s.shape[0],s.shape[1],n),g=f.getCustomSetupFunc(a);return this.compileAndRun(f,[s],"int32",g)},De.prototype.oneHot=function(e,t,n,a){var s=new jx(e.size,t,n,a);return this.compileAndRun(s,[e])},De.prototype.diag=function(e){var t=new Ta(e.size);return this.compileAndRun(t,[e])},De.prototype.nonMaxSuppression=function(e,t,n,a,s){return L("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Ws(e.dataSync(),t.dataSync(),n,a,s)},De.prototype.cropAndResize=function(e,t,n,a,s,c){var d=new xi(e.shape,t.shape,a,s,c);return this.compileAndRun(d,[e,t,n],"float32")},De.prototype.depthToSpace=function(e,t,n){ue(1<t,function(){return"blockSize should be > 1 for depthToSpace, but was: "+t});var a=e.shape[0],f=("NHWC"===n?e.shape[1]:e.shape[2])*t,g=("NHWC"===n?e.shape[2]:e.shape[3])*t,m=("NHWC"===n?e.shape[3]:e.shape[1])/(t*t),w=new vl("NHWC"===n?[a,f,g,m]:[a,m,f,g],t,n);return this.compileAndRun(w,[e])},De.prototype.split=function(e,t,n){return Kl(e,t,n)},De.prototype.scatterND=function(e,t,n){var a=Os(0,e,n),s=a.sliceRank,c=a.numUpdates,d=a.sliceSize,f=a.strides,g=a.outputSize,m=[g/d,d],w=e.reshape([c,s]),A=t.reshape([c,d]);if(0===g)return hl(Wt([]),n);var T=nt(0),M=new Zf(c,s,w.rank,A.rank,f,m);return this.compileAndRun(M,[A,w,T]).reshape(n)},De.prototype.sparseToDense=function(e,t,n,a){var s=Os(0,e,n),m=new Zf(s.numUpdates,s.sliceRank,e.rank,t.rank,s.strides,[s.outputSize,1],!1);return this.compileAndRun(m,[t,e,a]).reshape(n)},De.prototype.fft=function(e){return this.fftImpl(e,!1)},De.prototype.ifft=function(e){return this.fftImpl(e,!0)},De.prototype.fftImpl=function(e,t){var n=this.texData.get(e.dataId),a=new Vi("return real * expR - imag * expI;",e.shape,t),s=new Vi("return real * expI + imag * expR;",e.shape,t),c=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag)],d=this.compileAndRun(a,c),f=this.compileAndRun(s,c),g=this.complex(d,f).as2D(e.shape[0],e.shape[1]);return d.dispose(),f.dispose(),g},De.prototype.gatherND=function(e,t){var n=t.shape,a=n[n.length-1],s=Vl(e,t),c=s[0],d=s[1],f=s[2],g=s[3],m=t.reshape([d,a]),w=e.reshape([e.size/f,f]),A=new mh(a,g,[d,f]);return this.compileAndRun(A,[w,m]).reshape(c)},De.prototype.fill=function(e,t,n){if("string"===(n=n||Si(t))){var a=la(n,mt(e));return a.fill(t),P.makeTensor(a,e,n,this)}var s=new Kc(e,t),c=s.getCustomSetupFunc(t);return this.compileAndRun(s,[],n,c)},De.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)},De.prototype.zerosLike=function(e){return this.fill(e.shape,"string"===e.dtype?"":0,e.dtype)},De.prototype.linspace=function(e,t,n){return $l(e,t,n)},De.prototype.makeTensorInfo=function(e,t){var n=this.write(null,e,t);return this.texData.get(n).usage=null,{dataId:n,shape:e,dtype:t}},De.prototype.makeOutput=function(e,t){var n=this.makeTensorInfo(e,t).dataId;return P.makeTensorFromDataId(n,e,t,this)},De.prototype.unpackTensor=function(e){var t=new gb(e.shape);return this.runWebGLProgram(t,[e],e.dtype)},De.prototype.packTensor=function(e){var t=new Ux(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)},De.prototype.packedReshape=function(e,t){var n=[Gn(e.shape)].concat(cr(e.shape)),a={dtype:e.dtype,shape:n,dataId:e.dataId},c=new Jx([Gn(t)].concat(cr(t)),n),d=this.runWebGLProgram(c,[a],e.dtype,null,!0);return{dataId:d.dataId,shape:t,dtype:d.dtype}},De.prototype.decode=function(e){var t,n=this.texData.get(e),a=n.isPacked,s=n.shape,c=n.dtype,d=Xr(s);return t=a?new Ia(d):new xr(d),{dtype:c,shape:s,dataId:this.runWebGLProgram(t,[{shape:d,dtype:c,dataId:e}],c,null,!0).dataId}},De.prototype.runWebGLProgram=function(e,t,n,a,s){var c=this;void 0===s&&(s=!1);var d=this.makeTensorInfo(e.outputShape,n),f=this.texData.get(d.dataId);if(e.packedOutput&&(f.isPacked=!0),e.outPackingScheme===o.DENSE){var g=N(e.outputShape);f.texShape=g.map(function(X){return 2*X})}if(null!=e.outTexUsage&&(f.usage=e.outTexUsage),0===mt(d.shape))return f.values=Ai(d.dtype,0),d;var m=[],w=t.map(function(X){if("complex64"===X.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var $=c.texData.get(X.dataId);if(null==$.texture){if(!e.packedInputs&&mt(X.shape)<=_e().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:X.shape,texData:null,isUniform:!0,uniformValues:$.values};e.packedInputs&&($.isPacked=!0,$.shape=X.shape)}else if(!!$.isPacked!=!!e.packedInputs)X=$.isPacked?c.unpackTensor(X):c.packTensor(X),m.push(X),$=c.texData.get(X.dataId);else if($.isPacked&&!kr($.shape,X.shape)){var ee=X,re=X.shape;X.shape=$.shape,X=c.packedReshape(X,re),m.push(X),$=c.texData.get(X.dataId),ee.shape=re}return c.uploadToGPU(X.dataId),{shape:X.shape,texData:$,isUniform:!1}});this.uploadToGPU(d.dataId);var A,X,re,T={shape:d.shape,texData:f,isUniform:!1},M=(X=e,re="",w.concat(T).forEach(function(le){re+=le.shape+"_"+(le.isUniform?"uniform":le.texData.texShape)+"_"+(null!=le.texData&&null!=le.texData.slice&&0<le.texData.slice.flatOffset)}),X.constructor.name+"_"+re+"_"+X.userCode),O=this.getAndSaveBinary(M,function(){return function(X,$,ee,re){var te=$.userCode,le=ee.map(function(Ee,He){var tt={logicalShape:Ee.shape,texShape:Ee.isUniform?null:Ee.texData.texShape,isUniform:Ee.isUniform,isPacked:!Ee.isUniform&&Ee.texData.isPacked,flatOffset:null};return null!=Ee.texData&&null!=Ee.texData.slice&&0<Ee.texData.slice.flatOffset&&(tt.flatOffset=Ee.texData.slice.flatOffset),{name:$.variableNames[He],shapeInfo:tt}}),se=le.map(function(Ee){return Ee.shapeInfo}),ie={logicalShape:re.shape,texShape:re.texData.texShape,isUniform:!1,isPacked:re.texData.isPacked,flatOffset:null},ce=function gh(e,t,n,a){var s=[];e.forEach(function(O){var V=mt(O.shapeInfo.logicalShape);O.shapeInfo.isUniform?s.push("uniform float "+O.name+(1<V?"["+V+"]":"")+";"):(s.push("uniform sampler2D "+O.name+";"),s.push("uniform int offset"+O.name+";"))});var c,d,f,g=s.join("\n"),m=e.map(function(O){return function(V,H,X){void 0===X&&(X=!1);var $="";return $+=X?function te(le){var se,he,be,Ae,Te,We,Fe;switch(le.shapeInfo.logicalShape.length){case 0:return"\n    vec4 get"+(se=le.name).charAt(0).toUpperCase()+se.slice(1)+"() {\n      return "+ci().texture2D+"("+se+", halfCR);\n    }\n  ";case 1:return Ae="get"+(be=(he=le).name).charAt(0).toUpperCase()+be.slice(1),Te=he.shapeInfo.texShape,We=[Math.ceil(Te[0]/2),Math.ceil(Te[1]/2)],Fe=ci(),"\n    vec4 "+Ae+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+We[0]+", "+We[1]+", index);\n      return "+Fe.texture2D+"("+be+", uv);\n    }\n  ";case 2:return function(he){var be=he.shapeInfo.logicalShape,Ae=he.name,Te="get"+Ae.charAt(0).toUpperCase()+Ae.slice(1),We=he.shapeInfo.texShape,Fe=We[0],Ee=We[1],He=ci();if(null!=We&&or(be,We))return"\n      vec4 "+Te+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+Ee+".0, "+Fe+".0);\n\n        return "+He.texture2D+"("+Ae+", uv);\n      }\n    ";var tt=[Math.ceil(We[0]/2),Math.ceil(We[1]/2)];return"\n    vec4 "+Te+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+Math.ceil(be[1]/2)+", "+tt[0]+", "+tt[1]+", row, col);\n      return "+He.texture2D+"("+Ae+", uv);\n    }\n  "}(le);case 3:return function(he){var be=he.shapeInfo.logicalShape,Ae=he.name,Te="get"+Ae.charAt(0).toUpperCase()+Ae.slice(1),We=he.shapeInfo.texShape,Fe=[Math.ceil(We[0]/2),Math.ceil(We[1]/2)];if(1===be[0]){var He=qa(he,be.slice(1));return"\n        "+te(He)+"\n        vec4 "+Te+"(int b, int row, int col) {\n          return "+Te+"("+us(["b","row","col"],[1,2])+");\n        }\n      "}var tt=Fe[0],it=Fe[1],ot=Math.ceil(be[2]/2);return"\n    vec4 "+Te+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+tt+", "+it+", "+ot*Math.ceil(be[1]/2)+", "+ot+", b, row, col);\n      return "+ci().texture2D+"("+Ae+", uv);\n    }\n  "}(le);default:return function(he){for(var be=he.shapeInfo.logicalShape,Ae=be.length,Te=he.name,We="get"+Te.charAt(0).toUpperCase()+Te.slice(1),Fe=he.shapeInfo.texShape,Ee=[Math.ceil(Fe[0]/2),Math.ceil(Fe[1]/2)],He=Ee[0],tt=Ee[1],it=Math.ceil(be[Ae-1]/2),ot=it*Math.ceil(be[Ae-2]/2),pt="int b, int row, int col",Rt="b * "+ot+" + (row / 2) * "+it+" + (col / 2)",Dt=2;Dt<Ae-1;Dt++)pt="int b"+Dt+", "+pt,Rt="b"+Dt+" * "+(ot*=be[Ae-Dt-1])+" + "+Rt;return"\n    vec4 "+We+"("+pt+") {\n      int index = "+Rt+";\n      int texR = index / "+tt+";\n      int texC = index - texR * "+tt+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+tt+", "+He+");\n      return "+ci().texture2D+"("+Te+", uv);\n    }\n  "}(le)}}(V):function te(le){var se=le.shapeInfo.logicalShape;switch(se.length){case 0:return function(ie){var ce=ie.name,he="get"+ce.charAt(0).toUpperCase()+ce.slice(1);if(ie.shapeInfo.isUniform)return"float "+he+"() {return "+ce+";}";var be=ie.shapeInfo.texShape;if(1===be[0]&&1===be[1])return"\n      float "+he+"() {\n        return sampleTexture("+ce+", halfCR);\n      }\n    ";var We=ie.shapeInfo.texShape;return"\n    float "+he+"() {\n      vec2 uv = uvFromFlat("+We[0]+", "+We[1]+", "+Oo(ce)+");\n      return sampleTexture("+ce+", uv);\n    }\n  "}(le);case 1:return function(ie){var ce=ie.name,he="get"+ce.charAt(0).toUpperCase()+ce.slice(1);if(ie.shapeInfo.isUniform)return"\n      float "+he+"(int index) {\n        "+Bo(ie)+"\n      }\n    ";var be=ie.shapeInfo.texShape,Ae=be[0],Te=be[1];if(1===Te&&1===Ae)return"\n      float "+he+"(int index) {\n        return sampleTexture("+ce+", halfCR);\n      }\n    ";var We=Oo(ce);return 1===Te?"\n      float "+he+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+We+") + 0.5) / "+Ae+".0);\n        return sampleTexture("+ce+", uv);\n      }\n    ":1===Ae?"\n      float "+he+"(int index) {\n        vec2 uv = vec2((float(index + "+We+") + 0.5) / "+Te+".0, 0.5);\n        return sampleTexture("+ce+", uv);\n      }\n    ":"\n    float "+he+"(int index) {\n      vec2 uv = uvFromFlat("+Ae+", "+Te+", index + "+We+");\n      return sampleTexture("+ce+", uv);\n    }\n  "}(le);case 2:return function(ie){var ce=ie.shapeInfo.logicalShape,he=ie.name,be="get"+he.charAt(0).toUpperCase()+he.slice(1),Ae=ie.shapeInfo.texShape;if(null!=Ae&&or(ce,Ae))return"\n    float "+be+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+Ae[1]+".0, "+Ae[0]+".0);\n      return sampleTexture("+he+", uv);\n    }\n  ";var Fe=Je(ce),Ee=Fe.newShape,He=Fe.keptDims;if(Ee.length<ce.length){var it=qa(ie,Ee);return"\n      "+te(it)+"\n      float "+be+"(int row, int col) {\n        return "+be+"("+us(["row","col"],He)+");\n      }\n    "}if(ie.shapeInfo.isUniform)return"\n      float "+be+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+ce[1]+", 1)));\n        "+Bo(ie)+"\n      }\n    ";var ot=Ae[0],pt=Ae[1],Rt=Oo(he);return 1===pt?"\n    float "+be+"(int row, int col) {\n      float index = dot(vec3(row, col, "+Rt+"), vec3("+ce[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+ot+".0);\n      return sampleTexture("+he+", uv);\n    }\n  ":1===ot?"\n    float "+be+"(int row, int col) {\n      float index = dot(vec3(row, col, "+Rt+"), vec3("+ce[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+pt+".0, 0.5);\n      return sampleTexture("+he+", uv);\n    }\n  ":"\n  float "+be+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+ce[1]+" + col + "+Rt+";\n    vec2 uv = uvFromFlat("+ot+", "+pt+", index);\n    return sampleTexture("+he+", uv);\n  }\n"}(le);case 3:return function(ie){var ce=ie.shapeInfo.logicalShape,he=ie.name,be="get"+he.charAt(0).toUpperCase()+he.slice(1),Ae=ce[1]*ce[2],Te=ce[2],We=Je(ce),Fe=We.newShape,Ee=We.keptDims;if(Fe.length<ce.length){var tt=qa(ie,Fe);return"\n        "+te(tt)+"\n        float "+be+"(int row, int col, int depth) {\n          return "+be+"("+us(["row","col","depth"],Ee)+");\n        }\n      "}if(ie.shapeInfo.isUniform)return"\n      float "+be+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+Ae+", "+Te+", 1)));\n        "+Bo(ie)+"\n      }\n    ";var it=ie.shapeInfo.texShape,ot=it[0],pt=it[1],Rt=ie.shapeInfo.flatOffset;return pt===Ae&&null==Rt?"\n        float "+be+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+Te+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+pt+".0, "+ot+".0);\n          return sampleTexture("+he+", uv);\n        }\n      ":pt===Te&&null==Rt?"\n    float "+be+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+ce[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+pt+".0, "+ot+".0);\n      return sampleTexture("+he+", uv);\n    }\n  ":"\n      float "+be+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+Ae+" + col * "+Te+" + depth + "+Oo(he)+";\n        vec2 uv = uvFromFlat("+ot+", "+pt+", index);\n        return sampleTexture("+he+", uv);\n      }\n  "}(le);case 4:return function(ie){var ce=ie.shapeInfo.logicalShape,he=ie.name,be="get"+he.charAt(0).toUpperCase()+he.slice(1),Ae=ce[3],Te=ce[2]*Ae,We=ce[1]*Te,Fe=Je(ce),Ee=Fe.newShape,He=Fe.keptDims;if(Ee.length<ce.length){var tt=qa(ie,Ee);return"\n      "+te(tt)+"\n      float "+be+"(int row, int col, int depth, int depth2) {\n        return "+be+"("+us(["row","col","depth","depth2"],He)+");\n      }\n    "}if(ie.shapeInfo.isUniform)return"\n      float "+be+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+We+", "+Te+", "+Ae+", 1)));\n        "+Bo(ie)+"\n      }\n    ";var it=ie.shapeInfo.flatOffset,ot=ie.shapeInfo.texShape,pt=ot[0],Rt=ot[1];return Rt===We&&null==it?"\n      float "+be+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+Te+", "+Ae+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+Rt+".0, "+pt+".0);\n        return sampleTexture("+he+", uv);\n      }\n    ":Rt===Ae&&null==it?"\n      float "+be+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+ce[1]*ce[2]+", "+ce[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+Rt+".0, "+pt+".0);\n        return sampleTexture("+he+", uv);\n      }\n    ":"\n    float "+be+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+We+" + col * "+Te+" +\n          depth * "+Ae+" + depth2;\n      vec2 uv = uvFromFlat("+pt+", "+Rt+", index + "+Oo(he)+");\n      return sampleTexture("+he+", uv);\n    }\n  "}(le);case 5:return function(ie){var ce=ie.shapeInfo.logicalShape,he=ie.name,be="get"+he.charAt(0).toUpperCase()+he.slice(1),Ae=ce[4],Te=ce[3]*Ae,We=ce[2]*Te,Fe=ce[1]*We,Ee=Je(ce),He=Ee.newShape,tt=Ee.keptDims;if(He.length<ce.length){var it=qa(ie,He);return"\n      "+te(it)+"\n      float "+be+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+be+"("+us(["row","col","depth","depth2","depth3"],tt)+");\n      }\n    "}if(ie.shapeInfo.isUniform)return"\n      float "+be+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+Fe+", "+We+", "+Te+", "+Ae+")) +\n          depth3;\n        "+Bo(ie)+"\n      }\n    ";var ot=ie.shapeInfo.flatOffset,pt=ie.shapeInfo.texShape,Rt=pt[0],Dt=pt[1];return Dt===Fe&&null==ot?"\n      float "+be+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+We+", "+Te+", "+Ae+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+Dt+".0, "+Rt+".0);\n        return sampleTexture("+he+", uv);\n      }\n    ":Dt===Ae&&null==ot?"\n      float "+be+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+ce[1]*ce[2]*ce[3]+",\n               "+ce[2]*ce[3]+", "+ce[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+Dt+".0, "+Rt+".0);\n        return sampleTexture("+he+", uv);\n      }\n    ":"\n    float "+be+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+Fe+" + col * "+We+" + depth * "+Te+" +\n          depth2 * "+Ae+" + depth3 + "+Oo(he)+";\n      vec2 uv = uvFromFlat("+Rt+", "+Dt+", index);\n      return sampleTexture("+he+", uv);\n    }\n  "}(le);case 6:return function(ie){var ce=ie.shapeInfo.logicalShape,he=ie.name,be="get"+he.charAt(0).toUpperCase()+he.slice(1),Ae=Je(ce),Te=Ae.newShape,We=Ae.keptDims;if(Te.length<ce.length){var Fe=qa(ie,Te);return"\n      "+te(Fe)+"\n      float "+be+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+be+"("+us(["row","col","depth","depth2","depth3","depth4"],We)+");\n      }\n    "}var Ee=ce[5],He=ce[4]*Ee,tt=ce[3]*He,it=ce[2]*tt,ot=ce[1]*it;if(ie.shapeInfo.isUniform)return"\n      float "+be+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+ot+", "+it+", "+tt+", "+He+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+Ee+", 1)));\n        "+Bo(ie)+"\n      }\n    ";var pt=ie.shapeInfo.flatOffset,Rt=ie.shapeInfo.texShape,Dt=Rt[0],qt=Rt[1];return qt===ot&&null==pt?"\n      float "+be+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+it+", "+tt+", "+He+", "+Ee+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+qt+".0, "+Dt+".0);\n        return sampleTexture("+he+", uv);\n      }\n    ":qt===Ee&&null==pt?"\n      float "+be+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+ce[1]*ce[2]*ce[3]*ce[4]+",\n               "+ce[2]*ce[3]*ce[4]+",\n               "+ce[3]*ce[4]+",\n               "+ce[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+qt+".0, "+Dt+".0);\n        return sampleTexture("+he+", uv);\n      }\n    ":"\n    float "+be+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+ot+" + col * "+it+" + depth * "+tt+" +\n          depth2 * "+He+" + depth3 * "+Ee+" + depth4 + "+Oo(he)+";\n      vec2 uv = uvFromFlat("+Dt+", "+qt+", index);\n      return sampleTexture("+he+", uv);\n    }\n  "}(le);default:throw new Error(se.length+"-D input sampling is not yet supported")}}(V),V.shapeInfo.logicalShape.length<=H.logicalShape.length&&($+=X?function(te,le){var se,He,ie=te.name,ce=ie.charAt(0).toUpperCase()+ie.slice(1),he="get"+ce+"AtOutCoords",be=te.shapeInfo.logicalShape.length,Ae=le.logicalShape.length,Te=ja(te.shapeInfo.logicalShape,le.logicalShape),We=jn(Ae),Fe=Ae-be,Ee=["x","y","z","w","u","v"];se=0===be?"":Ae<2&&1<=Te.length?"coords = 0;":Te.map(function(Dt){return"coords."+Ee[Dt+Fe]+" = 0;"}).join("\n"),He=Ae<2&&0<be?"coords":te.shapeInfo.logicalShape.map(function(Dt,qt){return"coords."+Ee[qt+Fe]}).join(", ");var tt="return outputValue;",it=1===mt(te.shapeInfo.logicalShape),ot=1===mt(le.logicalShape);if(1!==be||it||ot){if(it&&!ot)tt=1===Ae?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(Te.length){var pt=be-2,Rt=be-1;-1<Te.indexOf(pt)&&-1<Te.indexOf(Rt)?tt="return vec4(outputValue.x);":-1<Te.indexOf(pt)?tt="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":-1<Te.indexOf(Rt)&&(tt="return vec4(outputValue.xx, outputValue.zz);")}}else tt="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+he+"() {\n      "+We+" coords = getOutputCoords();\n      "+se+"\n      vec4 outputValue = get"+ce+"("+He+");\n      "+tt+"\n    }\n  "}(V,H):function(te,le){var se=te.name,ie=se.charAt(0).toUpperCase()+se.slice(1),ce="get"+ie+"AtOutCoords",Ae=te.shapeInfo.logicalShape.length,Te=le.logicalShape.length;if(!te.shapeInfo.isUniform&&Ae===Te&&null==te.shapeInfo.flatOffset&&or(te.shapeInfo.texShape,le.texShape))return"\n      float "+ce+"() {\n        return sampleTexture("+se+", resultUV);\n      }\n    ";var We=jn(Te),Fe=ja(te.shapeInfo.logicalShape,le.logicalShape),Ee=Te-Ae,He=["x","y","z","w","u","v"];return"\n    float "+ce+"() {\n      "+We+" coords = getOutputCoords();\n      "+(0===Ae?"":Te<2&&1<=Fe.length?"coords = 0;":Fe.map(function(tt){return"coords."+He[tt+Ee]+" = 0;"}).join("\n"))+"\n      return get"+ie+"("+(Te<2&&0<Ae?"coords":te.shapeInfo.logicalShape.map(function(tt,it){return"coords."+He[it+Ee]}).join(", "))+");\n    }\n  "}(V,H)),$}(O,t,a)}).join("\n"),w=t.texShape,A=ci(),T="\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+A.texture2D+"(textureSampler, uv).r;\n    }\n  ",M=(f=A).version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+f.varyingFs+" vec2 resultUV;\n    "+f.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    "+f.defineSpecialNaN+"\n    "+f.defineSpecialInf+"\n    "+f.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    \nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n    \nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n    \nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  ";return d=t.isPacked?(c=function(O,V){switch(O.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return H=V,1===(X=[Math.ceil(H[0]/2),Math.ceil(H[1]/2)])[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+X[1]+".0);\n      }\n    ":1===X[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+X[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+X[0]+", "+X[1]+"));\n      return 2 * (resTexRC.x * "+X[1]+" + resTexRC.y);\n    }\n  ";case 2:return function(se,ie){var ce=[Math.ceil(ie[0]/2),Math.ceil(ie[1]/2)];if(or(se,ie))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+ce[0]+", "+ce[1]+"));\n      }\n    ";var he=Math.ceil(se[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+ce[0]+", "+ce[1]+"));\n\n      int index = resTexRC.x * "+ce[1]+" + resTexRC.y;\n      int r = 2 * (index / "+he+");\n      int c = imod(index, "+he+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(O,V);case 3:return $=O,ee=V,re=[Math.ceil(ee[0]/2),Math.ceil(ee[1]/2)],le=(te=Math.ceil($[2]/2))*Math.ceil($[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+re[0]+", "+re[1]+"));\n      int index = resTexRC.x * "+re[1]+" + resTexRC.y;\n\n      int b = index / "+le+";\n      index -= b * "+le+";\n\n      int r = 2 * (index / "+te+");\n      int c = imod(index, "+te+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(se,ie){for(var ce=[Math.ceil(ie[0]/2),Math.ceil(ie[1]/2)],he=Math.ceil(se[se.length-1]/2),be=he*Math.ceil(se[se.length-2]/2),Ae=be,Te="",We="b, r, c",Fe=2;Fe<se.length-1;Fe++)Te="\n      int b"+Fe+" = index / "+(Ae*=se[se.length-Fe-1])+";\n      index -= b"+Fe+" * "+Ae+";\n    "+Te,We="b"+Fe+", "+We;return"\n    ivec"+se.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+ce[0]+", "+ce[1]+"));\n      int index = resTexRC.x * "+ce[1]+" + resTexRC.y;\n\n      "+Te+"\n\n      int b = index / "+be+";\n      index -= b * "+be+";\n\n      int r = 2 * (index / "+he+");\n      int c = imod(index, "+he+") * 2;\n\n      return ivec"+se.length+"("+We+");\n    }\n  "}(O,V)}var H,X,$,ee,re,te,le}(t.logicalShape,w),"\n    void setOutput(vec4 val) {\n      "+A.output+" = val;\n    }\n  "):(c=function(O,V){switch(O.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return 1===(ie=V)[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+ie[1]+".0);\n      }\n    ":1===ie[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+ie[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+ie[0]+", "+ie[1]+"));\n      return resTexRC.x * "+ie[1]+" + resTexRC.y;\n    }\n  ";case 2:return or(le=O,se=V)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+se[0]+", "+se[1]+"));\n      }\n    ":1===le[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+se[0]+", "+se[1]+"));\n        int index = resTexRC.x * "+se[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===le[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+se[0]+", "+se[1]+"));\n        int index = resTexRC.x * "+se[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+se[0]+", "+se[1]+"));\n      int index = resTexRC.x * "+se[1]+" + resTexRC.y;\n      int r = index / "+le[1]+";\n      int c = index - r * "+le[1]+";\n      return ivec2(r, c);\n    }\n  ";case 3:return ce=V,he=Fo(["r","c","d"],O),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+ce[0]+", "+ce[1]+"));\n      int index = resTexRC.x * "+ce[1]+" + resTexRC.y;\n      "+he+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return re=V,te=Fo(["r","c","d","d2"],O),"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+re[0]+", "+re[1]+"));\n      int index = resTexRC.x * "+re[1]+" + resTexRC.y;\n      "+te+"\n      return ivec4(r, c, d, d2);\n    }\n  ";case 5:return $=V,ee=Fo(["r","c","d","d2","d3"],O),"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+$[0]+",\n                             "+$[1]+"));\n\n      int index = resTexRC.x * "+$[1]+" + resTexRC.y;\n\n      "+ee+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ";case 6:return H=V,X=Fo(["r","c","d","d2","d3","d4"],O),"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+H[0]+", "+H[1]+"));\n      int index = resTexRC.x * "+H[1]+" + resTexRC.y;\n\n      "+X+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ";default:throw new Error(O.length+"-D output sampling is not yet supported")}var H,X,$,ee,re,te,le,se,ie,ce,he}(t.logicalShape,w),"\n    void setOutput(float val) {\n      "+A.output+" = vec4(val, 0, 0, 0);\n    }\n  "),a&&(M+="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n"),[M,T,d,g,c,m,n].join("\n")}(le,ie,te,$.packedInputs),he=X.createProgram(ce),be=null,Ae=X.getUniformLocation(he,"NAN",!1);1===_e().getNumber("WEBGL_VERSION")&&(be=X.getUniformLocation(he,"INFINITY",!1));for(var Te={},We=0;We<$.variableNames.length;We++){var Fe=$.variableNames[We];Te[Fe]=X.getUniformLocation(he,Fe,!1),Te["offset"+Fe]=X.getUniformLocation(he,"offset"+Fe,!1)}return{program:$,source:ce,webGLProgram:he,uniformLocations:Te,inShapeInfos:se,outShapeInfo:ie,infLoc:be,nanLoc:Ae}}(c.gpgpu,e,w,T)}),V=null!=this.activeTimers;if(V&&(A=this.startTimer()),function(X,$,ee,re,te){bl($.inShapeInfos,ee),bl([$.outShapeInfo],[re]);var le=re.texData.texture,se=re.texData.texShape;re.texData.isPacked?X.setOutputPackedMatrixTexture(le,se[0],se[1]):X.setOutputMatrixTexture(le,se[0],se[1]),X.setProgram($.webGLProgram),1===_e().getNumber("WEBGL_VERSION")&&null!==$.infLoc&&X.gl.uniform1f($.infLoc,1/0),null!==$.nanLoc&&X.gl.uniform1f($.nanLoc,NaN),ee.forEach(function(ie,ce){var he=$.program.variableNames[ce],be=$.uniformLocations[he],Ae=$.uniformLocations["offset"+he];if(null!=be)if(ie.isUniform)if(mt(ie.shape)<2)X.gl.uniform1f(be,ie.uniformValues[0]);else{var Te=ie.uniformValues;Te instanceof Float32Array||(Te=new Float32Array(Te)),X.gl.uniform1fv(be,Te)}else null!=ie.texData.slice&&null!=Ae&&X.gl.uniform1i(Ae,ie.texData.slice.flatOffset),X.setInputMatrixTexture(ie.texData.texture,be,ce)}),te?.(X,$.webGLProgram),X.executeProgram()}(this.gpgpu,O,w,T,a),m.forEach(function(X){return c.disposeData(X.dataId)}),V&&(A=this.endTimer(A),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(A)})),_e().getBool("WEBGL_LAZILY_UNPACK")||!f.isPacked||!1!==s)return d;var H=this.unpackTensor(d);return this.disposeData(d.dataId),H},De.prototype.compileAndRun=function(e,t,n,a,s){void 0===s&&(s=!1);var c=this.runWebGLProgram(e,t,n=n||t[0].dtype,a,s);return P.makeTensorFromDataId(c.dataId,c.shape,c.dtype)},De.prototype.getAndSaveBinary=function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]},De.prototype.getTextureManager=function(){return this.textureManager},De.prototype.dispose=function(){var e=this;this.disposed||(_e().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]}),this.textureManager.dispose(),null!=this.canvas&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},De.prototype.floatPrecision=function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=ht(function(){if(!_e().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=_e().getBool("DEBUG");_e().set("DEBUG",!1);var n=e.abs(nt(1e-8)).dataSync()[0];if(_e().set("DEBUG",t),0<n)return 32}return 16})),this.floatPrecisionValue},De.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},De.prototype.uploadToGPU=function(e){var t,n=this.texData.get(e),a=n.shape,s=n.dtype,c=n.values,f=n.usage,g=n.isPacked;if(null==n.texture){var m,w=null!=this.activeTimers;w&&(m=pi());var A=n.texShape;if(null==A&&(A=Qi(a,g),n.texShape=A),null!=c){var M,T=Xr(a),O=A[1],V=A[0],H=c instanceof Uint8Array;M=g?(O=(t=B(A[0],A[1]))[0],new bi(T,[V=t[1],O],H)):new tr(T,[V,O],H);var X=this.makeTensorInfo([V,O],s);this.texData.get(X.dataId).usage=H?l.PIXELS:l.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(X.dataId),O,V,c);var $=this.runWebGLProgram(M,[X],s,null,!0),ee=this.texData.get($.dataId);n.texture=ee.texture,n.texShape=ee.texShape,n.isPacked=ee.isPacked,n.usage=ee.usage,this.disposeData(X.dataId),this.texData.delete($.dataId),n.values=null,w&&(this.uploadWaitMs+=pi()-m)}else{var re=this.acquireTexture(A,f,s,g);n.texture=re}}},De.prototype.convertAndCacheOnCPU=function(e,t){var n=this.texData.get(e),a=n.dtype;return this.releaseGPUData(e),null!=t&&(n.values=function(s,c){if("float32"===c||"complex64"===c)return s;if("int32"!==c&&"bool"!==c)throw new Error("Unknown dtype "+c);for(var d="int32"===c?new Int32Array(s.length):new Uint8Array(s.length),f=0;f<d.length;++f)d[f]=Math.round(s[f]);return d}(t,a)),n.values},De.prototype.acquireTexture=function(e,t,n,a){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+s+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,a)},De.prototype.computeBytes=function(e,t){return e[0]*e[1]*Dr(t)},De);function De(e){var t,n=pp.call(this)||this;if(n.pendingRead=new WeakMap,n.pendingDisposal=new WeakSet,n.dataRefCount=new WeakMap,n.numBytesInGPU=0,n.uploadWaitMs=0,n.downloadWaitMs=0,n.warnedAboutMemory=!1,n.pendingDeletes=0,n.disposed=!1,!_e().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==e){var a=S(_e().getNumber("WEBGL_VERSION"));n.binaryCache=((t=_e().getNumber("WEBGL_VERSION"))in kh||(kh[t]={}),kh[t]),n.gpgpu=new ru(a),n.canvas=a.canvas,n.gpgpuCreatedLocally=!0}else n.gpgpu=e,n.binaryCache={},n.gpgpuCreatedLocally=!1,n.canvas=e.gl.canvas;return n.textureManager=new hb(n.gpgpu),n.numMBBeforeWarning=null==_e().global.screen?1024:_e().global.screen.height*_e().global.screen.width*window.devicePixelRatio*600/1024/1024,n.texData=new Va(n,P),n}r()&&P.registerBackend("webgl",function(){return new gp},2);var vp=ye({square_:function(e){var t=D(e,"x","square");return P.runKernelFunc(function(a,s){return s([t]),a.square(t)},{x:t},null,"Square",{},[t],[])}}),lc="SquaredDifference",Ah=ye({squaredDifference_:function(e,t){var n,a=D(e,"a","squaredDifference"),s=D(t,"b","squaredDifference");return n=Bn(a,s),gn((a=n[0]).shape,(s=n[1]).shape),P.runKernelFunc(function(f,g){var m=f.squaredDifference(a,s);return g([a,s]),m},{a,b:s},function(f,g){var m=g[0],w=g[1],A=nt(2);return{a:function(){return f.mul(m.sub(w).mul(A))},b:function(){return f.mul(w.sub(m).mul(A))}}},lc,{},[a,s],[])}}),mp=ye({abs_:function(e){var t=D(e,"x","abs");return"complex64"===t.dtype?P.runKernelFunc(function(n){return n.complexAbs(t)},{$x:t}):P.runKernelFunc(function(n,a){var s=n.abs(t);return a([t]),s},{x:t},function(n,a){var s=a[0];return{x:function(){return n.mul(s.toFloat().step(-1))}}},"Abs")}}),xp=ye({acos_:function(e){var t=D(e,"x","acos");return P.runKernelFunc(function(n,a){var s=n.acos(t);return a([t]),s},{$x:t},function(n,a){var s=a[0];return{$x:function(){return n.divStrict(nt(1).sub(s.toFloat().square()).sqrt()).neg()}}})}}),bp=ye({acosh_:function(e){var t=D(e,"x","acosh");return P.runKernelFunc(function(n,a){var s=n.acosh(t);return a([t]),s},{$x:t},function(n,a){var s=a[0];return{$x:function(){return n.divStrict(s.toFloat().square().sub(1).sqrt())}}})}}),yp=ye({asin_:function(e){var t=D(e,"x","asin");return P.runKernelFunc(function(n,a){var s=n.asin(t);return a([t]),s},{$x:t},function(n,a){var s=a[0];return{$x:function(){return n.divStrict(nt(1).sub(s.toFloat().square()).sqrt())}}})}}),wp=ye({asinh_:function(e){var t=D(e,"x","asinh");return P.runKernelFunc(function(n,a){var s=n.asinh(t);return a([t]),s},{$x:t},function(n,a){var s=a[0];return{$x:function(){return n.divStrict(nt(1).add(s.toFloat().square()).sqrt())}}})}}),Cp=ye({atan_:function(e){var t=D(e,"x","atan");return P.runKernelFunc(function(n,a){var s=n.atan(t);return a([t]),s},{$x:t},function(n,a){var s=a[0];return{$x:function(){return n.div(s.toFloat().square().add(1))}}})}}),kp=ye({atanh_:function(e){var t=D(e,"x","atanh");return P.runKernelFunc(function(n,a){var s=n.atanh(t);return a([t]),s},{$x:t},function(n,a){var s=a[0];return{$x:function(){return n.div(nt(1).sub(s.toFloat().square()))}}})}}),Ap=ye({ceil_:function(e){var t=D(e,"x","ceil");return P.runKernelFunc(function(n){return n.ceil(t)},{$x:t},function(n){return{$x:function(){return Vt(n)}}})}}),su=ye({clipByValue_:function(e,t,n){var a=D(e,"x","clipByValue");return ue(t<=n,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."}),P.runKernelFunc(function(d,f){var g=d.clip(a,t,n);return f([a]),g},{x:a},function(d,f){var g=f[0];return{x:function(){return d.where(g.greaterEqual(t).logicalAnd(g.lessEqual(n)),Vt(d))}}},"ClipByValue",{min:t,max:n},[a])}}),Sp=ye({cos_:function(e){var t=D(e,"x","cos");return P.runKernelFunc(function(a,s){var c=a.cos(t);return s([t]),c},{x:t},function(a,s){var c=s[0];return{x:function(){return c.toFloat().sin().neg().mul(a)}}},"Cos",{},[t])}}),Ep=ye({cosh_:function(e){var t=D(e,"x","cosh");return P.runKernelFunc(function(n,a){var s=n.cosh(t);return a([t]),s},{$x:t},function(n,a){var s=a[0];return{$x:function(){return s.toFloat().sinh().mulStrict(n)}}})}}),_p=ye({erf_:function(e){var t=D(e,"x","erf");return ue("int32"===t.dtype||"float32"===t.dtype,function(){return"Input dtype must be `int32` or `float32`."}),"int32"===t.dtype&&(t=t.toFloat()),P.runKernelFunc(function(n,a){var s=n.erf(t);return a([t]),s},{$x:t},function(n,a){var s=a[0];return{$x:function(){return n.mul(s.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),lu=ye({exp_:function(e){var t=D(e,"x","exp");return P.runKernelFunc(function(n,a){var s=n.exp(t);return a([s]),s},{x:t},function(n,a){return{x:function(){return n.mulStrict(a[0])}}},"Exp",{},[],[!0])}}),Ip=ye({expm1_:function(e){var t=D(e,"x","expm1");return P.runKernelFunc(function(n,a){var s=n.expm1(t);return a([t]),s},{$x:t},function(n,a){var s=a[0];return{$x:function(){return n.mul(s.exp())}}})}}),Tp=ye({floor_:function(e){var t=D(e,"x","floor");return P.runKernelFunc(function(n){return n.floor(t)},{$x:t},function(n){return{$x:function(){return Vt(n)}}})}}),Rp=ye({log_:function(e){var t=D(e,"x","log");return P.runKernelFunc(function(a,s){var c=a.log(t);return s([t]),c},{x:t},function(a,s){var c=s[0];return{x:function(){return a.div(c.toFloat())}}},"Log",{},[t])}}),Dp=ye({log1p_:function(e){var t=D(e,"x","log1p");return P.runKernelFunc(function(n,a){var s=n.log1p(t);return a([t]),s},{$x:t},function(n,a){var s=a[0];return{$x:function(){return n.div(s.add(1))}}})}}),Pp=ye({logSigmoid_:function(e){var t=D(e,"x","logSigmoid");return P.runKernelFunc(function(n,a){var s=n.softplus(t.neg()).neg();return a([t]),s},{$x:t},function(n,a){var s=a[0];return{$x:function(){return n.mul(s.neg().sigmoid())}}})}}),cc=ye({neg_:function(e){var t=D(e,"x","neg");return P.runKernelFunc(function(a){return a.neg(t)},{x:t},function(a){return{x:function(){return a.neg()}}},"Neg",{},[t])}}),Mp=ye({reciprocal_:function(e){var t=D(e,"x","reciprocal");return P.runKernelFunc(function(n,a){var s=n.reciprocal(t);return a([t]),s},{$x:t},function(n,a){var s=a[0];return{$x:function(){return n.div(s.square().neg())}}})}}),Np=ye({round_:function(e){var t=D(e,"x","round");return P.runKernelFunc(function(n){return n.round(t)},{$x:t},function(n){return{$x:function(){return Vt(n)}}})}}),Sh=ye({rsqrt_:function(e){var t=D(e,"x","rsqrt");return P.runKernelFunc(function(a,s){var c=a.rsqrt(t);return s([t]),c},{x:t},function(a,s){var c=s[0];return{x:function(){return a.div(c.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},[t])}}),Eh=ye({sigmoid_:function(e){var t=D(e,"x","sigmoid");return P.runKernelFunc(function(n,a){var s=n.sigmoid(t);return a([s]),s},{x:t},function(n,a){var s=a[0];return{x:function(){return n.mul(s.mul(nt(1).sub(s)))}}},"Sigmoid")}}),Lp=ye({sign_:function(e){var t=D(e,"x","sign");return P.runKernelFunc(function(n){return n.sign(t)},{$x:t},function(n){return{$x:function(){return Vt(n)}}})}}),Fp=ye({isNaN_:function(e){var t=D(e,"x","isNaN");return P.runKernelFunc(function(n){return n.isNaN(t)},{$x:t},function(n){return{$x:function(){return Vt(n)}}})}}),Op=ye({isInf_:function(e){var t=D(e,"x","isInf");return P.runKernelFunc(function(n){return n.isInf(t)},{$x:t},function(n){return{$x:function(){return Vt(n)}}})}}),Bp=ye({isFinite_:function(e){var t=D(e,"x","isFinite");return P.runKernelFunc(function(n){return n.isFinite(t)},{$x:t},function(n){return{$x:function(){return Vt(n)}}})}}),zp=ye({sin_:function(e){var t=D(e,"x","sin");return P.runKernelFunc(function(a,s){var c=a.sin(t);return s([t]),c},{x:t},function(a,s){var c=s[0];return{x:function(){return c.toFloat().cos().mul(a)}}},"Sin",{},[t])}}),Wp=ye({sinh_:function(e){var t=D(e,"x","sinh");return P.runKernelFunc(function(n,a){var s=n.sinh(t);return a([t]),s},{$x:t},function(n,a){var s=a[0];return{$x:function(){return s.toFloat().cosh().mulStrict(n)}}})}}),Hp=ye({softplus_:function(e){var t=D(e,"x","softplus");return P.runKernelFunc(function(n,a){var s=n.softplus(t);return a([t]),s},{$x:t},function(n,a){var s=a[0];return{$x:function(){return n.mul(s.sigmoid())}}})}}),Xp=ye({sqrt_:function(e){var t=D(e,"x","sqrt");return P.runKernelFunc(function(n,a){var s=n.sqrt(t);return a([t]),s},{$x:t},function(n,a){var s=a[0];return{$x:function(){return n.div(s.toFloat().sqrt().mul(2))}}})}}),Gp=ye({step_:function(e,t){void 0===t&&(t=0);var n=D(e,"x","step");return P.runKernelFunc(function(a){return a.step(n,t)},{$x:n},function(a){return{$x:function(){return Vt(a)}}})}}),Vp=ye({tan_:function(e){var t=D(e,"x","tan");return P.runKernelFunc(function(n,a){var s=n.tan(t);return a([t]),s},{$x:t},function(n,a){var s=a[0];return{$x:function(){return n.div(s.cos().square())}}})}}),Yp=ye({tanh_:function(e){var t=D(e,"x","tanh");return P.runKernelFunc(function(n,a){var s=n.tanh(t);return a([s]),s},{x:t},function(n,a){var s=a[0];return{x:function(){return nt(1).sub(s.square()).mulStrict(n)}}},"Tanh",{},null,[!0])}});function jp(e,t,n,a,s,c){var d,f,g=D(e,"x","batchNorm"),m=D(t,"mean","batchNorm"),w=D(n,"variance","batchNorm");return null!=s&&(d=D(s,"scale","batchNorm")),null!=a&&(f=D(a,"offset","batchNorm")),ue(2===g.rank,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+g.rank+"."}),ue(2===m.rank||1===m.rank,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+m.rank+"."}),ue(2===w.rank||1===w.rank,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+w.rank+"."}),null!=d&&ue(2===d.rank||1===d.rank,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+d.rank+"."}),null!=f&&ue(2===f.rank||1===f.rank,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+f.rank+"."}),uc(g,m,w,f,d,c)}function Up(e,t,n,a,s,c){var d,f,g=D(e,"x","batchNorm"),m=D(t,"mean","batchNorm"),w=D(n,"variance","batchNorm");return null!=s&&(d=D(s,"scale","batchNorm")),null!=a&&(f=D(a,"offset","batchNorm")),ue(3===g.rank,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+g.rank+"."}),ue(3===m.rank||1===m.rank,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+m.rank+"."}),ue(3===w.rank||1===w.rank,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+w.rank+"."}),null!=d&&ue(3===d.rank||1===d.rank,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+d.rank+"."}),null!=f&&ue(3===f.rank||1===f.rank,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+f.rank+"."}),uc(g,m,w,f,d,c)}function qp(e,t,n,a,s,c){var d,f,g=D(e,"x","batchNorm"),m=D(t,"mean","batchNorm"),w=D(n,"variance","batchNorm");return null!=s&&(d=D(s,"scale","batchNorm")),null!=a&&(f=D(a,"offset","batchNorm")),ue(4===g.rank,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+g.rank+"."}),ue(4===m.rank||1===m.rank,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+m.rank+"."}),ue(4===w.rank||1===w.rank,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+w.rank+"."}),null!=d&&ue(4===d.rank||1===d.rank,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+d.rank+"."}),null!=f&&ue(4===f.rank||1===f.rank,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+f.rank+"."}),uc(g,m,w,f,d,c)}function uc(e,t,n,a,s,c){null==c&&(c=.001);var d,f,g,m=D(e,"x","batchNorm"),w=D(t,"mean","batchNorm"),A=D(n,"variance","batchNorm");return null!=s&&(d=D(s,"scale","batchNorm")),null!=a&&(f=D(a,"offset","batchNorm")),ue(w.rank===A.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),ue(null==f||w.rank===f.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),ue(null==d||w.rank===d.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),g=0===m.rank||1===m.rank?m.as4D(1,1,1,m.size):2===m.rank?m.as4D(1,1,m.shape[0],m.shape[1]):3===m.rank?m.as4D(1,m.shape[0],m.shape[1],m.shape[2]):m,P.runKernelFunc(function(M,O){var V=M.batchNormalization(g,cu(w),cu(A),c,cu(d),cu(f));return O([m,w,A,d]),V},{x:m,mean:w,variance:A,scale:d,offset:f},function(M,O){var H=O[0],X=O[1],$=O[2],re=O[3]??nt(1),te=Ir(X.shape,g.shape),le=[];if(1===X.rank){for(var se=0;se<g.shape.length-1;++se)le.push(g.shape[se]);le.push(1)}var ie=H.sub(X),ce=M.mul(re),he=Sh($.add(nt(c))),be=he.mul(he).mul(he).mul(nt(-.5));return{x:function(){return 1===X.rank?M.mul(Ro(he.as4D(1,1,1,X.shape[0]),le)).mul(re).reshape(H.shape):M.mul(he).mul(re).reshape(H.shape)},mean:function(){var Ae=he.mul(nt(-1)).mul(ce);return 1===X.rank&&(Ae=Ae.sum(te)),Ae.reshape(X.shape)},variance:function(){var Ae=be.mul(ie).mul(ce);return 1===X.rank&&(Ae=Ae.sum(te)),Ae.reshape(X.shape)},scale:function(){var Ae=ie.mul(he),Te=M.mul(Ae);return 1===X.rank&&(Te=Te.sum(te)),Te.reshape(X.shape)},offset:function(){var Ae=M;return 1===X.rank&&(Ae=Ae.sum(te)),Ae.reshape(X.shape)}}},"BatchNormalization",{varianceEpsilon:c},[m,w,A,d]).reshape(m.shape)}function cu(e){return null==e?null:0===e.rank?e.as1D():1===e.rank?e:2===e.rank?e.as4D(1,1,e.shape[0],e.shape[1]):3===e.rank?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function uu(){is("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}function _h(e){return F(this,void 0,void 0,function(){var t,n,a;return de(this,function(s){switch(s.label){case 0:return[4,(t=D(e,"condition","whereAsync","bool")).data()];case 1:return n=s.sent(),a=Hs(t.shape,n),e!==t&&t.dispose(),[2,a]}})})}var $p=ye({batchNormalization2d_:function(e,t,n,a,s,c){return void 0===a&&(a=.001),uu(),jp(e,t,n,c,s,a)}}),Kp=ye({batchNormalization3d_:function(e,t,n,a,s,c){return void 0===a&&(a=.001),uu(),Up(e,t,n,c,s,a)}}),Zp=ye({batchNormalization4d_:function(e,t,n,a,s,c){return void 0===a&&(a=.001),uu(),qp(e,t,n,c,s,a)}}),Jp=ye({batchNormalization_:function(e,t,n,a,s,c){return void 0===a&&(a=.001),uu(),uc(e,t,n,c,s,a)}}),Ih=ye({batchNorm_:uc}),Qp=ye({batchNorm2d_:jp}),eg=ye({batchNorm3d_:Up}),tg=ye({batchNorm4d_:qp}),hc=ye({logicalAnd_:function(e,t){var n=D(e,"a","logicalAnd","bool"),a=D(t,"b","logicalAnd","bool");return gn(n.shape,a.shape),P.runKernelFunc(function(s){return s.logicalAnd(n,a)},{a:n,b:a},null,"LogicalAnd")}}),ng=ye({logicalNot_:function(e){var t=D(e,"x","logicalNot","bool");return P.runKernelFunc(function(n){return n.logicalNot(t)},{$x:t})}}),Th=ye({logicalOr_:function(e,t){var n=D(e,"a","logicalOr","bool"),a=D(t,"b","logicalOr","bool");return gn(n.shape,a.shape),P.runKernelFunc(function(s){return s.logicalOr(n,a)},{$a:n,$b:a})}}),rg=ye({logicalXor_:function(e,t){var n=D(e,"a","logicalXor","bool"),a=D(t,"b","logicalXor","bool");return gn(n.shape,a.shape),Th(e,t).logicalAnd(hc(e,t).logicalNot())}}),fs=ye({where_:function(e,t,n){var a=D(t,"a","where"),s=D(n,"b","where"),c=D(e,"condition","where","bool");return z(a.shape,s.shape,"Error in where: "),1===c.rank?ue(c.shape[0]===a.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):z(c.shape,s.shape,"Error in where: "),P.runKernelFunc(function(d,f){var g=d.select(c,a,s);return f([c]),g},{$condition:c,$a:a,$b:s},function(d,f){var g=f[0];return{$condition:function(){return Vt(g).toFloat()},$a:function(){return d.mul(g.cast(d.dtype))},$b:function(){return d.mul(g.logicalNot().cast(d.dtype))}}})}}),xn=ye({add_:function(e,t){var n,a=D(e,"a","add"),s=D(t,"b","add");n=Bn(a,s);var c=gn((a=n[0]).shape,(s=n[1]).shape);return P.runKernelFunc(function(d){return d.add(a,s)},{a,b:s},function(d){return{a:function(){var f=d,g=Ir(a.shape,c);return 0<g.length&&(f=f.sum(g)),f.reshape(a.shape)},b:function(){var f=d,g=Ir(s.shape,c);return 0<g.length&&(f=f.sum(g)),f.reshape(s.shape)}}},"Add")}}),ig=ye({addN_:function(e){ue(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),ue(1<=e.length,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var t=e.map(function(s,c){return D(s,"tensors"+c,"addN")}),n=t[0];return t.forEach(function(s){if(s.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(s){if(!or(s.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}),P.runKernelFunc(function(s){return s.addN(t)},t,function(s){var c={};return t.forEach(function(d,f){c[f]=function(){return s.clone()}}),c},"AddN")}}),ag=ye({addStrict_:function(e,t){var n=D(e,"a","addStrict"),a=D(t,"b","addStrict");return z(n.shape,a.shape,"Error in addStrict: "),n.add(a)}}),og=ye({atan2_:function(e,t){var n,a=D(e,"a","atan2"),s=D(t,"b","atan2");n=Bn(a,s);var c=gn((a=n[0]).shape,(s=n[1]).shape);return P.runKernelFunc(function(d,f){var g=d.atan2(a,s);return f([a,s]),g},{$a:a,$b:s},function(d,f){var g=f[0],m=f[1];return{$a:function(){var w=xn(g.square(),m.square()),A=d.mul(m.div(w)),T=Ir(g.shape,c);return 0<T.length&&(A=A.sum(T)),A.reshape(g.shape)},$b:function(){var w=xn(g.square(),m.square()),A=cc(d.mul(g.div(w))),T=Ir(m.shape,c);return 0<T.length&&(A=A.sum(T)),A.reshape(m.shape)}}})}}),Ra=ye({div_:function(e,t){var n,a=D(e,"a","div"),s=D(t,"b","div");if(n=Bn(a,s),s=n[1],"int32"===(a=n[0]).dtype&&"int32"===s.dtype)return Rh(a,s);var c=gn(a.shape,s.shape);return P.runKernelFunc(function(d,f){var g=d.realDivide(a,s);return f([a,s]),g},{a,b:s},function(d,f){var g=f[0],m=f[1];return{a:function(){var w=d.div(m.toFloat()),A=Ir(g.shape,c);return 0<A.length?w.sum(A).reshape(g.shape):w},b:function(){var w=d.mul(g.toFloat()),A=Ir(m.shape,c);0<A.length&&(w=w.sum(A).reshape(m.shape));var T=m.square();return w.div(T.toFloat()).neg()}}},"Div")}}),sg=ye({divNoNan_:function(e,t){var n,a=D(e,"a","div"),s=D(t,"b","div");a=(n=Bn(a,s))[0];var c=Ra(a,s=n[1]),d=Vt(c),f=s.equal(d);return fs(f,d,c)}}),lg=ye({divStrict_:function(e,t){var n=D(e,"a","div"),a=D(t,"b","div");return z(n.shape,a.shape,"Error in divideStrict: "),n.div(a)}}),Rh=ye({floorDiv_:function(e,t){var n,a=D(e,"a","floorDiv"),s=D(t,"b","floorDiv");n=Bn(a,s);var c=gn((a=n[0]).shape,(s=n[1]).shape);return P.runKernelFunc(function(d,f){var g=d.floorDiv(a,s);return f([a,s]),g},{a,b:s},function(d,f){var g=f[0],m=f[1];return{a:function(){var w=d.div(m.toFloat()),A=Ir(g.shape,c);return 0<A.length?w.sum(A).reshape(g.shape):w},b:function(){var w=d.mul(g.toFloat()),A=Ir(m.shape,c);0<A.length&&(w=w.sum(A).reshape(m.shape));var T=m.square();return w.div(T.toFloat()).neg()}}},"FloorDiv")}}),hu=ye({maximum_:function(e,t){var n,a=D(e,"a","maximum"),s=D(t,"b","maximum");return n=Bn(a,s),s=n[1],"bool"===(a=n[0]).dtype&&(a=a.toInt(),s=s.toInt()),gn(a.shape,s.shape),P.runKernelFunc(function(c,d){var f=c.maximum(a,s);return d([a,s]),f},{a,b:s},function(c,d){var f=d[0],g=d[1];return{a:function(){return c.mul(f.greaterEqual(g).toFloat())},b:function(){return c.mul(f.less(g).toFloat())}}},"Maximum")}}),cg=ye({maximumStrict_:function(e,t){var n=D(e,"a","maximumStrict"),a=D(t,"b","maximumStrict");return z(n.shape,a.shape,"Error in maximumStrict: "),n.maximum(a)}}),Dh=ye({minimum_:function(e,t){var n,a=D(e,"a","minimum"),s=D(t,"b","minimum");return n=Bn(a,s),s=n[1],"bool"===(a=n[0]).dtype&&(a=a.toInt(),s=s.toInt()),gn(a.shape,s.shape),P.runKernelFunc(function(c,d){var f=c.minimum(a,s);return d([a,s]),f},{a,b:s},function(c,d){var f=d[0],g=d[1];return{a:function(){return c.mul(f.lessEqual(g).toFloat())},b:function(){return c.mul(f.greater(g).toFloat())}}},"Minimum")}}),ug=ye({minimumStrict_:function(e,t){var n=D(e,"a","minimumStrict"),a=D(t,"b","minimumStrict");return z(n.shape,a.shape,"Error in minimumStrict: "),n.minimum(a)}}),hg=ye({mod_:function(e,t){var n,a=D(e,"a","mod"),s=D(t,"b","mod");n=Bn(a,s);var c=gn((a=n[0]).shape,(s=n[1]).shape);return P.runKernelFunc(function(d,f){var g=d.mod(a,s);return f([a,s]),g},{$a:a,$b:s},function(d,f){var g=f[0],m=f[1];return{$a:function(){var w=Ir(g.shape,c);return 0<w.length?d.sum(w).reshape(g.shape):d},$b:function(){var w=d.mul(g.div(m).floor().neg()),A=Ir(m.shape,c);return 0<A.length?w.sum(A).reshape(m.shape):w}}})}}),dg=ye({modStrict_:function(e,t){var n=D(e,"a","modStrict"),a=D(t,"b","modStrict");return z(n.shape,a.shape,"Error in modStrict: "),n.mod(a)}}),yi=ye({mul_:function(e,t){var n,a=D(e,"a","mul"),s=D(t,"b","mul");n=Bn(a,s);var c=gn((a=n[0]).shape,(s=n[1]).shape);return P.runKernelFunc(function(d,f){var g=d.multiply(a,s);return f([a,s]),g},{a,b:s},function(d,f){var g=f[0],m=f[1];return{a:function(){var w=d.mul(m.toFloat()),A=Ir(g.shape,c);return 0<A.length?w.sum(A).reshape(g.shape):w},b:function(){var w=d.mul(g.toFloat()),A=Ir(m.shape,c);return 0<A.length?w.sum(A).reshape(m.shape):w}}},"Mul")}}),fg=ye({mulStrict_:function(e,t){var n=D(e,"a","mul"),a=D(t,"b","mul");return z(n.shape,a.shape,"Error in multiplyStrict: "),n.mul(a)}}),dc=ye({pow_:function(e,t){var n,a=D(e,"base","pow"),s=D(t,"exp","pow");n=Bn(a,s);var c=gn((a=n[0]).shape,(s=n[1]).shape);return P.runKernelFunc(function(f,g){var m=f.pow(a,s);return g([a,s,m]),m},{a,b:s},function(f,g){var m=g[0],w=g[1],A=g[2];return{a:function(){var T=w.toFloat(),M=f.mul(T.mul(m.pow(T.sub(nt(1))))),O=Ir(m.shape,c);return 0<O.length&&(M=M.sum(O)),M.reshape(m.shape)},b:function(){var T=m.greater(0),M=m.log().where(T,Vt(m)),O=f.mul(A.mul(M)),V=Ir(w.shape,c);return 0<V.length&&(O=O.sum(V)),O.reshape(w.shape)}}},"Pow",{},[a,s],[!0])}}),pg=ye({powStrict_:function(e,t){return z(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),gg=ye({squaredDifferenceStrict_:function(e,t){var n=D(e,"a","squaredDifferenceStrict"),a=D(t,"b","squaredDifferenceStrict");return z(n.shape,a.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(a)}}),Yr=ye({sub_:function(e,t){var n,a=D(e,"a","sub"),s=D(t,"b","sub");n=Bn(a,s);var c=gn((a=n[0]).shape,(s=n[1]).shape);return P.runKernelFunc(function(d){return d.subtract(a,s)},{a,b:s},function(d){return{a:function(){var f=d,g=Ir(a.shape,c);return 0<g.length&&(f=f.sum(g)),f.reshape(a.shape)},b:function(){var f=d,g=Ir(s.shape,c);return 0<g.length&&(f=f.sum(g)),f.neg().reshape(s.shape)}}},"Sub")}}),vg=ye({subStrict_:function(e,t){var n=D(e,"a","subStrict"),a=D(t,"b","subStrict");return z(n.shape,a.shape,"Error in subStrict: "),n.sub(a)}}),Ph=ye({equal_:function(e,t){var n,a=D(e,"a","equal"),s=D(t,"b","equal");return n=Bn(a,s),gn((a=n[0]).shape,(s=n[1]).shape),P.runKernelFunc(function(c){return c.equal(a,s)},{$a:a,$b:s})}}),mg=ye({equalStrict_:function(e,t){var n=D(e,"a","equalStrict"),a=D(t,"b","equalStrict");return z(n.shape,a.shape,"Error in equalStrict: "),n.equal(a)}}),xg=ye({greater_:function(e,t){var n,a=D(e,"a","greater"),s=D(t,"b","greater");return n=Bn(a,s),gn((a=n[0]).shape,(s=n[1]).shape),P.runKernelFunc(function(c){return c.greater(a,s)},{a,b:s},null,"Greater")}}),Mh=ye({greaterEqual_:function(e,t){var n,a=D(e,"a","greaterEqual"),s=D(t,"b","greaterEqual");return n=Bn(a,s),gn((a=n[0]).shape,(s=n[1]).shape),P.runKernelFunc(function(c,d){var f=c.greaterEqual(a,s);return d([a,s]),f},{a,b:s},function(c,d){var f=d[0],g=d[1];return{a:function(){return Vt(f)},b:function(){return Vt(g)}}},"GreaterEqual")}}),bg=ye({greaterEqualStrict_:function(e,t){var n=D(e,"a","greaterEqualStrict"),a=D(t,"b","greaterEqualStrict");return z(n.shape,a.shape,"Error in greaterEqualStrict: "),n.greaterEqual(a)}}),yg=ye({greaterStrict_:function(e,t){var n=D(e,"a","greaterStrict"),a=D(t,"b","greaterStrict");return z(n.shape,a.shape,"Error in greaterStrict: "),n.greater(a)}}),wg=ye({less_:function(e,t){var n,a=D(e,"a","less"),s=D(t,"b","less");return n=Bn(a,s),gn((a=n[0]).shape,(s=n[1]).shape),P.runKernelFunc(function(c){return c.less(a,s)},{a,b:s},null,"Less")}}),Cg=ye({lessEqual_:function(e,t){var n,a=D(e,"a","lessEqual"),s=D(t,"b","lessEqual");return n=Bn(a,s),gn((a=n[0]).shape,(s=n[1]).shape),P.runKernelFunc(function(c,d){var f=c.lessEqual(a,s);return d([a,s]),f},{a,b:s},null,"LessEqual")}}),kg=ye({lessEqualStrict_:function(e,t){var n=D(e,"a","lessEqualStrict"),a=D(t,"b","lessEqualStrict");return z(n.shape,a.shape,"Error in lessEqualStrict: "),n.lessEqual(a)}}),Ag=ye({lessStrict_:function(e,t){var n=D(e,"a","lessStrict"),a=D(t,"b","lessStrict");return z(n.shape,a.shape,"Error in lessStrict: "),n.less(a)}}),Sg=ye({notEqual_:function(e,t){var n,a=D(e,"a","notEqual"),s=D(t,"b","notEqual");return n=Bn(a,s),gn((a=n[0]).shape,(s=n[1]).shape),P.runKernelFunc(function(c){return c.notEqual(a,s)},{a,b:s},null,"NotEqual")}}),Eg=ye({notEqualStrict_:function(e,t){var n=D(e,"a","notEqualStrict"),a=D(t,"b","notEqualStrict");return z(n.shape,a.shape,"Error in notEqualStrict: "),n.notEqual(a)}});function _g(e,t){for(var n=[],a=e;a<t;++a)n.push(a);return n}function Ig(e){for(var t=[],n=0;n<e.length;++n)for(var a=0;a<e[n].length;++a)t.push(e[n][a]);return t}function Tg(e,t,n){return F(this,void 0,void 0,function(){var a,s,c,d,f,g,m,w,A,T,M,O,V;return de(this,function(H){switch(H.label){case 0:for(a=D(e,"tensor","boolMask"),s=D(t,"mask","boolMask","bool"),c=n??0,f=a.shape,ue(0<(d=s.rank),function(){return"mask cannot be scalar"}),z(f.slice(c,c+d),s.shape,"mask's shape must match the first K dimensions of tensor's shape,"),g=1,m=c;m<c+d;m++)g*=f[m];return w=f.slice(0,c).concat([g],f.slice(c+d)),A=a.reshape(w),[4,_h(T=s.reshape([-1]))];case 1:return M=H.sent(),O=M.squeeze([1]),V=du(A,O,c),e!==a&&a.dispose(),t!==s&&s.dispose(),O.dispose(),A.dispose(),T.dispose(),M.dispose(),[2,V]}})})}var du=ye({gather_:function(e,t,n){void 0===n&&(n=0);var a=D(e,"x","gather"),s=D(t,"indices","gather","int32");n=Nn(n,a.shape)[0];var c=function(d,f,g){for(var m=d.shape[g],w=[],A=1,T=1,M=0;M<g;M++)w.push(d.shape[M]),A*=d.shape[M];for(M=0;M<f.rank;M++)w.push(f.shape[M]);for(M=g+1;M<d.rank;M++)w.push(d.shape[M]),T*=d.shape[M];return{batchSize:A,sliceSize:T,dimSize:m,outputShape:w}}(a,s,n);return P.runKernelFunc(function(d,f){var g=d.gather(a,s.flatten(),n);return f([s]),g},{x:a,indices:s},function(d,f){var g=f[0];return{x:function(){var m=a.shape,w=g.size,A=m.slice(0,n),T=A.length,M=m.slice(n,m.length).slice(1),O=M.length,V=_g(0,T),H=_g(T+1,T+1+O),X=Ig([A,[w],M]),$=d.reshape(X),ee=g.reshape([w]),re=Ig([[T],V,H]),te=$.transpose(re),le=Nh(te,ee,a.shape[n]),se=et(re);return le.transpose(se)},indices:function(){return g}}},"Gather",{axis:n}).reshape(c.outputShape)}}),Nh=ye({unsortedSegmentSum_:function(e,t,n){var a=D(e,"x","unsortedSegmentSum"),s=D(t,"segmentIds","unsortedSegmentSum","int32");return ue(Qn(n),function(){return"numSegments must be of dtype int"}),P.runKernelFunc(function(c,d){var f=c.unsortedSegmentSum(a,s,n);return d([s]),f},{$x:a},function(c,d){var f=d[0];return{$x:function(){return function(g,m){for(var w=hu(m,Vt(m)),A=du(g,w),T=Mh(m,nt(0,"int32")),M=A.rank-T.rank,O=0;O<M;++O)T=Bt(T,O+1);T=hc(T,_i(A.shape,"bool"));var V=Vt(A);return fs(T,A,V)}(c,f)}}})}});function Rg(e,t,n,a,s,c,d){void 0===c&&(c="NHWC"),ue(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var f=e,g=t,m=!1;3===t.rank&&(m=!0,g=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),f=[1,e[0],e[1],e[2]]),ue(4===f.length,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+f.length+"."}),ue(4===g.rank,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+g.rank}),ue(4===n.rank,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var w="NHWC"===c?f[3]:f[1],A="NHWC"===c?g.shape[3]:g.shape[1];ue(w===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+w+") must match input depth for filter "+n.shape[2]+"."}),ue(A===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+A+") must match output depth for filter "+n.shape[3]+"."}),null!=d&&ue(Qn(s),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+d+" but got pad "+s+"."});var T=ul(c),M=Ua(f,n.shape,a,1,s,d,!1,T),O=P.runKernelFunc(function(V,H){var X=V.conv2dDerInput(g,n,M);return H([n,g]),X},{dy4D:g,filter:n},function(V,H){var X=H[0],$=H[1];return{dy4D:function(){return ga(V,X,a,s,c,1,d)},filter:function(){return Fh(V,$,X.shape,a,s,c,d)}}});return m?O.as3D(O.shape[1],O.shape[2],O.shape[3]):O}function Lh(e){var t,n="number"==typeof(t=e)?[t,t,t]:2===t.length?[t[0],t[1],1]:t;return 1===n[0]&&1===n[1]&&1===n[2]}function Dg(e,t,n,a,s){ue(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var c=e,d=t,f=!1;4===t.rank&&(f=!0,d=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),c=[1,e[0],e[1],e[2],e[3]]);var g=c[4],m=d.shape[4];ue(5===c.length,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+c.length+"."}),ue(5===d.rank,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+d.rank}),ue(5===n.rank,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),ue(g===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+g+") must match input depth for filter "+n.shape[3]+"."}),ue(m===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+m+") must match output depth for filter "+n.shape[4]+"."});var w=Bs(c,n.shape,a,1,s),A=P.runKernelFunc(function(T){return T.conv3dDerInput(d,n,w)},{dy5D:d});return f?A.as4D(A.shape[1],A.shape[2],A.shape[3],A.shape[4]):A}var Pg=ye({conv1d_:function(e,t,n,a,s,c,d){void 0===s&&(s="NWC"),void 0===c&&(c=1);var f=D(e,"x","conv1d"),g=D(t,"filter","conv1d"),m=f,w=!1;2===f.rank&&(w=!0,m=f.as3D(1,f.shape[0],f.shape[1])),ue(3===m.rank,function(){return"Error in conv1d: input must be rank 3, but got rank "+m.rank+"."}),ue(3===g.rank,function(){return"Error in conv1d: filter must be rank 3, but got rank "+g.rank+"."}),null!=d&&ue(Qn(a),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+d+" but got pad "+a+"."}),ue(m.shape[2]===g.shape[1],function(){return"Error in conv1d: depth of input ("+m.shape[2]+") must match input depth for filter "+g.shape[1]+"."}),ue(mi(n,c),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+c+"'"}),ue("NWC"===s,function(){return"Error in conv1d: got dataFormat of "+s+" but only NWC is currently supported."});var A=g.as4D(1,g.shape[0],g.shape[1],g.shape[2]),T=m.as4D(m.shape[0],1,m.shape[1],m.shape[2]),M=ga(T,A,[1,n],a,"NHWC",[1,c],d);return w?M.as2D(M.shape[2],M.shape[3]):M.as3D(M.shape[0],M.shape[2],M.shape[3])}}),ga=ye({conv2d_:function(e,t,n,a,s,c,d){void 0===s&&(s="NHWC"),void 0===c&&(c=[1,1]);var f=D(e,"x","conv2d"),g=D(t,"filter","conv2d"),m=f,w=!1;3===f.rank&&(w=!0,m=f.as4D(1,f.shape[0],f.shape[1],f.shape[2])),ue(4===m.rank,function(){return"Error in conv2d: input must be rank 4, but got rank "+m.rank+"."}),ue(4===g.rank,function(){return"Error in conv2d: filter must be rank 4, but got rank "+g.rank+"."}),null!=d&&ue(Qn(a),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+d+" but got pad "+a+"."});var A="NHWC"===s?m.shape[3]:m.shape[1];ue(A===g.shape[2],function(){return"Error in conv2d: depth of input ("+A+") must match input depth for filter "+g.shape[2]+"."}),ue(mi(n,c),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+c+"'"});var T=ul(s),M=Ua(m.shape,g.shape,n,c,a,d,!1,T),V=P.runKernelFunc(function(H,X){var $=H.conv2d(m,g,M);return X([g,m]),$},{x:m,filter:g},function(H,X){var ee=X[0],re=X[1];return ue(No(c),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+c+"'"}),{x:function(){return Ng(re.shape,H,ee,n,a,s)},filter:function(){return Fh(re,H,ee.shape,n,a,s)}}},"Conv2D",M,[g,m]);return w?V.as3D(V.shape[1],V.shape[2],V.shape[3]):V}}),Mg=ye({conv3d_:function(e,t,n,a,s,c){void 0===s&&(s="NDHWC"),void 0===c&&(c=[1,1,1]);var d,f=D(e,"x","conv3d"),g=D(t,"filter","conv3d"),m=f,w=!1;4===f.rank&&(w=!0,m=f.as5D(1,f.shape[0],f.shape[1],f.shape[2],f.shape[3])),ue(5===m.rank,function(){return"Error in conv3d: input must be rank 5, but got rank "+m.rank+"."}),ue(5===g.rank,function(){return"Error in conv3d: filter must be rank 5, but got rank "+g.rank+"."}),ue(m.shape[4]===g.shape[3],function(){return"Error in conv3d: depth of input ("+m.shape[4]+") must match input depth for filter "+g.shape[3]+"."}),ue((d=c,Lh(n)||Lh(d)),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+c+"'"}),ue("NDHWC"===s,function(){return"Error in conv3d: got dataFormat of "+s+" but only NDHWC is currently supported."});var A=Bs(m.shape,g.shape,n,c,a),T=P.runKernelFunc(function(M,O){var V=M.conv3d(m,g,A);return O([m,g]),V},{x:m,$filter:g},function(M,O){ue(Lh(c),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+c+"'"});var V=O[0],H=O[1];return{x:function(){return Dg(V.shape,M,H,n,a)},$filter:function(){return function(X,$,ee,re,te){var le=X;4===X.rank&&(le=X.as5D(1,X.shape[0],X.shape[1],X.shape[2],X.shape[3]));var se=$;4===se.rank&&(se=$.as5D(1,$.shape[0],$.shape[1],$.shape[2],$.shape[3])),ue(5===le.rank,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+le.shape+"."}),ue(5===se.rank,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+se.shape+"."}),ue(5===ee.length,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+ee+"."}),ue(le.shape[4]===ee[3],function(){return"Error in conv3dDerFilter: depth of input "+le.shape[4]+") must match input depth in filter ("+ee[3]+"."}),ue(se.shape[4]===ee[4],function(){return"Error in conv3dDerFilter: depth of dy ("+se.shape[4]+") must match output depth for filter ("+ee[4]+")."});var ie=Bs(le.shape,ee,re,1,te);return P.runKernelFunc(function(ce){return ce.conv3dDerFilter(le,se,ie)},{x5D:le,dy5D:se})}(V,M,H.shape,n,a)}}});return w?T.as4D(T.shape[1],T.shape[2],T.shape[3],T.shape[4]):T}}),Fh=ye({conv2dDerFilter_:function(e,t,n,a,s,c,d){void 0===c&&(c="NHWC");var f=e;3===e.rank&&(f=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var g=t;3===g.rank&&(g=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),ue(4===f.rank,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+f.shape+"."}),ue(4===g.rank,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+g.shape+"."}),ue(4===n.length,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var m="NHWC"===c?f.shape[3]:f.shape[1],w="NHWC"===c?g.shape[3]:g.shape[1];ue(m===n[2],function(){return"Error in conv2dDerFilter: depth of input "+m+") must match input depth in filter ("+n[2]+"."}),ue(w===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+w+") must match output depth for filter ("+n[3]+")."}),null!=d&&ue(Qn(s),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+d+" but got pad "+s+"."});var A=ul(c),T=Ua(f.shape,n,a,1,s,d,!1,A);return P.runKernelFunc(function(M){return M.conv2dDerFilter(f,g,T)},{x4D:f,dy4D:g})}}),Ng=ye({conv2dDerInput_:Rg}),fc=ye({depthwiseConv2d_:function(e,t,n,a,s,c,d){void 0===c&&(c=[1,1]);var f=D(e,"x","depthwiseConv2d"),g=D(t,"filter","depthwiseConv2d"),m=f,w=!1;3===f.rank&&(w=!0,m=f.as4D(1,f.shape[0],f.shape[1],f.shape[2])),ue(4===m.rank,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+m.rank+"."}),ue(4===g.rank,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+g.rank+"."}),ue(m.shape[3]===g.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+m.shape[3]+") must match the inChannels dimension in filter "+g.shape[2]+"."}),null==c&&(c=[1,1]),ue(mi(n,c),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+c+"'"}),null!=d&&ue(Qn(a),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+d+" but got pad "+a+"."});var A=Ua(m.shape,g.shape,n,c,a,d,!0),M=P.runKernelFunc(function(O,V){var H=O.depthwiseConv2D(m,g,A);return V([m,g]),H},{x:m,filter:g},function(O,V){ue(No(c),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+c+"'"});var H=V[0],X=V[1];return{x:function(){return Lg(H.shape,O,X,A)},filter:function(){return Fg(H,O,X.shape,A)}}},"DepthwiseConv2dNative",A,[m,g]);return w?M.as3D(M.shape[1],M.shape[2],M.shape[3]):M}}),Lg=ye({depthwiseConv2dDerInput_:function(e,t,n,a){var s=t,c=!1;3===t.rank&&(c=!0,s=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var d=P.runKernelFunc(function(f){return f.depthwiseConv2DDerInput(s,n,a)},{dy4D:s});return c?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}}),Fg=ye({depthwiseConv2dDerFilter_:function(e,t,n,a){var s=e;3===e.rank&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var c=t;return 3===c.rank&&(c=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),P.runKernelFunc(function(d){return d.depthwiseConv2DDerFilter(s,c,a)},{x4D:s,dy4D:c})}}),fu=ye({separableConv2d_:function(e,t,n,a,s,c,d){void 0===c&&(c=[1,1]),void 0===d&&(d="NHWC");var f=D(e,"x","separableConv2d"),g=D(t,"depthwiseFilter","separableConv2d"),m=D(n,"pointwiseFilter","separableConv2d"),w=f,A=!1;if(3===f.rank&&(A=!0,w=f.as4D(1,f.shape[0],f.shape[1],f.shape[2])),"NCHW"===d)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");ue(4===w.rank,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+w.rank+"."}),ue(4===g.rank,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+g.rank+"."}),ue(4===m.rank,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+g.rank+"."}),ue(1===m.shape[0],function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+m.shape[0]+"."}),ue(1===m.shape[1],function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+m.shape[1]+"."});var T=g.shape[2],M=g.shape[3];ue(m.shape[2]===T*M,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+T*M+", but got "+m.shape[2]+"."});var O=fc(w,g,a,s,d,c),V=ga(O,m,1,"valid",d);return A?V.as3D(V.shape[1],V.shape[2],V.shape[3]):V}}),Og=ye({conv2dTranspose_:function(e,t,n,a,s,c){return Rg(n,D(e,"x","conv2dTranspose"),D(t,"filter","conv2dTranspose"),a,s,"NHWC",c)}}),Bg=ye({conv3dTranspose_:function(e,t,n,a,s){return Dg(n,D(e,"x","conv3dTranspose"),D(t,"filter","conv3dTranspose"),a,s)}}),pc=ye({matMul_:function(e,t,n,a){var s;void 0===n&&(n=!1),void 0===a&&(a=!1);var c=D(e,"a","matMul"),d=D(t,"b","matMul");s=Bn(c,d),c=s[0],d=s[1];var f=n?c.shape[c.rank-2]:c.shape[c.rank-1],g=a?d.shape[d.rank-1]:d.shape[d.rank-2],m=n?c.shape[c.rank-1]:c.shape[c.rank-2],w=a?d.shape[d.rank-2]:d.shape[d.rank-1],A=c.shape.slice(0,-2),T=d.shape.slice(0,-2),M=mt(A),O=mt(T);ue(2<=c.rank&&2<=d.rank&&c.rank===d.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+c.rank+" and "+d.rank+"."}),ue(or(A,T),function(){return"Error in matMul: outer dimensions ("+A+") and ("+T+") of Tensors with shapes "+c.shape+" and "+d.shape+" must match."}),ue(f===g,function(){return"Error in matMul: inner shapes ("+f+") and ("+g+") of Tensors with shapes "+c.shape+" and "+d.shape+" and transposeA="+n+" and transposeB="+a+" must match."});var V=c.shape.slice(0,-2).concat([m,w]),H=n?c.as3D(M,f,m):c.as3D(M,m,f),X=a?d.as3D(O,w,g):d.as3D(O,g,w);return P.runKernelFunc(function(ee,re){var te=ee.batchMatMul(H,X,n,a);return re([H,X]),te},{a:H,b:X},function(ee,re){var le=re[0],se=re[1];return n||a?!n&&a?{a:function(){return ee.matMul(se,!1,!1)},b:function(){return ee.matMul(le,!0,!1)}}:n&&!a?{a:function(){return se.matMul(ee,!1,!0)},b:function(){return le.matMul(ee,!1,!1)}}:{a:function(){return se.matMul(ee,!0,!0)},b:function(){return ee.matMul(le,!0,!0)}}:{a:function(){return ee.matMul(se,!1,!0)},b:function(){return le.matMul(ee,!0,!1)}}},"BatchMatMul",{transposeA:n,transposeB:a}).reshape(V)}}),zg=ye({dot_:function(e,t){var n=D(e,"t1","dot"),a=D(t,"t2","dot");ue(!(1!==n.rank&&2!==n.rank||1!==a.rank&&2!==a.rank),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+a.rank+"."});var s=1===n.rank?n.size:n.shape[1],c=1===a.rank?a.size:a.shape[0];return ue(s===c,function(){return"Error in dot: inner dimensions of inputs must match, but got "+s+" and "+c+"."}),1===n.rank&&1===a.rank?n.as2D(1,-1).matMul(a.as2D(-1,1)).asScalar():1===n.rank&&2===a.rank?n.as2D(1,-1).matMul(a.as2D(a.shape[0],a.shape[1])).as1D():2===n.rank&&1===a.rank?n.matMul(a.as2D(-1,1)).as1D():n.matMul(a.as2D(a.shape[0],a.shape[1]))}}),Wg=ye({outerProduct_:function(e,t){var n=D(e,"v1","outerProduct"),a=D(t,"v2","outerProduct");return ue(1===n.rank&&1===a.rank,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+a.rank+"."}),n.as2D(-1,1).matMul(a.as2D(1,-1))}}),yl=ye({reverse_:function(e,t){var n=D(e,"x","reverse");if(0===n.rank)return n.clone();var a=Nn(t,n.shape);return P.runKernelFunc(function(s){return s.reverse(n,a)},{$x:n},function(s){return{$x:function(){return s.reverse(a)}}}).reshapeAs(n)}}),Hg=ye({reverse1d_:function(e){var t=D(e,"x","reverse");return ue(1===t.rank,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),yl(t,0)}}),Xg=ye({reverse2d_:function(e,t){var n=D(e,"x","reverse");return ue(2===n.rank,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),yl(n,t)}}),Gg=ye({reverse3d_:function(e,t){var n=D(e,"x","reverse");return ue(3===n.rank,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),yl(n,t)}}),Vg=ye({reverse4d_:function(e,t){var n=D(e,"x","reverse");return ue(4===n.rank,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),yl(n,t)}});function Yg(e,t,n,a,s,c){var d=D(e,"x","maxPool"),f=d,g=!1;3===d.rank&&(g=!0,f=d.as4D(1,d.shape[0],d.shape[1],d.shape[2])),null==a&&(a=[1,1]),ue(4===f.rank,function(){return"Error in maxPool: input must be rank 4 but got rank "+f.rank+"."}),ue(mi(n,a),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),null!=c&&ue(Qn(s),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+s+"."});var m=pa(f.shape,t,n,a,s,c);if(1===m.filterWidth&&1===m.filterHeight&&or(m.inShape,m.outShape))return d.clone();var A=P.runKernelFunc(function(T,M){var O=T.maxPool(f,m);return M([f,O]),O},{x:f},function(T,M){var O=M[0],V=M[1];return{x:function(){return function(H,X,$,ee,re,te,le){var se=D(T,"dy","maxPoolBackprop"),ie=D(X,"input","maxPoolBackprop"),ce=D($,"output","maxPoolBackprop");ue(ie.rank===se.rank,function(){return"Rank of input ("+ie.rank+") does not match rank of dy ("+se.rank+")"}),null==te&&(te=[1,1]),ue(mi(re,te),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+re+" and dilations '"+te+"'"}),ue(4===se.rank,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+se.rank+"."}),ue(4===ie.rank,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+ie.rank+"."});var he=pa(ie.shape,ee,re,te,le,void 0);return P.runKernelFunc(function(be){return be.maxPoolBackprop(se,ie,ce,he)},{$dy:se,$input:ie})}(0,O,V,t,n,a,s)}}},"MaxPool",m,[f]);return g?A.as3D(A.shape[1],A.shape[2],A.shape[3]):A}function jg(e,t,n,a,s,c){var d=D(e,"x","avgPool","float32");null==a&&(a=[1,1]),ue(mi(n,a),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"});var f=d,g=!1;3===d.rank&&(g=!0,f=d.as4D(1,d.shape[0],d.shape[1],d.shape[2])),ue(4===f.rank,function(){return"Error in avgPool: x must be rank 4 but got rank "+f.rank+"."}),null!=c&&ue(Qn(s),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+s+"."});var m=pa(f.shape,t,n,a,s,c);if(1===m.filterWidth&&1===m.filterHeight&&or(m.inShape,m.outShape))return d.clone();var w=P.runKernelFunc(function(A){return A.avgPool(f,m)},{x:f},function(A){return{x:function(){return function(T,M,O,V,H,X){var $=D(A,"dy","avgPoolBackprop"),ee=D(M,"input","avgPoolBackprop");ue(ee.rank===$.rank,function(){return"Rank of input ("+ee.rank+") does not match rank of dy ("+$.rank+")"}),null==H&&(H=[1,1]),ue(mi(V,H),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+V+" and dilations '"+H+"'"});var re=ee,te=$,le=!1;3===ee.rank&&(le=!0,re=ee.as4D(1,ee.shape[0],ee.shape[1],ee.shape[2]),te=$.as4D(1,$.shape[0],$.shape[1],$.shape[2])),ue(4===te.rank,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+te.rank+"."}),ue(4===re.rank,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+re.rank+"."});var se=pa(re.shape,O,V,H,X),ie=P.runKernelFunc(function(ce){return ce.avgPoolBackprop(te,re,se)},{dy4D:te,input4D:re});return le?ie.as3D(ie.shape[1],ie.shape[2],ie.shape[3]):ie}(0,f,t,n,a,s)}}},"AvgPool",m);return w=w.cast(d.dtype),g?w.as3D(w.shape[1],w.shape[2],w.shape[3]):w}var Qr=ye({maxPool_:function(e,t,n,a,s){return Yg(e,t,n,1,a,s)}}),wl=ye({avgPool_:function(e,t,n,a,s){return jg(e,t,n,1,a,s)}}),Ug=ye({pool_:function(e,t,n,a,s,c){null==s&&(s=[1,1]),null==c&&(c=1),0===a&&(a="valid");var d=D(e,"x","maxPool"),f=d,g=!1;3===d.rank&&(g=!0,f=d.as4D(1,d.shape[0],d.shape[1],d.shape[2])),ue(mi(c,s),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+c+" and dilations '"+s+"'"});var m,A,T,M,O,V=pa(f.shape,t,c,s,a),H=[V.dilationHeight,V.dilationWidth];m="same"===a?(A=H,T=[V.filterHeight,V.filterWidth].map(function(Ee,He){return Ee+(Ee-1)*(A[He]-1)}).map(function(Ee){return Ee-1}),M=T.map(function(Ee){return Math.floor(Ee/2)}),O=T.map(function(Ee,He){return Ee-M[He]}),T.map(function(Ee,He){return[M[He],O[He]]})):[[0,0],[0,0]];var X,$,ee,re,te,le,se,ie,ce=1===H[0]&&1===H[1],he=(X=[V.inHeight,V.inWidth],$=H,re=(ee=m).map(function(Ee){return Ee[0]}),te=ee.map(function(Ee){return Ee[1]}),le=X.concat(re,te),se=$.map(function(Ee,He){return(Ee-le[He]%Ee)%Ee}),ie=te.map(function(Ee,He){return Ee+se[He]}),[$.map(function(Ee,He){return[re[He],ie[He]]}),$.map(function(Ee,He){return[0,se[He]]})]),be=he[1],Ae=ce?a:"valid",Te=ce?f:Io(f,H,he[0]),We=("avg"===n?function(){return jg(Te,t,c,1,Ae)}:function(){return Yg(Te,t,c,1,Ae)})(),Fe=ce?We:Qe(We,H,be);return g?Fe.as3D(Fe.shape[1],Fe.shape[2],Fe.shape[3]):Fe}}),qg=ye({maxPool3d_:function(e,t,n,a,s,c,d){void 0===c&&(c="NDHWC");var f=D(e,"x","maxPool3d"),g=f,m=!1;4===f.rank&&(m=!0,g=f.as5D(1,f.shape[0],f.shape[1],f.shape[2],f.shape[3])),null==d&&(d=[1,1,1]),ue(5===g.rank,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+g.rank+"."}),ue("NDHWC"===c,function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+c}),ue(mi(n,d),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+d+"'"}),null!=s&&ue(Qn(a),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."});var w=Po(g.shape,t,n,d,a,s,c),A=P.runKernelFunc(function(T,M){var O=T.maxPool3d(g,w);return M([g,O]),O},{x:g},function(T,M){var O=M[0],V=M[1];return{x:function(){return function(H,X,$,ee,re,te,le,se){var ie=D(T,"dy","maxPool3dBackprop"),ce=D(X,"input","maxPool3dBackprop"),he=D($,"output","maxPool3dBackprop"),be=ie,Ae=ce,Te=he,We=!1;4===ce.rank&&(We=!0,be=ie.as5D(1,ie.shape[0],ie.shape[1],ie.shape[2],ie.shape[3]),Ae=ce.as5D(1,ce.shape[0],ce.shape[1],ce.shape[2],ce.shape[3]),Te=he.as5D(1,he.shape[0],he.shape[1],he.shape[2],he.shape[3])),ue(5===be.rank,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+be.rank+"."}),ue(5===Ae.rank,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+Ae.rank+"."}),ue(5===Te.rank,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+Te.rank+"."}),null==te&&(te=[1,1,1]),ue(mi(re,te),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+re+" and dilations '"+te+"'"}),null!=se&&ue(Qn(le),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+se+" but got pad "+le+"."});var Fe=Po(Ae.shape,ee,re,te,le,se),Ee=P.runKernelFunc(function(He){return He.maxPool3dBackprop(be,Ae,Te,Fe)},{dy5D:be,input5D:Ae});return We?Ee.as4D(Ee.shape[1],Ee.shape[2],Ee.shape[3],Ee.shape[4]):Ee}(0,O,V,t,n,d,a,s)}}});return m?A.as4D(A.shape[1],A.shape[2],A.shape[3],A.shape[4]):A}}),$g=ye({avgPool3d_:function(e,t,n,a,s,c,d){void 0===c&&(c="NDHWC");var f=D(e,"x","avgPool3d","float32"),g=f,m=!1;4===f.rank&&(m=!0,g=f.as5D(1,f.shape[0],f.shape[1],f.shape[2],f.shape[3])),null==d&&(d=[1,1,1]),ue(5===g.rank,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+g.rank+"."}),ue("NDHWC"===c,function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+c}),ue(mi(n,d),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+d+"'"}),null!=s&&ue(Qn(a),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."});var w=Po(g.shape,t,n,d,a,s,c),A=P.runKernelFunc(function(T){return T.avgPool3d(g,w)},{x:g},function(T){return{x:function(){return function(M,O,V,H,X,$,ee){var re=D(T,"dy","avgPool3dBackprop"),te=D(O,"input","avgPool3dBackprop"),le=re,se=te,ie=!1;4===te.rank&&(ie=!0,le=re.as5D(1,re.shape[0],re.shape[1],re.shape[2],re.shape[3]),se=te.as5D(1,te.shape[0],te.shape[1],te.shape[2],te.shape[3])),ue(5===le.rank,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+le.rank+"."}),ue(5===se.rank,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+se.rank+"."}),null==X&&(X=[1,1,1]),ue(mi(H,X),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+H+" and dilations '"+X+"'"}),null!=ee&&ue(Qn($),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+ee+" but got pad "+$+"."});var ce=Po(se.shape,V,H,X,$,ee),he=P.runKernelFunc(function(be){return be.avgPool3dBackprop(le,se,ce)},{dy5D:le,input5D:se});return ie?he.as4D(he.shape[1],he.shape[2],he.shape[3],he.shape[4]):he}(0,g,t,n,d,a,s)}}});return A=A.cast(g.dtype),m?A.as4D(A.shape[1],A.shape[2],A.shape[3],A.shape[4]):A}}),Ka=ye({slice_:function(e,t,n){var a,s,c=D(e,"x","slice");if(0===c.rank)throw new Error("Slicing scalar is not possible");(a="number"==typeof t?[t].concat(new Array(c.rank-1).fill(0)):t.length<c.rank?t.concat(new Array(c.rank-t.length).fill(0)):t.slice()).forEach(function(g){ue(-1!==g,function(){return"slice() does not support negative begin indexing."})}),s=(s=null==n?new Array(c.rank).fill(-1):"number"==typeof n?[n].concat(new Array(c.rank-1).fill(-1)):n.length<c.rank?n.concat(new Array(c.rank-n.length).fill(-1)):n).map(function(g,m){return 0<=g?g:(ue(-1===g,function(){return"Negative size values should be exactly -1 but got "+g+" for the slice() size at index "+m+"."}),c.shape[m]-a[m])}),Hc(c,a,s);var d=c.shape;return P.runKernelFunc(function(g){return g.slice(c,a,s)},{x:c},function(g){for(var m=[],w=0;w<g.rank;w++)m.push([a[w],d[w]-a[w]-s[w]]);return{x:function(){return g.pad(m)}}},"Slice",{begin:a,size:s})}}),Kg=ye({slice1d_:function(e,t,n){var a=D(e,"x","slice1d");return ue(1===a.rank,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+a.rank+" tensor"}),Ka(a,[t],[n])}}),Zg=ye({slice2d_:function(e,t,n){var a=D(e,"x","slice2d");return ue(2===a.rank,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+a.rank+" tensor"}),Ka(a,t,n)}}),Oh=ye({slice3d_:function(e,t,n){var a=D(e,"x","slice3d");return ue(3===a.rank,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+a.rank+" tensor"}),Ka(a,t,n)}}),Jg=ye({slice4d_:function(e,t,n){var a=D(e,"x","slice4d");return ue(4===a.rank,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+a.rank+" tensor"}),Ka(a,t,n)}});function Qg(e,t,n,a,s){return t.rank<n.rank&&(t=t.reshape(Oe(t.shape,a))),e.rank<n.rank&&(e=e.reshape(Oe(e.shape,a))),{x:function(){var c=e.mul(n.equal(t).cast(e.dtype));return null==s?c:c.transpose(s)}}}var ev=ye({all_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var a=D(e,"x","all","bool"),s=Nn(t,a.shape),c=s,d=Ne(c,a.rank);null!=d&&(a=a.transpose(d),c=Ct(c.length,a.rank));var f=P.runKernelFunc(function(m){return m.all(a,c)},{$x:a});if(n){var g=Oe(f.shape,s);return f.reshape(g)}return f}}),tv=ye({any_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var a=D(e,"x","any","bool"),s=Nn(t,a.shape),c=s,d=Ne(c,a.rank);null!=d&&(a=a.transpose(d),c=Ct(c.length,a.rank));var f=P.runKernelFunc(function(m){return m.any(a,c)},{$x:a});if(n){var g=Oe(f.shape,s);return f.reshape(g)}return f}}),nv=ye({argMax_:function(e,t){void 0===t&&(t=0);var n=D(e,"x","argMax");null==t&&(t=0);var a=Nn(t,n.shape),s=Ne(a,n.rank);return null!=s&&(n=n.transpose(s),a=Ct(a.length,n.rank)),P.runKernelFunc(function(f,g){var m=f.argMax(n,a[0]);return g([n]),m},{x:n},function(f,g){var m=g[0];return{x:function(){return Vt(m)}}},"ArgMax",{axis:a[0]},[n])}}),rv=ye({argMin_:function(e,t){void 0===t&&(t=0);var n=D(e,"x","argMin");null==t&&(t=0);var a=Nn(t,n.shape),s=Ne(a,n.rank);return null!=s&&(n=n.transpose(s),a=Ct(a.length,n.rank)),P.runKernelFunc(function(c,d){var f=c.argMin(n,a[0]);return d([n]),f},{$x:n},function(c,d){var f=d[0];return{$x:function(){return Vt(f)}}})}}),iv=ye({logSumExp_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var a=D(e,"x","logSumExp"),s=Nn(t,a.shape),c=a.max(s,!0),d=a.sub(c).exp().sum(s).log(),f=c.reshape(d.shape).add(d);if(n){var g=Oe(f.shape,s);return f.reshape(g)}return f}}),gc=ye({max_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var a=D(e,"x","max"),s=a,c=Nn(t,a.shape),d=c,f=Ne(d,a.rank);null!=f&&(a=a.transpose(f),d=Ct(d.length,a.rank));var m=P.runKernelFunc(function(A,T){var M=A.max(a,d);return T([s,M]),M},{x:a},function(A,T){return Qg(A,T[1],T[0],c,f)},"Max",{axes:d},[a],[!0]);if(n){var w=Oe(m.shape,c);m=m.reshape(w)}return m}}),av=ye({mean_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var a=D(e,"x","mean"),s=Nn(t,a.shape),c=mt(Ie(a.shape,s)[1]);return Do(function(d){var f=nt(c);return{value:(f.dtype===d.dtype?d:d.cast(f.dtype)).div(f).sum(t,n),gradFunc:function(g){var m=d.shape.slice();return s.forEach(function(w){m[w]=1}),g.reshape(m).mul(_i(d.shape,"float32")).div(c)}}})(a)}}),ov=ye({min_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var a=D(e,"x","min"),s=a,c=Nn(t,a.shape),d=c,f=Ne(d,a.rank);null!=f&&(a=a.transpose(f),d=Ct(d.length,a.rank));var m=P.runKernelFunc(function(A,T){var M=A.min(a,d);return T([s,M]),M},{x:a},function(A,T){return Qg(A,T[1],T[0],c,f)},"Min",{axes:d},[a],[!0]);if(n){var w=Oe(m.shape,c);m=m.reshape(w)}return m}}),sv=ye({moments_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var a=Nn(t,(e=D(e,"x","moments")).shape),s=e.mean(a,n),c=s.shape;n||(c=Oe(s.shape,a));var d=e.toFloat().sub(s.reshape(c)).square();return{mean:s,variance:d.mean(a,n)}}}),Bh=ye({sum_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var a=D(e,"x","sum");"bool"===a.dtype&&(a=a.toInt());var s=Nn(t,a.shape);return Do(function(c){var d=Ne(s,c.rank),f=s,g=c;function m(M){var O=c.shape.slice();return s.forEach(function(V){O[V]=1}),M.reshape(O).mul(_i(c.shape,"float32"))}null!=d&&(g=c.transpose(d),f=Ct(f.length,c.rank));var A=P.runKernelFunc(function(M){return M.sum(g,f)},{x:g},function(M){return{x:function(){return m(M)}}},"Sum",{axes:f});if(n){var T=Oe(A.shape,s);A=A.reshape(T)}return{value:A,gradFunc:m}})(a)}}),lv=ye({prod_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var a=D(e,"x","prod");"bool"===a.dtype&&(a=a.toInt());var s=Nn(t,a.shape),c=Ne(s,a.rank),d=s,f=a;null!=c&&(f=a.transpose(c),d=Ct(d.length,a.rank));var g=P.runKernelFunc(function(w){return w.prod(f,d)},{permutedX:f});if(n){var m=Oe(g.shape,s);g=g.reshape(m)}return g}}),zh=ye({elu_:function(e){var t=D(e,"x","elu");return P.runKernelFunc(function(n,a){var s=n.elu(t);return a([s]),s},{$x:t},function(n,a){var s=a[0];return{$x:function(){return P.runKernelFunc(function(c){return c.eluDer(n,s)},{dy:n,y:s})}}})}}),cv=ye({leakyRelu_:function(e,t){void 0===t&&(t=.2);var n=D(e,"x","leakyRelu");return hu(nt(t).mul(n),n)}}),Wh=ye({prelu_:function(e,t){var n=D(e,"x","prelu"),a=D(t,"alpha","prelu");return P.runKernelFunc(function(s,c){var d=s.prelu(n,a);return c([n,a]),d},{x:n,alpha:a},function(s,c){var d=c[0],f=c[1],g=d.greater(0);return{x:function(){return fs(g,s,s.mul(f))},alpha:function(){var m=fs(g,Vt(s),s.mul(d)),w=Ir(f.shape,s.shape);return 0<w.length&&(m=m.sum(w)),m.reshape(f.shape)}}},"Prelu")}}),br=ye({relu_:function(e){var t=D(e,"x","relu");return"bool"===t.dtype?t.toInt():P.runKernelFunc(function(n,a){var s=n.relu(t);return a([t]),s},{x:t},function(n,a){var s=a[0];return{x:function(){return n.mulStrict(s.step().toFloat())}}},"Relu")}}),Hh=ye({relu6_:function(e){var t=D(e,"x","relu6");return"bool"===t.dtype?t.toInt():P.runKernelFunc(function(n,a){var s=n.relu6(t);return a([t]),s},{x:t},function(n,a){var s=a[0],c=s.lessEqual(6).mul(s.step());return{x:function(){return n.mulStrict(c.toFloat())}}},"Relu6")}}),uv=ye({selu_:function(e){var t=D(e,"x","selu");return P.runKernelFunc(function(n,a){var s=n.selu(t);return a([t]),s},{$x:t},function(n,a){var s=a[0];return{$x:function(){var c=s.greater(nt(0)),d=nt(1.7580993408473768),f=nt(1.0507009873554805),g=n.mul(f),m=n.mul(d).mul(s.toFloat().exp());return fs(c,g,m)}}})}}),zo=ye({transpose_:function(e,t){var n=D(e,"x","transpose");return null==t&&(t=n.shape.map(function(s,c){return c}).reverse()),ue(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."}),t.forEach(function(s){ue(0<=s&&s<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t})}),n.rank<=1?n.clone():P.runKernelFunc(function(s){return s.transpose(n,t)},{x:n},function(s){var c=et(t);return{x:function(){return s.transpose(c)}}},"Transpose",{perm:t})}}),hv=ye({localResponseNormalization_:function(e,t,n,a,s){void 0===t&&(t=5),void 0===n&&(n=1),void 0===a&&(a=1),void 0===s&&(s=.5);var c=D(e,"x","localResponseNormalization");ue(4===c.rank||3===c.rank,function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+c.rank+"."}),ue(Qn(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var d=c,f=!1;3===c.rank&&(f=!0,d=c.as4D(1,c.shape[0],c.shape[1],c.shape[2]));var g=P.runKernelFunc(function(m,w){var A=m.localResponseNormalization4D(d,t,n,a,s);return w([d,A]),A},{x4D:d},function(m,w){var A=w[0],T=w[1];return{x4D:function(){return P.runKernelFunc(function(M){return M.LRNGrad(m,A,T,t,n,a,s)},{})}}});return f?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),Xh=ye({norm_:function(e,t,n,a){void 0===t&&(t="euclidean"),void 0===n&&(n=null),void 0===a&&(a=!1);var s=function f(g,m,w){if(void 0===w&&(w=null),0===g.rank)return g.abs();if(1!==g.rank&&null===w)return f(g.reshape([-1]),m,w);if(1===g.rank||"number"==typeof w||Array.isArray(w)&&1===w.length){if(1===m)return g.abs().sum(w);if(m===1/0)return g.abs().max(w);if(m===-1/0)return g.abs().min(w);if("euclidean"===m||2===m)return g.abs().pow(nt(2,"int32")).sum(w).sqrt();throw new Error("Error in norm: invalid ord value: "+m)}if(Array.isArray(w)&&2===w.length){if(1===m)return g.abs().sum(w[0]).max(w[1]-1);if(m===1/0)return g.abs().sum(w[1]).max(w[0]);if(m===-1/0)return g.abs().sum(w[1]).min(w[0]);if("fro"===m||"euclidean"===m)return g.square().sum(w).sqrt();throw new Error("Error in norm: invalid ord value: "+m)}throw new Error("Error in norm: invalid axis: "+w)}(e=D(e,"x","norm"),t,n),c=s.shape;if(a){var d=Nn(n,e.shape);c=Oe(s.shape,d)}return s.reshape(c)}}),dv=ye({basicLSTMCell_:function(e,t,n,a,s,c){var d=D(e,"forgetBias","basicLSTMCell"),f=D(t,"lstmKernel","basicLSTMCell"),g=D(n,"lstmBias","basicLSTMCell"),m=D(a,"data","basicLSTMCell"),w=D(s,"c","basicLSTMCell"),A=D(c,"h","basicLSTMCell"),T=m.concat(A,1).matMul(f).add(g),O=T.shape[1]/4,V=[T.shape[0],O],H=T.slice([0,0],V),X=T.slice([0,O],V),$=T.slice([0,2*O],V),ee=T.slice([0,3*O],V),re=H.sigmoid().mulStrict(X.tanh()).addStrict(w.mulStrict(d.add($).sigmoid())),te=re.tanh().mulStrict(ee.sigmoid());return[re,te]}}),fv=ye({multiRNNCell_:function(e,t,n,a){for(var s=D(t,"data","multiRNNCell"),c=ae(n,"c","multiRNNCell"),d=ae(a,"h","multiRNNCell"),f=s,g=[],m=0;m<e.length;m++){var w=e[m](f,c[m],d[m]);g.push(w[0]),g.push(w[1]),f=w[1]}var A=[],T=[];for(m=0;m<g.length;m+=2)A.push(g[m]),T.push(g[m+1]);return[A,T]}}),pv=ye({movingAverage_:function(e,t,n,a,s){void 0===s&&(s=!0);var c=D(e,"v","movingAverage"),d=D(t,"x","movingAverage"),f=D(n,"decay","movingAverage");ns(c,d),ue(or(c.shape,d.shape),function(){return"Shape mismatch in v and x"});var g=nt(1),m=g.sub(f),w=d.sub(c).mul(m);if(s){ue(null!=a,function(){return"When using zeroDebias: true, step is required."});var A=D(a,"step","movingAverage");w=w.div(g.sub(dc(f,A)))}return c.add(w)}}),gv=ye({stridedSlice_:function(e,t,n,a,s,c,d,f,g){if(void 0===s&&(s=0),void 0===c&&(c=0),void 0===d&&(d=0),void 0===f&&(f=0),void 0===g&&(g=0),null==a&&(a=new Array(t.length)),0!==d)throw new Error("ellipsis mask is not yet supported");var m=D(e,"x","stridedSlice"),w=Yl(f),A=m.shape.slice();w.forEach(function(H){t[H]=0,n[H]=1,A.splice(H,0,1)}),m=m.reshape(A);for(var T=0;T<m.rank;T++)t[T]=Xc(s,t,a,m.shape,T),n[T]=ol(c,n,a,m.shape,T),a[T]=a[T]||1;var M=Yl(g);M.forEach(function(H){n[H]=t[H]+1,a[H]=1});var O=al(t,n,a),V=O.filter(function(H,X){return-1===M.indexOf(X)});return a.every(function(H){return 1===H})?Ka(m,t,O).reshape(V):P.runKernelFunc(function(H){return H.stridedSlice(m,t,n,a)},{$x:m}).reshape(V)}}),vv=ye({topk_:function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=!0);var a=D(e,"x","topk");if(0===a.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var s=a.shape[a.shape.length-1];if(s<t)throw new Error("'k' passed to topk() must be <= the last dimension ("+s+") but got "+t);var c=P.runKernelFunc(function(d){return d.topk(a,t,n)},{$x:a});return{values:c[0],indices:c[1]}}}),mv=ye({scatterND_:function(e,t,n){var a=D(e,"indices","scatterND","int32"),s=D(t,"updates","scatterND");return Wc(s,a,n),P.runKernelFunc(function(c){return c.scatterND(a,s,n)},{indices:a,updates:s},null,"ScatterNd",{shape:n})}}),pu=ye({fft_:function(e){ue("complex64"===e.dtype,function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],a=e.as2D(e.size/t,t);return P.runKernelFunc(function(s){return s.fft(a)},{input:e}).reshape(e.shape)}}),vc=ye({ifft_:function(e){ue("complex64"===e.dtype,function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],a=e.as2D(e.size/t,t);return P.runKernelFunc(function(s){return s.ifft(a)},{input:e}).reshape(e.shape)}}),gu=ye({rfft_:function(e,t){ue("float32"===e.dtype,function(){return"The dtype for rfft() must be real value but got "+e.dtype});var n,a=e.shape[e.shape.length-1],s=e.size/a;if(null!=t&&t<a){var c=e.shape.map(function(X){return 0}),d=e.shape.map(function(X){return X});d[e.shape.length-1]=t,n=e.slice(c,d),a=t}else if(null!=t&&a<t){var f=e.shape.map(function(X){return X});f[e.shape.length-1]=t-a,n=e.concat(sn(f),e.shape.length-1),a=t}else n=e;var g=n.zerosLike(),m=an(n,g).as2D(s,a),w=pu(m),A=Math.floor(a/2)+1,T=ir(w),M=gr(w),O=T.split([A,a-A],T.shape.length-1),V=M.split([A,a-A],M.shape.length-1),H=n.shape.slice();return H[n.shape.length-1]=A,an(O[0],V[0]).reshape(H)}}),Gh=ye({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var a=e.as2D(n,t),s=vc(a);return ir(s)}var c=[n,2*(t-1)],d=ir(e).as2D(n,t),f=gr(e).as2D(n,t),g=d.slice([0,1],[n,t-2]).reverse(1),m=f.slice([0,1],[n,t-2]).reverse(1).mul(nt(-1)),w=d.concat(g,1),A=f.concat(m,1);return a=an(w,A).as2D(c[0],c[1]),s=vc(a),ir(s)}}),xv=Object.freeze({fft:pu,ifft:vc,rfft:gu,irfft:Gh}),bv=ye({sparseToDense_:function(e,t,n,a){void 0===a&&(a=0);var s=D(e,"sparseIndices","sparseToDense","int32"),c=D(t,"sparseValues","sparseToDense"),d=D(a,"defaultValue","sparseToDense",c.dtype);return function(f,g,m,w){if("int32"!==f.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+f.dtype+".");if(2<f.rank)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+f.shape+".");var A=0<f.rank?f.shape[0]:1,T=1<f.rank?f.shape[1]:1;if(m.length!==T)throw new Error("outputShape has incorrect number of elements:, "+m.length+", should be: "+T+".");if(0!==g.rank&&(1!==g.rank||g.size!==A))throw new Error("sparseValues has incorrect shape "+g.shape+", should be [] or ["+A+"]");if(g.dtype!==w.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(s,c,n,d),P.runKernelFunc(function(f){return f.sparseToDense(s,c,n,d)},{$sparseIndices:s,$sparseValues:c,$defaultValue:d})}}),yv=ye({gatherND_:function(e,t){var n=D(t,"indices","gatherND","int32"),a=D(e,"x","gatherND");return P.runKernelFunc(function(s){return s.gatherND(a,n)},{x:a,indices:n},null,"GatherNd")}}),wv=ye({diag_:function(e){var t=D(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return P.runKernelFunc(function(a){return a.diag(t)},{$x:t}).reshape(n)}}),Cv=ye({dropout_:function(e,t,n,a){var s=D(e,"x","dropout");if(ue("float32"===s.dtype,function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+s.dtype+" tensor instead."}),ue(0<=t&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),0===t)return e instanceof rn?s.clone():s;var c=function(g,m){if(null==m)return g.shape.slice();if(or(g.shape,m)||g.shape.length!==m.length)return m;for(var w=[],A=0;A<g.shape.length;A++)w.push(null==m[A]&&null!=g.shape[A]?g.shape[A]:m[A]);return w}(s,n),d=1-t,f=si(c,0,1,"float32",a).add(d).floor().div(d);return s.mul(f)}});function kv(e,t,n){for(var a=1-e%2,s=new Float32Array(e),c=0;c<e;++c){var d=2*Math.PI*c/(e+a-1);s[c]=t-n*Math.cos(d)}return tn(s,"float32")}function Av(e,t,n){return void 0===n&&(n=1),F(this,void 0,void 0,function(){var a,s,c,d,f,g,m,w,A,T,M,O,V,H;return de(this,function(X){switch(X.label){case 0:return a=D(e,"predictions","inTopK"),s=D(t,"targets","inTopK"),ue(1<a.rank,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+a.rank}),ue(a.rank-1===s.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+a.rank+" and targets rank "+s.rank}),z(a.shape.slice(0,a.shape.length-1),s.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),c=a.shape[a.shape.length-1],ue(0<n&&n<=c,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+c+"), but got "+n}),[4,a.data()];case 1:return d=X.sent(),[4,s.data()];case 2:for(f=X.sent(),w=(g=[d.length/c,c])[1],A=Ai("bool",m=g[0]),T=0;T<m;T++){for(O=d.subarray(M=T*w,M+w),V=[],H=0;H<O.length;H++)V.push({value:O[H],index:H});for(V.sort(function($,ee){return ee.value-$.value}),A[T]=0,H=0;H<n;H++)if(V[H].index===f[T]){A[T]=1;break}}return e!==a&&a.dispose(),t!==s&&s.dispose(),[2,Wt(A,s.shape,"bool")]}})})}var wi,ps,vu=ye({hannWindow_:function(e){return kv(e,.5,.5)}}),Vh=ye({hammingWindow_:function(e){return kv(e,.54,.46)}}),mu=ye({frame_:function(e,t,n,a,s){void 0===a&&(a=!1),void 0===s&&(s=0);for(var c=0,d=[];c+t<=e.size;)d.push(Ka(e,c,t)),c+=n;if(a)for(;c<e.size;){var f=c+t-e.size,g=vt([Ka(e,c,t-f),Wn([f],s)]);d.push(g),c+=n}return 0===d.length?vi([],[0,t]):vt(d).as2D(d.length,t)}}),Yh=ye({stft_:function(e,t,n,a,s){void 0===s&&(s=vu),null==a&&(a=Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2)))));for(var d=mu(e,t,n),f=yi(d,s(t)),g=[],m=0;m<d.shape[0];m++)g.push(gu(f.slice([m,0],[1,t]),a));return vt(g)}}),Sv=Object.freeze({hannWindow:vu,hammingWindow:Vh,frame:mu,stft:Yh});(ps=wi=wi||{})[ps.NONE=0]="NONE",ps[ps.MEAN=1]="MEAN",ps[ps.SUM=2]="SUM",ps[ps.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS";var xb=ye({absoluteDifference_:function(e,t,n,a){void 0===a&&(a=wi.SUM_BY_NONZERO_WEIGHTS);var s=D(e,"labels","absoluteDifference"),c=D(t,"predictions","absoluteDifference"),d=null;null!=n&&(d=D(n,"weights","absoluteDifference")),z(s.shape,c.shape,"Error in absoluteDifference: ");var f=s.sub(c).abs();return Wo(f,d,a)}}),Wo=ye({computeWeightedLoss_:function(e,t,n){void 0===n&&(n=wi.SUM_BY_NONZERO_WEIGHTS);var a=D(e,"losses","computeWeightedLoss"),s=null;null!=t&&(s=D(t,"weights","computeWeightedLoss"));var c=null==s?a:a.mul(s);if(n===wi.NONE)return c;if(n===wi.SUM)return c.sum();if(n===wi.MEAN){if(null==s)return c.mean();var d=a.size/s.size,f=c.sum().div(s.sum());return 1<d?f.div(nt(d)):f}if(n!==wi.SUM_BY_NONZERO_WEIGHTS)throw Error("Unknown reduction: "+n);if(null==s)return c.sum().div(nt(a.size));var g=s.mul(_i(a.shape)).notEqual(nt(0)).sum().toFloat();return c.sum().div(g)}}),bb=ye({cosineDistance_:function(e,t,n,a,s){void 0===s&&(s=wi.SUM_BY_NONZERO_WEIGHTS);var c=D(e,"labels","cosineDistance"),d=D(t,"predictions","cosineDistance"),f=null;null!=a&&(f=D(a,"weights","cosineDistance")),z(c.shape,d.shape,"Error in cosineDistance: ");var g=nt(1).sub(c.mul(d).sum(n,!0));return Wo(g,f,s)}}),yb=ye({hingeLoss_:function(e,t,n,a){void 0===a&&(a=wi.SUM_BY_NONZERO_WEIGHTS);var s=D(e,"labels","hingeLoss"),c=D(t,"predictions","hingeLoss"),d=null;null!=n&&(d=D(n,"weights","hingeLoss")),z(s.shape,c.shape,"Error in hingeLoss: ");var f=nt(1);s=nt(2).mul(s).sub(f);var g=f.sub(s.mul(c)).relu();return Wo(g,d,a)}}),wb=ye({huberLoss_:function(e,t,n,a,s){void 0===a&&(a=1),void 0===s&&(s=wi.SUM_BY_NONZERO_WEIGHTS);var c=D(e,"labels","huberLoss"),d=D(t,"predictions","huberLoss"),f=null;null!=n&&(f=D(n,"weights","huberLoss")),z(c.shape,d.shape,"Error in huberLoss: ");var g=nt(a),m=d.sub(c).abs(),w=Dh(m,g),A=m.sub(w),T=nt(.5).mul(w.square()).add(g.mul(A));return Wo(T,f,s)}}),Cb=ye({logLoss_:function(e,t,n,a,s){void 0===a&&(a=1e-7),void 0===s&&(s=wi.SUM_BY_NONZERO_WEIGHTS);var c=D(e,"labels","logLoss"),d=D(t,"predictions","logLoss"),f=null;null!=n&&(f=D(n,"weights","logLoss")),z(c.shape,d.shape,"Error in logLoss: ");var g=nt(1),m=nt(a),w=c.mul(d.add(m).log()).neg().sub(g.sub(c).mul(g.sub(d).add(m).log()));return Wo(w,f,s)}}),kb=ye({meanSquaredError_:function(e,t,n,a){void 0===a&&(a=wi.SUM_BY_NONZERO_WEIGHTS);var s=D(e,"labels","meanSquaredError"),c=D(t,"predictions","meanSquaredError"),d=null;null!=n&&(d=D(n,"weights","meanSquaredError")),z(s.shape,c.shape,"Error in meanSquaredError: ");var f=s.squaredDifference(c);return Wo(f,d,a)}}),Ab=ye({sigmoidCrossEntropy_:function(e,t,n,a,s){void 0===a&&(a=0),void 0===s&&(s=wi.SUM_BY_NONZERO_WEIGHTS);var c=D(e,"multiClassLabels","sigmoidCrossEntropy"),d=D(t,"logits","sigmoidCrossEntropy"),f=null;if(null!=n&&(f=D(n,"weights","sigmoidCrossEntropy")),z(c.shape,d.shape,"Error in sigmoidCrossEntropy: "),0<a){var g=nt(a),m=nt(1),w=nt(.5);c=c.mul(m.sub(g)).add(w.mul(g))}var A=function(T,M){var O=D(c,"labels","sigmoidCrossEntropyWithLogits"),V=D(M,"logits","sigmoidCrossEntropyWithLogits");z(O.shape,V.shape,"Error in sigmoidCrossEntropyWithLogits: ");var H=V.relu(),X=V.mul(O),$=V.abs().neg().exp().log1p();return H.sub(X).add($)}(0,d);return Wo(A,f,s)}}),Sb=ye({softmaxCrossEntropy_:function(e,t,n,a,s){void 0===a&&(a=0),void 0===s&&(s=wi.SUM_BY_NONZERO_WEIGHTS);var c=D(e,"onehotLabels","softmaxCrossEntropy"),d=D(t,"logits","softmaxCrossEntropy"),f=null;if(null!=n&&(f=D(n,"weights","softmaxCrossEntropy")),z(c.shape,d.shape,"Error in softmaxCrossEntropy: "),0<a){var g=nt(a),m=nt(1),w=nt(c.shape[1]);c=c.mul(m.sub(g)).add(g.div(w))}var A=function(T,M,O){if(void 0===O&&(O=-1),-1===O&&(O=M.rank-1),O!==M.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+M.rank+" and dim was "+O);return Do(function(V,H,X){var $=H.logSumExp([O],!0),ee=H.toFloat().sub($);return X([V,ee]),{value:ee.mul(V).neg().sum([O]),gradFunc:function(re,te){var le=te[0],se=te[1],ie=Oe(re.shape,[O]);return[re.reshape(ie).mul(le.toFloat().sub(se.exp())),re.reshape(ie).mul(se.exp().sub(le.toFloat()))]}}})(T,M)}(c,d);return Wo(A,f,s)}}),Ev=Object.freeze({get Reduction(){return wi},absoluteDifference:xb,computeWeightedLoss:Wo,cosineDistance:bb,hingeLoss:yb,huberLoss:wb,logLoss:Cb,meanSquaredError:kb,sigmoidCrossEntropy:Ab,softmaxCrossEntropy:Sb});function _v(e,t){return void 0===t&&(t=!1),P.tidy(function(){if(2!==e.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],a=e.shape[1],s=Kt(n),c=e.clone(),d=vi([[1]],[1,1]),f=d.clone(),g=a<=n?a:n,m=function(A){var T,M=c,O=f,V=s;f=(T=P.tidy(function(){var H=c.slice([A,A],[n-A,1]),X=H.norm(),$=c.slice([A,A],[1,1]),ee=vi([[-1]]).where($.greater(0),vi([[1]])),re=$.sub(ee.mul(X)),te=H.div(re);f=1===te.shape[0]?d.clone():d.concat(te.slice([1,0],[te.shape[0]-1,te.shape[1]]),0);var le=ee.matMul(re).div(X).neg(),se=c.slice([A,0],[n-A,a]),ie=le.mul(f);if(0===A)c=se.sub(ie.matMul(f.transpose().matMul(se)));else{var ce=se.sub(ie.matMul(f.transpose().matMul(se)));c=c.slice([0,0],[A,a]).concat(ce,0)}var he=s.slice([0,A],[n,s.shape[1]-A]);if(0===A)s=he.sub(he.matMul(f).matMul(ie.transpose()));else{var be=he.sub(he.matMul(f).matMul(ie.transpose()));s=s.slice([0,0],[n,A]).concat(be,1)}return[f,c,s]}))[0],c=T[1],s=T[2],b([M,O,V])},w=0;w<g;++w)m(w);return!t&&a<n&&(s=s.slice([0,0],[n,a]),c=c.slice([0,0],[a,a])),[s,c]})}var Eb=ye({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var a=D(e,"a","bandPart");if(a.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+a.rank+".");var s=a.shape,c=a.shape.slice(-2),d=c[0],f=c[1];if(!(t<=d))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+d+").");if(!(n<=f))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+f+").");t<0&&(t=d),n<0&&(n=f);var g=Ar(0,d,1,"int32").reshape([-1,1]),m=Ar(0,f,1,"int32"),w=Yr(g,m),A=hc(w.lessEqual(nt(+t,"int32")),w.greaterEqual(nt(-n,"int32"))),T=sn([d,f],a.dtype);return li(_r(a.reshape([-1,d,f])).map(function(M){return fs(A,M,T)})).reshape(s)}}),_b=ye({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,ue(null!=e&&0<e.length,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=e[0].shape[0],a=function(g){ue(e[g].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[g].shape[0]+" vs. "+n+")"})},s=1;s<e.length;++s)a(s)}else t=!0,e=ta(e,e.shape[0],0).map(function(g){return To(g,[0])});function c(g){d.push(P.tidy(function(){var m=f[g];if(0<g)for(var w=0;w<g;++w){var A=Bh(d[w].mulStrict(m)).mul(d[w]);m=m.sub(A)}return m.div(Xh(m,"euclidean"))}))}ue(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var d=[],f=e;for(s=0;s<e.length;++s)c(s);return t?li(d,0):d}}),Ib=ye({qr_:function(e,t){if(void 0===t&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(2===e.rank)return _v(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce(function(d,f){return d*f}),a=_r(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),s=[],c=[];return a.forEach(function(d){var f=_v(d,t),m=f[1];s.push(f[0]),c.push(m)}),[li(s,0).reshape(e.shape),li(c,0).reshape(e.shape)]}}),Iv=Object.freeze({bandPart:Eb,gramSchmidt:_b,qr:Ib});function xu(e,t,n,a,s,c){null==a&&(a=.5),null==s&&(s=Number.NEGATIVE_INFINITY),null==c&&(c=0);var d=e.shape[0];return n=Math.min(n,d),ue(0<=a&&a<=1,function(){return"iouThreshold must be in [0, 1], but was '"+a+"'"}),ue(2===e.rank,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),ue(4===e.shape[1],function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),ue(1===t.rank,function(){return"scores must be a 1D tensor"}),ue(t.shape[0]===d,function(){return"scores has incompatible shape with boxes. Expected "+d+", but was "+t.shape[0]}),ue(0<=c&&c<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+c+"'"}),{maxOutputSize:n,iouThreshold:a,scoreThreshold:s,softNmsSigma:c}}function jh(e,t){return!(0<e)||"linear"===t}function Uh(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")}function qh(e,t){var n=t,a=Ir(e.shape,t.shape);return 0<a.length&&(n=n.sum(a)),n.reshape(e.shape)}function $h(e,t,n){if("linear"===t)return e;if("relu"===t)return br(e);if("elu"===t)return zh(e);if("relu6"===t)return Hh(e);if("prelu"===t)return Wh(e,n);throw new Error("Unknown fused activation "+t+".")}var Tb=ye({resizeBilinear_:function(e,t,n){void 0===n&&(n=!1);var a=D(e,"images","resizeBilinear");ue(3===a.rank||4===a.rank,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+a.rank+"."}),ue(2===t.length,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var s=a,c=!1;3===a.rank&&(c=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2]));var d=t[0],f=t[1],g=P.runKernelFunc(function(m,w){return w([s]),m.resizeBilinear(s,d,f,n)},{x:s},function(m,w){return{x:function(){return P.runKernelFunc(function(A){return A.resizeBilinearBackprop(m,w[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:d,newWidth:f});return c?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),Rb=ye({resizeNearestNeighbor_:function(e,t,n){void 0===n&&(n=!1);var a=D(e,"images","resizeNearestNeighbor");ue(3===a.rank||4===a.rank,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+a.rank+"."}),ue(2===t.length,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),ue("float32"===a.dtype||"int32"===a.dtype,function(){return"`images` must have `int32` or `float32` as dtype"});var s=a,c=!1;3===a.rank&&(c=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2]));var d=t[0],f=t[1],g=P.runKernelFunc(function(m,w){return w([s]),m.resizeNearestNeighbor(s,d,f,n)},{batchImages:s},function(m,w){return{batchImages:function(){return P.runKernelFunc(function(A){return A.resizeNearestNeighborBackprop(m,w[0],n)},{})}}});return c?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),Db=ye({nonMaxSuppression_:function(e,t,n,a,s){void 0===a&&(a=.5),void 0===s&&(s=Number.NEGATIVE_INFINITY);var c=D(e,"boxes","nonMaxSuppression"),d=D(t,"scores","nonMaxSuppression"),f=xu(c,d,n,a,s);return P.runKernelFunc(function(m){return m.nonMaxSuppression(c,d,n,a,s)},{boxes:c,scores:d},null,"NonMaxSuppressionV3",{maxOutputSize:n=f.maxOutputSize,iouThreshold:a=f.iouThreshold,scoreThreshold:s=f.scoreThreshold})}}),Pb=ye({nonMaxSuppressionWithScore_:function(e,t,n,a,s,c){void 0===a&&(a=.5),void 0===s&&(s=Number.NEGATIVE_INFINITY),void 0===c&&(c=0);var d=D(e,"boxes","nonMaxSuppression"),f=D(t,"scores","nonMaxSuppression"),g=xu(d,f,n,a,s,c),m={maxOutputSize:n=g.maxOutputSize,iouThreshold:a=g.iouThreshold,scoreThreshold:s=g.scoreThreshold,softNmsSigma:c=g.softNmsSigma},w=P.runKernel("NonMaxSuppressionV5",{boxes:d,scores:f},m);return{selectedIndices:w[0],selectedScores:w[1]}}}),Mb=ye({cropAndResize_:function(e,t,n,a,s,c){var d=D(e,"image","cropAndResize"),f=D(t,"boxes","cropAndResize","float32"),g=D(n,"boxInd","cropAndResize","int32");s=s||"bilinear",c=c||0;var m=f.shape[0];return ue(4===d.rank,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+d.rank+"."}),ue(2===f.rank&&4===f.shape[1],function(){return"Error in cropAndResize: boxes must be have size ["+m+",4] but had shape "+f.shape+"."}),ue(1===g.rank&&g.shape[0]===m,function(){return"Error in cropAndResize: boxInd must be have size ["+m+"] but had shape "+f.shape+"."}),ue(2===a.length,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+a.length+"."}),ue(1<=a[0]&&1<=a[1],function(){return"cropSize must be atleast [1,1], but was "+a}),ue("bilinear"===s||"nearest"===s,function(){return"method must be bilinear or nearest, but was "+s}),P.runKernelFunc(function(w,A){return w.cropAndResize(d,f,g,a,s,c)},{images:d,boxes:f,boxInd:g},null,"CropAndResize",{method:s,extrapolationValue:c,cropSize:a})}}),bu=Object.freeze({resizeBilinear:Tb,resizeNearestNeighbor:Rb,nonMaxSuppression:Db,nonMaxSuppressionAsync:function(e,t,n,a,s){return void 0===a&&(a=.5),void 0===s&&(s=Number.NEGATIVE_INFINITY),F(this,void 0,void 0,function(){var c,d,f,g,A;return de(this,function(T){switch(T.label){case 0:return c=D(e,"boxes","nonMaxSuppressionAsync"),d=D(t,"scores","nonMaxSuppressionAsync"),f=xu(c,d,n,a,s),n=f.maxOutputSize,a=f.iouThreshold,s=f.scoreThreshold,[4,Promise.all([c.data(),d.data()])];case 1:return g=T.sent(),A=Ws(g[0],g[1],n,a,s),c!==e&&c.dispose(),d!==t&&d.dispose(),[2,A]}})})},nonMaxSuppressionWithScore:Pb,nonMaxSuppressionWithScoreAsync:function(e,t,n,a,s,c){return void 0===a&&(a=.5),void 0===s&&(s=Number.NEGATIVE_INFINITY),void 0===c&&(c=0),F(this,void 0,void 0,function(){var d,f,g,m,T;return de(this,function(M){switch(M.label){case 0:return d=D(e,"boxes","nonMaxSuppressionAsync"),f=D(t,"scores","nonMaxSuppressionAsync"),g=xu(d,f,n,a,s,c),n=g.maxOutputSize,a=g.iouThreshold,s=g.scoreThreshold,c=g.softNmsSigma,[4,Promise.all([d.data(),f.data()])];case 1:return m=M.sent(),T=fl(m[0],m[1],n,a,s,c),d!==e&&d.dispose(),f!==t&&f.dispose(),[2,T]}})})},cropAndResize:Mb}),Nb=ye({fusedMatMul_:function(e){var t,n=e.a,a=e.b,s=e.transposeA,c=void 0!==s&&s,d=e.transposeB,f=void 0!==d&&d,g=e.bias,m=e.activation,w=void 0===m?"linear":m,A=e.preluActivationWeights;if(!1===jh(P.state.gradientDepth,w)){var T=pc(n,a,c,f);return null!=g&&(T=xn(T,g)),$h(T,w,A)}var M=D(n,"a","fused matMul"),O=D(a,"b","fused matMul");t=Bn(M,O),M=t[0],O=t[1];var V=c?M.shape[M.rank-2]:M.shape[M.rank-1],H=f?O.shape[O.rank-1]:O.shape[O.rank-2],X=c?M.shape[M.rank-1]:M.shape[M.rank-2],$=f?O.shape[O.rank-2]:O.shape[O.rank-1],ee=M.shape.slice(0,-2),re=O.shape.slice(0,-2),te=mt(ee),le=mt(re);ue(2<=M.rank&&2<=O.rank&&M.rank===O.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+M.rank+" and "+O.rank+"."}),ue(or(ee,re),function(){return"Error in fused matMul: outer dimensions ("+ee+") and ("+re+") of Tensors with shapes "+M.shape+" and "+O.shape+" must match."}),ue(V===H,function(){return"Error in fused matMul: inner shapes ("+V+") and ("+H+") of Tensors with shapes "+M.shape+" and "+O.shape+" and transposeA="+c+" and transposeB="+f+" must match."});var se,ie,ce=M.shape.slice(0,-2).concat([X,$]),he=c?M.as3D(te,V,X):M.as3D(te,X,V),be=f?O.as3D(le,$,H):O.as3D(le,H,$);null!=g&&gn(ce,(se=Bn(se=D(g,"bias","fused matMul"),M)[0]).shape),null!=A&&(ie=D(A,"prelu weights","fused matMul"));var Ae={a:he,b:be};return null!=g&&(Ae.bias=se),null!=A&&(Ae.preluActivationWeights=ie),P.runKernelFunc(function(We,Fe){var Ee=We.fusedBatchMatMul({a:he,b:be,transposeA:c,transposeB:f,bias:se,activation:w,preluActivationWeights:ie});return Fe([he,be,Ee]),Ee},Ae,function(We,Fe){var Ee=Fe[0],He=Fe[1],it=Uh(We,Fe[2],w),ot={};return null!=g&&(ot={bias:function(){return qh(se,it)}}),Object.assign(c||f?!c&&f?{a:function(){return it.matMul(He,!1,!1)},b:function(){return it.matMul(Ee,!0,!1)}}:c&&!f?{a:function(){return He.matMul(it,!1,!0)},b:function(){return Ee.matMul(it,!1,!1)}}:{a:function(){return He.matMul(it,!0,!0)},b:function(){return it.matMul(Ee,!0,!0)}}:{a:function(){return it.matMul(He,!1,!0)},b:function(){return Ee.matMul(it,!0,!1)}},ot)},"_FusedMatMul",{transposeA:c,transposeB:f,activation:w},[he,be],[!0]).reshape(ce)}}),Lb=ye({fusedConv2d_:function(e){var t=e.x,n=e.filter,a=e.strides,s=e.pad,c=e.dataFormat,d=void 0===c?"NHWC":c,f=e.dilations,g=void 0===f?[1,1]:f,m=e.dimRoundingMode,w=e.bias,A=e.activation,T=void 0===A?"linear":A,M=e.preluActivationWeights;if(!1===jh(P.state.gradientDepth,T=T||"linear")){var O=ga(t,n,a,s,d,g,m);return null!=w&&(O=xn(O,w)),$h(O,T,M)}var V=D(t,"x","conv2d"),H=D(n,"filter","conv2d"),X=V,$=!1;3===V.rank&&($=!0,X=V.as4D(1,V.shape[0],V.shape[1],V.shape[2])),ue(4===X.rank,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+X.rank+"."}),ue(4===H.rank,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+H.rank+"."}),null!=m&&ue(Qn(s),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+m+" but got pad "+s+"."}),ue(X.shape[3]===H.shape[2],function(){return"Error in conv2d: depth of input ("+X.shape[3]+") must match input depth for filter "+H.shape[2]+"."}),ue(mi(a,g),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+g+"'"}),ue("NHWC"===d,function(){return"Error in conv2d: got dataFormat of "+d+" but only NHWC is currently supported."});var ee,re,te=Ua(X.shape,H.shape,a,g,s,m);null!=w&&(ee=Bn(ee=D(w,"bias","fused conv2d"),V)[0],gn(te.outShape,ee.shape)),null!=M&&(re=D(M,"prelu weights","fused conv2d"));var le={x:X,filter:H};null!=w&&(le.bias=ee),null!=M&&(le.preluActivationWeights=re);var ie=P.runKernelFunc(function(ce,he){var be=ce.fusedConv2d({input:X,filter:H,convInfo:te,bias:ee,activation:T,preluActivationWeights:re});return he([H,X,be]),be},le,function(ce,he){var Ae=he[0],Te=he[1],Fe=Uh(ce,he[2],T);ue(No(g),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+g+"'"});var Ee={};return null!=w&&(Ee={bias:function(){return qh(ee,Fe)}}),Object.assign({x:function(){return Ng(Te.shape,Fe,Ae,a,s)},filter:function(){return Fh(Te,Fe,Ae.shape,a,s)}},Ee)},"FusedConv2D",{convInfo:te,activation:T},[H,X],[!0]);return $?ie.as3D(ie.shape[1],ie.shape[2],ie.shape[3]):ie}}),Fb=ye({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,a=e.strides,s=e.pad,c=e.dataFormat,d=void 0===c?"NHWC":c,f=e.dilations,g=void 0===f?[1,1]:f,m=e.dimRoundingMode,w=e.bias,A=e.activation,T=void 0===A?"linear":A,M=e.preluActivationWeights;if(!1===jh(P.state.gradientDepth,T)){var O=fc(t,n,a,s,d,g,m);return null!=w&&(O=xn(O,w)),$h(O,T,M)}var V=D(t,"x","depthwiseConv2d"),H=D(n,"filter","depthwiseConv2d"),X=V,$=!1;3===V.rank&&($=!0,X=V.as4D(1,V.shape[0],V.shape[1],V.shape[2])),ue(4===X.rank,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+X.rank+"."}),ue(4===H.rank,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+H.rank+"."}),ue(X.shape[3]===H.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+X.shape[3]+") must match the inChannels dimension in filter "+H.shape[2]+"."}),null==g&&(g=[1,1]),ue(mi(a,g),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+g+"'"}),null!=m&&ue(Qn(s),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+m+" but got pad "+s+"."});var ee,re,te=Ua(X.shape,H.shape,a,g,s,m,!0);null!=w&&(ee=Bn(ee=D(w,"bias","fused conv2d"),V)[0],gn(te.outShape,ee.shape)),null!=M&&(re=D(M,"prelu weights","fused depthwiseConv2d"));var le={x:X,filter:H};null!=w&&(le.bias=ee),null!=M&&(le.preluActivationWeights=re);var ie=P.runKernelFunc(function(ce,he){var be=ce.fusedDepthwiseConv2D({input:X,filter:H,convInfo:te,bias:ee,activation:T,preluActivationWeights:re});return he([H,X,be]),be},le,function(ce,he){ue(No(g),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+g+"'"});var be=he[0],Ae=he[1],We=Uh(ce,he[2],T),Fe={};return null!=w&&(Fe={bias:function(){return qh(ee,We)}}),Object.assign({x:function(){return Lg(Ae.shape,We,be,te)},filter:function(){return Fg(Ae,We,be.shape,te)}},Fe)},"FusedDepthwiseConv2D",{convInfo:te,activation:T},[H,X],[!0]);return $?ie.as3D(ie.shape[1],ie.shape[2],ie.shape[3]):ie}}),Tv=Object.freeze({matMul:Nb,conv2d:Lb,depthwiseConv2d:Fb}),Ob=Object.freeze({image:bu,linalg:Iv,losses:Ev,spectral:xv,fused:Tv,signal:Sv,square:vp,squaredDifference:Ah,conv1d:Pg,conv2d:ga,conv3d:Mg,depthwiseConv2d:fc,separableConv2d:fu,conv2dTranspose:Og,conv3dTranspose:Bg,op:ye,batchNormalization2d:$p,batchNormalization3d:Kp,batchNormalization4d:Zp,batchNormalization:Jp,batchNorm:Ih,batchNorm2d:Qp,batchNorm3d:eg,batchNorm4d:tg,booleanMaskAsync:Tg,complex:an,real:ir,imag:gr,concat:vt,concat1d:ur,concat2d:hr,concat3d:pn,concat4d:Ii,split:ta,matMul:pc,dot:zg,outerProduct:Wg,reverse:yl,reverse1d:Hg,reverse2d:Xg,reverse3d:Gg,reverse4d:Vg,maxPool:Qr,avgPool:wl,pool:Ug,maxPool3d:qg,avgPool3d:$g,slice:Ka,slice1d:Kg,slice2d:Zg,slice3d:Oh,slice4d:Jg,abs:mp,acos:xp,acosh:bp,asin:yp,asinh:wp,atan:Cp,atanh:kp,ceil:Ap,clipByValue:su,cos:Sp,cosh:Ep,erf:_p,exp:lu,expm1:Ip,floor:Tp,log:Rp,log1p:Dp,logSigmoid:Pp,neg:cc,reciprocal:Mp,round:Np,rsqrt:Sh,sigmoid:Eh,sign:Lp,isNaN:Fp,isInf:Op,isFinite:Bp,sin:zp,sinh:Wp,softplus:Hp,sqrt:Xp,step:Gp,tan:Vp,tanh:Yp,all:ev,any:tv,argMax:nv,argMin:rv,logSumExp:iv,max:gc,mean:av,min:ov,moments:sv,sum:Bh,prod:lv,equal:Ph,equalStrict:mg,greater:xg,greaterEqual:Mh,greaterEqualStrict:bg,greaterStrict:yg,less:wg,lessEqual:Cg,lessEqualStrict:kg,lessStrict:Ag,notEqual:Sg,notEqualStrict:Eg,add:xn,addN:ig,addStrict:ag,atan2:og,div:Ra,divNoNan:sg,divStrict:lg,floorDiv:Rh,maximum:hu,maximumStrict:cg,minimum:Dh,minimumStrict:ug,mod:hg,modStrict:dg,mul:yi,mulStrict:fg,pow:dc,powStrict:pg,squaredDifferenceStrict:gg,sub:Yr,subStrict:vg,elu:zh,leakyRelu:cv,prelu:Wh,relu:br,relu6:Hh,selu:uv,logicalAnd:hc,logicalNot:ng,logicalOr:Th,logicalXor:rg,where:fs,whereAsync:_h,buffer:xe,print:ze,batchToSpaceND:Qe,broadcastTo:bt,cast:yt,clone:Pt,cumsum:wt,depthToSpace:An,expandDims:Bt,eye:Kt,multinomial:mn,oneHot:Ht,pad:Vn,pad1d:Sr,pad2d:Er,pad3d:Jr,pad4d:vr,rand:mr,randomNormal:Yn,randomGamma:Ea,randomUniform:si,reshape:Gr,spaceToBatchND:Io,squeeze:To,stack:li,tile:Ro,truncatedNormal:Fc,unstack:_r,setdiff1dAsync:je,fill:Wn,linspace:fr,ones:_i,range:Ar,scalar:nt,tensor:Wt,tensor1d:tn,tensor2d:vi,tensor3d:Wa,tensor4d:er,tensor5d:ro,tensor6d:Kr,variable:Zr,zeros:sn,onesLike:ea,zerosLike:Vt,transpose:zo,softmax:_a,logSoftmax:Vc,localResponseNormalization:hv,norm:Xh,gather:du,unsortedSegmentSum:Nh,basicLSTMCell:dv,multiRNNCell:fv,movingAverage:pv,stridedSlice:gv,topk:vv,scatterND:mv,fft:pu,ifft:vc,rfft:gu,irfft:Gh,sparseToDense:bv,gatherND:yv,diag:wv,dropout:Cv,hannWindow:vu,hammingWindow:Vh,frame:mu,stft:Yh,inTopKAsync:Av});function at(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(n){null!=n&&ue("complex64"!==n.dtype,function(){return t+" does not support complex64 tensors."})})}function Kh(e,t,n,a){if("linear"===n)return e.linear(t);if("relu"===n)return e.relu(t);if("elu"===n)return e.elu(t);if("relu6"===n)return e.relu6(t);if("prelu"===n)return e.prelu(t,a);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var Rv,Bb=(ut(Be,Rv=jl),Be.prototype.write=function(e,t,n){this.firstUse&&(this.firstUse=!1,_e().get("IS_NODE")&&L("\n============================\nHi there \u{1f44b}. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var a={};return this.data.set(a,{values:e,dtype:n}),a},Be.prototype.move=function(e,t,n,a){this.data.set(e,{values:t,dtype:a})},Be.prototype.numDataIds=function(){return this.data.numDataIds()},Be.prototype.read=function(e){return F(this,void 0,void 0,function(){return de(this,function(t){return[2,this.readSync(e)]})})},Be.prototype.readSync=function(e){var t=this.data.get(e),a=t.complexTensors;return"complex64"===t.dtype?dl(this.readSync(a.real.dataId),this.readSync(a.imag.dataId)):this.data.get(e).values},Be.prototype.bufferSync=function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map(function(a){return Pi(a)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return xe(e.shape,e.dtype,n)},Be.prototype.makeOutput=function(e,t,n){var a=this.write(e,t,n);return P.makeTensorFromDataId(a,t,n,this)},Be.prototype.disposeData=function(e){if(this.data.has(e)){var t=this.data.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.data.delete(e)}},Be.prototype.time=function(e){return F(this,void 0,void 0,function(){var t;return de(this,function(n){return t=pi(),e(),[2,{kernelMs:pi()-t}]})})},Be.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},Be.prototype.complex=function(e,t){var n=this.makeOutput(null,e.shape,"complex64");return this.data.get(n.dataId).complexTensors={real:P.keep(e.clone()),imag:P.keep(t.clone())},n},Be.prototype.real=function(e){return this.data.get(e.dataId).complexTensors.real.clone()},Be.prototype.imag=function(e){return this.data.get(e.dataId).complexTensors.imag.clone()},Be.prototype.slice=function(e,t,n){if(at(e,"slice"),ls(e.shape,t,n)){var a=sl(t,e.strides),s=mt(n);return Wt(this.readSync(e.dataId).subarray(a,a+s),n,e.dtype)}for(var c=xe(n,e.dtype),d=this.bufferSync(e),f=0;f<c.size;++f){var g=c.indexToLoc(f).map(function(m,w){return m+t[w]});c.values[f]=d.get.apply(d,g)}return c.toTensor()},Be.prototype.stridedSlice=function(e,t,n,a){at(e,"stridedSlice");var s=al(t,n,a);if(s.some(function(A){return 0===A}))return Wt([],s);for(var c=xe(s,e.dtype),d=this.bufferSync(e),f=0;f<c.size;f++){for(var g=c.indexToLoc(f),m=new Array(g.length),w=0;w<m.length;w++)m[w]=g[w]*a[w]+t[w];c.set.apply(c,[d.get.apply(d,m)].concat(g))}return c.toTensor()},Be.prototype.diag=function(e){for(var t=this.readSync(e.dataId),n=xe([e.size,e.size],e.dtype),a=n.values,s=0;s<t.length;s++)a[s*e.size+s]=t[s];return n.toTensor()},Be.prototype.unstack=function(e,t){for(var n=e.shape[t],a=new Array(e.rank-1),s=0,c=0;c<e.rank;c++)c!==t&&(a[s++]=e.shape[c]);var d=new Array(e.rank).fill(0),f=e.shape.slice();f[t]=1;var g=new Array(n);for(c=0;c<g.length;c++)g[d[t]=c]=this.slice(e,d,f).reshape(a);return g},Be.prototype.reverse=function(e,t){at(e,"reverse");for(var n=xe(e.shape,e.dtype),a=this.bufferSync(e),s=function(d){var f=n.indexToLoc(d),g=f.slice();t.forEach(function(m){return g[m]=e.shape[m]-1-g[m]}),n.set.apply(n,[a.get.apply(a,g)].concat(f))},c=0;c<n.size;c++)s(c);return n.toTensor()},Be.prototype.concat=function(e,t){var n=this;if("complex64"===e[0].dtype){var a=e.map(function(A){return ir(A)}),s=e.map(function(A){return gr(A)});return an(this.concat(a,t),this.concat(s,t))}var c=e.map(function(A){var T=mt(A.shape.slice(t));return A.as2D(-1,T)}),d=zt(c.map(function(A){return A.shape}),1),f=xe(d,e[0].dtype).values;if(1===c[0].shape[0]){var g=0;c.forEach(function(A){f.set(n.readSync(A.dataId),g),g+=A.size})}else{var m=0;c.forEach(function(A){for(var T=n.readSync(A.dataId),M=0,O=0;O<A.shape[0];++O)for(var V=O*d[1]+m,H=0;H<A.shape[1];++H)f[V+H]=T[M++];m+=A.shape[1]})}var w=zt(e.map(function(A){return A.shape}),t);return Wt(f,w,e[0].dtype)},Be.prototype.neg=function(e){return at(e,"neg"),this.multiply(nt(-1),e)},Be.prototype.add=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),function(n,a,s,c){return{real:n+s,imag:a+c}}):this.broadcastedBinaryOp(e,t,Dn(e.dtype,t.dtype),function(n,a){return n+a})},Be.prototype.addN=function(e){var t=this;at(e,"addN");for(var n=e.map(function(g){return t.readSync(g.dataId)}),a=xe(e[0].shape,e[0].dtype),s=a.values,c=0;c<e.length;c++)for(var d=n[c],f=0;f<s.length;f++)s[f]+=d[f];return a.toTensor()},Be.prototype.softmax=function(e,t){var n=Nn([t],e.shape),a=this.max(e,n),s=Oe(a.shape,n),c=this.subtract(e,a.reshape(s)),d=this.exp(c),f=this.sum(d,n).reshape(s);return this.realDivide(d,f)},Be.prototype.subtract=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),function(n,a,s,c){return{real:n-s,imag:a-c}}):this.broadcastedBinaryOp(e,t,Dn(e.dtype,t.dtype),function(n,a){return n-a})},Be.prototype.pow=function(e,t){return at([e,t],"pow"),this.broadcastedBinaryOp(e,t,e.dtype,function(n,a){return Math.pow(n,a)})},Be.prototype.batchMatMul=function(e,t,n,a){at([e,t],"matMul");for(var s=n?e.shape[1]:e.shape[2],c=n?e.shape[2]:e.shape[1],d=a?t.shape[1]:t.shape[2],f=e.shape[0],g=this.readSync(e.dataId),m=this.readSync(t.dataId),w=n?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],A=w[0],T=w[1],M=w[2],O=a?[1,t.strides[1],t.strides[0]]:[t.strides[1],1,t.strides[0]],V=O[0],H=O[1],X=O[2],$=c*d,ee=xe([f,c,d],e.dtype),re=ee.values,te=this.blockSize,le=0;le<f;le++)for(var se=0;se<c;se+=te)for(var ie=0;ie<d;ie+=te)for(var ce=0;ce<s;ce+=te)for(var he=Math.min(se+te,c),be=Math.min(ie+te,d),Ae=Math.min(ce+te,s),Te=se;Te<he;Te++)for(var We=ie;We<be;We++){for(var Fe=0,Ee=ce;Ee<Ae;Ee++)Fe+=g[le*A+Te*T+Ee*M]*m[Ee*V+We*H+le*X];re[le*$+(Te*d+We)]+=Fe}return ee.toTensor()},Be.prototype.fusedBatchMatMul=function(e){var c=e.bias,d=e.activation,f=e.preluActivationWeights,g=this.batchMatMul(e.a,e.b,e.transposeA,e.transposeB);return c&&(g=this.add(g,c)),d&&(g=Kh(this,g,d,f)),g},Be.prototype.multiply=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),function(n,a,s,c){return{real:n*s-a*c,imag:n*c+a*s}}):this.broadcastedBinaryOp(e,t,Dn(e.dtype,t.dtype),function(n,a){return n*a})},Be.prototype.realDivide=function(e,t){return at([e,t],"realDivide"),this.broadcastedBinaryOp(e,t,"float32",function(n,a){return n/a})},Be.prototype.floorDiv=function(e,t){return at([e,t],"floorDiv"),this.broadcastedBinaryOp(e,t,"int32",function(n,a){return Math.floor(n/a)})},Be.prototype.sum=function(e,t){at(e,"sum"),Ye("sum",t,e.rank);for(var n=Ie(e.shape,t),s=n[1],c=sn(n[0],Dn(e.dtype,"int32")),d=mt(s),f=this.readSync(c.dataId),g=this.readSync(e.dataId),m=0;m<f.length;++m){for(var w=m*d,A=0,T=0;T<d;++T)A+=g[w+T];f[m]=A}return c},Be.prototype.prod=function(e,t){at(e,"sum");for(var n=Ie(e.shape,t),s=n[1],c=sn(n[0],Dn(e.dtype,"int32")),d=mt(s),f=this.readSync(c.dataId),g=this.readSync(e.dataId),m=0;m<f.length;++m){for(var w=m*d,A=1,T=0;T<d;++T)A*=g[w+T];f[m]=A}return c},Be.prototype.unsortedSegmentSum=function(e,t,n){at(e,"unsortedSegmentSum");for(var a=[],s=e.rank-t.rank,c=0;c<s;++c)t=t.expandDims(c+1);for(c=0;c<n;++c){var d=nt(c,"int32"),f=Ph(d,t).asType("float32").mul(e).sum(0);a.push(f)}return li(a)},Be.prototype.argMin=function(e,t){at(e,"argMin");var n=[t];Ye("argMin",n,e.rank);for(var a=Ie(e.shape,n),c=a[1],d=sn(a[0],"int32"),f=mt(c),g=this.readSync(d.dataId),m=this.readSync(e.dataId),w=0;w<g.length;++w){for(var A=w*f,T=m[A],M=0,O=0;O<f;++O){var V=m[A+O];V<T&&(T=V,M=O)}g[w]=M}return d},Be.prototype.argMax=function(e,t){at(e,"argMax");var n=[t];Ye("argMax",n,e.rank);for(var a=Ie(e.shape,n),c=a[1],d=sn(a[0],"int32"),f=mt(c),g=this.readSync(d.dataId),m=this.readSync(e.dataId),w=0;w<g.length;++w){for(var A=w*f,T=m[A],M=0,O=0;O<f;++O){var V=m[A+O];T<V&&(T=V,M=O)}g[w]=M}return d},Be.prototype.cumsum=function(e,t,n,a){if(at(e,"cumsum"),t!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+t);for(var s=Dn(e.dtype,"int32"),c=sn(e.shape,s),d=this.readSync(c.dataId),f=this.readSync(e.dataId),g=e.shape[e.rank-1],m=a?function(O,V){return O+g-V-1}:function(O,V){return O+V},w=0;w<f.length;w+=g)for(var A=0;A<g;A++){var T=m(w,A);if(0===A)d[T]=n?0:f[T];else{var M=m(w,A-1);d[T]=n?f[M]+d[M]:f[T]+d[M]}}return c},Be.prototype.equal=function(e,t){return at([e,t],"equal"),this.broadcastedBinaryOp(e,t,"bool",function(n,a){return n===a?1:0})},Be.prototype.notEqual=function(e,t){return at([e,t],"notEqual"),this.broadcastedBinaryOp(e,t,"bool",function(n,a){return n!==a?1:0})},Be.prototype.less=function(e,t){return at([e,t],"less"),this.broadcastedBinaryOp(e,t,"bool",function(n,a){return n<a?1:0})},Be.prototype.lessEqual=function(e,t){return at([e,t],"lessEqual"),this.broadcastedBinaryOp(e,t,"bool",function(n,a){return n<=a?1:0})},Be.prototype.greater=function(e,t){return at([e,t],"greater"),this.broadcastedBinaryOp(e,t,"bool",function(n,a){return a<n?1:0})},Be.prototype.greaterEqual=function(e,t){return at([e,t],"greaterEqual"),this.broadcastedBinaryOp(e,t,"bool",function(n,a){return a<=n?1:0})},Be.prototype.logicalNot=function(e){at(e,"logicalNot");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),a=0;a<t.length;++a)n[a]=t[a]?0:1;return this.makeOutput(n,e.shape,"bool")},Be.prototype.logicalAnd=function(e,t){return at([e,t],"logicalAnd"),this.broadcastedBinaryOp(e,t,"bool",function(n,a){return n&&a})},Be.prototype.logicalOr=function(e,t){return at([e,t],"logicalOr"),this.broadcastedBinaryOp(e,t,"bool",function(n,a){return n||a})},Be.prototype.select=function(e,t,n){at([e,t,n],"select");for(var a=this.readSync(e.dataId),s=this.readSync(t.dataId),c=this.readSync(n.dataId),d=sn(t.shape,Dn(t.dtype,n.dtype)),f=this.readSync(d.dataId),g=0,m=0===e.rank||1<e.rank||1===t.rank?1:mt(t.shape.slice(1)),w=0;w<a.length;w++)for(var A=0;A<m;A++)f[g++]=1===a[w]?s[w]:c[w];return d},Be.prototype.where=function(e){at([e],"where");var t=this.readSync(e.dataId);return Hs(e.shape,t)},Be.prototype.topk=function(e,t,n){return at(e,"topk"),Zl(this.readSync(e.dataId),e.shape,e.dtype,t)},Be.prototype.min=function(e,t){at(e,"min"),Ye("min",t,e.rank);for(var n=Ie(e.shape,t),s=n[1],c=sn(n[0],e.dtype),d=mt(s),f=this.readSync(c.dataId),g=this.readSync(e.dataId),m=0;m<f.length;++m){for(var w=m*d,A=g[w],T=0;T<d;++T){var M=g[w+T];M<A&&(A=M)}f[m]=A}return c},Be.prototype.minimum=function(e,t){return at([e,t],"minimum"),this.broadcastedBinaryOp(e,t,e.dtype,function(n,a){return Math.min(n,a)})},Be.prototype.mod=function(e,t){return at([e,t],"mod"),this.broadcastedBinaryOp(e,t,e.dtype,function(n,a){var s=n%a;return n<0&&a<0||0<=n&&0<=a?s:(s+a)%a})},Be.prototype.max=function(e,t){at(e,"max"),Ye("max",t,e.rank);for(var n=Ie(e.shape,t),s=n[1],c=sn(n[0],e.dtype),d=mt(s),f=this.readSync(c.dataId),g=this.readSync(e.dataId),m=0;m<f.length;++m){for(var w=m*d,A=g[w],T=0;T<d;++T){var M=g[w+T];A<M&&(A=M)}f[m]=A}return c},Be.prototype.maximum=function(e,t){return at([e,t],"maximum"),this.broadcastedBinaryOp(e,t,e.dtype,function(n,a){return Math.max(n,a)})},Be.prototype.all=function(e,t){at(e,"all"),Ye("all",t,e.rank);for(var n=Ie(e.shape,t),s=n[1],c=sn(n[0],e.dtype),d=mt(s),f=this.readSync(c.dataId),g=this.readSync(e.dataId),m=0;m<f.length;++m){for(var w=m*d,A=g[w],T=0;T<d;++T)A=A&&g[w+T];f[m]=A}return c},Be.prototype.any=function(e,t){at(e,"any"),Ye("any",t,e.rank);for(var n=Ie(e.shape,t),s=n[1],c=sn(n[0],e.dtype),d=mt(s),f=this.readSync(c.dataId),g=this.readSync(e.dataId),m=0;m<f.length;++m){for(var w=m*d,A=g[w],T=0;T<d;++T)A=A||g[w+T];f[m]=A}return c},Be.prototype.squaredDifference=function(e,t){return at([e,t],"squaredDifference"),this.broadcastedBinaryOp(e,t,e.dtype,function(n,a){var s=n-a;return s*s})},Be.prototype.ceil=function(e){at(e,"ceil");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),a=0;a<t.length;++a)n[a]=Math.ceil(t[a]);return this.makeOutput(n,e.shape,"float32")},Be.prototype.floor=function(e){at(e,"floor");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),a=0;a<t.length;++a)n[a]=Math.floor(t[a]);return this.makeOutput(n,e.shape,"float32")},Be.prototype.sign=function(e){at(e,"x");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),a=0;a<t.length;++a)n[a]=t[a]<0?-1:0<t[a]?1:0;return this.makeOutput(n,e.shape,"float32")},Be.prototype.isNaN=function(e){at(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),a=0;a<t.length;++a)Number.isNaN(t[a])&&(n[a]=1);return this.makeOutput(n,e.shape,"bool")},Be.prototype.isInf=function(e){at(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),a=0;a<t.length;++a)Math.abs(t[a])===1/0&&(n[a]=1);return this.makeOutput(n,e.shape,"bool")},Be.prototype.isFinite=function(e){at(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),a=0;a<t.length;++a)Number.isFinite(t[a])&&(n[a]=1);return this.makeOutput(n,e.shape,"bool")},Be.prototype.round=function(e){at(e,"round");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),a=0;a<t.length;++a){var s=Math.floor(t[a]);n[a]=t[a]-s<.5?Math.floor(t[a]):.5<t[a]-s?Math.ceil(t[a]):s%2==0?s:s+1}return this.makeOutput(n,e.shape,"float32")},Be.prototype.exp=function(e){at(e,"exp");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),a=0;a<t.length;++a)n[a]=Math.exp(t[a]);return this.makeOutput(n,e.shape,"float32")},Be.prototype.expm1=function(e){at(e,"expm1");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),a=0;a<t.length;++a)n[a]=Math.expm1(t[a]);return this.makeOutput(n,e.shape,"float32")},Be.prototype.log=function(e){at(e,"log");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),a=0;a<t.length;++a)n[a]=Math.log(t[a]);return this.makeOutput(n,e.shape,"float32")},Be.prototype.log1p=function(e){at(e,"log1p");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),a=0;a<t.length;++a)n[a]=Math.log1p(t[a]);return this.makeOutput(n,e.shape,"float32")},Be.prototype.sqrt=function(e){at(e,"sqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),a=0;a<t.length;++a)n[a]=Math.sqrt(t[a]);return this.makeOutput(n,e.shape,"float32")},Be.prototype.rsqrt=function(e){at(e,"rsqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),a=0;a<t.length;++a)n[a]=1/Math.sqrt(t[a]);return this.makeOutput(n,e.shape,"float32")},Be.prototype.reciprocal=function(e){at(e,"reciprocal");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),a=0;a<t.length;++a)n[a]=1/t[a];return this.makeOutput(n,e.shape,"float32")},Be.prototype.linear=function(e){return e},Be.prototype.relu=function(e){at(e,"relu");for(var t=sn(e.shape,e.dtype),n=this.readSync(t.dataId),a=this.readSync(e.dataId),s=0;s<a.length;++s)n[s]=Math.max(0,a[s]);return t},Be.prototype.relu6=function(e){at(e,"relu");for(var t=sn(e.shape,e.dtype),n=this.readSync(t.dataId),a=this.readSync(e.dataId),s=0;s<a.length;++s)n[s]=Math.min(Math.max(0,a[s]),6);return t},Be.prototype.prelu=function(e,t){return at([e,t],"prelu"),this.broadcastedBinaryOp(e,t,e.dtype,function(n,a){return n<0?a*n:n})},Be.prototype.elu=function(e){at(e,"elu");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),a=0;a<n.length;++a){var s=n[a];t[a]=0<=s?s:Math.exp(s)-1}return this.makeOutput(t,e.shape,"float32")},Be.prototype.eluDer=function(e,t){at([e,t],"eluDer");for(var n=new Float32Array(t.size),a=this.readSync(t.dataId),s=this.readSync(e.dataId),c=0;c<a.length;++c){var d=a[c];n[c]=1<=d?s[c]:s[c]*(d+1)}return this.makeOutput(n,t.shape,"float32")},Be.prototype.selu=function(e){at(e,"selu");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),a=0;a<n.length;++a){var s=n[a];t[a]=0<=s?1.0507009873554805*s:1.7580993408473768*(Math.exp(s)-1)}return this.makeOutput(t,e.shape,"float32")},Be.prototype.clip=function(e,t,n){at(e,"clip");for(var a=new Float32Array(e.size),s=this.readSync(e.dataId),c=0;c<s.length;++c){var d=s[c];a[c]=n<d?n:d<t?t:d}return this.makeOutput(a,e.shape,"float32")},Be.prototype.abs=function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),a=0;a<n.length;++a)t[a]=Math.abs(n[a]);return this.makeOutput(t,e.shape,"float32")},Be.prototype.complexAbs=function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),a=0;a<e.size;++a)t[a]=Math.hypot(n[2*a],n[2*a+1]);return this.makeOutput(t,e.shape,"float32")},Be.prototype.int=function(e){at(e,"int");for(var t=new Int32Array(e.size),n=this.readSync(e.dataId),a=0;a<n.length;++a)t[a]=n[a];return this.makeOutput(t,e.shape,"int32")},Be.prototype.sigmoid=function(e){at(e,"sigmoid");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),a=0;a<n.length;++a)t[a]=1/(1+Math.exp(-n[a]));return this.makeOutput(t,e.shape,"float32")},Be.prototype.softplus=function(e){at(e,"softplus");for(var t=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(e.size),a=this.readSync(e.dataId),s=0;s<a.length;++s){var c,d=a[s]>-t,f=a[s]<t,g=Math.exp(a[s]);c=f?g:d?a[s]:Math.log(1+g),n[s]=c}return this.makeOutput(n,e.shape,"float32")},Be.prototype.sin=function(e){at(e,"sin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),a=0;a<n.length;++a)t[a]=Math.sin(n[a]);return this.makeOutput(t,e.shape,"float32")},Be.prototype.cos=function(e){at(e,"cos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),a=0;a<n.length;++a)t[a]=Math.cos(n[a]);return this.makeOutput(t,e.shape,"float32")},Be.prototype.tan=function(e){at(e,"tan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),a=0;a<n.length;++a)t[a]=Math.tan(n[a]);return this.makeOutput(t,e.shape,"float32")},Be.prototype.asin=function(e){at(e,"asin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),a=0;a<n.length;++a)t[a]=Math.asin(n[a]);return this.makeOutput(t,e.shape,"float32")},Be.prototype.acos=function(e){at(e,"acos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),a=0;a<n.length;++a)t[a]=Math.acos(n[a]);return this.makeOutput(t,e.shape,"float32")},Be.prototype.atan=function(e){at(e,"atan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),a=0;a<n.length;++a)t[a]=Math.atan(n[a]);return this.makeOutput(t,e.shape,"float32")},Be.prototype.atan2=function(e,t){return at([e,t],"atan2"),this.broadcastedBinaryOp(e,t,e.dtype,function(n,a){return Math.atan2(n,a)})},Be.prototype.sinh=function(e){at(e,"sinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),a=0;a<n.length;++a)t[a]=Math.sinh(n[a]);return this.makeOutput(t,e.shape,"float32")},Be.prototype.cosh=function(e){at(e,"cosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),a=0;a<n.length;++a)t[a]=Math.cosh(n[a]);return this.makeOutput(t,e.shape,"float32")},Be.prototype.tanh=function(e){at(e,"tanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),a=0;a<n.length;++a)t[a]=Cn(n[a]);return this.makeOutput(t,e.shape,"float32")},Be.prototype.asinh=function(e){at(e,"asinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),a=0;a<n.length;++a)t[a]=Math.asinh(n[a]);return this.makeOutput(t,e.shape,"float32")},Be.prototype.acosh=function(e){at(e,"acosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),a=0;a<n.length;++a)t[a]=Math.acosh(n[a]);return this.makeOutput(t,e.shape,"float32")},Be.prototype.atanh=function(e){at(e,"atanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),a=0;a<n.length;++a)t[a]=Math.atanh(n[a]);return this.makeOutput(t,e.shape,"float32")},Be.prototype.erf=function(e){at(e,"erf");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),a=0;a<n.length;++a){var s=Math.sign(n[a]),c=Math.abs(n[a]),d=1/(1+.3275911*c);t[a]=s*(1-((((1.061405429*d-1.453152027)*d+1.421413741)*d-.284496736)*d+.254829592)*d*Math.exp(-c*c))}return this.makeOutput(t,e.shape,"float32")},Be.prototype.step=function(e,t){void 0===t&&(t=0),at(e,"step");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),s=0;s<a.length;++s){var c=a[s];n[s]=isNaN(c)?NaN:0<c?1:t}return this.makeOutput(n,e.shape,"float32")},Be.prototype.fusedConv2d=function(e){var s=e.bias,c=e.activation,d=e.preluActivationWeights,f=this.conv2d(e.input,e.filter,e.convInfo);return s&&(f=this.add(f,s)),c&&(f=Kh(this,f,c,d)),f},Be.prototype.conv2d=function(e,t,n){at([e,t],"conv2d");for(var a=n.filterHeight,s=n.filterWidth,c=n.dilationHeight,d=n.dilationWidth,f=n.padInfo.left,g=n.padInfo.top,m="channelsLast"===n.dataFormat,w=xe(n.outShape,e.dtype),A=e.strides[0],T=m?e.strides[1]:e.strides[2],M=m?e.strides[2]:1,O=m?1:e.strides[1],V=w.strides[0],H=m?w.strides[1]:w.strides[2],X=m?w.strides[2]:1,$=m?1:w.strides[1],ee=this.readSync(e.dataId),re=this.readSync(t.dataId),te=w.values,le=0;le<n.batchSize;++le)for(var se=le*A,ie=le*V,ce=0;ce<n.outHeight;++ce)for(var he=ie+ce*H,be=ce*n.strideHeight-g,Ae=0;Ae<a;Ae++){var Te=be+Ae*c;if(!(Te<0||Te>=n.inHeight))for(var We=Ae*t.strides[0],Fe=se+Te*T,Ee=0;Ee<n.outWidth;++Ee)for(var He=he+Ee*X,tt=Ee*n.strideWidth-f,it=0;it<s;it++){var ot=tt+it*d;if(!(ot<0||ot>=n.inWidth))for(var pt=Fe+ot*M,Rt=We+it*t.strides[1],Dt=0;Dt<n.inChannels;++Dt){for(var qt=ee[pt+Dt*O],In=0;In<n.outChannels;++In)te[He+In*$]+=qt*re[Rt+In];Rt+=n.outChannels}}}return w.toTensor()},Be.prototype.conv3d=function(e,t,n){for(var a=n.filterDepth,s=n.filterHeight,c=n.filterWidth,d=n.dilationDepth,f=n.dilationHeight,g=n.dilationWidth,m=n.padInfo.front,w=n.padInfo.left,A=n.padInfo.top,T=xe(n.outShape,e.dtype),M=this.readSync(e.dataId),O=this.readSync(t.dataId),V=T.values,H=0;H<n.batchSize;++H)for(var X=H*e.strides[0],$=H*T.strides[0],ee=0;ee<n.outDepth;++ee)for(var re=$+ee*T.strides[1],te=ee*n.strideDepth-m,le=0;le<a;le++){var se=te+le*d;if(!(se<0||se>=n.inDepth))for(var ie=le*t.strides[0],ce=X+se*e.strides[1],he=0;he<n.outHeight;++he)for(var be=re+he*T.strides[2],Ae=he*n.strideHeight-A,Te=0;Te<s;Te++){var We=Ae+Te*f;if(!(We<0||We>=n.inHeight))for(var Fe=ie+Te*t.strides[1],Ee=ce+We*e.strides[2],He=0;He<n.outWidth;++He)for(var tt=be+He*n.outChannels,it=He*n.strideWidth-w,ot=0;ot<c;ot++){var pt=it+ot*g;if(!(pt<0||pt>=n.inWidth))for(var Dt=Ee+pt*n.inChannels,qt=Fe+ot*t.strides[2],In=0;In<n.inChannels;++In){for(var Tn=M[Dt+In],Rn=0;Rn<n.outChannels;++Rn)V[tt+Rn]+=Tn*O[qt+Rn];qt+=n.outChannels}}}}return T.toTensor()},Be.prototype.conv2dDerInput=function(e,t,n){at([e,t],"conv2dDerInput");for(var a=xe(n.inShape,"float32"),s=a.values,c=this.readSync(e.dataId),d=this.readSync(t.dataId),f=t.strides,g=f[0],m=f[1],w=f[2],A=n.batchSize,T=n.filterHeight,M=n.filterWidth,O=n.inChannels,V=n.inHeight,H=n.inWidth,X=n.outChannels,$=n.outHeight,ee=n.outWidth,re=n.strideHeight,te=n.strideWidth,se=T-1-n.padInfo.top,ie=M-1-n.padInfo.left,ce="channelsLast"===n.dataFormat,he=a.strides[0],be=ce?a.strides[1]:a.strides[2],Ae=ce?a.strides[2]:1,Te=ce?1:a.strides[1],We=e.strides[0],Fe=ce?e.strides[1]:e.strides[2],Ee=ce?e.strides[2]:1,He=ce?1:e.strides[1],tt=0;tt<A;++tt)for(var it=0;it<O;++it)for(var ot=0;ot<V;++ot)for(var pt=ot-se,Rt=Math.max(0,Math.ceil(pt/re)),Dt=Math.min($,(T+pt)/re),qt=0;qt<H;++qt){for(var In=qt-ie,Tn=Math.max(0,Math.ceil(In/te)),Rn=Math.min(ee,(M+In)/te),zr=0,Xn=Rt;Xn<Dt;++Xn)for(var lr=Xn*re-pt,Jn=Tn;Jn<Rn;++Jn)for(var jr=We*tt+Fe*Xn+Ee*Jn,dr=g*(T-1-lr)+m*(M-1-(Jn*te-In))+w*it,pr=0;pr<X;++pr)zr+=c[jr+He*pr]*d[dr+pr];s[he*tt+be*ot+Ae*qt+Te*it]=zr}return a.toTensor()},Be.prototype.conv3dDerInput=function(e,t,n){for(var a=xe(n.inShape,"float32"),s=a.values,c=a.strides,d=c[0],f=c[1],g=c[2],m=c[3],w=this.readSync(e.dataId),A=e.strides,T=A[0],M=A[1],O=A[2],V=A[3],H=this.readSync(t.dataId),X=t.strides,$=X[0],ee=X[1],re=X[2],te=X[3],le=n.batchSize,se=n.filterDepth,ie=n.filterHeight,ce=n.filterWidth,he=n.inChannels,be=n.inDepth,Ae=n.inHeight,Te=n.inWidth,We=n.outChannels,Fe=n.outDepth,Ee=n.outHeight,He=n.outWidth,tt=n.strideDepth,it=n.strideHeight,ot=n.strideWidth,pt=se-1-n.padInfo.front,Rt=ie-1-n.padInfo.top,Dt=ce-1-n.padInfo.left,qt=0;qt<le;++qt)for(var In=0;In<he;++In)for(var Tn=0;Tn<be;++Tn)for(var Rn=Tn-pt,zr=Math.max(0,Math.ceil(Rn/tt)),Xn=Math.min(Fe,(se+Rn)/tt),lr=0;lr<Ae;++lr)for(var Jn=lr-Rt,jr=Math.max(0,Math.ceil(Jn/it)),dr=Math.min(Ee,(ie+Jn)/it),pr=0;pr<Te;++pr){for(var wo=pr-Dt,Co=Math.max(0,Math.ceil(wo/ot)),ya=Math.min(He,(ce+wo)/ot),nl=0,Ds=zr;Ds<Xn;++Ds)for(var Qo=Ds*tt-Rn,Ps=jr;Ps<dr;++Ps)for(var hh=Ps*it-Jn,es=Co;es<ya;++es)for(var Gl=T*qt+M*Ds+O*Ps+V*es,Wx=$*(se-1-Qo)+ee*(ie-1-hh)+re*(ce-1-(es*ot-wo))+te*In,ts=0;ts<We;++ts)nl+=w[Gl+ts]*H[Wx+ts];s[d*qt+f*Tn+g*lr+m*pr+In]=nl}return a.toTensor()},Be.prototype.conv2dDerFilter=function(e,t,n){at([e,t],"conv2dDerFilter");for(var a=n.strideHeight,s=n.strideWidth,c=n.filterHeight,d=n.filterWidth,f="channelsLast"===n.dataFormat,g=xe(n.filterShape,"float32"),m=n.padInfo.left,w=n.padInfo.top,A=this.bufferSync(e),T=this.bufferSync(t),M=0;M<c;++M)for(var O=Math.max(0,Math.ceil((w-M)/a)),V=Math.min(n.outHeight,(n.inHeight+w-M)/a),H=0;H<d;++H)for(var X=Math.max(0,Math.ceil((m-H)/s)),$=Math.min(n.outWidth,(n.inWidth+m-H)/s),ee=0;ee<n.inChannels;++ee)for(var re=0;re<n.outChannels;++re){for(var te=0,le=0;le<n.batchSize;++le)for(var se=O;se<V;++se)for(var ie=M+se*a-w,ce=X;ce<$;++ce){var he=H+ce*s-m;te+=f?A.get(le,ie,he,ee)*T.get(le,se,ce,re):A.get(le,ee,ie,he)*T.get(le,re,se,ce)}g.set(te,M,H,ee,re)}return g.toTensor()},Be.prototype.conv3dDerFilter=function(e,t,n){for(var a=n.strideDepth,s=n.strideHeight,c=n.strideWidth,d=n.filterDepth,f=n.filterHeight,g=n.filterWidth,m=xe(n.filterShape,"float32"),w=m.values,A=m.strides,T=A[0],M=A[1],O=A[2],V=A[3],H=this.readSync(t.dataId),X=t.strides,$=X[0],ee=X[1],re=X[2],te=X[3],le=this.readSync(e.dataId),se=e.strides,ie=se[0],ce=se[1],he=se[2],be=se[3],Ae=n.padInfo.front,Te=n.padInfo.left,We=n.padInfo.top,Fe=0;Fe<d;++Fe)for(var Ee=Math.max(0,Math.ceil((Ae-Fe)/a)),He=Math.min(n.outDepth,(n.inDepth+Ae-Fe)/a),tt=Fe*T,it=0;it<f;++it)for(var ot=Math.max(0,Math.ceil((We-it)/s)),pt=Math.min(n.outHeight,(n.inHeight+We-it)/s),Rt=it*M+tt,Dt=0;Dt<g;++Dt)for(var qt=Math.max(0,Math.ceil((Te-Dt)/c)),In=Math.min(n.outWidth,(n.inWidth+Te-Dt)/c),Tn=Dt*O+Rt,Rn=0;Rn<n.inChannels;++Rn)for(var zr=Rn*V+Tn,Xn=0;Xn<n.outChannels;++Xn){for(var lr=0,Jn=0;Jn<n.batchSize;++Jn)for(var jr=Jn*ie,dr=Jn*$,pr=Ee;pr<He;++pr)for(var wo=(Fe+pr*a-Ae)*ce+jr,Co=pr*ee+dr,ya=ot;ya<pt;++ya)for(var nl=(it+ya*s-We)*he+wo,Ds=ya*re+Co,Qo=qt;Qo<In;++Qo)lr+=le[(Dt+Qo*c-Te)*be+nl+Rn]*H[Qo*te+Ds+Xn];w[zr+Xn]=lr}return m.toTensor()},Be.prototype.fusedDepthwiseConv2D=function(e){var s=e.bias,c=e.activation,d=e.preluActivationWeights,f=this.depthwiseConv2D(e.input,e.filter,e.convInfo);return s&&(f=this.add(f,s)),c&&(f=Kh(this,f,c,d)),f},Be.prototype.depthwiseConv2D=function(e,t,n){at([e,t],"depthwiseConv2D");for(var a=n.filterHeight,s=n.filterWidth,c=n.dilationHeight,d=n.dilationWidth,f=n.padInfo.left,g=n.padInfo.top,m=n.outChannels/n.inChannels,w=xe(n.outShape,e.dtype),A=this.readSync(e.dataId),T=this.readSync(t.dataId),M=w.values,O=0;O<n.batchSize;++O)for(var V=O*e.strides[0],H=O*w.strides[0],X=0;X<n.outHeight;++X)for(var $=H+X*w.strides[1],ee=X*n.strideHeight-f,re=0;re<a;++re){var te=ee+re*c;if(!(te<0||te>=n.inHeight))for(var le=re*t.strides[0],se=V+te*e.strides[1],ie=0;ie<n.outWidth;++ie)for(var ce=$+ie*w.strides[2],he=ie*n.strideWidth-g,be=0;be<s;++be){var Ae=he+be*d;if(!(Ae<0||Ae>=n.inWidth))for(var We=se+Ae*n.inChannels,Fe=ce,Ee=le+be*t.strides[1],He=0;He<n.inChannels;++He){for(var tt=A[We+He],it=0;it<m;++it)M[Fe+it]+=tt*T[Ee+it];Fe+=m,Ee+=m}}}return w.toTensor()},Be.prototype.depthwiseConv2DDerInput=function(e,t,n){at([e,t],"depthwiseConv2DDerInput");for(var a=xe(n.inShape,"float32"),s=a.values,c=a.strides,d=c[0],f=c[1],g=c[2],m=this.readSync(e.dataId),w=e.strides,A=w[0],T=w[1],M=w[2],O=this.readSync(t.dataId),V=t.strides,H=V[0],X=V[1],$=V[2],ee=n.batchSize,re=n.filterHeight,te=n.filterWidth,le=n.inChannels,se=n.inHeight,ie=n.inWidth,he=n.outHeight,be=n.outWidth,Ae=n.strideHeight,Te=n.strideWidth,We=re-1-n.padInfo.top,Fe=te-1-n.padInfo.left,Ee=n.outChannels/le,He=0;He<ee;++He)for(var tt=0;tt<le;++tt)for(var it=0;it<se;++it)for(var ot=it-We,pt=Math.max(0,Math.ceil(ot/Ae)),Rt=Math.min(he,(re+ot)/Ae),Dt=0;Dt<ie;++Dt){for(var qt=Dt-Fe,In=Math.max(0,Math.ceil(qt/Te)),Tn=Math.min(be,(te+qt)/Te),Rn=0,zr=pt;zr<Rt;++zr)for(var Xn=zr*Ae-ot,lr=In;lr<Tn;++lr)for(var Jn=A*He+T*zr+M*lr,jr=H*(re-1-Xn)+X*(te-1-(lr*Te-qt))+$*tt,dr=0;dr<Ee;++dr)Rn+=m[Jn+(tt*Ee+dr)]*O[jr+dr];s[d*He+f*it+g*Dt+tt]=Rn}return a.toTensor()},Be.prototype.depthwiseConv2DDerFilter=function(e,t,n){at([e,t],"depthwiseConv2DDerFilter");for(var a=n.strideHeight,s=n.strideWidth,c=n.filterHeight,d=n.filterWidth,f=xe(n.filterShape,"float32"),g=n.padInfo.left,m=n.padInfo.top,w=n.outChannels/n.inChannels,A=this.bufferSync(e),T=this.bufferSync(t),M=0;M<c;++M)for(var O=Math.max(0,Math.ceil((m-M)/a)),V=Math.min(n.outHeight,(n.inHeight+m-M)/a),H=0;H<d;++H)for(var X=Math.max(0,Math.ceil((g-H)/s)),$=Math.min(n.outWidth,(n.inWidth+g-H)/s),ee=0;ee<n.outChannels;++ee){for(var re=Math.trunc(ee/w),te=ee%w,le=0,se=0;se<n.batchSize;++se)for(var ie=O;ie<V;++ie)for(var ce=M+ie*a-m,he=X;he<$;++he)le+=A.get(se,ce,H+he*s-g,re)*T.get(se,ie,he,ee);f.set(le,M,H,re,te)}return f.toTensor()},Be.prototype.tile=function(e,t){return at(e,"tile"),gl(this.bufferSync(e),t)},Be.prototype.pad=function(e,t,n){at(e,"pad");var a=t.map(function(w,A){return w[0]+e.shape[A]+w[1]}),s=t.map(function(w){return w[0]}),c=this.bufferSync(e),d=xe(a,e.dtype);0!==n&&d.values.fill(n);for(var f=0;f<e.size;f++){var g=c.indexToLoc(f),m=g.map(function(w,A){return w+s[A]});d.set.apply(d,[c.get.apply(c,g)].concat(m))}return d.toTensor()},Be.prototype.transpose=function(e,t){at(e,"transpose");for(var n=new Array(e.rank),a=0;a<n.length;a++)n[a]=e.shape[t[a]];var s=this.readSync(e.dataId),c=xe(n,e.dtype),d=this.bufferSync(e);for(a=0;a<e.size;++a){for(var f=d.indexToLoc(a),g=new Array(f.length),m=0;m<g.length;m++)g[m]=f[t[m]];var w=c.locToIndex(g);c.values[w]=s[a]}return c.toTensor()},Be.prototype.gather=function(e,t,n){at([e,t],"gather");var a=e.shape.slice(),s=this.readSync(t.dataId);a[n]=s.length;for(var c=xe(a,e.dtype),d=this.bufferSync(e),f=0;f<c.size;++f){var g=c.indexToLoc(f),m=g.slice();m[n]=s[g[n]];var w=d.locToIndex(m);c.values[f]=d.values[w]}return c.toTensor()},Be.prototype.batchToSpaceND=function(e,t,n){at([e],"batchToSpaceND");var a=t.reduce(function(m,w){return m*w}),s=Ls(e.shape,t,a),c=rl(s.length,t.length),d=il(e.shape,t,a),f=Oc(n,t.length),g=Bc(d,n,t.length);return e.reshape(s).transpose(c).reshape(d).slice(f,g)},Be.prototype.spaceToBatchND=function(e,t,n){at([e],"spaceToBatchND");var a=t.reduce(function(w,A){return w*A}),s=[[0,0]];s.push.apply(s,n);for(var c=1+t.length;c<e.shape.length;++c)s.push([0,0]);var d=e.pad(s),f=Ls(d.shape,t,a,!1),g=rl(f.length,t.length,!1),m=il(d.shape,t,a,!1);return d.reshape(f).transpose(g).reshape(m)},Be.prototype.pool=function(e,t,n){at(e,"pool");for(var a=t.strideHeight,s=t.strideWidth,c=t.dilationHeight,d=t.dilationWidth,f=t.effectiveFilterHeight,g=t.effectiveFilterWidth,m=t.padInfo.top,w=t.padInfo.left,A="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,T=this.readSync(e.dataId),M=xe(t.outShape,e.dtype),O=M.values,V=t.outShape[1]*t.outShape[2]*t.outShape[3],H=t.outShape[2]*t.outShape[3],X=t.outShape[3],$=0;$<t.batchSize;++$)for(var ee=$*V,re=$*e.strides[0],te=0;te<t.inChannels;++te)for(var le=0;le<t.outHeight;++le)for(var se=le*a-m,ie=Math.max(0,se),ce=Math.min(t.inHeight,f+se),he=ee+le*H,be=0;be<t.outWidth;++be){for(var Ae=be*s-w,Te=Math.max(0,Ae),We=Math.min(t.inWidth,g+Ae),Fe=A,Ee=0,He=0,tt=ie;tt<ce;tt+=c){for(var it=re+tt*e.strides[1],ot=Te;ot<We;ot+=d){var pt=T[it+ot*e.strides[2]+te];"max"===n&&Fe<pt?Fe=pt:"avg"===n&&(Ee+=pt,He++)}if(isNaN(Fe))break}O[he+be*X+te]="avg"===n?Ee/He:Fe}return M.toTensor()},Be.prototype.maxPool=function(e,t){return this.pool(e,t,"max")},Be.prototype.maxPoolPositions=function(e,t){for(var n=xe(t.outShape,"int32"),a=t.strideHeight,s=t.strideWidth,c=t.dilationHeight,d=t.dilationWidth,f=t.effectiveFilterHeight,g=t.effectiveFilterWidth,m=t.padInfo.top,w=t.padInfo.left,A=this.bufferSync(e),T=0;T<t.batchSize;++T)for(var M=0;M<t.inChannels;++M)for(var O=0;O<t.outHeight;++O){for(var V=O*a-m,H=V;H<0;)H+=c;for(var X=Math.min(t.inHeight,f+V),$=0;$<t.outWidth;++$){for(var ee=$*s-w,re=ee;re<0;)re+=d;for(var te=Math.min(t.inWidth,g+ee),le=Number.NEGATIVE_INFINITY,se=-1,ie=H;ie<X;ie+=c)for(var ce=ie-V,he=re;he<te;he+=d){var be=he-ee,Ae=A.get(T,ie,he,M);le<Ae&&(le=Ae,se=ce*g+be)}n.set(se,T,O,$,M)}}return n.toTensor()},Be.prototype.maxPoolBackprop=function(e,t,n,a){at([t,n],"maxPoolBackprop");for(var s=this.maxPoolPositions(t,a),c=a.strideHeight,d=a.strideWidth,f=a.dilationHeight,g=a.dilationWidth,m=a.effectiveFilterHeight,w=a.effectiveFilterWidth,A=w-1-a.padInfo.left,T=m-1-a.padInfo.top,M=xe(t.shape,"float32"),O=this.bufferSync(s),V=this.bufferSync(e),H=0;H<a.batchSize;++H)for(var X=0;X<a.inChannels;++X)for(var $=0;$<a.inHeight;++$)for(var ee=0;ee<a.inWidth;++ee){for(var re=$-T,te=ee-A,le=0,se=0;se<m;se+=f){var ie=(re+se)/c;if(!(ie<0||ie>=a.outHeight||Math.floor(ie)!==ie))for(var ce=0;ce<w;ce+=g){var he=(te+ce)/d;if(!(he<0||he>=a.outWidth||Math.floor(he)!==he)){var be=m*w-1-O.get(H,ie,he,X)===se*w+ce?1:0;0!=be&&(le+=V.get(H,ie,he,X)*be)}}}M.set(le,H,$,ee,X)}return M.toTensor()},Be.prototype.avgPoolBackprop=function(e,t,n){at([e,t],"avgPoolBackprop");for(var a=n.strideHeight,s=n.strideWidth,c=n.filterHeight,d=n.filterWidth,f=n.dilationHeight,g=n.dilationWidth,m=n.effectiveFilterHeight,w=n.effectiveFilterWidth,A=w-1-n.padInfo.left,T=m-1-n.padInfo.top,M=xe(t.shape,"float32"),O=1/(c*d),V=this.bufferSync(e),H=0;H<n.batchSize;++H)for(var X=0;X<n.inChannels;++X)for(var $=0;$<n.inHeight;++$)for(var ee=0;ee<n.inWidth;++ee){for(var re=$-T,te=ee-A,le=0,se=0;se<m;se+=f){var ie=(re+se)/a;if(!(ie<0||ie>=n.outHeight||Math.floor(ie)!==ie))for(var ce=0;ce<w;ce+=g){var he=(te+ce)/s;he<0||he>=n.outWidth||Math.floor(he)!==he||(le+=V.get(H,ie,he,X))}}M.set(le*O,H,$,ee,X)}return M.toTensor()},Be.prototype.pool3d=function(e,t,n){at(e,"pool3d");for(var a=t.strideDepth,s=t.strideHeight,c=t.strideWidth,d=t.dilationDepth,f=t.dilationHeight,g=t.dilationWidth,m=t.effectiveFilterDepth,w=t.effectiveFilterHeight,A=t.effectiveFilterWidth,T=t.padInfo.front,M=t.padInfo.top,O=t.padInfo.left,V="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,H=this.readSync(e.dataId),X=xe(t.outShape,e.dtype),$=X.values,ee=t.outShape[1]*t.outShape[2]*t.outShape[3]*t.outShape[4],re=t.outShape[2]*t.outShape[3]*t.outShape[4],te=t.outShape[3]*t.outShape[4],le=t.outShape[4],se=0;se<t.batchSize;++se)for(var ie=se*ee,ce=se*e.strides[0],he=0;he<t.inChannels;++he)for(var be=0;be<t.outDepth;++be){for(var Ae=be*a-T,Te=Ae;Te<0;)Te+=d;for(var We=Math.min(t.inDepth,m+Ae),Fe=ie+be*re,Ee=0;Ee<t.outHeight;++Ee){for(var He=Ee*s-M,tt=He;tt<0;)tt+=f;for(var it=Math.min(t.inHeight,w+He),ot=Fe+Ee*te,pt=0;pt<t.outWidth;++pt){for(var Rt=pt*c-O,Dt=Rt;Dt<0;)Dt+=g;for(var qt=Math.min(t.inWidth,A+Rt),In=ot+pt*le,Tn=V,Rn=0,zr=0,Xn=Te;Xn<We;Xn+=d){for(var lr=ce+Xn*e.strides[1],Jn=tt;Jn<it;Jn+=f){for(var jr=lr+Jn*e.strides[2],dr=Dt;dr<qt;dr+=g){var pr=H[jr+dr*e.strides[3]+he];if("max"===n&&Tn<pr?Tn=pr:"avg"===n&&(Rn+=pr,zr++),isNaN(Tn))break}if(isNaN(Tn))break}if(isNaN(Tn))break}$[In+he]="avg"===n?Rn/zr:Tn}}}return X.toTensor()},Be.prototype.avgPool3d=function(e,t){return at(e,"avgPool3d"),this.pool3d(e,t,"avg").toFloat()},Be.prototype.avgPool3dBackprop=function(e,t,n){at([e,t],"avgPool3dBackprop");for(var a=n.strideDepth,s=n.strideHeight,c=n.strideWidth,d=n.filterDepth,f=n.filterHeight,g=n.filterWidth,m=n.dilationDepth,w=n.dilationHeight,A=n.dilationWidth,T=n.effectiveFilterDepth,M=n.effectiveFilterHeight,O=n.effectiveFilterWidth,V=T-1-n.padInfo.front,H=O-1-n.padInfo.left,X=M-1-n.padInfo.top,$=xe(t.shape,"float32"),ee=1/(d*f*g),re=this.bufferSync(e),te=0;te<n.batchSize;++te)for(var le=0;le<n.inChannels;++le)for(var se=0;se<n.inDepth;++se)for(var ie=0;ie<n.inHeight;++ie)for(var ce=0;ce<n.inWidth;++ce){for(var he=se-V,be=ie-X,Ae=ce-H,Te=0,We=0;We<T;We+=m){var Fe=(he+We)/a;if(!(Fe<0||Fe>=n.outDepth||Math.floor(Fe)!==Fe))for(var Ee=0;Ee<M;Ee+=w){var He=(be+Ee)/s;if(!(He<0||He>=n.outHeight||Math.floor(He)!==He))for(var tt=0;tt<O;tt+=A){var it=(Ae+tt)/c;it<0||it>=n.outWidth||Math.floor(it)!==it||(Te+=re.get(te,Fe,He,it,le))}}}$.set(Te*ee,te,se,ie,ce,le)}return $.toTensor()},Be.prototype.maxPool3d=function(e,t){return at(e,"maxPool3d"),this.pool3d(e,t,"max").toFloat()},Be.prototype.maxPool3dPositions=function(e,t){for(var n=xe(t.outShape,"int32"),a=t.strideDepth,s=t.strideHeight,c=t.strideWidth,d=t.dilationDepth,f=t.dilationHeight,g=t.dilationWidth,m=t.effectiveFilterDepth,w=t.effectiveFilterHeight,A=t.effectiveFilterWidth,T=t.padInfo.front,M=t.padInfo.top,O=t.padInfo.left,V=this.bufferSync(e),H=0;H<t.batchSize;++H)for(var X=0;X<t.inChannels;++X)for(var $=0;$<t.outDepth;++$){for(var ee=$*a-T,re=ee;re<0;)re+=d;for(var te=Math.min(t.inDepth,m+ee),le=0;le<t.outHeight;++le){for(var se=le*s-M,ie=se;ie<0;)ie+=f;for(var ce=Math.min(t.inHeight,w+se),he=0;he<t.outWidth;++he){for(var be=he*c-O,Ae=be;Ae<0;)Ae+=g;for(var Te=Math.min(t.inWidth,A+be),We=Number.NEGATIVE_INFINITY,Fe=-1,Ee=re;Ee<te;Ee+=d)for(var He=Ee-ee,tt=ie;tt<ce;tt+=f)for(var it=tt-se,ot=Ae;ot<Te;ot+=g){var pt=ot-be,Rt=V.get(H,Ee,tt,ot,X);We<=Rt&&(We=Rt,Fe=He*w*A+it*w+pt)}n.set(Fe,H,$,le,he,X)}}}return n.toTensor()},Be.prototype.maxPool3dBackprop=function(e,t,n,a){at([t,n],"maxPool3dBackprop");for(var s=this.maxPool3dPositions(t,a),c=a.strideDepth,d=a.strideHeight,f=a.strideWidth,g=a.dilationDepth,m=a.dilationHeight,w=a.dilationWidth,A=a.effectiveFilterDepth,T=a.effectiveFilterHeight,M=a.effectiveFilterWidth,O=A-1-a.padInfo.front,V=M-1-a.padInfo.left,H=T-1-a.padInfo.top,X=xe(t.shape,"float32"),$=this.bufferSync(s),ee=this.bufferSync(e),re=0;re<a.batchSize;++re)for(var te=0;te<a.inChannels;++te)for(var le=0;le<a.inDepth;++le)for(var se=0;se<a.inHeight;++se)for(var ie=0;ie<a.inWidth;++ie){for(var ce=le-O,he=se-H,be=ie-V,Ae=0,Te=0;Te<A;Te+=g){var We=(ce+Te)/c;if(!(We<0||We>=a.outDepth||Math.floor(We)!==We))for(var Fe=0;Fe<T;Fe+=m){var Ee=(he+Fe)/d;if(!(Ee<0||Ee>=a.outHeight||Math.floor(Ee)!==Ee))for(var He=0;He<M;He+=w){var tt=(be+He)/f;if(!(tt<0||tt>=a.outWidth||Math.floor(tt)!==tt)){var it=A*T*M-1-$.get(re,We,Ee,tt,te)===Te*T*M+Fe*M+He?1:0;0!=it&&(Ae+=ee.get(re,We,Ee,tt,te)*it)}}}}X.set(Ae,re,le,se,ie,te)}return X.toTensor()},Be.prototype.cast=function(e,t){return ql(e,t,this)},Be.prototype.reshape=function(e,t){return hl(e,t)},Be.prototype.avgPool=function(e,t){return at(e,"avgPool"),this.pool(e,t,"avg").toFloat()},Be.prototype.resizeBilinear=function(e,t,n,a){at(e,"resizeBilinear");for(var s=e.shape,c=s[0],d=s[1],f=s[2],g=s[3],m=this.readSync(e.dataId),w=new Float32Array(mt([c,t,n,g])),A=[a&&1<t?d-1:d,a&&1<n?f-1:f],T=[a&&1<t?t-1:t,a&&1<n?n-1:n],M=0,O=A[0]/T[0],V=A[1]/T[1],H=0;H<c;H++)for(var X=0;X<t;X++)for(var $=O*X,ee=Math.floor($),re=$-ee,te=Math.min(d-1,Math.ceil($)),le=H*e.strides[0]+ee*e.strides[1],se=H*e.strides[0]+te*e.strides[1],ie=0;ie<n;ie++)for(var ce=V*ie,he=Math.floor(ce),be=ce-he,Ae=Math.min(f-1,Math.ceil(ce)),Te=le+he*e.strides[2],We=se+he*e.strides[2],Fe=le+Ae*e.strides[2],Ee=se+Ae*e.strides[2],He=0;He<g;He++){var tt=m[Te+He],it=m[We+He],ot=tt+(m[Fe+He]-tt)*be;w[M++]=ot+(it+(m[Ee+He]-it)*be-ot)*re}return Wt(w,[c,t,n,g])},Be.prototype.resizeBilinearBackprop=function(e,t,n){at([e,t],"resizeBilinearBackprop");for(var a=t.shape,s=a[0],c=a[1],d=a[2],f=a[3],g=e.shape,m=g[1],w=g[2],A=new Float32Array(s*c*d*f),T=[n&&1<m?c-1:c,n&&1<w?d-1:d],M=[n&&1<m?m-1:m,n&&1<w?w-1:w],O=T[0]/M[0],V=T[1]/M[1],H=this.readSync(e.dataId),X=0,$=0;$<s;$++)for(var ee=$*t.strides[0],re=0;re<m;re++)for(var te=re*O,le=Math.floor(te),se=Math.min(Math.ceil(te),c-1),ie=ee+le*t.strides[1],ce=ee+se*t.strides[1],he=te-le,be=1-he,Ae=0;Ae<w;Ae++)for(var Te=Ae*V,We=Math.floor(Te),Fe=Math.min(Math.ceil(Te),d-1),Ee=Te-We,He=1-Ee,tt=ie+We*t.strides[2],it=ie+Fe*t.strides[2],ot=ce+We*t.strides[2],pt=ce+Fe*t.strides[2],Rt=be*He,Dt=be*Ee,qt=he*He,In=he*Ee,Tn=0;Tn<f;Tn++){var Rn=H[X++];A[tt+Tn]+=Rn*Rt,A[it+Tn]+=Rn*Dt,A[ot+Tn]+=Rn*qt,A[pt+Tn]+=Rn*In}return er(A,[s,d,c,f],t.dtype)},Be.prototype.resizeNearestNeighbor=function(e,t,n,a){at(e,"resizeNearestNeighbor");for(var s=e.shape,c=s[0],d=s[1],f=s[2],g=s[3],m=this.readSync(e.dataId),w=new Float32Array(c*t*n*g),A=[a&&1<t?d-1:d,a&&1<n?f-1:f],T=[a&&1<t?t-1:t,a&&1<n?n-1:n],M=A[0]/T[0],O=A[1]/T[1],V=0,H=0;H<c;H++)for(var X=H*e.strides[0],$=0;$<t;$++)for(var ee=M*$,re=X+Math.min(d-1,a?Math.round(ee):Math.floor(ee))*e.strides[1],te=0;te<n;te++)for(var le=O*te,se=re+Math.min(f-1,a?Math.round(le):Math.floor(le))*e.strides[2],ie=0;ie<g;ie++)w[V++]=m[se+ie];return Wt(w,[c,t,n,g],e.dtype)},Be.prototype.resizeNearestNeighborBackprop=function(e,t,n){at([e,t],"resizeNearestNeighborBackprop");for(var a=t.shape,s=a[0],c=a[1],d=a[2],f=a[3],g=e.shape,m=g[1],w=g[2],A=new Float32Array(s*c*d*f),T=this.readSync(e.dataId),M=[n&&1<m?c-1:c,n&&1<w?d-1:d],O=[n&&1<m?m-1:m,n&&1<w?w-1:w],V=M[0]/O[0],H=M[1]/O[1],X=1/V,$=1/H,ee=2*Math.ceil(X)+2,re=2*Math.ceil($)+2,te=0;te<s;te++)for(var le=te*t.strides[0],se=0;se<c;se++)for(var ie=le+se*t.strides[1],ce=Math.floor(se*X),he=Math.floor(ce-ee/2),be=0;be<d;be++)for(var Ae=ie+be*t.strides[2],Te=Math.floor(be*$),We=Math.floor(Te-re/2),Fe=0;Fe<f;Fe++){for(var Ee=0,He=0;He<ee;He++){var tt=He+he;if(!(tt<0||m<=tt)){var it=le+tt*e.strides[1],ot=tt*V;if(se===Math.min(c-1,n?Math.round(ot):Math.floor(ot)))for(var pt=0;pt<re;pt++){var Rt=pt+We;if(!(Rt<0||w<=Rt)){var Dt=it+Rt*e.strides[2],qt=Rt*H;be===Math.min(d-1,n?Math.round(qt):Math.floor(qt))&&(Ee+=T[Dt+Fe])}}}}A[Ae+Fe]=Ee}return er(A,t.shape,t.dtype)},Be.prototype.batchNormalization=function(e,t,n,a,s,c){at([e,t,n,s,c],"batchNorm");for(var d=this.readSync(e.dataId),f=this.readSync(t.dataId),g=this.readSync(n.dataId),m=s?this.readSync(s.dataId):new Float32Array([1]),w=c?this.readSync(c.dataId):new Float32Array([0]),A=new Float32Array(d.length),T=w.length,M=m.length,O=g.length,V=f.length,H=0,X=0,$=0,ee=0,re=0;re<d.length;++re)A[re]=w[H++]+(d[re]-f[X++])*m[$++]/Math.sqrt(g[ee++]+a),T<=H&&(H=0),V<=X&&(X=0),M<=$&&($=0),O<=ee&&(ee=0);return er(A,e.shape)},Be.prototype.localResponseNormalization4D=function(e,t,n,a,s){at(e,"localResponseNormalization4D");var c=e.shape[3],d=c-1,f=this.readSync(e.dataId),g=e.size,m=new Float32Array(g);function w(O){for(var V=O%c,H=O-V+Math.max(0,V-t),X=O-V+Math.min(V+t,d),$=0;H<=X;H++){var ee=f[H];$+=ee*ee}return $}for(var A=0;A<g;A++){var T=w(A),M=f[A]*Math.pow(n+a*T,-s);m[A]=M}return er(m,e.shape)},Be.prototype.LRNGrad=function(e,t,n,a,s,c,d){at(e,"LRNGrad");for(var f=e.shape[3],g=this.readSync(e.dataId),m=this.readSync(t.dataId),w=this.readSync(n.dataId),A=new Float32Array(e.size),T=e.size,M=0;M<T;M++){for(var O=M%f,V=M-O+Math.max(0,O-a),H=M-O+Math.min(f,O+a+1),X=0,$=V;$<H;$++)X+=Math.pow(m[$],2);for(X=c*X+s,$=V;$<H;$++){var ee=-2*c*d*m[$]*w[M]/X;M===$&&(ee+=Math.pow(X,-d)),A[$]+=ee*=g[M]}}return er(A,e.shape)},Be.prototype.multinomial=function(e,t,n,a){at(e,"multinomial");for(var s=t?e:_a(e),c=s.shape[0],d=s.shape[1],f=sn([c,n],"int32"),g=this.readSync(f.dataId),m=this.readSync(s.dataId),w=0;w<c;++w){var A=w*d,T=new Float32Array(d-1);T[0]=m[A];for(var M=1;M<T.length;++M)T[M]=T[M-1]+m[A+M];for(var O=io(a.toString()),V=w*n,H=0;H<n;++H){var X=O();g[V+H]=T.length;for(var $=0;$<T.length;$++)if(X<T[$]){g[V+H]=$;break}}}return f},Be.prototype.oneHot=function(e,t,n,a){at(e,"oneHot");var s=new Float32Array(e.size*t);s.fill(a);for(var c=this.readSync(e.dataId),d=0;d<e.size;++d)0<=c[d]&&c[d]<t&&(s[d*t+c[d]]=n);return vi(s,[e.size,t],"int32")},Be.prototype.nonMaxSuppression=function(e,t,n,a,s){return at(e,"nonMaxSuppression"),Ws(this.readSync(e.dataId),this.readSync(t.dataId),n,a,s)},Be.prototype.fft=function(e){return this.fftBatch(e,!1)},Be.prototype.ifft=function(e){return this.fftBatch(e,!0)},Be.prototype.fftBatch=function(e,t){for(var n=e.shape[0],a=e.shape[1],s=xe(e.shape,"float32"),c=xe(e.shape,"float32"),d=ir(e).as2D(n,a),f=gr(e).as2D(n,a),g=0;g<n;g++)for(var m=d.slice([g,0],[1,a]),w=f.slice([g,0],[1,a]),A=an(m,w),T=this.readSync(this.fftImpl(A,t).dataId),M=0;M<a;M++){var O=Yc(T,M);s.values[g*a+M]=O.real,c.values[g*a+M]=O.imag}return an(s.toTensor(),c.toTensor()).as2D(n,a)},Be.prototype.fftImpl=function(e,t){var n=e.as1D(),a=n.size;if(this.isExponentOf2(a)){var s=this.fftRadix2(n,a,t).as2D(e.shape[0],e.shape[1]);return t&&(s=an(ir(s).div(nt(a)),gr(s).div(nt(a)))),s}var c=this.readSync(e.dataId),d=function(f){for(var g=new Float32Array(f.length/2),m=new Float32Array(f.length/2),w=0;w<f.length;w+=2)g[w/2]=f[w],m[w/2]=f[w+1];return{real:g,imag:m}}(this.fourierTransformByMatmul(c,a,t));return an(d.real,d.imag).as2D(e.shape[0],e.shape[1])},Be.prototype.isExponentOf2=function(e){return!(e&e-1)},Be.prototype.fftRadix2=function(e,t,n){if(1===t)return e;var a=this.readSync(e.dataId),s=t/2,c=function(V){for(var H=Math.ceil(V.length/4),X=new Float32Array(H),$=new Float32Array(H),ee=0;ee<V.length;ee+=4)X[Math.floor(ee/4)]=V[ee],$[Math.floor(ee/4)]=V[ee+1];return{real:X,imag:$}}(a),d=an(c.real,c.imag).as1D(),f=function(V){for(var H=Math.floor(V.length/4),X=new Float32Array(H),$=new Float32Array(H),ee=2;ee<V.length;ee+=4)X[Math.floor(ee/4)]=V[ee],$[Math.floor(ee/4)]=V[ee+1];return{real:X,imag:$}}(a),g=an(f.real,f.imag).as1D();d=this.fftRadix2(d,s,n),g=this.fftRadix2(g,s,n);var m=function(V,H){for(var X=new Float32Array(V/2),$=new Float32Array(V/2),ee=0;ee<Math.ceil(V/2);ee++){var re=(H?2:-2)*Math.PI*(ee/V);X[ee]=Math.cos(re),$[ee]=Math.sin(re)}return{real:X,imag:$}}(t,n),w=an(m.real,m.imag).mul(g),A=d.add(w),T=d.sub(w),M=ir(A).concat(ir(T)),O=gr(A).concat(gr(T));return an(M,O).as1D()},Be.prototype.fourierTransformByMatmul=function(e,t,n){for(var a=new Float32Array(2*t),s=0;s<t;s++){for(var c=0,d=0,f=0;f<t;f++){var g=(H=(n?2:-2)*Math.PI*(s*f/t),{real:Math.cos(H),imag:Math.sin(H)}),m=Yc(e,f);c+=m.real*g.real-m.imag*g.imag,d+=m.real*g.imag+m.imag*g.real}n&&(c/=t,d/=t),T=d,(w=a)[2*(M=s)]=c,w[2*M+1]=T}var w,T,M,H;return a},Be.prototype.depthToSpace=function(e,t,n){ue("NHWC"===n,function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n}),ue(1<t,function(){return"blockSize should be > 1 for depthToSpace, but was: "+t});for(var a=e.shape[0],s=e.shape[1],c=e.shape[2],d=e.shape[3],f=s*t,g=c*t,m=d/(t*t),w=this.readSync(e.dataId),A=new Float32Array(a*f*g*m),T=0,M=0;M<a;++M)for(var O=0;O<f;++O)for(var V=Math.floor(O/t),H=O%t,X=0;X<g;++X)for(var $=Math.floor(X/t),ee=(H*t+X%t)*m,re=0;re<m;++re)A[T++]=w[re+ee+d*($+c*(V+s*M))];return er(A,[a,f,g,m])},Be.prototype.broadcastedBinaryOp=function(e,t,n,a){var s=gn(e.shape,t.shape),c=xe(s,n),d=this.readSync(e.dataId),f=this.readSync(t.dataId),g=ja(e.shape,s),m=ja(t.shape,s),w=c.values;if(g.length+m.length===0)for(var A=0;A<w.length;++A)w[A]=a(d[A%d.length],f[A%f.length]);else{var T=this.bufferSync(e),M=this.bufferSync(t),O=function(V){var H=c.indexToLoc(V),X=H.slice(-e.rank);g.forEach(function(te){return X[te]=0});var $=T.locToIndex(X),ee=H.slice(-t.rank);m.forEach(function(te){return ee[te]=0});var re=M.locToIndex(ee);w[V]=a(d[$],f[re])};for(A=0;A<w.length;++A)O(A)}return c.toTensor()},Be.prototype.broadcastedBinaryComplexOp=function(e,t,n){var a=gn(e.shape,t.shape),s=xe(a,"float32"),c=xe(a,"float32"),d=this.readSync(e.dataId),f=this.readSync(t.dataId),g=ja(e.shape,a),m=ja(t.shape,a),w=s.values,A=c.values;if(g.length+m.length===0)for(var T=0;T<w.length;T++){var M=T%d.length,O=T%f.length,V=n(d[2*M],d[2*M+1],f[2*O],f[2*O+1]);w[T]=V.real,A[T]=V.imag}else{var H=this.bufferSync(this.data.get(e.dataId).complexTensors.real),X=this.bufferSync(this.data.get(t.dataId).complexTensors.real),$=function(ee){var re=s.indexToLoc(ee),te=re.slice(-e.rank);g.forEach(function(he){return te[he]=0});var le=H.locToIndex(te),se=re.slice(-t.rank);m.forEach(function(he){return se[he]=0});var ie=X.locToIndex(se),ce=n(d[2*le],d[2*le+1],f[2*ie],f[2*ie+1]);w[ee]=ce.real,A[ee]=ce.imag};for(T=0;T<w.length;T++)$(T)}return this.complex(s.toTensor(),c.toTensor())},Be.prototype.split=function(e,t,n){return Kl(e,t,n)},Be.prototype.dispose=function(){},Be.prototype.floatPrecision=function(){return 32},Be.prototype.epsilon=function(){return 1e-7},Be.prototype.cropAndResize=function(e,t,n,a,s,c){for(var d=e.shape,f=d[0],g=d[1],m=d[2],w=d[3],A=t.shape[0],T=a[0],M=a[1],O=xe([A,T,M,w],"float32"),V=this.readSync(t.dataId),H=this.readSync(n.dataId),X=this.readSync(e.dataId),$=e.strides,ee=O.strides,re=0;re<A;re++){var te=4*re,le=V[te],se=V[1+te],ie=V[2+te],ce=V[3+te],he=H[re];if(!(f<=he))for(var be=1<T?(ie-le)*(g-1)/(T-1):0,Ae=1<M?(ce-se)*(m-1)/(M-1):0,Te=0;Te<T;Te++){var We=1<T?le*(g-1)+Te*be:.5*(le+ie)*(g-1);if(We<0||g-1<We)for(var Fe=0;Fe<M;Fe++)for(var Ee=0;Ee<w;Ee++){var He=Ee+Fe*ee[2]+Te*ee[1]+re*ee[0];O.values[He]=c}else if("bilinear"===s){var tt=Math.floor(We),it=Math.ceil(We),ot=We-tt;for(Fe=0;Fe<M;Fe++)if((Xn=1<M?se*(m-1)+Fe*Ae:.5*(se+ce)*(m-1))<0||m-1<Xn)for(Ee=0;Ee<w;Ee++)O.values[He=Ee+Fe*ee[2]+Te*ee[1]+re*ee[0]]=c;else{var pt=Math.floor(Xn),Rt=Math.ceil(Xn),Dt=Xn-pt;for(Ee=0;Ee<w;Ee++){var qt=X[He=Ee+pt*$[2]+tt*$[1]+he*$[0]],In=X[He=Ee+Rt*$[2]+tt*$[1]+he*$[0]],Tn=X[He=Ee+pt*$[2]+it*$[1]+he*$[0]],Rn=qt+(In-qt)*Dt,zr=Tn+(X[He=Ee+Rt*$[2]+it*$[1]+he*$[0]]-Tn)*Dt;O.values[He=Ee+Fe*ee[2]+Te*ee[1]+re*ee[0]]=Rn+(zr-Rn)*ot}}}else for(Fe=0;Fe<M;++Fe){var Xn;if((Xn=1<M?se*(m-1)+Fe*Ae:.5*(se+ce)*(m-1))<0||m-1<Xn)for(Ee=0;Ee<w;Ee++)O.values[He=Ee+Fe*ee[2]+Te*ee[1]+re*ee[0]]=c;else{var lr=Math.round(Xn),Jn=Math.round(We);for(Ee=0;Ee<w;Ee++)O.values[Ee+Fe*ee[2]+Te*ee[1]+re*ee[0]]=X[Ee+lr*$[2]+Jn*$[1]+he*$[0]]}}}}return O.toTensor()},Be.prototype.sparseToDense=function(e,t,n,a){var s=Os(0,e,n);return this.scatter(e,t,n,s.outputSize,s.sliceSize,s.numUpdates,s.sliceRank,s.strides,a,!1)},Be.prototype.gatherND=function(e,t){var n=t.shape,a=n[n.length-1],s=Vl(e,t),c=s[0],d=s[1],f=s[2],g=s[3];if(0===d)return Wt([],c,e.dtype);for(var m=new Li([d,f],e.dtype),w=this.readSync(t.dataId),A=this.readSync(e.dataId),T=0;T<d;T++){for(var M=[],O=0,V=0;V<a;V++){var H=w[T*a+V];O+=H*g[V],M.push(H)}if(O<0||O>=e.size/f)throw new Error("Invalid indices: "+M+" does not index into "+e.shape);for(var X=0;X<f;X++)m.values[T*f+X]=A[O*f+X]}return m.toTensor().reshape(c)},Be.prototype.scatterND=function(e,t,n){var a=Os(0,e,n),s=a.sliceRank,c=a.numUpdates,d=a.sliceSize,f=a.strides,g=a.outputSize,m=nt(0);return this.scatter(e,t,n,g,d,c,s,f,m,!0)},Be.prototype.fill=function(e,t,n){var a=la(n=n||Si(t),mt(e));return a.fill(t),P.makeTensor(a,e,n,this)},Be.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)},Be.prototype.zerosLike=function(e){var t=la(e.dtype,mt(e.shape));return this.makeOutput(t,e.shape,e.dtype)},Be.prototype.linspace=function(e,t,n){return $l(e,t,n)},Be.prototype.scatter=function(e,t,n,a,s,c,d,f,g,m){var w=[a/s,s],A=this.readSync(e.dataId),T=this.readSync(t.dataId);if(0===a)return Wt([],n,t.dtype);var M=new Li(w,t.dtype);M.values.fill(this.readSync(g.dataId)[0]);for(var O=0;O<c;O++){for(var V=[],H=0,X=0;X<d;X++){var $=A[O*d+X];V.push($),H+=$*f[X]}if(H<0||a/s<=H)throw new Error("Invalid indices: "+V+" does not index into "+n);for(var ee=0;ee<s;ee++)m?M.values[H*s+ee]+=T[O*s+ee]:M.values[H*s+ee]=0===t.rank?T[0]:T[O*s+ee]}return M.toTensor().reshape(n)},Be);function Be(){var e=Rv.call(this)||this;return e.blockSize=48,e.firstUse=!0,e.data=new Va(e,P),e}P.registerBackend("cpu",function(){return new Bb},1);for(var Zh=0,Dv=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,a=e.attrs,c=t.boxes,d=t.scores,g=a.maxOutputSize,m=a.iouThreshold,w=a.scoreThreshold,A=a.softNmsSigma,T=e.backend;at(c,"NonMaxSuppressionWithScore");var M=fl(T.data.get(c.dataId).values,T.data.get(d.dataId).values,g,m,w,A);return[M.selectedIndices,M.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var a=e.inputs.x,s=e.backend;at(a,"square");for(var c=s.data.get(a.dataId).values,d=new Float32Array(c.length),f=0;f<c.length;++f){var g=c[f];d[f]=g*g}return{dataId:s.write(d,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},{kernelName:lc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,s=t.a,c=t.b,d=e.backend;at([s,c],lc);var f=d.data.get(s.dataId).values,g=d.data.get(c.dataId).values,m=function(T,M,O,V,H,X){var $=gn(T,M),ee=$.length,re=yr($),te=Ai(H,mt($)),le=T.length,se=M.length,ie=yr(T),ce=yr(M),he=ja(T,$),be=ja(M,$);if(he.length+be.length===0)for(var Ae=0;Ae<te.length;++Ae)te[Ae]=X(O[Ae%O.length],V[Ae%V.length]);else{var Te=function(We){var Fe=nr(We,ee,re),Ee=Fe.slice(-le);he.forEach(function(ot){return Ee[ot]=0});var He=Tt(Ee,le,ie),tt=Fe.slice(-se);be.forEach(function(ot){return tt[ot]=0});var it=Tt(tt,se,ce);te[We]=X(O[He],V[it])};for(Ae=0;Ae<te.length;++Ae)Te(Ae)}return[te,$]}(s.shape,c.shape,f,g,s.dtype,function(T,M){var O=T-M;return O*O}),A=m[1];return{dataId:d.write(m[0],A,s.dtype),shape:A,dtype:s.dtype}}}];Zh<Dv.length;Zh++)Et(Dv[Zh]);for(var Cl,zb=function(e){this.variableNames=["A"];var t=ci(),n=e[0],a=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+a+".0, "+n+".0);\n\n        vec4 values = "+t.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},Wb=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=ci(),n=e[0],a=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2("+a+".0, "+n+".0);\n            vec4 values = "+t.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+t.output+" = result;\n      }\n    "},Jh=0,Pv=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var n=e.backend,s=e.inputs.pixels,d=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,f=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,g=d?[s.videoWidth,s.videoHeight]:[s.width,s.height],m=g[0],w=g[1],A=[w,m],T=[w,m,e.attrs.numChannels];(f||d)&&(null==Cl&&(Cl=document.createElement("canvas").getContext("2d")),Cl.canvas.width=m,Cl.canvas.height=w,Cl.drawImage(s,0,0,m,w),s=Cl.canvas);var M=n.makeTensorInfo(A,"int32");n.texData.get(M.dataId).usage=l.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(M.dataId),s);var O=_e().getBool("WEBGL_PACK")?new Wb(T):new zb(T),V=n.runWebGLProgram(O,[M],"int32");return n.disposeData(M.dataId),V}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,a=e.attrs;L("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var d=t.scores,g=a.maxOutputSize,m=a.iouThreshold,w=a.scoreThreshold,A=a.softNmsSigma,T=n,M=fl(T.readSync(t.boxes.dataId),T.readSync(d.dataId),g,m,w,A);return[M.selectedIndices,M.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var a=e.inputs.x,s=e.backend,c=new hn(a.shape,"return x * x;");return s.runWebGLProgram(c,[a],a.dtype)}},{kernelName:lc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,s=t.a,c=t.b,d=e.backend,f=_e().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Re("return (a - b) * (a - b);",s.shape,c.shape):new Se("return (a - b) * (a - b);",s.shape,c.shape);return d.compileAndRun(f,[s,c])}}];Jh<Pv.length;Jh++)Et(Pv[Jh]);for(var Qh=0,Mv=[{kernelName:"Square",gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:lc,gradFunc:function(e,t){var n=t[0],a=t[1],s=nt(2);return{a:function(){return yi(e,yi(s,Yr(n,a)))},b:function(){return yi(e,yi(s,Yr(a,n)))}}}}];Qh<Mv.length;Qh++)bn(Mv[Qh]);var Hb=(mc.prototype.fetch=function(e,t){return fetch(e,t)},mc.prototype.now=function(){return performance.now()},mc.prototype.encode=function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got "+t);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)},mc.prototype.decode=function(e,t){return new TextDecoder(t).decode(e)},mc);function mc(){}_e().get("IS_BROWSER")&&_e().setPlatform("browser",new Hb);var ed,Xb=(xc.prototype.fetch=function(e,t){return null!=_e().global.fetch?_e().global.fetch(e,t):(null==ed&&(ed=require("node-fetch")),ed(e,t))},xc.prototype.now=function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6},xc.prototype.encode=function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got "+t);return this.textEncoder.encode(e)},xc.prototype.decode=function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)},xc);function xc(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}_e().get("IS_NODE")&&_e().setPlatform("node",new Xb);var td={float32:4,int32:4,uint16:2,uint8:1,bool:1},yu=4;function Nv(e,t){for(var n={},a=0,s=function(f){var g=f.name,m=f.dtype,w=f.shape,A=mt(w),T=void 0;if("quantization"in f){var M=f.quantization;if("uint8"!==M.dtype&&"uint16"!==M.dtype)throw new Error("Weight "+f.name+" has unknown quantization dtype "+M.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var O=td[M.dtype],V=e.slice(a,a+A*O),H="uint8"===M.dtype?new Uint8Array(V):new Uint16Array(V);if("float32"===m)T=Float32Array.from(H,function(le){return le*M.scale+M.min});else{if("int32"!==m)throw new Error("Unsupported dtype in weight '"+g+"': "+m);T=Int32Array.from(H,function(le){return Math.round(le*M.scale+M.min)})}a+=A*O}else if("string"===m){var X=mt(f.shape);T=[];for(var $=0;$<X;$++){var ee=new Uint32Array(e.slice(a,a+yu))[0];a+=yu;var re=new Uint8Array(e.slice(a,a+ee));T.push(re),a+=ee}}else{var te=td[m];if(V=e.slice(a,a+A*te),"float32"===m)T=new Float32Array(V);else if("int32"===m)T=new Int32Array(V);else{if("bool"!==m)throw new Error("Unsupported dtype in weight '"+g+"': "+m);T=new Uint8Array(V)}a+=A*te}n[g]=Wt(T,w,m)},c=0,d=t;c<d.length;c++)s(d[c]);return n}var nd=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function Lv(e){return nd?Buffer.byteLength(e):new Blob([e]).size}function rd(e){var t=0;e.forEach(function(s){t+=s.byteLength});var n=new Uint8Array(t),a=0;return e.forEach(function(s){n.set(new Uint8Array(s),a),a+=s.byteLength}),n.buffer}function Fv(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function bc(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:Lv(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:Lv(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}var va=(Ci.getInstance=function(){return null==Ci.instance&&(Ci.instance=new Ci),Ci.instance},Ci.registerSaveRouter=function(e){Ci.getInstance().saveRouters.push(e)},Ci.registerLoadRouter=function(e){Ci.getInstance().loadRouters.push(e)},Ci.getSaveHandlers=function(e){return Ci.getHandlers(e,"save")},Ci.getLoadHandlers=function(e,t){return Ci.getHandlers(e,"load",t)},Ci.getHandlers=function(e,t,n){var a=[];return("load"===t?Ci.getInstance().loadRouters:Ci.getInstance().saveRouters).forEach(function(s){var c=s(e,n);null!==c&&a.push(c)}),a},Ci),kl="://",gs=(ho.getInstance=function(){return null==ho.instance&&(ho.instance=new ho),ho.instance},ho.registerManager=function(e,t){ue(null!=e,function(){return"scheme must not be undefined or null."}),e.endsWith(kl)&&(e=e.slice(0,e.indexOf(kl))),ue(0<e.length,function(){return"scheme must not be an empty string."});var n=ho.getInstance();ue(null==n.managers[e],function(){return"A model store manager is already registered for scheme '"+e+"'."}),n.managers[e]=t},ho.getManager=function(e){var t=this.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '"+e+"'");return t},ho.getSchemes=function(){return Object.keys(this.getInstance().managers)},ho);function ho(){this.managers={}}function Ci(){this.saveRouters=[],this.loadRouters=[]}function wu(e){if(-1===e.indexOf(kl))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+gs.getSchemes().join(","));return{scheme:e.split(kl)[0],path:e.split(kl)[1]}}function Ov(e,t,n){return void 0===n&&(n=!1),F(this,void 0,void 0,function(){var a,s,c,d,f,g,m,w,A;return de(this,function(T){switch(T.label){case 0:return ue(e!==t,function(){return"Old path and new path are the same: '"+e+"'"}),ue(0<(a=va.getLoadHandlers(e)).length,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),ue(a.length<2,function(){return"Copying failed because more than one ("+a.length+") load handlers for source URL "+e+"."}),s=a[0],ue(0<(c=va.getSaveHandlers(t)).length,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),ue(c.length<2,function(){return"Copying failed because more than one ("+a.length+") save handlers for destination URL "+t+"."}),d=c[0],f=wu(e).scheme,g=wu(e).path,m=f===wu(e).scheme,[4,s.load()];case 1:return w=T.sent(),n&&m?[4,gs.getManager(f).removeModel(g)]:[3,3];case 2:T.sent(),T.label=3;case 3:return[4,d.save(w)];case 4:return A=T.sent(),!n||m?[3,6]:[4,gs.getManager(f).removeModel(g)];case 5:T.sent(),T.label=6;case 6:return[2,A.modelArtifactsInfo]}})})}var Ys="models_store",vs="model_info_store";function Bv(){if(!_e().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function id(e){var t=e.result;t.createObjectStore(Ys,{keyPath:"modelPath"}),t.createObjectStore(vs,{keyPath:"modelPath"})}function zv(e){return _e().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Al.URL_SCHEME)?(t=e.slice(Al.URL_SCHEME.length),new Al(t)):null;var t}var Al=(yc.prototype.save=function(e){return F(this,void 0,void 0,function(){return de(this,function(t){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]})})},yc.prototype.load=function(){return F(this,void 0,void 0,function(){return de(this,function(e){return[2,this.databaseAction(this.modelPath)]})})},yc.prototype.databaseAction=function(e,t){var n=this;return new Promise(function(a,s){var c=n.indexedDB.open("tensorflowjs",1);c.onupgradeneeded=function(){return id(c)},c.onsuccess=function(){var d=c.result;if(null==t){var f=d.transaction(Ys,"readonly"),g=f.objectStore(Ys).get(n.modelPath);g.onsuccess=function(){if(null==g.result)return d.close(),s(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));a(g.result.modelArtifacts)},g.onerror=function(O){return d.close(),s(g.error)},f.oncomplete=function(){return d.close()}}else{var m,w=bc(t),A=d.transaction(vs,"readwrite"),T=A.objectStore(vs),M=T.put({modelPath:n.modelPath,modelArtifactsInfo:w});M.onsuccess=function(){var O=(m=d.transaction(Ys,"readwrite")).objectStore(Ys).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:w});O.onsuccess=function(){return a({modelArtifactsInfo:w})},O.onerror=function(V){var H=(T=A.objectStore(vs)).delete(n.modelPath);H.onsuccess=function(){return d.close(),s(O.error)},H.onerror=function(X){return d.close(),s(O.error)}}},M.onerror=function(O){return d.close(),s(M.error)},A.oncomplete=function(){null==m?d.close():m.oncomplete=function(){return d.close()}}}},c.onerror=function(d){return s(c.error)}})},yc.URL_SCHEME="indexeddb://",yc);function yc(e){if(this.indexedDB=Bv(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}va.registerSaveRouter(zv),va.registerLoadRouter(zv);var Gb=(ad.prototype.listModels=function(){return F(this,void 0,void 0,function(){var e=this;return de(this,function(t){return[2,new Promise(function(n,a){var s=e.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return id(s)},s.onsuccess=function(){var c=s.result,d=c.transaction(vs,"readonly"),f=d.objectStore(vs).getAll();f.onsuccess=function(){for(var g={},m=0,w=f.result;m<w.length;m++){var A=w[m];g[A.modelPath]=A.modelArtifactsInfo}n(g)},f.onerror=function(g){return c.close(),a(f.error)},d.oncomplete=function(){return c.close()}},s.onerror=function(c){return a(s.error)}})]})})},ad.prototype.removeModel=function(e){return F(this,void 0,void 0,function(){var t=this;return de(this,function(n){var a;return e=(a=e).startsWith(Al.URL_SCHEME)?a.slice(Al.URL_SCHEME.length):a,[2,new Promise(function(s,c){var d=t.indexedDB.open("tensorflowjs",1);d.onupgradeneeded=function(){return id(d)},d.onsuccess=function(){var f,g=d.result,m=g.transaction(vs,"readwrite"),w=m.objectStore(vs),A=w.get(e);A.onsuccess=function(){if(null==A.result)return g.close(),c(new Error("Cannot find model with path '"+e+"' in IndexedDB."));function T(){var O=(f=g.transaction(Ys,"readwrite")).objectStore(Ys).delete(e);O.onsuccess=function(){return s(A.result.modelArtifactsInfo)},O.onerror=function(V){return c(A.error)}}var M=w.delete(e);M.onsuccess=T,M.onerror=function(O){return T(),g.close(),c(A.error)}},A.onerror=function(T){return g.close(),c(A.error)},m.oncomplete=function(){null==f?g.close():f.oncomplete=function(){return g.close()}}},d.onerror=function(f){return c(d.error)}})]})})},ad);function ad(){this.indexedDB=Bv()}if(_e().getBool("IS_BROWSER"))try{gs.registerManager(Al.URL_SCHEME,new Gb)}catch{}var Ho="/",Sl="tensorflowjs_models",Wv="info",Vb="model_topology",Yb="weight_specs",jb="weight_data",Ub="model_metadata";function Hv(e){return{info:[Sl,e,Wv].join(Ho),topology:[Sl,e,Vb].join(Ho),weightSpecs:[Sl,e,Yb].join(Ho),weightData:[Sl,e,jb].join(Ho),modelMetadata:[Sl,e,Ub].join(Ho)}}function qb(e){var t=e.split(Ho);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(Ho)}function Xv(e){return _e().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(El.URL_SCHEME)?(t=e.slice(El.URL_SCHEME.length),new El(t)):null;var t}var El=(Cu.prototype.save=function(e){return F(this,void 0,void 0,function(){var t,n,a;return de(this,function(s){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),a=bc(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(c){if(nd)return Buffer.from(c).toString("base64");for(var d=new Uint8Array(c),f="",g=0,m=d.length;g<m;g++)f+=String.fromCharCode(d[g]);return btoa(f)}(e.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata})),[2,{modelArtifactsInfo:a}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+a.modelTopologyBytes+", weightSpecsBytes="+a.weightSpecsBytes+", weightDataBytes="+a.weightDataBytes+".")}return[2]})})},Cu.prototype.load=function(){return F(this,void 0,void 0,function(){var e,t,n,a,s,c,d;return de(this,function(f){if(null==(e=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(t={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(t.modelTopology=n,null==(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(t.weightSpecs=a,null!=(s=this.LS.getItem(this.keys.modelMetadata))&&(c=JSON.parse(s),t.format=c.format,t.generatedBy=c.generatedBy,t.convertedBy=c.convertedBy,t.userDefinedMetadata=c.userDefinedMetadata),null==(d=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return t.weightData=function(g){if(nd){var m=Buffer.from(g,"base64");return m.buffer.slice(m.byteOffset,m.byteOffset+m.byteLength)}for(var w=atob(g),A=new Uint8Array(w.length),T=0;T<w.length;++T)A.set([w.charCodeAt(T)],T);return A.buffer}(d),[2,t]})})},Cu.URL_SCHEME="localstorage://",Cu);function Cu(e){if(!_e().getBool("IS_BROWSER")||typeof window>"u"||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=Hv(this.modelPath)}va.registerSaveRouter(Xv),va.registerLoadRouter(Xv);var $b=(od.prototype.listModels=function(){return F(this,void 0,void 0,function(){var e,t,n,a,s,c;return de(this,function(d){for(e={},t=Sl+Ho,n=Ho+Wv,a=0;a<this.LS.length;++a)(s=this.LS.key(a)).startsWith(t)&&s.endsWith(n)&&(c=qb(s),e[c]=JSON.parse(this.LS.getItem(s)));return[2,e]})})},od.prototype.removeModel=function(e){return F(this,void 0,void 0,function(){var t,n;return de(this,function(a){var s;if(e=(s=e).startsWith(El.URL_SCHEME)?s.slice(El.URL_SCHEME.length):s,t=Hv(e),null==this.LS.getItem(t.info))throw new Error("Cannot find model at path '"+e+"'");return n=JSON.parse(this.LS.getItem(t.info)),this.LS.removeItem(t.info),this.LS.removeItem(t.topology),this.LS.removeItem(t.weightSpecs),this.LS.removeItem(t.weightData),[2,n]})})},od);function od(){ue(_e().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),ue(typeof window>"u"||void 0!==window.localStorage,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}if(_e().getBool("IS_BROWSER"))try{gs.registerManager(El.URL_SCHEME,new $b)}catch{}function Gv(e){return new Promise(function(t){return setTimeout(t)}).then(e)}var sd=(wc.prototype.save=function(e){return F(this,void 0,void 0,function(){var t,s,c,d;return de(this,function(f){switch(f.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return s=window.URL.createObjectURL(new Blob([JSON.stringify({modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}]})],{type:"application/json"})),(c=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,c.href=s,[4,Gv(function(){return c.dispatchEvent(new MouseEvent("click"))})];case 2:return f.sent(),null==e.weightData?[3,4]:((d=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,d.href=t,[4,Gv(function(){return d.dispatchEvent(new MouseEvent("click"))})]);case 3:f.sent(),f.label=4;case 4:return[2,{modelArtifactsInfo:bc(e)}]}})})},wc.URL_SCHEME="downloads://",wc),Kb=(ld.prototype.load=function(){return F(this,void 0,void 0,function(){var e,t,n=this;return de(this,function(a){return e=this.files[0],t=this.files.slice(1),[2,new Promise(function(s,c){var d=new FileReader;d.onload=function(f){var g=JSON.parse(f.target.result),m=g.modelTopology;if(null!=m){0===t.length&&s({modelTopology:m});var w=g.weightsManifest;if(null!=w){var A;try{A=n.checkManifestAndWeightFiles(w,t)}catch(V){return void c(V)}var T=[],M=[],O=[];w.forEach(function(V){V.paths.forEach(function(H){M.push(H),O.push(null)}),T.push.apply(T,V.weights)}),w.forEach(function(V){V.paths.forEach(function(H){var X=new FileReader;X.onload=function($){var ee=$.target.result,re=M.indexOf(H);O[re]=ee,-1===O.indexOf(null)&&s({modelTopology:m,weightSpecs:T,weightData:rd(O),format:g.format,generatedBy:g.generatedBy,convertedBy:g.convertedBy,userDefinedMetadata:g.userDefinedMetadata})},X.onerror=function($){return c("Failed to weights data from file of path '"+H+"'.")},X.readAsArrayBuffer(A[H])})})}else c(new Error("weightManifest field is missing from file "+e.name))}else c(new Error("modelTopology field is missing from file "+e.name))},d.onerror=function(f){return c("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},d.readAsText(e)})]})})},ld.prototype.checkManifestAndWeightFiles=function(e,t){for(var n=[],a=t.map(function(f){return Fv(f.name)}),s={},c=0,d=e;c<d.length;c++)d[c].paths.forEach(function(f){var g=Fv(f);if(-1!==n.indexOf(g))throw new Error("Duplicate file basename found in weights manifest: '"+g+"'");if(n.push(g),-1===a.indexOf(g))throw new Error("Weight file with basename '"+g+"' is not provided.");s[f]=t[a.indexOf(g)]});if(n.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+t.length+").");return s},ld);function ld(e){if(null==e||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}function wc(e){if(!_e().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(wc.URL_SCHEME)&&(e=e.slice(wc.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelTopologyFileName=e+".json",this.weightDataFileName=e+".weights.bin"}function Vv(e,t,n,a){var s,c,d;ue(null!=(d=e)&&Array.isArray(d)&&0<d.length,function(){return"promises must be a none empty array"}),s=n=n??0,c=a=a??1,ue(0<=s&&s<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+s}),ue(0<=c&&c<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+c}),ue(s<=c,function(){return"startFraction must be no more than endFraction, but got startFraction "+s+" and endFraction "+c});var f=0;return Promise.all(e.map(function(g){return g.then(function(m){var w=n+ ++f/e.length*(a-n);return t(w),m}),g}))}function Yv(e,t){return F(this,void 0,void 0,function(){var n,a,s,c,d,f,g,m,w;return de(this,function(A){switch(A.label){case 0:return null==t&&(t={}),n=null==t.fetchFunc?_e().platform.fetch:t.fetchFunc,a=e.map(function(T){return n(T,t.requestInit,{isBinary:!0})}),s=0,c=.5,null!=t.onProgress?[3,2]:[4,Promise.all(a)];case 1:return d=A.sent(),[3,4];case 2:return[4,Vv(a,t.onProgress,s,c)];case 3:d=A.sent(),A.label=4;case 4:return f=d.map(function(T){return T.arrayBuffer()}),g=.5,m=1,null!=t.onProgress?[3,6]:[4,Promise.all(f)];case 5:return w=A.sent(),[3,8];case 6:return[4,Vv(f,t.onProgress,g,m)];case 7:w=A.sent(),A.label=8;case 8:return[2,w]}})})}function jv(e){var t=this;return function(n,a,s){return void 0===a&&(a=""),F(t,void 0,void 0,function(){var c,d,f,g,m,w,A,T,M,O;return de(this,function(V){switch(V.label){case 0:if(c=n.map(function(){return!1}),d={},f=null!=s?s.map(function(){return!1}):[],g=[],n.forEach(function(H,X){var $=0;H.weights.forEach(function(ee){function re(){c[X]=!0,null==d[X]&&(d[X]=[]),d[X].push({manifestEntry:ee,groupOffset:$,sizeBytes:le})}var le=td["quantization"in ee?ee.quantization.dtype:ee.dtype]*mt(ee.shape);null!=s?s.forEach(function(se,ie){se===ee.name&&(re(),f[ie]=!0)}):re(),g.push(ee.name),$+=le})}),!f.every(function(H){return H}))throw m=s.filter(function(H,X){return!f[X]}),new Error("Could not find weights in manifest with names: "+m.join(", ")+". \nManifest JSON has weights with names: "+g.join(", ")+".");return w=c.reduce(function(H,X,$){return X&&H.push($),H},[]),A=[],w.forEach(function(H){n[H].paths.forEach(function(X){var $=a+(a.endsWith("/")?"":"/")+X;A.push($)})}),[4,e(A)];case 1:return T=V.sent(),M={},O=0,w.forEach(function(H){for(var X=n[H].paths.length,$=0,ee=0;ee<X;ee++)$+=T[O+ee].byteLength;for(var re=new ArrayBuffer($),te=new Uint8Array(re),le=0,se=0;se<X;se++){var ie=new Uint8Array(T[O+se]);te.set(ie,le),le+=ie.byteLength}d[H].forEach(function(ce){var he=Nv(re.slice(ce.groupOffset,ce.groupOffset+ce.sizeBytes),[ce.manifestEntry]);for(var be in he)M[be]=he[be]}),O+=X}),[2,M]}})})}}va.registerSaveRouter(function(e){return _e().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(sd.URL_SCHEME)?(void 0===(t=e.slice(sd.URL_SCHEME.length))&&(t="model"),new sd(t)):null;var t});var Uv=(Cc.prototype.save=function(e){return F(this,void 0,void 0,function(){var t,s;return de(this,function(c){switch(c.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,t.body.append("model.json",new Blob([JSON.stringify({modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:[{paths:["./model.weights.bin"],weights:e.weightSpecs}]})],{type:"application/json"}),"model.json"),null!=e.weightData&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,t)];case 1:if((s=c.sent()).ok)return[2,{modelArtifactsInfo:bc(e),responses:[s]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+s.status+".")}})})},Cc.prototype.load=function(){return F(this,void 0,void 0,function(){var e,t,n,a,s,c,d,f,g,m,w,A;return de(this,function(T){switch(T.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(e=T.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+e.status+". Please verify this URL points to the model JSON of the model to load.");T.label=2;case 2:return T.trys.push([2,4,,5]),[4,e.json()];case 3:return t=T.sent(),[3,5];case 4:throw T.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(s=t.weightsManifest,c=t.generatedBy,d=t.convertedBy,f=t.format,g=t.userDefinedMetadata,null==(a=t.modelTopology)&&null==s)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==s?[3,7]:[4,this.loadWeights(s)];case 6:A=T.sent(),m=A[0],w=A[1],T.label=7;case 7:return[2,{modelTopology:a,weightSpecs:m,weightData:w,userDefinedMetadata:g,generatedBy:c,convertedBy:d,format:f}]}})})},Cc.prototype.loadWeights=function(e){return F(this,void 0,void 0,function(){var n,a,s,c,d,f,g,w,A;return de(this,function(T){switch(T.label){case 0:for(O=(M=Array.isArray(this.path)?this.path[1]:this.path).lastIndexOf("/"),V=M.lastIndexOf("?"),n=[M.substring(0,O)+"/",O<V?M.substring(V):""],a=n[0],s=n[1],c=this.weightPathPrefix||a,d=[],f=0,g=e;f<g.length;f++)d.push.apply(d,g[f].weights);return w=[],e.forEach(function(H){H.paths.forEach(function(X){w.push(c+X+s)})}),[4,Yv(w,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return A=T.sent(),[2,[d,rd(A)]]}var M,O,V})})},Cc.URL_SCHEME_REGEX=/^https?:\/\//,Cc);function Cc(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,null!=t.fetchFunc?(ue("function"==typeof t.fetchFunc,function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=t.fetchFunc):this.fetch=_e().platform.fetch,ue(null!=e&&0<e.length,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(e)&&ue(2===e.length,function(){return"URL paths for http must have a length of 2, (actual length is "+e.length+")."}),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}function cd(e){return null!=e.match(Uv.URL_SCHEME_REGEX)}function qv(e,t){return typeof fetch>"u"?null:(Array.isArray(e)?e.every(function(n){return cd(n)}):cd(e))?ud(e,{onProgress:t}):null}function ud(e,t){return new Uv(e,t)}va.registerSaveRouter(qv),va.registerLoadRouter(qv);var hd=(Kv.prototype.load=function(){return F(this,void 0,void 0,function(){return de(this,function(e){return[2,this.modelArtifacts]})})},Kv),Zb=($v.prototype.save=function(e){return F(this,void 0,void 0,function(){return de(this,function(t){return[2,this.saveHandler(e)]})})},$v);function $v(e){this.saveHandler=e}function Kv(e){this.modelArtifacts=e}var _l,dd=Object.freeze({browserFiles:function(e){return new Kb(e)},browserHTTPRequest:function(e,t){return ud(e,t)},concatenateArrayBuffers:rd,decodeWeights:Nv,encodeWeights:function(e,t){return F(this,void 0,void 0,function(){var n,a,s,c,d,f=this;return de(this,function(g){switch(g.label){case 0:for(n=[],a=[],s=Array.isArray(e)?e.map(function(m){return m.name}):Object.keys(e),c=function(m){var w=s[m],A=Array.isArray(e)?e[m].tensor:e[w];if("float32"!==A.dtype&&"int32"!==A.dtype&&"bool"!==A.dtype&&"string"!==A.dtype)throw new Error("Unsupported dtype in weight '"+w+"': "+A.dtype);var T={name:w,shape:A.shape,dtype:A.dtype};if("string"===A.dtype){var M=new Promise(function(O){return F(f,void 0,void 0,function(){var V,H,X,$,ee,re,te;return de(this,function(le){switch(le.label){case 0:return[4,A.bytes()];case 1:for(V=le.sent(),H=V.reduce(function(se,ie){return se+ie.length},0)+yu*V.length,X=new Uint8Array(H),ee=$=0;ee<V.length;ee++)re=V[ee],te=new Uint8Array(new Uint32Array([re.length]).buffer),X.set(te,$),X.set(re,$+=yu),$+=re.length;return O(X),[2]}})})});a.push(M)}else a.push(A.data());null!=t&&(T.group=t),n.push(T)},d=0;d<s.length;++d)c(d);return[4,Promise.all(a)];case 1:return[2,{data:function(m){if(null===m)throw new Error("Invalid input value: "+JSON.stringify(m));var w=0,A=[];m.forEach(function(O){if(w+=O.byteLength,A.push(O.byteLength===O.buffer.byteLength?O:new O.constructor(O)),!(O instanceof Float32Array||O instanceof Int32Array||O instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+O.constructor.name)});var T=new Uint8Array(w),M=0;return A.forEach(function(O){T.set(new Uint8Array(O.buffer),M),M+=O.byteLength}),T.buffer}(g.sent()),specs:n}]}})})},fromMemory:function(e,t,n,a){return 1===arguments.length?null!=e.modelTopology||null!=e.weightSpecs?new hd(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new hd({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new hd({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:a}))},getLoadHandlers:function(e,t){return va.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:bc,getSaveHandlers:function(e){return va.getSaveHandlers(e)},http:ud,isHTTPScheme:cd,loadWeights:function(e,t,n,a){return void 0===t&&(t=""),F(this,void 0,void 0,function(){return de(this,function(s){return[2,jv(function(c){return Yv(c,{requestInit:a})})(e,t,n)]})})},registerLoadRouter:function(e){return va.registerLoadRouter(e)},registerSaveRouter:function(e){return va.registerSaveRouter(e)},weightsLoaderFactory:jv,withSaveHandler:function(e){return new Zb(e)},copyModel:function(e,t){return F(this,void 0,void 0,function(){return de(this,function(n){return[2,Ov(e,t,!1)]})})},listModels:function(){return F(this,void 0,void 0,function(){var e,t,n,a,s,c,d;return de(this,function(f){switch(f.label){case 0:e=gs.getSchemes(),t={},n=0,a=e,f.label=1;case 1:return n<a.length?[4,gs.getManager(s=a[n]).listModels()]:[3,4];case 2:for(d in c=f.sent())t[s+kl+d]=c[d];f.label=3;case 3:return n++,[3,1];case 4:return[2,t]}})})},moveModel:function(e,t){return F(this,void 0,void 0,function(){return de(this,function(n){return[2,Ov(e,t,!0)]})})},removeModel:function(e){return F(this,void 0,void 0,function(){var t;return de(this,function(n){return t=wu(e),[2,gs.getManager(t.scheme).removeModel(t.path)]})})}}),Jb=ye({confusionMatrix_:function(e,t,n){var a=D(e,"labels","confusionMatrix"),s=D(t,"predictions","confusionMatrix");ue(null==n||0<n&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),ue(1===a.rank,function(){return"Expected the rank of labels to be 1, but got "+a.rank}),ue(1===s.rank,function(){return"Expected the rank of predictions to be 1, but got "+s.rank}),ue(a.shape[0]===s.shape[0],function(){return"Mismatch in the number of examples: "+a.shape[0]+" vs. "+s.shape[0]+". Labels and predictions should have the same number of elements."}),ue(0<n&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var c=Ht(a.asType("int32"),n),d=Ht(s.asType("int32"),n);return c.transpose().matMul(d).asType("int32")}}),Qb=Object.freeze({confusionMatrix:Jb}),ey=ye({fromPixels_:function(e,t){if(void 0===t&&(t=3),4<t)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,a=!1,s=!1,c=!1,d=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)a=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)s=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)c=!0;else{if(null==e.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);d=!0}if(s&&s&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(null!=dn("FromPixels",P.backendName))return P.runKernel("FromPixels",{pixels:e},{numChannels:t});var f,g,m=s?[e.videoWidth,e.videoHeight]:[e.width,e.height],w=m[0],A=m[1];if(d?f=e.getContext("2d").getImageData(0,0,w,A).data:a||n?f=e.data:(c||s)&&(null==_l&&(_l=document.createElement("canvas").getContext("2d")),_l.canvas.width=w,_l.canvas.height=A,_l.drawImage(e,0,0,w,A),f=_l.getImageData(0,0,w,A).data),4===t)g=new Int32Array(f);else{var T=w*A;g=new Int32Array(T*t);for(var M=0;M<T;M++)for(var O=0;O<t;++O)g[M*t+O]=f[4*M+O]}return Wa(g,[A,w,t],"int32")}}),ku=Object.freeze({toPixels:function(e,t){return F(this,void 0,void 0,function(){var n,a,s,c,d,f,g,m,w,M,O,V,H,X,$,ee,re,te,le,se,ie;return de(this,function(ce){switch(ce.label){case 0:if(n=D(e,"img","toPixels"),e instanceof rn||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(a=n.shape.slice(0,2),s=a[0],c=a[1],4<(d=2===n.rank?1:n.shape[2])||2===d)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+d);return[4,n.data()];case 1:return f=ce.sent(),g=n.min(),m=n.max(),[4,Promise.all([g.data(),m.data()])];case 2:if(w=ce.sent(),M=w[0][0],O=w[1][0],g.dispose(),m.dispose(),"float32"===n.dtype){if(M<0||1<O)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+M+" - "+O+"].")}else{if("int32"!==n.dtype)throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(M<0||255<O)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+M+" - "+O+"].")}for(V="float32"===n.dtype?255:1,H=new Uint8ClampedArray(c*s*4),X=0;X<s*c;++X)te=re=ee=$=void 0,1===d?($=f[X]*V,ee=f[X]*V,re=f[X]*V,te=255):3===d?($=f[3*X]*V,ee=f[3*X+1]*V,re=f[3*X+2]*V,te=255):4===d&&($=f[4*X]*V,ee=f[4*X+1]*V,re=f[4*X+2]*V,te=f[4*X+3]*V),H[0+(le=4*X)]=Math.round($),H[1+le]=Math.round(ee),H[2+le]=Math.round(re),H[3+le]=Math.round(te);return null!=t&&(t.width=c,t.height=s,se=t.getContext("2d"),ie=new ImageData(H,c,s),se.putImageData(ie,0,0)),n!==e&&n.dispose(),[2,H]}})})},fromPixels:ey}),Zv=(fd.prototype.getClassName=function(){return this.constructor.className},fd.fromConfig=function(e,t){return new e(t)},fd),Jv=(ms.getMap=function(){return null==ms.instance&&(ms.instance=new ms),ms.instance},ms.register=function(e){ms.getMap().classNameMap[e.className]=[e,e.fromConfig]},ms);function ms(){this.classNameMap={}}function fd(){}function xs(e){ue(null!=e.className,function(){return"Class being registered does not have the static className property defined."}),ue("string"==typeof e.className,function(){return"className is required to be a string, but got type "+typeof e.className}),ue(0<e.className.length,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),Jv.register(e)}var ty=Object.freeze({Serializable:Zv,SerializationMap:Jv,registerClass:xs});function pd(){return 32===P.backend.floatPrecision()?.001:.1}function gd(e,t,n){var a=!0;if((wn(e)||wn(t))&&(a=!1),wn(e)&&wn(t)&&(a=!0),a){var s=e.constructor.name,c=t.constructor.name;if(s!==c)throw new Error("Arrays are of different type. Actual: "+s+". Expected: "+c)}if(Array.isArray(e)&&Array.isArray(t)){var d=G(e),f=G(t);if(!or(d,f))throw new Error("Arrays have different shapes. Actual: ["+d+"]. Expected: ["+f+"]")}var g=wn(e)?e:Qt(e),m=wn(t)?t:Qt(t);if(g.length!==m.length)throw new Error("Arrays have different lengths actual: "+g.length+" vs expected: "+m.length+".\nActual:   "+g+".\nExpected: "+m+".");for(var w=0;w<m.length;++w){var A=g[w],T=m[w];if(!n(A,T))throw new Error("Arrays differ: actual["+w+"] = "+A+", expected["+w+"] = "+T+".\nActual:   "+g+".\nExpected: "+m+".")}}function vd(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}var md,ny=Object.freeze({TEST_EPSILON_FLOAT16:.1,expectArraysClose:function(e,t,n){return null==n&&(n=pd()),gd(e,t,function(a,s){return vd(a,s,n)})},testEpsilon:pd,expectPromiseToFail:function(e,t){e().then(function(){return t.fail()},function(){return t()})},expectArraysEqual:function(e,t){var n="string"==typeof t||"number"==typeof t||"boolean"==typeof t?[t]:t;return Or(e)||Or(e[0])||Or(t)||Or(t[0])?gd(e,n,function(a,s){return a==s}):gd(e,t,function(a,s){return vd(a,s,0)})},expectNumbersClose:function(e,t,n){if(null==n&&(n=pd()),!vd(e,t,n))throw new Error("Numbers differ: actual === "+e+", expected === "+t)},expectValuesInRange:function(e,t,n){for(var a=0;a<e.length;a++)if(e[a]<t||e[a]>n)throw new Error("Value out of range:"+e[a]+" low: "+t+", high: "+n)},expectArrayBuffersEqual:function(e,t){expect(new Float32Array(e)).toEqual(new Float32Array(t))}}),ry=Object.freeze({gpgpu_util:nu,webgl_util:So,forceHalfFloat:function(){_e().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:gp,setWebGLContext:k,GPGPUContext:ru}),bs=(ut(Za,md=Zv),Za.prototype.minimize=function(e,t,n){void 0===t&&(t=!1);var a=this.computeGradients(e,n),s=a.value,c=a.grads;if(null!=n){var d=n.map(function(f){return{name:f.name,tensor:c[f.name]}});this.applyGradients(d)}else this.applyGradients(c);return b(c),t?s:(s.dispose(),null)},Object.defineProperty(Za.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),Za.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},Za.prototype.computeGradients=function(e,t){return cs(e,t)},Za.prototype.dispose=function(){null!=this.iterations_&&b(this.iterations_)},Za.prototype.saveIterations=function(){return F(this,void 0,void 0,function(){return de(this,function(e){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:nt(this.iterations_,"int32")}]})})},Za.prototype.getWeights=function(){return F(this,void 0,void 0,function(){return de(this,function(e){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},Za.prototype.setWeights=function(e){return F(this,void 0,void 0,function(){return de(this,function(t){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},Za.prototype.extractIterations=function(e){return F(this,void 0,void 0,function(){var t;return de(this,function(n){switch(n.label){case 0:return t=this,[4,e[0].tensor.data()];case 1:return t.iterations_=n.sent()[0],[2,e.slice(1)]}})})},Za);function Za(){return null!==md&&md.apply(this,arguments)||this}Object.defineProperty(bs,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var Qv,xd=(ut(Xo,Qv=bs),Xo.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map(function(n){return n.name}):Object.keys(e)).forEach(function(n,a){var s=P.registeredVariables[n];null==t.accumulatedGrads[a]&&(t.accumulatedGrads[a]={originalName:n+"/accum_grad",variable:ht(function(){return Vt(s).variable(!1)})}),null==t.accumulatedUpdates[a]&&(t.accumulatedUpdates[a]={originalName:n+"/accum_var",variable:ht(function(){return Vt(s).variable(!1)})});var c=Array.isArray(e)?e[a].tensor:e[n];if(null!=c){var d=t.accumulatedGrads[a].variable,f=t.accumulatedUpdates[a].variable;ht(function(){var g=d.mul(t.rho).add(c.square().mul(1-t.rho)),m=f.add(t.epsilon).sqrt().div(d.add(t.epsilon).sqrt()).mul(c),w=f.mul(t.rho).add(m.square().mul(1-t.rho));d.assign(g),f.assign(w);var A=m.mul(-t.learningRate).add(s);s.assign(A)})}}),this.incrementIterations()},Xo.prototype.dispose=function(){null!=this.accumulatedUpdates&&(b(this.accumulatedGrads.map(function(e){return e.variable})),b(this.accumulatedUpdates.map(function(e){return e.variable})))},Xo.prototype.getWeights=function(){return F(this,void 0,void 0,function(){var e;return de(this,function(t){switch(t.label){case 0:return e=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map(function(n){return{name:n.originalName,tensor:n.variable}}))]}})})},Xo.prototype.setWeights=function(e){return F(this,void 0,void 0,function(){var t;return de(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),this.accumulatedGrads=e.slice(0,t=e.length/2).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedUpdates=e.slice(t,2*t).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},Xo.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},Xo.fromConfig=function(e,t){return new e(t.learningRate,t.rho,t.epsilon)},Xo.className="Adadelta",Xo);function Xo(e,t,n){void 0===n&&(n=null);var a=Qv.call(this)||this;return a.learningRate=e,a.rho=t,a.epsilon=n,a.accumulatedGrads=[],a.accumulatedUpdates=[],null==n&&(a.epsilon=P.backend.epsilon()),a}xs(xd);var em,bd=(ut(Go,em=bs),Go.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map(function(n){return n.name}):Object.keys(e)).forEach(function(n,a){var s=P.registeredVariables[n];null==t.accumulatedGrads[a]&&(t.accumulatedGrads[a]={originalName:n+"/accumulator",variable:ht(function(){return Wn(s.shape,t.initialAccumulatorValue).variable(!1)})});var c=Array.isArray(e)?e[a].tensor:e[n];if(null!=c){var d=t.accumulatedGrads[a].variable;ht(function(){var f=d.add(c.square());d.assign(f);var g=c.div(f.add(P.backend.epsilon()).sqrt()).mul(-t.learningRate).add(s);s.assign(g)})}}),this.incrementIterations()},Go.prototype.dispose=function(){null!=this.accumulatedGrads&&b(this.accumulatedGrads.map(function(e){return e.variable}))},Go.prototype.getWeights=function(){return F(this,void 0,void 0,function(){return de(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulatedGrads.map(function(t){return{name:t.originalName,tensor:t.variable}}))]}})})},Go.prototype.setWeights=function(e){return F(this,void 0,void 0,function(){return de(this,function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:return e=t.sent(),this.accumulatedGrads=e.map(function(n){return{originalName:n.name,variable:n.tensor.variable(!1)}}),[2]}})})},Go.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},Go.fromConfig=function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)},Go.className="Adagrad",Go);function Go(e,t){void 0===t&&(t=.1);var n=em.call(this)||this;return n.learningRate=e,n.initialAccumulatorValue=t,n.accumulatedGrads=[],n}xs(bd);var tm,yd=(ut(Vo,tm=bs),Vo.prototype.applyGradients=function(e){var t=this,n=Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e);ht(function(){var a=Yr(1,t.accBeta1),s=Yr(1,t.accBeta2);n.forEach(function(c,d){var f=P.registeredVariables[c];null==t.accumulatedFirstMoment[d]&&(t.accumulatedFirstMoment[d]={originalName:c+"/m",variable:ht(function(){return Vt(f).variable(!1)})}),null==t.accumulatedSecondMoment[d]&&(t.accumulatedSecondMoment[d]={originalName:c+"/v",variable:ht(function(){return Vt(f).variable(!1)})});var g=Array.isArray(e)?e[d].tensor:e[c];if(null!=g){var m=t.accumulatedFirstMoment[d].variable,w=t.accumulatedSecondMoment[d].variable,A=m.mul(t.beta1).add(g.mul(1-t.beta1)),T=w.mul(t.beta2).add(g.square().mul(1-t.beta2)),M=A.div(a),O=T.div(s);m.assign(A),w.assign(T);var V=M.div(O.sqrt().add(t.epsilon)).mul(-t.learningRate).add(f);f.assign(V)}}),t.accBeta1.assign(t.accBeta1.mul(t.beta1)),t.accBeta2.assign(t.accBeta2.mul(t.beta2))}),this.incrementIterations()},Vo.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&b(this.accumulatedFirstMoment.map(function(e){return e.variable})),null!=this.accumulatedSecondMoment&&b(this.accumulatedSecondMoment.map(function(e){return e.variable}))},Vo.prototype.getWeights=function(){return F(this,void 0,void 0,function(){var e;return de(this,function(t){switch(t.label){case 0:return e=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map(function(n){return{name:n.originalName,tensor:n.variable}}))]}})})},Vo.prototype.setWeights=function(e){return F(this,void 0,void 0,function(){var t,n=this;return de(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(e)];case 1:return e=a.sent(),ht(function(){n.accBeta1.assign(dc(n.beta1,n.iterations_+1)),n.accBeta2.assign(dc(n.beta2,n.iterations_+1))}),this.accumulatedFirstMoment=e.slice(0,t=e.length/2).map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}}),this.accumulatedSecondMoment=e.slice(t,2*t).map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}}),[2]}})})},Vo.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},Vo.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)},Vo.className="Adam",Vo);function Vo(e,t,n,a){void 0===a&&(a=null);var s=tm.call(this)||this;return s.learningRate=e,s.beta1=t,s.beta2=n,s.epsilon=a,s.accumulatedFirstMoment=[],s.accumulatedSecondMoment=[],ht(function(){s.accBeta1=nt(t).variable(),s.accBeta2=nt(n).variable()}),null==a&&(s.epsilon=P.backend.epsilon()),s}xs(yd);var nm,wd=(ut(Yo,nm=bs),Yo.prototype.applyGradients=function(e){var t=this,n=Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e);ht(function(){var a=Yr(1,t.accBeta1),s=Ra(-t.learningRate,t.iteration.mul(t.decay).add(1));n.forEach(function(c,d){var f=P.registeredVariables[c];null==t.accumulatedFirstMoment[d]&&(t.accumulatedFirstMoment[d]={originalName:c+"/m",variable:Vt(f).variable(!1)}),null==t.accumulatedWeightedInfNorm[d]&&(t.accumulatedWeightedInfNorm[d]={originalName:c+"/v",variable:Vt(f).variable(!1)});var g=Array.isArray(e)?e[d].tensor:e[c];if(null!=g){var m=t.accumulatedFirstMoment[d].variable,w=t.accumulatedWeightedInfNorm[d].variable,A=m.mul(t.beta1).add(g.mul(1-t.beta1)),T=w.mul(t.beta2),M=g.abs(),O=T.maximum(M);m.assign(A),w.assign(O);var V=s.div(a).mul(A.div(O.add(t.epsilon))).add(f);f.assign(V)}}),t.iteration.assign(t.iteration.add(1)),t.accBeta1.assign(t.accBeta1.mul(t.beta1))}),this.incrementIterations()},Yo.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&b(this.accumulatedFirstMoment.map(function(e){return e.variable})),null!=this.accumulatedWeightedInfNorm&&b(this.accumulatedWeightedInfNorm.map(function(e){return e.variable}))},Yo.prototype.getWeights=function(){return F(this,void 0,void 0,function(){return de(this,function(e){throw new Error("getWeights() is not implemented for Adamax yet.")})})},Yo.prototype.setWeights=function(e){return F(this,void 0,void 0,function(){return de(this,function(t){throw new Error("setWeights() is not implemented for Adamax yet.")})})},Yo.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},Yo.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)},Yo.className="Adamax",Yo);function Yo(e,t,n,a,s){void 0===a&&(a=null),void 0===s&&(s=0);var c=nm.call(this)||this;return c.learningRate=e,c.beta1=t,c.beta2=n,c.epsilon=a,c.decay=s,c.accumulatedFirstMoment=[],c.accumulatedWeightedInfNorm=[],ht(function(){c.iteration=nt(0).variable(),c.accBeta1=nt(t).variable()}),null==a&&(c.epsilon=P.backend.epsilon()),c}xs(wd);var rm,Au=(ut(fo,rm=bs),fo.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map(function(n){return n.name}):Object.keys(e)).forEach(function(n,a){var s=Array.isArray(e)?e[a].tensor:e[n];if(null!=s){var c=P.registeredVariables[n];ht(function(){var d=t.c.mul(s).add(c);c.assign(d)})}}),this.incrementIterations()},fo.prototype.setLearningRate=function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=_(nt(-e))},fo.prototype.dispose=function(){this.c.dispose()},fo.prototype.getWeights=function(){return F(this,void 0,void 0,function(){return de(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()]]}})})},fo.prototype.setWeights=function(e){return F(this,void 0,void 0,function(){return de(this,function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:if(0!==(e=t.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},fo.prototype.getConfig=function(){return{learningRate:this.learningRate}},fo.fromConfig=function(e,t){return new e(t.learningRate)},fo.className="SGD",fo);function fo(e){var t=rm.call(this)||this;return t.learningRate=e,t.setLearningRate(e),t}xs(Au);var im,Cd=(ut(po,im=Au),po.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map(function(n){return n.name}):Object.keys(e)).forEach(function(n,a){var s=P.registeredVariables[n];null==t.accumulations[a]&&(t.accumulations[a]={originalName:n+"/momentum",variable:ht(function(){return Vt(s).variable(!1)})});var c=t.accumulations[a].variable,d=Array.isArray(e)?e[a].tensor:e[n];null!=d&&ht(function(){var f,g=t.m.mul(c).add(d);f=t.useNesterov?t.c.mul(d.add(g.mul(t.m))).add(s):t.c.mul(g).add(s),c.assign(g),s.assign(f)})}),this.incrementIterations()},po.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&b(this.accumulations.map(function(e){return e.variable}))},po.prototype.setMomentum=function(e){this.momentum=e},po.prototype.getWeights=function(){return F(this,void 0,void 0,function(){return de(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulations.map(function(t){return{name:t.originalName,tensor:t.variable}}))]}})})},po.prototype.setWeights=function(e){return F(this,void 0,void 0,function(){return de(this,function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:return e=t.sent(),this.accumulations=e.map(function(n){return{originalName:n.name,variable:n.tensor.variable(!1)}}),[2]}})})},po.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},po.fromConfig=function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)},po.className="Momentum",po);function po(e,t,n){void 0===n&&(n=!1);var a=im.call(this,e)||this;return a.learningRate=e,a.momentum=t,a.useNesterov=n,a.accumulations=[],a.m=nt(a.momentum),a}xs(Cd);var am,kd=(ut(jo,am=bs),jo.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map(function(n){return n.name}):Object.keys(e)).forEach(function(n,a){var s=P.registeredVariables[n];null==t.accumulatedMeanSquares[a]&&(t.accumulatedMeanSquares[a]={originalName:n+"/rms",variable:ht(function(){return Vt(s).variable(!1)})}),null==t.accumulatedMoments[a]&&(t.accumulatedMoments[a]={originalName:n+"/momentum",variable:ht(function(){return Vt(s).variable(!1)})}),null==t.accumulatedMeanGrads[a]&&t.centered&&(t.accumulatedMeanGrads[a]={originalName:n+"/mg",variable:ht(function(){return Vt(s).variable(!1)})});var c=Array.isArray(e)?e[a].tensor:e[n];if(null!=c){var d=t.accumulatedMeanSquares[a].variable,f=t.accumulatedMoments[a].variable;ht(function(){var g=d.mul(t.decay).add(c.square().mul(1-t.decay));if(t.centered){var m=t.accumulatedMeanGrads[a].variable,w=m.mul(t.decay).add(c.mul(1-t.decay)),A=f.mul(t.momentum).add(c.mul(t.learningRate).div(g.sub(w.square().add(t.epsilon)).sqrt()));d.assign(g),m.assign(w),f.assign(A);var T=s.sub(A);s.assign(T)}else{var M=d.mul(t.decay).add(c.square().mul(1-t.decay));A=f.mul(t.momentum).add(c.mul(t.learningRate).div(M.add(t.epsilon).sqrt())),d.assign(M),f.assign(A),T=s.sub(A),s.assign(T)}})}}),this.incrementIterations()},jo.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&b(this.accumulatedMeanSquares.map(function(e){return e.variable})),null!=this.accumulatedMeanGrads&&this.centered&&b(this.accumulatedMeanGrads.map(function(e){return e.variable})),null!=this.accumulatedMoments&&b(this.accumulatedMoments.map(function(e){return e.variable}))},jo.prototype.getWeights=function(){return F(this,void 0,void 0,function(){var e;return de(this,function(t){switch(t.label){case 0:return e=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&e.push.apply(e,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map(function(n){return{name:n.originalName,tensor:n.variable}}))]}})})},jo.prototype.setWeights=function(e){return F(this,void 0,void 0,function(){var t;return de(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),this.accumulatedMeanSquares=e.slice(0,t=this.centered?e.length/3:e.length/2).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedMoments=e.slice(t,2*t).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}})),[2]}})})},jo.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},jo.fromConfig=function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)},jo.className="RMSProp",jo);function jo(e,t,n,a,s){void 0===t&&(t=.9),void 0===n&&(n=0),void 0===a&&(a=null),void 0===s&&(s=!1);var c=am.call(this)||this;if(c.learningRate=e,c.decay=t,c.momentum=n,c.epsilon=a,c.accumulatedMeanSquares=[],c.accumulatedMoments=[],c.accumulatedMeanGrads=[],c.centered=s,null==a&&(c.epsilon=P.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.");return c}xs(kd);var js=(ys.sgd=function(e){return new Au(e)},ys.momentum=function(e,t,n){return void 0===n&&(n=!1),new Cd(e,t,n)},ys.rmsprop=function(e,t,n,a,s){return void 0===t&&(t=.9),void 0===n&&(n=0),void 0===a&&(a=null),void 0===s&&(s=!1),new kd(e,t,n,a,s)},ys.adam=function(e,t,n,a){return void 0===e&&(e=.001),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===a&&(a=null),new yd(e,t,n,a)},ys.adadelta=function(e,t,n){return void 0===e&&(e=.001),void 0===t&&(t=.95),void 0===n&&(n=null),new xd(e,t,n)},ys.adamax=function(e,t,n,a,s){return void 0===e&&(e=.002),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===a&&(a=null),void 0===s&&(s=0),new wd(e,t,n,a,s)},ys.adagrad=function(e,t){return void 0===t&&(t=.1),new bd(e,t)},ys),iy={sgd:js.sgd,momentum:js.momentum,adadelta:js.adadelta,adagrad:js.adagrad,rmsprop:js.rmsprop,adamax:js.adamax,adam:js.adam},ay=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:function(e){return e()};function ys(){}rn.prototype.squaredDifference=function(e){return Ah(this,e)},Ve=Ob;var oy=Object.freeze({__proto__:null,AdadeltaOptimizer:xd,AdagradOptimizer:bd,AdamOptimizer:yd,AdamaxOptimizer:wd,DataStorage:Va,get ENV(){return kt},Environment:me,KernelBackend:jl,MomentumOptimizer:Cd,Optimizer:bs,RMSPropOptimizer:kd,get Rank(){return ha},get Reduction(){return wi},SGDOptimizer:Au,Tensor:rn,TensorBuffer:Li,Variable:Ei,abs:mp,acos:xp,acosh:bp,add:xn,addN:ig,addStrict:ag,all:ev,any:tv,argMax:nv,argMin:rv,asin:yp,asinh:wp,atan:Cp,atan2:og,atanh:kp,avgPool:wl,avgPool3d:$g,backend:function(){return P.backend},backend_util:fh,basicLSTMCell:dv,batchNorm:Ih,batchNorm2d:Qp,batchNorm3d:eg,batchNorm4d:tg,batchNormalization:Jp,batchNormalization2d:$p,batchNormalization3d:Kp,batchNormalization4d:Zp,batchToSpaceND:Qe,booleanMaskAsync:Tg,broadcastTo:bt,browser:ku,buffer:xe,cast:yt,ceil:Ap,clipByValue:su,clone:Pt,complex:an,concat:vt,concat1d:ur,concat2d:hr,concat3d:pn,concat4d:Ii,conv1d:Pg,conv2d:ga,conv2dTranspose:Og,conv3d:Mg,conv3dTranspose:Bg,cos:Sp,cosh:Ep,cumsum:wt,customGrad:Do,deprecationWarn:is,depthToSpace:An,depthwiseConv2d:fc,diag:wv,disableDeprecationWarnings:function(){_e().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")},dispose:b,disposeVariables:function(){P.disposeVariables()},div:Ra,divNoNan:sg,divStrict:lg,dot:zg,dropout:Cv,elu:zh,enableDebugMode:function(){_e().set("DEBUG",!0)},enableProdMode:function(){_e().set("PROD",!0)},engine:function(){return P},env:_e,equal:Ph,equalStrict:mg,erf:_p,exp:lu,expandDims:Bt,expm1:Ip,eye:Kt,fft:pu,fill:Wn,findBackend:function(e){return P.findBackend(e)},findBackendFactory:function(e){return P.findBackendFactory(e)},floor:Tp,floorDiv:Rh,frame:mu,fused:Tv,gather:du,gatherND:yv,gather_util:Ga,getBackend:function(){return P.backendName},getGradient:ar,getKernel:dn,getKernelsForBackend:gt,grad:function(e){return ue(Br(e),function(){return"The f passed in grad(f) must be a function"}),function(t,n){var a=D(t,"x","tf.grad",null),s=null!=n?D(n,"dy","tf.grad"):null;return P.tidy(function(){var c=P.gradients(function(){return e(a)},[a],s),f=c.grads;return null!=s&&z(c.value.shape,s.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),ll(f),f[0]})}},grads:function(e){return ue(Br(e),function(){return"The f passed in grads(f) must be a function"}),function(t,n){ue(Array.isArray(t),function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"});var a=ae(t,"args","tf.grads",null),s=null!=n?D(n,"dy","tf.grads"):null;return P.tidy(function(){var c=P.gradients(function(){return e.apply(void 0,a)},a,s),f=c.grads;return null!=s&&z(c.value.shape,s.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),ll(f),f})}},greater:xg,greaterEqual:Mh,greaterEqualStrict:bg,greaterStrict:yg,hammingWindow:Vh,hannWindow:vu,ifft:vc,imag:gr,image:bu,inTopKAsync:Av,io:dd,irfft:Gh,isFinite:Bp,isInf:Op,isNaN:Fp,keep:_,leakyRelu:cv,less:wg,lessEqual:Cg,lessEqualStrict:kg,lessStrict:Ag,linalg:Iv,linspace:fr,localResponseNormalization:hv,log:Rp,log1p:Dp,logSigmoid:Pp,logSoftmax:Vc,logSumExp:iv,logicalAnd:hc,logicalNot:ng,logicalOr:Th,logicalXor:rg,losses:Ev,matMul:pc,math:Qb,max:gc,maxPool:Qr,maxPool3d:qg,maximum:hu,maximumStrict:cg,mean:av,memory:function(){return P.memory()},min:ov,minimum:Dh,minimumStrict:ug,mod:hg,modStrict:dg,moments:sv,movingAverage:pv,mul:yi,mulStrict:fg,multiRNNCell:fv,multinomial:mn,neg:cc,nextFrame:function(){return new Promise(function(e){return ay(function(){return e()})})},norm:Xh,notEqual:Sg,notEqualStrict:Eg,oneHot:Ht,ones:_i,onesLike:ea,op:ye,outerProduct:Wg,pad:Vn,pad1d:Sr,pad2d:Er,pad3d:Jr,pad4d:vr,pool:Ug,pow:dc,powStrict:pg,prelu:Wh,print:ze,prod:lv,profile:function(e){return P.profile(e)},rand:mr,randomGamma:Ea,randomNormal:Yn,randomUniform:si,range:Ar,ready:function(){return P.ready()},real:ir,reciprocal:Mp,registerBackend:function(e,t,n){return void 0===n&&(n=1),P.registerBackend(e,t,n)},registerGradient:bn,registerKernel:Et,relu:br,relu6:Hh,removeBackend:function(e){P.removeBackend(e)},reshape:Gr,reverse:yl,reverse1d:Hg,reverse2d:Xg,reverse3d:Gg,reverse4d:Vg,rfft:gu,round:Np,rsqrt:Sh,scalar:nt,scatterND:mv,scatter_util:dh,selu:uv,separableConv2d:fu,serialization:ty,setBackend:function(e){return P.setBackend(e)},setPlatform:function(e,t){_e().setPlatform(e,t)},setdiff1dAsync:je,sigmoid:Eh,sign:Lp,signal:Sv,sin:zp,sinh:Wp,slice:Ka,slice1d:Kg,slice2d:Zg,slice3d:Oh,slice4d:Jg,slice_util:Gc,softmax:_a,softplus:Hp,spaceToBatchND:Io,sparseToDense:bv,spectral:xv,split:ta,sqrt:Xp,square:vp,squaredDifference:Ah,squaredDifferenceStrict:gg,squeeze:To,stack:li,step:Gp,stft:Yh,stridedSlice:gv,sub:Yr,subStrict:vg,sum:Bh,sumOutType:Wi,tan:Vp,tanh:Yp,tensor:Wt,tensor1d:tn,tensor2d:vi,tensor3d:Wa,tensor4d:er,tensor5d:ro,tensor6d:Kr,tensor_util:Mr,test_util:ny,tidy:ht,tile:Ro,time:function(e){return P.time(e)},topk:vv,train:iy,transpose:zo,truncatedNormal:Fc,unregisterGradient:function(e){if(!cn.has(e))throw new Error("The gradient '"+e+"' for backend is not registered");cn.delete(e)},unregisterKernel:function(e,t){var n=pe(e,t);if(!Ft.has(n))throw new Error("The kernel '"+e+"' for backend '"+t+"' is not registered");Ft.delete(n)},unsortedSegmentSum:Nh,unstack:_r,util:Pa,valueAndGrad:function(e){return ue(Br(e),function(){return"The f passed in valueAndGrad(f) must be a function"}),function(t,n){ue(t instanceof rn,function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"}),ue(null==n||n instanceof rn,function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"});var a=P.gradients(function(){return e(t)},[t],n),s=a.grads,c=a.value;return ll(s),{grad:s[0],value:c}}},valueAndGrads:function(e){return ue(Br(e),function(){return"The f passed in valueAndGrads(f) must be a function"}),function(t,n){ue(Array.isArray(t)&&t.every(function(s){return s instanceof rn}),function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"}),ue(null==n||n instanceof rn,function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"});var a=P.gradients(function(){return e.apply(void 0,t)},t,n);return null!=n&&z(a.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),ll(a.grads),a}},variable:Zr,variableGrads:cs,version_core:"1.7.0",webgl:ry,where:fs,whereAsync:_h,zeros:sn,zerosLike:Vt});function ws(e,t,n){if(void 0===n&&(n=!1),e.beginPath(),t.slice(1).forEach(function(c,d){var f=c.x,g=c.y,m=t[d];e.moveTo(m.x,m.y),e.lineTo(f,g)}),n){var a=t[t.length-1],s=t[0];if(!a||!s)return;e.moveTo(a.x,a.y),e.lineTo(s.x,s.y)}e.stroke()}var om=function(e,t){return(om=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var s in a)a.hasOwnProperty(s)&&(n[s]=a[s])})(e,t)};function on(e,t){function n(){this.constructor=e}om(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var Yi=function(){return(Yi=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};function Mt(e,t,n,a){return new(n=n||Promise)(function(s,c){function d(m){try{g(a.next(m))}catch(w){c(w)}}function f(m){try{g(a.throw(m))}catch(w){c(w)}}function g(m){m.done?s(m.value):new n(function(w){w(m.value)}).then(d,f)}g((a=a.apply(e,t||[])).next())})}function Nt(e,t){var n,a,s,c,d={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return c={next:f(0),throw:f(1),return:f(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function f(g){return function(m){return function(w){if(n)throw new TypeError("Generator is already executing.");for(;d;)try{if(n=1,a&&(s=2&w[0]?a.return:w[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,w[1])).done)return s;switch(a=0,s&&(w=[2&w[0],s.value]),w[0]){case 0:case 1:s=w;break;case 4:return d.label++,{value:w[1],done:!1};case 5:d.label++,a=w[1],w=[0];continue;case 7:w=d.ops.pop(),d.trys.pop();continue;default:if(!(s=0<(s=d.trys).length&&s[s.length-1])&&(6===w[0]||2===w[0])){d=0;continue}if(3===w[0]&&(!s||w[1]>s[0]&&w[1]<s[3])){d.label=w[1];break}if(6===w[0]&&d.label<s[1]){d.label=s[1],s=w;break}if(s&&d.label<s[2]){d.label=s[2],d.ops.push(w);break}s[2]&&d.ops.pop(),d.trys.pop();continue}w=t.call(e,d)}catch(A){w=[6,A],a=0}finally{n=s=0}if(5&w[0])throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}([g,m])}}}function kc(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),s=0;for(t=0;t<n;t++)for(var c=arguments[t],d=0,f=c.length;d<f;d++,s++)a[s]=c[d];return a}var Cs=(Object.defineProperty(Ac.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(Ac.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Ac.prototype.reverse=function(){return new Ac(1/this.width,1/this.height)},Ac);function Ac(e,t){if(!ks(e)||!ks(t))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:e,height:t}));this._width=e,this._height=t}function Il(e,t){return e instanceof rn&&e.shape.length===t}function sm(e){return Il(e,2)}function Sc(e){return Il(e,3)}function Uo(e){return Il(e,4)}function lm(e){return e%1!=0}function Ad(e){return e%2==0}function Su(e,t){void 0===t&&(t=2);var n=Math.pow(10,t);return Math.floor(e*n)/n}function Sd(e){return e&&e.width&&e.height}function cm(e,t){var n=e.width,a=e.height,s=t/Math.max(a,n);return new Cs(Math.round(n*s),Math.round(a*s))}function Eu(e){return e.reduce(function(t,n){return t.add(n)},new Fn(0,0)).div(new Fn(e.length,e.length))}function Tl(e,t,n){return Array(e).fill(0).map(function(a,s){return t+s*n})}function ks(e){return!!e&&e!==1/0&&e!==-1/0&&!isNaN(e)||0===e}function _u(e){return ks(e)&&0<=e&&e<=1}var sy=Object.freeze({__proto__:null,isTensor:Il,isTensor1D:function(e){return Il(e,1)},isTensor2D:sm,isTensor3D:Sc,isTensor4D:Uo,isFloat:lm,isEven:Ad,round:Su,isDimensions:Sd,computeReshapedDimensions:cm,getCenterPoint:Eu,range:Tl,isValidNumber:ks,isValidProbablitiy:_u}),Fn=(Object.defineProperty(Di.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(Di.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Di.prototype.add=function(e){return new Di(this.x+e.x,this.y+e.y)},Di.prototype.sub=function(e){return new Di(this.x-e.x,this.y-e.y)},Di.prototype.mul=function(e){return new Di(this.x*e.x,this.y*e.y)},Di.prototype.div=function(e){return new Di(this.x/e.x,this.y/e.y)},Di.prototype.abs=function(){return new Di(Math.abs(this.x),Math.abs(this.y))},Di.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},Di.prototype.floor=function(){return new Di(Math.floor(this.x),Math.floor(this.y))},Di);function Di(e,t){this._x=e,this._y=t}var Ja=(Pn.isRect=function(e){return!!e&&[e.x,e.y,e.width,e.height].every(ks)},Pn.assertIsValidBox=function(e,t,n){if(void 0===n&&(n=!1),!Pn.isRect(e))throw new Error(t+" - invalid box: "+JSON.stringify(e)+", expected object with properties x, y, width, height");if(!n&&(e.width<0||e.height<0))throw new Error(t+" - width ("+e.width+") and height ("+e.height+") must be positive numbers")},Object.defineProperty(Pn.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(Pn.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(Pn.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(Pn.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(Pn.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(Pn.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(Pn.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(Pn.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(Pn.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(Pn.prototype,"topLeft",{get:function(){return new Fn(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(Pn.prototype,"topRight",{get:function(){return new Fn(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(Pn.prototype,"bottomLeft",{get:function(){return new Fn(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(Pn.prototype,"bottomRight",{get:function(){return new Fn(this.right,this.bottom)},enumerable:!0,configurable:!0}),Pn.prototype.round=function(){var e=[this.x,this.y,this.width,this.height].map(function(t){return Math.round(t)});return new Pn({x:e[0],y:e[1],width:e[2],height:e[3]})},Pn.prototype.floor=function(){var e=[this.x,this.y,this.width,this.height].map(function(t){return Math.floor(t)});return new Pn({x:e[0],y:e[1],width:e[2],height:e[3]})},Pn.prototype.toSquare=function(){var e=this.x,t=this.y,n=this.width,a=this.height,s=Math.abs(n-a);return n<a&&(e-=s/2,n+=s),a<n&&(t-=s/2,a+=s),new Pn({x:e,y:t,width:n,height:a})},Pn.prototype.rescale=function(e){var t=Sd(e)?e.width:e,n=Sd(e)?e.height:e;return new Pn({x:this.x*t,y:this.y*n,width:this.width*t,height:this.height*n})},Pn.prototype.pad=function(e,t){var n=[this.x-e/2,this.y-t/2,this.width+e,this.height+t];return new Pn({x:n[0],y:n[1],width:n[2],height:n[3]})},Pn.prototype.clipAtImageBorders=function(e,t){var a=this.y,s=this.right,c=this.bottom,d=Math.max(this.x,0),f=Math.max(a,0),m=c-f;return new Pn({x:d,y:f,width:Math.min(s-d,e-d),height:Math.min(m,t-f)}).floor()},Pn.prototype.shift=function(e,t){return new Pn({x:this.x+e,y:this.y+t,width:this.width,height:this.height})},Pn.prototype.padAtBorders=function(e,t){var n=this.width+1,a=this.height+1,s=n,c=a,d=this.left,f=this.top,g=this.right,m=this.bottom;return t<g&&(s=-g+t+n,g=t),e<m&&(c=-m+e+a,m=e),d<1&&(c=2-d,d=1),f<1&&(c=2-f,f=1),{dy:1,edy:c,dx:1,edx:s,y:f,ey:m,x:d,ex:g,w:n,h:a}},Pn.prototype.calibrate=function(e){return new Pn({left:this.left+e.left*this.width,top:this.top+e.top*this.height,right:this.right+e.right*this.width,bottom:this.bottom+e.bottom*this.height}).toSquare().round()},Pn);function Pn(e,t){void 0===t&&(t=!0);var n=e||{},a=[n.left,n.top,n.right,n.bottom].every(ks),s=[n.x,n.y,n.width,n.height].every(ks);if(!s&&!a)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(n));var c=s?[n.x,n.y,n.width,n.height]:[n.left,n.top,n.right-n.left,n.bottom-n.top],d=c[0],f=c[1],g=c[2],m=c[3];Pn.assertIsValidBox({x:d,y:f,width:g,height:m},"Box.constructor",t),this._x=d,this._y=f,this._width=g,this._height=m}var um,Ec=(on(hm,um=Ja),hm);function hm(e,t,n,a,s){return void 0===s&&(s=!1),um.call(this,{left:e,top:t,right:n,bottom:a},s)||this}var Ed=(Object.defineProperty(Qa.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(Qa.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(Qa.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(Qa.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(Qa.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(Qa.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(Qa.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(Qa.prototype,"relativeBox",{get:function(){return new Ja(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),Qa.prototype.forSize=function(e,t){return new Qa(this.score,this.classScore,this.className,this.relativeBox,{width:e,height:t})},Qa);function Qa(e,t,n,a,s){this._imageDims=new Cs(s.width,s.height),this._score=e,this._classScore=t,this._className=n,this._box=new Ja(a).rescale(this._imageDims)}var _d,aa=(on(Iu,_d=Ed),Iu.prototype.forSize=function(e,t){var n=_d.prototype.forSize.call(this,e,t);return new Iu(n.score,n.relativeBox,n.imageDims)},Iu);function Iu(e,t,n){return _d.call(this,e,e,"",t,n)||this}function dm(e,t,n){void 0===n&&(n=!0);var a=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left))*Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top));return n?a/(e.area+t.area-a):a/Math.min(e.area,t.area)}function fm(e){var t=e.map(function(f){return f.x}),n=e.map(function(f){return f.y}),a=t.reduce(function(f,g){return g<f?g:f},1/0),s=n.reduce(function(f,g){return g<f?g:f},1/0),c=t.reduce(function(f,g){return f<g?g:f},0),d=n.reduce(function(f,g){return f<g?g:f},0);return new Ec(a,s,c,d)}function Rl(e,t,n,a){void 0===a&&(a=!0);for(var s=t.map(function(f,g){return{score:f,boxIndex:g}}).sort(function(f,g){return f.score-g.score}).map(function(f){return f.boxIndex}),c=[],d=function(){var f=s.pop();c.push(f);for(var g=s,m=[],w=0;w<g.length;w++)m.push(dm(e[f],e[g[w]],a));s=s.filter(function(O,V){return m[V]<=n})};0<s.length;)d();return c}function Dl(e,t){return ht(function(){var n=t[0],a=t[1],s=t[2],c=Wn(kc(e.shape.slice(0,3),[1]),n),d=Wn(kc(e.shape.slice(0,3),[1]),a),f=Wn(kc(e.shape.slice(0,3),[1]),s),g=vt([c,d,f],3);return Yr(e,g)})}function pm(e,t){return void 0===t&&(t=!1),ht(function(){var n=e.shape.slice(1),a=n[0],s=n[1];if(a===s)return e;function c(T){var M=e.shape.slice();return M[g]=T,Wn(M,0)}var d=Math.abs(a-s),f=Math.round(d*(t?.5:1)),g=s<a?2:1,m=c(f),w=d-m.shape[g],A=[t&&w?c(w):null,e,m].filter(function(T){return!!T}).map(function(T){return T.toFloat()});return vt(A,g)})}function Tu(e){return 1/(1+Math.exp(-e))}var gm,Ru=(on(vm,gm=Ja),vm);function vm(e,t,n,a,s){return void 0===s&&(s=!1),gm.call(this,{x:e,y:t,width:n,height:a},s)||this}var Us=(Object.defineProperty(ma.prototype,"shift",{get:function(){return new Fn(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(ma.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(ma.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(ma.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(ma.prototype,"relativePositions",{get:function(){var e=this;return this._positions.map(function(t){return t.sub(e._shift).div(new Fn(e.imageWidth,e.imageHeight))})},enumerable:!0,configurable:!0}),ma.prototype.forSize=function(e,t){return new this.constructor(this.relativePositions,{width:e,height:t})},ma.prototype.shiftBy=function(e,t){return new this.constructor(this.relativePositions,this._imgDims,new Fn(e,t))},ma.prototype.shiftByPoint=function(e){return this.shiftBy(e.x,e.y)},ma.prototype.align=function(e,t){if(void 0===t&&(t={}),e){var n=e instanceof aa?e.box.floor():new Ja(e);return this.shiftBy(n.x,n.y).align(null,t)}var a=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},t),c=a.minBoxPadding;return a.useDlibAlignment?this.alignDlib():this.alignMinBbox(c)},ma.prototype.alignDlib=function(){function e(w){return s.sub(w).magnitude()}var t=this.getRefPointsForAlignment(),a=t[1],s=t[2],c=(e(t[0])+e(a))/2,d=Math.floor(c/.45),f=Eu(t),g=Math.floor(Math.max(0,f.x-.5*d)),m=Math.floor(Math.max(0,f.y-.43*d));return new Ru(g,m,Math.min(d,this.imageWidth+g),Math.min(d,this.imageHeight+m))},ma.prototype.alignMinBbox=function(e){var t=fm(this.positions);return t.pad(t.width*e,t.height*e)},ma.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},ma);function ma(e,t,n){void 0===n&&(n=new Fn(0,0));var a=t.width,s=t.height;this._imgDims=new Cs(a,s),this._shift=n,this._positions=e.map(function(c){return c.mul(new Fn(a,s)).add(n)})}var Id,mm=(on(Td,Id=Us),Td.prototype.getRefPointsForAlignment=function(){var e=this.positions;return[e[0],e[1],Eu([e[3],e[4]])]},Td);function Td(){return null!==Id&&Id.apply(this,arguments)||this}var Rd,Dd=(on(go,Rd=Us),go.prototype.getJawOutline=function(){return this.positions.slice(0,17)},go.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},go.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},go.prototype.getNose=function(){return this.positions.slice(27,36)},go.prototype.getLeftEye=function(){return this.positions.slice(36,42)},go.prototype.getRightEye=function(){return this.positions.slice(42,48)},go.prototype.getMouth=function(){return this.positions.slice(48,68)},go.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(Eu)},go);function go(){return null!==Rd&&Rd.apply(this,arguments)||this}var Pd=(Object.defineProperty(Du.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(Du.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),Du.prototype.toString=function(e){return void 0===e&&(e=!0),this.label+(e?" ("+Su(this.distance)+")":"")},Du);function Du(e,t){this._label=e,this._distance=t}var xm,Md=(on(Pu,xm=Ja),Pu.assertIsValidLabeledBox=function(e,t){if(Ja.assertIsValidBox(e,t),!ks(e.label))throw new Error(t+" - expected property label ("+e.label+") to be a number")},Object.defineProperty(Pu.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Pu);function Pu(e,t){var n=xm.call(this,e)||this;return n._label=t,n}var _c=(Object.defineProperty(Pl.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(Pl.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),Pl.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(e){return Array.from(e)})}},Pl.fromJSON=function(e){var t=e.descriptors.map(function(n){return new Float32Array(n)});return new Pl(e.label,t)},Pl);function Pl(e,t){if("string"!=typeof e)throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(t)||t.some(function(n){return!(n instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=e,this._descriptors=t}var bm,ei,ly=(on(Ic,bm=Md),Ic.assertIsValidPredictedBox=function(e,t){if(Md.assertIsValidLabeledBox(e,t),!_u(e.score)||!_u(e.classScore))throw new Error(t+" - expected properties score ("+e.score+") and ("+e.classScore+") to be a number between [0, 1]")},Object.defineProperty(Ic.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(Ic.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Ic);function Ic(e,t,n,a){var s=bm.call(this,e,t)||this;return s._score=n,s._classScore=a,s}function Ml(e){return e.detection instanceof aa}function Nl(e,t){return Object.assign({},e,{detection:t})}function ym(){var e=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:e,readFile:function(){throw new Error("readFile - filesystem not available for browser environment")}}}function wm(e){var t="";if(!e)try{e=require("fs")}catch(n){t=n.toString()}return{readFile:e?function(n){return new Promise(function(a,s){e.readFile(n,function(c,d){return c?s(c):a(d)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)}}}function Cm(){var e=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,n=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},a=wm();return Yi({Canvas:e||function(){},CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){},Image:t||function(){},ImageData:global.ImageData||function(){},Video:global.HTMLVideoElement||function(){},createCanvasElement:function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},createImageElement:function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},fetch:n},a)}function km(){return"object"==typeof window&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function Am(){return"object"==typeof global&&"function"==typeof require&&typeof module<"u"&&typeof process<"u"&&!!process.version}function Nd(e){ei=e}function Ld(){km()&&Nd(ym()),Am()&&Nd(Cm())}var qo,Mu,ui={getEnv:function(){if(!ei)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return ei},setEnv:Nd,initialize:Ld,createBrowserEnv:ym,createFileSystem:wm,createNodejsEnv:Cm,monkeyPatch:function(e){if(ei||Ld(),!ei)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=e.Canvas,n=void 0===t?ei.Canvas:t,a=e.Image,s=void 0===a?ei.Image:a;ei.Canvas=n,ei.Image=s,ei.createCanvasElement=e.createCanvasElement||function(){return new n},ei.createImageElement=e.createImageElement||function(){return new s},ei.ImageData=e.ImageData||ei.ImageData,ei.Video=e.Video||ei.Video,ei.fetch=e.fetch||ei.fetch,ei.readFile=e.readFile||ei.readFile},isBrowser:km,isNodejs:Am};function Nu(e){return ui.isNodejs()||"string"!=typeof e?e:document.getElementById(e)}function eo(e){var t=ui.getEnv(),n=t.Canvas;if(e instanceof t.CanvasRenderingContext2D)return e;var a=Nu(e);if(!(a instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var s=a.getContext("2d");if(!s)throw new Error("resolveContext2d - canvas 2d context is null");return s}Ld(),(Mu=qo=qo||{}).TOP_LEFT="TOP_LEFT",Mu.TOP_RIGHT="TOP_RIGHT",Mu.BOTTOM_LEFT="BOTTOM_LEFT",Mu.BOTTOM_RIGHT="BOTTOM_RIGHT";var Fd=function(e){void 0===e&&(e={});var n=e.backgroundColor,a=e.fontColor,s=e.fontSize,c=e.fontStyle,d=e.padding;this.anchorPosition=e.anchorPosition||qo.TOP_LEFT,this.backgroundColor=n||"rgba(0, 0, 0, 0.5)",this.fontColor=a||"rgba(255, 255, 255, 1)",this.fontSize=s||14,this.fontStyle=c||"Georgia",this.padding=d||4},Od=(Ll.prototype.measureWidth=function(e){var t=this.options.padding;return this.text.map(function(n){return e.measureText(n).width}).reduce(function(n,a){return n<a?a:n},0)+2*t},Ll.prototype.measureHeight=function(){var e=this.options;return this.text.length*e.fontSize+2*e.padding},Ll.prototype.getUpperLeft=function(e,t){var n=this.options.anchorPosition,a=n===qo.BOTTOM_RIGHT||n===qo.TOP_RIGHT,s=n===qo.BOTTOM_LEFT||n===qo.BOTTOM_RIGHT,c=this.measureWidth(e),d=this.measureHeight(),f=a?this.anchor.x-c:this.anchor.x,g=s?this.anchor.y-d:this.anchor.y;if(t){var w=t.height;return{x:Math.max(Math.min(f,t.width-c),0),y:Math.max(Math.min(g,w-d),0)}}return{x:f,y:g}},Ll.prototype.draw=function(e){var t=Nu(e),n=eo(t),a=this.options,s=a.backgroundColor,c=a.fontColor,d=a.fontSize,g=a.padding;n.font=d+"px "+a.fontStyle;var m=this.measureWidth(n),w=this.measureHeight();n.fillStyle=s;var A=this.getUpperLeft(n,t);n.fillRect(A.x,A.y,m,w),n.fillStyle=c,this.text.forEach(function(T,M){n.fillText(T,g+A.x,g+A.y+(M+1)*d)})},Ll);function Ll(e,t,n){void 0===n&&(n={}),this.text="string"==typeof e?[e]:e instanceof Ll?e.text:e,this.anchor=t,this.options=new Fd(n)}var Sm=function(e){void 0===e&&(e={});var n=e.lineWidth,a=e.label,s=e.drawLabelOptions;this.boxColor=e.boxColor||"rgba(0, 0, 255, 1)",this.lineWidth=n||2,this.label=a,this.drawLabelOptions=new Fd(Object.assign({},{anchorPosition:qo.BOTTOM_LEFT,backgroundColor:this.boxColor},s))},Em=(_m.prototype.draw=function(e){var t=eo(e),n=this.options,s=n.lineWidth,c=this.box,d=c.x,f=c.y,g=c.width,m=c.height;t.strokeStyle=n.boxColor,t.lineWidth=s,t.strokeRect(d,f,g,m);var w=this.options.label;w&&new Od([w],{x:d-s/2,y:f},this.options.drawLabelOptions).draw(e)},_m);function _m(e,t){void 0===t&&(t={}),this.box=new Ja(e),this.options=new Sm(t)}function Bd(e){var t=ui.getEnv();return e instanceof t.Image&&e.complete||e instanceof t.Video&&3<=e.readyState}function Im(e){return new Promise(function(t,n){if(e instanceof ui.getEnv().Canvas||Bd(e))return t();function a(c){c.currentTarget&&(c.currentTarget.removeEventListener("load",a),c.currentTarget.removeEventListener("error",s),t(c))}function s(c){c.currentTarget&&(c.currentTarget.removeEventListener("load",a),c.currentTarget.removeEventListener("error",s),n(c))}e.addEventListener("load",a),e.addEventListener("error",s)})}function Tm(e){return new Promise(function(t,n){if(!(e instanceof Blob))return n("bufferToImage - expected buf to be of type: Blob");var a=new FileReader;a.onload=function(){if("string"!=typeof a.result)return n("bufferToImage - expected reader.result to be a string, in onload");var s=ui.getEnv().createImageElement();s.onload=function(){return t(s)},s.onerror=n,s.src=a.result},a.onerror=n,a.readAsDataURL(e)})}function Lu(e){var t=ui.getEnv(),a=t.Video;return e instanceof t.Image?new Cs(e.naturalWidth,e.naturalHeight):e instanceof a?new Cs(e.videoWidth,e.videoHeight):new Cs(e.width,e.height)}function Tc(e){var t=e.width,n=e.height,a=(0,ui.getEnv().createCanvasElement)();return a.width=t,a.height=n,a}function Fu(e,t){var n=ui.getEnv().ImageData;if(!(e instanceof n||Bd(e)))throw new Error("createCanvasFromMedia - media has not finished loading yet");var a=t||Lu(e),s=a.width,c=a.height,d=Tc({width:s,height:c});return e instanceof n?eo(d).putImageData(e,0,0):eo(d).drawImage(e,0,0,s,c),d}function Rm(e,t){return Mt(this,void 0,void 0,function(){var n,a,s,c,d,f;return Nt(this,function(g){switch(g.label){case 0:return n=t||ui.getEnv().createCanvasElement(),a=e.shape.slice(Uo(e)?1:0),s=a[0],c=a[1],d=a[2],f=ht(function(){return e.as3D(s,c,d).toInt()}),[4,ku.toPixels(f,n)];case 1:return g.sent(),f.dispose(),[2,n]}})})}function zd(e){var t=ui.getEnv();return e instanceof t.Image||e instanceof t.Canvas||e instanceof t.Video}function Dm(e,t,n){void 0===n&&(n=!1);var a=ui.getEnv(),c=a.Canvas;if(!(e instanceof a.Image||e instanceof c))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var d=Lu(e),f=t/Math.max(d.height,d.width),g=f*d.width,m=f*d.height,w=Tc({width:t,height:t}),A=e instanceof c?e:Fu(e),T=Math.abs(g-m)/2,M=n&&g<m?T:0,O=n&&m<g?T:0;return eo(w).drawImage(A,M,O,g,m),w}var Rc=(Object.defineProperty(oa.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(oa.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(oa.prototype,"isBatchInput",{get:function(){return 1<this.batchSize||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(oa.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(oa.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(oa.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(oa.prototype,"reshapedInputDimensions",{get:function(){var e=this;return Tl(this.batchSize,0,1).map(function(t,n){return e.getReshapedInputDimensions(n)})},enumerable:!0,configurable:!0}),oa.prototype.getInput=function(e){return this.canvases[e]||this.imageTensors[e]},oa.prototype.getInputDimensions=function(e){return this._inputDimensions[e]},oa.prototype.getInputHeight=function(e){return this._inputDimensions[e][0]},oa.prototype.getInputWidth=function(e){return this._inputDimensions[e][1]},oa.prototype.getReshapedInputDimensions=function(e){if("number"!=typeof this.inputSize)throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");return cm({width:this.getInputWidth(e),height:this.getInputHeight(e)},this.inputSize)},oa.prototype.toBatchTensor=function(e,t){var n=this;return void 0===t&&(t=!0),this._inputSize=e,ht(function(){var a=Tl(n.batchSize,0,1).map(function(s){var c=n.getInput(s);if(c instanceof rn){var d=Uo(c)?c:c.expandDims();return(d=pm(d,t)).shape[1]===e&&d.shape[2]===e||(d=bu.resizeBilinear(d,[e,e])),d.as3D(e,e,3)}if(c instanceof ui.getEnv().Canvas)return ku.fromPixels(Dm(c,e,t));throw new Error("toBatchTensor - at batchIdx "+s+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+c)});return li(a.map(function(s){return s.toFloat()})).as4D(n.batchSize,e,e,3)})},oa);function oa(e,t){var n=this;if(void 0===t&&(t=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(e))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+e);this._treatAsBatchInput=t,this._batchSize=e.length,e.forEach(function(a,s){if(Sc(a))return n._imageTensors[s]=a,void(n._inputDimensions[s]=a.shape);if(Uo(a)){var c=a.shape[0];if(1!==c)throw new Error("NetInput - tf.Tensor4D with batchSize "+c+" passed, but not supported in input array");return n._imageTensors[s]=a,void(n._inputDimensions[s]=a.shape.slice(1))}var d=a instanceof ui.getEnv().Canvas?a:Fu(a);n._canvases[s]=d,n._inputDimensions[s]=[d.height,d.width,3]})}function ti(e){return Mt(this,void 0,void 0,function(){var t,n,a;return Nt(this,function(s){switch(s.label){case 0:if(e instanceof Rc)return[2,e];if(!(t=Array.isArray(e)?e:[e]).length)throw new Error("toNetInput - empty array passed as input");return n=function(c){return Array.isArray(e)?" at input index "+c+":":""},(a=t.map(Nu)).forEach(function(c,d){if(!zd(c)&&!Sc(c)&&!Uo(c))throw"string"==typeof t[d]?new Error("toNetInput -"+n(d)+" string passed, but could not resolve HTMLElement for element id "+t[d]):new Error("toNetInput -"+n(d)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(Uo(c)){var f=c.shape[0];if(1!==f)throw new Error("toNetInput -"+n(d)+" tf.Tensor4D with batchSize "+f+" passed, but not supported in input array")}}),[4,Promise.all(a.map(function(c){return zd(c)&&Im(c)}))];case 1:return s.sent(),[2,new Rc(a,Array.isArray(e))]}})})}function Ou(e,t){return Mt(this,void 0,void 0,function(){var n,a,s,c,d,f;return Nt(this,function(g){switch(g.label){case 0:return n=ui.getEnv().Canvas,(a=e)instanceof n?[3,5]:[4,ti(e)];case 1:if(1<(s=g.sent()).batchSize)throw new Error("extractFaces - batchSize > 1 not supported");return(c=s.getInput(0))instanceof n?(d=c,[3,4]):[3,2];case 2:return[4,Rm(c)];case 3:d=g.sent(),g.label=4;case 4:a=d,g.label=5;case 5:return f=eo(a),[2,t.map(function(m){return m instanceof aa?m.forSize(a.width,a.height).box.floor():m}).map(function(m){return m.clipAtImageBorders(a.width,a.height)}).map(function(m){var w=m.x,A=m.y,T=m.width,M=m.height,O=Tc({width:T,height:M});return eo(O).putImageData(f.getImageData(w,A,T,M),0,0),O})]}})})}function Bu(e,t){return Mt(this,void 0,void 0,function(){return Nt(this,function(n){if(!Sc(e)&&!Uo(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Uo(e)&&1<e.shape[0])throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,ht(function(){var a=e.shape.slice(Uo(e)?1:0),s=a[0],c=a[1],d=a[2];return t.map(function(f){return f instanceof aa?f.forSize(c,s).box:f}).map(function(f){return f.clipAtImageBorders(c,s)}).map(function(f){var g=f.x,m=f.y,w=f.width,A=f.height;return Oh(e.as3D(s,c,d),[m,g,0],[A,w,d])})})]})})}function zu(e,t){return Mt(this,void 0,void 0,function(){var n;return Nt(this,function(a){switch(a.label){case 0:return[4,(0,ui.getEnv().fetch)(e,t)];case 1:if(!((n=a.sent()).status<400))throw new Error("failed to fetch: ("+n.status+") "+n.statusText+", from url: "+n.url);return[2,n]}})})}function Pm(e){return Mt(this,void 0,void 0,function(){return Nt(this,function(t){switch(t.label){case 0:return[4,zu(e)];case 1:return[2,t.sent().json()]}})})}function Mm(e,t){var n=t+"-weights_manifest.json";if(!e)return{modelBaseUri:"",manifestUri:n};if("/"===e)return{modelBaseUri:"/",manifestUri:"/"+n};var a=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"",s=(e=e.replace(a,"")).split("/").filter(function(f){return f}),c=e.endsWith(".json")?s[s.length-1]:n,d=a+(e.endsWith(".json")?s.slice(0,s.length-1):s).join("/");return{modelBaseUri:d=e.startsWith("/")?"/"+d:d,manifestUri:"/"===d?"/"+c:d+"/"+c}}function Nm(e,t){return Mt(this,void 0,void 0,function(){var n,s,c;return Nt(this,function(d){switch(d.label){case 0:return n=Mm(e,t),s=n.modelBaseUri,[4,Pm(n.manifestUri)];case 1:return c=d.sent(),[2,dd.loadWeights(c,s)]}})})}var vo=(Object.defineProperty(ni.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(ni.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(ni.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),ni.prototype.getParamFromPath=function(e){var t=this.traversePropertyPath(e);return t.obj[t.objProp]},ni.prototype.reassignParamFromPath=function(e,t){var n=this.traversePropertyPath(e),a=n.obj,s=n.objProp;a[s].dispose(),a[s]=t},ni.prototype.getParamList=function(){var e=this;return this._paramMappings.map(function(t){var n=t.paramPath;return{path:n,tensor:e.getParamFromPath(n)}})},ni.prototype.getTrainableParams=function(){return this.getParamList().filter(function(e){return e.tensor instanceof Ei})},ni.prototype.getFrozenParams=function(){return this.getParamList().filter(function(e){return!(e.tensor instanceof Ei)})},ni.prototype.variable=function(){var e=this;this.getFrozenParams().forEach(function(t){e.reassignParamFromPath(t.path,t.tensor.variable())})},ni.prototype.freeze=function(){var e=this;this.getTrainableParams().forEach(function(t){var n=t.path,a=t.tensor,s=Wt(a.dataSync());a.dispose(),e.reassignParamFromPath(n,s)})},ni.prototype.dispose=function(e){void 0===e&&(e=!0),this.getParamList().forEach(function(t){if(e&&t.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+t.path);t.tensor.dispose()}),this._params=void 0},ni.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(e){return Array.from(e.tensor.dataSync())}).reduce(function(e,t){return e.concat(t)}))},ni.prototype.load=function(e){return Mt(this,void 0,void 0,function(){return Nt(this,function(t){switch(t.label){case 0:return e instanceof Float32Array?(this.extractWeights(e),[2]):[4,this.loadFromUri(e)];case 1:return t.sent(),[2]}})})},ni.prototype.loadFromUri=function(e){return Mt(this,void 0,void 0,function(){var t;return Nt(this,function(n){switch(n.label){case 0:if(e&&"string"!=typeof e)throw new Error(this._name+".loadFromUri - expected model uri");return[4,Nm(e,this.getDefaultModelName())];case 1:return t=n.sent(),this.loadFromWeightMap(t),[2]}})})},ni.prototype.loadFromDisk=function(e){return Mt(this,void 0,void 0,function(){var t,n,a,s,d,f,g,m,w;return Nt(this,function(A){switch(A.label){case 0:if(e&&"string"!=typeof e)throw new Error(this._name+".loadFromDisk - expected model file path");return t=ui.getEnv().readFile,n=Mm(e,this.getDefaultModelName()),a=n.manifestUri,s=n.modelBaseUri,d=dd.weightsLoaderFactory(function(T){return Promise.all(T.map(function(M){return t(M).then(function(O){return O.buffer})}))}),m=(g=JSON).parse,[4,t(a)];case 1:return f=m.apply(g,[A.sent().toString()]),[4,d(f,s)];case 2:return w=A.sent(),this.loadFromWeightMap(w),[2]}})})},ni.prototype.loadFromWeightMap=function(e){var t=this.extractParamsFromWeigthMap(e),a=t.params;this._paramMappings=t.paramMappings,this._params=a},ni.prototype.extractWeights=function(e){var t=this.extractParams(e),a=t.params;this._paramMappings=t.paramMappings,this._params=a},ni.prototype.traversePropertyPath=function(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var t=e.split("/").reduce(function(s,c){if(!s.nextObj.hasOwnProperty(c))throw new Error("traversePropertyPath - object does not have property "+c+", for path "+e);return{obj:s.nextObj,objProp:c,nextObj:s.nextObj[c]}},{nextObj:this.params}),n=t.obj,a=t.objProp;if(!(n&&a&&n[a]instanceof rn))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+e);return{obj:n,objProp:a}},ni);function ni(e){this._name=e,this._params=void 0,this._paramMappings=[]}function xa(e,t,n){return ht(function(){var a=fu(e,t.depthwise_filter,t.pointwise_filter,n,"same");return xn(a,t.bias)})}function Wd(e,t,n){return void 0===n&&(n=!1),ht(function(){var a=br(n?xn(ga(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):xa(e,t.conv0,[2,2])),s=xa(a,t.conv1,[1,1]),c=xa(br(xn(a,s)),t.conv2,[1,1]);return br(xn(a,xn(s,c)))})}function Wu(e,t,n,a){return void 0===n&&(n=!1),void 0===a&&(a=!0),ht(function(){var s=br(n?xn(ga(e,t.conv0.filters,a?[2,2]:[1,1],"same"),t.conv0.bias):xa(e,t.conv0,a?[2,2]:[1,1])),c=xa(s,t.conv1,[1,1]),d=xa(br(xn(s,c)),t.conv2,[1,1]),f=xa(br(xn(s,xn(c,d))),t.conv3,[1,1]);return br(xn(s,xn(c,xn(d,f))))})}function to(e,t,n,a){return void 0===n&&(n="same"),void 0===a&&(a=!1),ht(function(){var s=xn(ga(e,t.filters,[1,1],n),t.bias);return a?br(s):s})}function $o(e,t){Object.keys(e).forEach(function(n){t.some(function(a){return a.originalPath===n})||e[n].dispose()})}function Hu(e,t){return function(n,a,s,c){var d=er(e(n*a*s*s),[s,s,n,a]),f=tn(e(a));return t.push({paramPath:c+"/filters"},{paramPath:c+"/bias"}),{filters:d,bias:f}}}function Hd(e,t){return function(n,a,s){var c=vi(e(n*a),[n,a]),d=tn(e(a));return t.push({paramPath:s+"/weights"},{paramPath:s+"/bias"}),{weights:c,bias:d}}}var Lm=function(e,t,n){this.depthwise_filter=e,this.pointwise_filter=t,this.bias=n};function Xd(e,t){return function(n,a,s){var c=er(e(9*n),[3,3,n,1]),d=er(e(n*a),[1,1,n,a]),f=tn(e(a));return t.push({paramPath:s+"/depthwise_filter"},{paramPath:s+"/pointwise_filter"},{paramPath:s+"/bias"}),new Lm(c,d,f)}}function Gd(e){return function(t){var n=e(t+"/depthwise_filter",4),a=e(t+"/pointwise_filter",4),s=e(t+"/bias",1);return new Lm(n,a,s)}}function As(e,t){return function(n,a,s){var c=e[n];if(!Il(c,a))throw new Error("expected weightMap["+n+"] to be a Tensor"+a+"D, instead have "+c);return t.push({originalPath:n,paramPath:s||n}),c}}function Ko(e){var t=e;return{extractWeights:function(n){var a=t.slice(0,n);return t=t.slice(n),a},getRemainingWeights:function(){return t}}}function Fm(e,t){var n=Hu(e,t),a=Xd(e,t);function s(c,d,f,g){return void 0===g&&(g=!1),{conv0:g?n(c,d,3,f+"/conv0"):a(c,d,f+"/conv0"),conv1:a(d,d,f+"/conv1"),conv2:a(d,d,f+"/conv2")}}return{extractDenseBlock3Params:s,extractDenseBlock4Params:function(c,d,f,g){void 0===g&&(g=!1);var m=s(c,d,f,g);return{conv0:m.conv0,conv1:m.conv1,conv2:m.conv2,conv3:a(d,d,f+"/conv3")}}}}function Om(e){return function(t){return{filters:e(t+"/filters",4),bias:e(t+"/bias",1)}}}function Bm(e,t){var n=As(e,t),a=Om(n),s=Gd(n);return{extractDenseBlock3Params:function(c,d){return void 0===d&&(d=!1),{conv0:d?a(c+"/conv0"):s(c+"/conv0"),conv1:s(c+"/conv1"),conv2:s(c+"/conv2")}},extractDenseBlock4Params:function(c,d){return void 0===d&&(d=!1),{conv0:d?a(c+"/conv0"):s(c+"/conv0"),conv1:s(c+"/conv1"),conv2:s(c+"/conv2"),conv3:s(c+"/conv3")}}}}var zm,Wm=(on(qs,zm=vo),qs.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("FaceFeatureExtractor - load model before inference");return ht(function(){var n=Wu(Dl(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(nt(255)),t.dense0,!0);return n=Wu(n=Wu(n=Wu(n,t.dense1),t.dense2),t.dense3),wl(n,[7,7],[2,2],"valid")})},qs.prototype.forward=function(e){return Mt(this,void 0,void 0,function(){var t;return Nt(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,ti(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},qs.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},qs.prototype.extractParamsFromWeigthMap=function(e){return s={dense0:(a=Bm(t=e,n=[]).extractDenseBlock4Params)("dense0",!0),dense1:a("dense1"),dense2:a("dense2"),dense3:a("dense3")},$o(t,n),{params:s,paramMappings:n};var t,n,a,s},qs.prototype.extractParams=function(e){return function(t){var n=[],a=Ko(t),c=a.getRemainingWeights,d=Fm(a.extractWeights,n).extractDenseBlock4Params,f=d(3,32,"dense0",!0),g=d(32,64,"dense1"),m=d(64,128,"dense2"),w=d(128,256,"dense3");if(0!==c().length)throw new Error("weights remaing after extract: "+c().length);return{paramMappings:n,params:{dense0:f,dense1:g,dense2:m,dense3:w}}}(e)},qs);function qs(){return zm.call(this,"FaceFeatureExtractor")||this}function mo(e,t){return ht(function(){return xn(pc(e,t.weights),t.bias)})}function Hm(e){var t={},n={};return Object.keys(e).forEach(function(a){(a.startsWith("fc")?n:t)[a]=e[a]}),{featureExtractorMap:t,classifierMap:n}}var Vd,Xm=(on(Zo,Vd=vo),Object.defineProperty(Zo.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),Zo.prototype.runNet=function(e){var t=this,n=this.params;if(!n)throw new Error(this._name+" - load model before inference");return ht(function(){var a=e instanceof Rc?t.faceFeatureExtractor.forwardInput(e):e;return mo(a.as2D(a.shape[0],-1),n.fc)})},Zo.prototype.dispose=function(e){void 0===e&&(e=!0),this.faceFeatureExtractor.dispose(e),Vd.prototype.dispose.call(this,e)},Zo.prototype.loadClassifierParams=function(e){var t=this.extractClassifierParams(e),a=t.paramMappings;this._params=t.params,this._paramMappings=a},Zo.prototype.extractClassifierParams=function(e){return function(t,n,a){var s=[],c=Ko(t),f=c.getRemainingWeights,g=Hd(c.extractWeights,s)(n,a,"fc");if(0!==f().length)throw new Error("weights remaing after extract: "+f().length);return{paramMappings:s,params:{fc:g}}}(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},Zo.prototype.extractParamsFromWeigthMap=function(e){var s,d,f,g,t=Hm(e),a=t.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(t.featureExtractorMap),g={fc:{weights:(f=As(s=a,d=[]))("fc/weights",2),bias:f("fc/bias",1)}},$o(s,d),{params:g,paramMappings:d}},Zo.prototype.extractParams=function(e){var t=this.getClassifierChannelsIn(),n=this.getClassifierChannelsOut(),a=n*t+n,s=e.slice(0,e.length-a),c=e.slice(e.length-a);return this.faceFeatureExtractor.extractWeights(s),this.extractClassifierParams(c)},Zo);function Zo(e,t){var n=Vd.call(this,e)||this;return n._faceFeatureExtractor=t,n}var Yd=["neutral","happy","sad","angry","fearful","disgusted","surprised"],Xu=(Gm.prototype.asSortedArray=function(){var e=this;return Yd.map(function(t){return{expression:t,probability:e[t]}}).sort(function(t,n){return n.probability-t.probability})},Gm);function Gm(e){var t=this;if(7!==e.length)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+e.length);Yd.forEach(function(n,a){t[n]=e[a]})}var Vm,Ym=(on(Ss,Vm=Xm),Ss.prototype.forwardInput=function(e){var t=this;return ht(function(){return _a(t.runNet(e))})},Ss.prototype.forward=function(e){return Mt(this,void 0,void 0,function(){var t;return Nt(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,ti(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},Ss.prototype.predictExpressions=function(e){return Mt(this,void 0,void 0,function(){var t,n,a,s,c=this;return Nt(this,function(d){switch(d.label){case 0:return[4,ti(e)];case 1:return t=d.sent(),[4,this.forwardInput(t)];case 2:return n=d.sent(),[4,Promise.all(_r(n).map(function(f){return Mt(c,void 0,void 0,function(){var g;return Nt(this,function(m){switch(m.label){case 0:return[4,f.data()];case 1:return g=m.sent(),f.dispose(),[2,g]}})})}))];case 3:return a=d.sent(),n.dispose(),s=a.map(function(f){return new Xu(f)}),[2,t.isBatchInput?s:s[0]]}})})},Ss.prototype.getDefaultModelName=function(){return"face_expression_model"},Ss.prototype.getClassifierChannelsIn=function(){return 256},Ss.prototype.getClassifierChannelsOut=function(){return 7},Ss);function Ss(e){return void 0===e&&(e=new Wm),Vm.call(this,"FaceExpressionNet",e)||this}function jm(e){return e.expressions instanceof Xu}function jd(e,t){return Object.assign({},e,{expressions:t})}function Gu(e){return Ml(e)&&e.landmarks instanceof Us&&e.unshiftedLandmarks instanceof Us&&e.alignedRect instanceof aa}function Dc(e,t){var n=e.detection.box,a=t.shiftBy(n.x,n.y),s=a.align(),c=e.detection.imageDims,d={landmarks:a,unshiftedLandmarks:t,alignedRect:new aa(e.detection.score,s.rescale(c.reverse()),c)};return Object.assign({},e,d)}var Um=function(e){void 0===e&&(e={});var t=e.drawLines,a=e.drawPoints,s=void 0===a||a,c=e.lineWidth,d=e.lineColor,f=e.pointSize,g=e.pointColor;this.drawLines=void 0===t||t,this.drawPoints=s,this.lineWidth=c||1,this.pointSize=f||2,this.lineColor=d||"rgba(0, 255, 255, 1)",this.pointColor=g||"rgba(255, 0, 255, 1)"},qm=($m.prototype.draw=function(e){var t=eo(e),n=this.options,s=n.drawPoints,c=n.lineWidth,f=n.pointSize,g=n.pointColor;n.drawLines&&this.faceLandmarks instanceof Dd&&(t.strokeStyle=n.lineColor,t.lineWidth=c,ws(t,this.faceLandmarks.getJawOutline()),ws(t,this.faceLandmarks.getLeftEyeBrow()),ws(t,this.faceLandmarks.getRightEyeBrow()),ws(t,this.faceLandmarks.getNose()),ws(t,this.faceLandmarks.getLeftEye(),!0),ws(t,this.faceLandmarks.getRightEye(),!0),ws(t,this.faceLandmarks.getMouth(),!0)),s&&(t.strokeStyle=g,t.fillStyle=g,this.faceLandmarks.positions.forEach(function(m){t.beginPath(),t.arc(m.x,m.y,f,0,2*Math.PI),t.fill()}))},$m);function $m(e,t){void 0===t&&(t={}),this.faceLandmarks=e,this.options=new Um(t)}var cy=Object.freeze({__proto__:null,drawContour:ws,drawDetections:function(e,t){(Array.isArray(t)?t:[t]).forEach(function(n){var a=n instanceof aa?n.score:Ml(n)?n.detection.score:void 0,s=n instanceof aa?n.box:Ml(n)?n.detection.box:new Ja(n),c=a?""+Su(a):void 0;new Em(s,{label:c}).draw(e)})},drawFaceExpressions:function(e,t,n,a){void 0===n&&(n=.1),(Array.isArray(t)?t:[t]).forEach(function(s){var c=s instanceof Xu?s:jm(s)?s.expressions:void 0;if(!c)throw new Error("drawFaceExpressions - expected faceExpressions to be FaceExpressions | WithFaceExpressions<{}> or array thereof");var d=c.asSortedArray().filter(function(g){return g.probability>n}),f=Ml(s)?s.detection.box.bottomLeft:a||new Fn(0,0);new Od(d.map(function(g){return g.expression+" ("+Su(g.probability)+")"}),f).draw(e)})},DrawBoxOptions:Sm,DrawBox:Em,DrawFaceLandmarksOptions:Um,DrawFaceLandmarks:qm,drawFaceLandmarks:function(e,t){(Array.isArray(t)?t:[t]).forEach(function(n){var a=n instanceof Us?n:Gu(n)?n.landmarks:void 0;if(!a)throw new Error("drawFaceLandmarks - expected faceExpressions to be FaceLandmarks | WithFaceLandmarks<WithFaceDetection<{}>> or array thereof");new qm(a).draw(e)})},get AnchorPosition(){return qo},DrawTextFieldOptions:Fd,DrawTextField:Od});function Km(e,t,n){return xn(ga(e,t.filters,n,"same"),t.bias)}function Ud(e,t,n){void 0===n&&(n=!0);var a=n?br(e):e;return a=xa(a,t.separable_conv0,[1,1]),a=xa(br(a),t.separable_conv1,[1,1]),a=Qr(a,[3,3],[2,2],"same"),xn(a,Km(e,t.expansion_conv,[2,2]))}var Zm,Jm,dy=(on($s,Zm=vo),$s.prototype.forwardInput=function(e){var t=this,n=this.params;if(!n)throw new Error("TinyXception - load model before inference");return ht(function(){var a=Dl(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(nt(256)),s=br(Km(a,n.entry_flow.conv_in,[2,2]));return s=Ud(s=Ud(s,n.entry_flow.reduction_block_0,!1),n.entry_flow.reduction_block_1),Tl(t._numMainBlocks,0,1).forEach(function(c){var d,f,g;f=n.middle_flow["main_block_"+c],g=xa(br(d=s),f.separable_conv0,[1,1]),g=xa(br(g),f.separable_conv1,[1,1]),g=xa(br(g),f.separable_conv2,[1,1]),s=xn(g,d)}),s=Ud(s,n.exit_flow.reduction_block),s=br(xa(s,n.exit_flow.separable_conv,[1,1]))})},$s.prototype.forward=function(e){return Mt(this,void 0,void 0,function(){var t;return Nt(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,ti(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},$s.prototype.getDefaultModelName=function(){return"tiny_xception_model"},$s.prototype.extractParamsFromWeigthMap=function(e){return function hy(e,t){var M,O,V,n=[],a=(M=As(e,n),O=Om(M),V=Gd(M),{extractConvParams:O,extractSeparableConvParams:V,extractReductionBlockParams:function(H){return{separable_conv0:V(H+"/separable_conv0"),separable_conv1:V(H+"/separable_conv1"),expansion_conv:O(H+"/expansion_conv")}},extractMainBlockParams:function(H){return{separable_conv0:V(H+"/separable_conv0"),separable_conv1:V(H+"/separable_conv1"),separable_conv2:V(H+"/separable_conv2")}}}),c=a.extractSeparableConvParams,d=a.extractReductionBlockParams,f=a.extractMainBlockParams,g={conv_in:(0,a.extractConvParams)("entry_flow/conv_in"),reduction_block_0:d("entry_flow/reduction_block_0"),reduction_block_1:d("entry_flow/reduction_block_1")},m={};Tl(t,0,1).forEach(function(A){m["main_block_"+A]=f("middle_flow/main_block_"+A)});var w={reduction_block:d("exit_flow/reduction_block"),separable_conv:c("exit_flow/separable_conv")};return $o(e,n),{params:{entry_flow:g,middle_flow:m,exit_flow:w},paramMappings:n}}(e,this._numMainBlocks)},$s.prototype.extractParams=function(e){return function uy(e,t){var O,V,H,X,n=[],a=Ko(e),c=a.getRemainingWeights,d=(H=Hu(O=a.extractWeights,V=n),X=Xd(O,V),{extractConvParams:H,extractSeparableConvParams:X,extractReductionBlockParams:function($,ee,re){return{separable_conv0:X($,ee,re+"/separable_conv0"),separable_conv1:X(ee,ee,re+"/separable_conv1"),expansion_conv:H($,ee,1,re+"/expansion_conv")}},extractMainBlockParams:function($,ee){return{separable_conv0:X($,$,ee+"/separable_conv0"),separable_conv1:X($,$,ee+"/separable_conv1"),separable_conv2:X($,$,ee+"/separable_conv2")}}}),g=d.extractSeparableConvParams,m=d.extractReductionBlockParams,w=d.extractMainBlockParams,A={conv_in:(0,d.extractConvParams)(3,32,3,"entry_flow/conv_in"),reduction_block_0:m(32,64,"entry_flow/reduction_block_0"),reduction_block_1:m(64,128,"entry_flow/reduction_block_1")},T={};Tl(t,0,1).forEach(function(O){T["main_block_"+O]=w(128,"middle_flow/main_block_"+O)});var M={reduction_block:m(128,256,"exit_flow/reduction_block"),separable_conv:g(256,512,"exit_flow/separable_conv")};if(0!==c().length)throw new Error("weights remaing after extract: "+c().length);return{paramMappings:n,params:{entry_flow:A,middle_flow:T,exit_flow:M}}}(e,this._numMainBlocks)},$s);function $s(e){var t=Zm.call(this,"TinyXception")||this;return t._numMainBlocks=e,t}(Jm=Ce.Gender||(Ce.Gender={})).FEMALE="female",Jm.MALE="male";var qd,Qm=(on(ba,qd=vo),Object.defineProperty(ba.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),ba.prototype.runNet=function(e){var t=this,n=this.params;if(!n)throw new Error(this._name+" - load model before inference");return ht(function(){var a=e instanceof Rc?t.faceFeatureExtractor.forwardInput(e):e,s=wl(a,[7,7],[2,2],"valid").as2D(a.shape[0],-1);return{age:mo(s,n.fc.age).as1D(),gender:mo(s,n.fc.gender)}})},ba.prototype.forwardInput=function(e){var t=this;return ht(function(){var n=t.runNet(e);return{age:n.age,gender:_a(n.gender)}})},ba.prototype.forward=function(e){return Mt(this,void 0,void 0,function(){var t;return Nt(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,ti(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},ba.prototype.predictAgeAndGender=function(e){return Mt(this,void 0,void 0,function(){var t,n,a,s,c,d,f=this;return Nt(this,function(g){switch(g.label){case 0:return[4,ti(e)];case 1:return t=g.sent(),[4,this.forwardInput(t)];case 2:return n=g.sent(),a=_r(n.age),s=_r(n.gender),c=a.map(function(m,w){return{ageTensor:m,genderTensor:s[w]}}),[4,Promise.all(c.map(function(m){var w=m.ageTensor,A=m.genderTensor;return Mt(f,void 0,void 0,function(){var T,M,O,V,H;return Nt(this,function(X){switch(X.label){case 0:return[4,w.data()];case 1:return T=X.sent()[0],[4,A.data()];case 2:return M=X.sent()[0],V=(O=.5<M)?Ce.Gender.MALE:Ce.Gender.FEMALE,H=O?M:1-M,w.dispose(),A.dispose(),[2,{age:T,gender:V,genderProbability:H}]}})})}))];case 3:return d=g.sent(),n.age.dispose(),n.gender.dispose(),[2,t.isBatchInput?d:d[0]]}})})},ba.prototype.getDefaultModelName=function(){return"age_gender_model"},ba.prototype.dispose=function(e){void 0===e&&(e=!0),this.faceFeatureExtractor.dispose(e),qd.prototype.dispose.call(this,e)},ba.prototype.loadClassifierParams=function(e){var t=this.extractClassifierParams(e),a=t.paramMappings;this._params=t.params,this._paramMappings=a},ba.prototype.extractClassifierParams=function(e){return function(t){var n=[],a=Ko(t),c=a.getRemainingWeights,d=Hd(a.extractWeights,n),f=d(512,1,"fc/age"),g=d(512,2,"fc/gender");if(0!==c().length)throw new Error("weights remaing after extract: "+c().length);return{paramMappings:n,params:{fc:{age:f,gender:g}}}}(e)},ba.prototype.extractParamsFromWeigthMap=function(e){var t=Hm(e),a=t.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(t.featureExtractorMap),function(s){var c=[],d=As(s,c);function f(m){return{weights:d(m+"/weights",2),bias:d(m+"/bias",1)}}var g={fc:{age:f("fc/age"),gender:f("fc/gender")}};return $o(s,c),{params:g,paramMappings:c}}(a)},ba.prototype.extractParams=function(e){var t=e.slice(0,e.length-1539),n=e.slice(e.length-1539);return this.faceFeatureExtractor.extractWeights(t),this.extractClassifierParams(n)},ba);function ba(e){void 0===e&&(e=new dy(2));var t=qd.call(this,"AgeGenderNet")||this;return t._faceFeatureExtractor=e,t}var $d,ex=(on(Ks,$d=Xm),Ks.prototype.postProcess=function(e,t,n){var a=n.map(function(c){var d=c.width,f=c.height,g=t/Math.max(f,d);return{width:d*g,height:f*g}}),s=a.length;return ht(function(){function c(f,g){return li([Wn([68],f),Wn([68],g)],1).as2D(1,136).as1D()}function d(f,g){var m=a[f],w=m.width,A=m.height;return g(w,A)?Math.abs(w-A)/2:0}return e.mul(Wn([s,136],t)).sub(li(Array.from(Array(s),function(f,g){return c(d(g,function(w,A){return w<A}),d(g,function(w,A){return A<w}))}))).div(li(Array.from(Array(s),function(f,g){return c(a[g].width,a[g].height)})))})},Ks.prototype.forwardInput=function(e){var t=this;return ht(function(){var n=t.runNet(e);return t.postProcess(n,e.inputSize,e.inputDimensions.map(function(a){return{height:a[0],width:a[1]}}))})},Ks.prototype.forward=function(e){return Mt(this,void 0,void 0,function(){var t;return Nt(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,ti(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},Ks.prototype.detectLandmarks=function(e){return Mt(this,void 0,void 0,function(){var t,n,a,s=this;return Nt(this,function(c){switch(c.label){case 0:return[4,ti(e)];case 1:return t=c.sent(),n=ht(function(){return _r(s.forwardInput(t))}),[4,Promise.all(n.map(function(d,f){return Mt(s,void 0,void 0,function(){var g,m,w,A,T;return Nt(this,function(M){switch(M.label){case 0:return w=(m=Array).from,[4,d.data()];case 1:return g=w.apply(m,[M.sent()]),A=g.filter(function(O,V){return Ad(V)}),T=g.filter(function(O,V){return!Ad(V)}),[2,new Dd(Array(68).fill(0).map(function(O,V){return new Fn(A[V],T[V])}),{height:t.getInputHeight(f),width:t.getInputWidth(f)})]}})})}))];case 2:return a=c.sent(),n.forEach(function(d){return d.dispose()}),[2,t.isBatchInput?a:a[0]]}})})},Ks.prototype.getClassifierChannelsOut=function(){return 136},Ks);function Ks(){return null!==$d&&$d.apply(this,arguments)||this}var tx,Kd=(on(Vu,tx=ex),Vu.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},Vu.prototype.getClassifierChannelsIn=function(){return 256},Vu);function Vu(e){return void 0===e&&(e=new Wm),tx.call(this,"FaceLandmark68Net",e)||this}var nx,fy=(on(Zs,nx=vo),Zs.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("TinyFaceFeatureExtractor - load model before inference");return ht(function(){var n=Wd(Dl(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(nt(255)),t.dense0,!0);return n=Wd(n=Wd(n,t.dense1),t.dense2),wl(n,[14,14],[2,2],"valid")})},Zs.prototype.forward=function(e){return Mt(this,void 0,void 0,function(){var t;return Nt(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,ti(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},Zs.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},Zs.prototype.extractParamsFromWeigthMap=function(e){return s={dense0:(a=Bm(t=e,n=[]).extractDenseBlock3Params)("dense0",!0),dense1:a("dense1"),dense2:a("dense2")},$o(t,n),{params:s,paramMappings:n};var t,n,a,s},Zs.prototype.extractParams=function(e){return function(t){var n=[],a=Ko(t),c=a.getRemainingWeights,d=Fm(a.extractWeights,n).extractDenseBlock3Params,f=d(3,32,"dense0",!0),g=d(32,64,"dense1"),m=d(64,128,"dense2");if(0!==c().length)throw new Error("weights remaing after extract: "+c().length);return{paramMappings:n,params:{dense0:f,dense1:g,dense2:m}}}(e)},Zs);function Zs(){return nx.call(this,"TinyFaceFeatureExtractor")||this}var rx,ix=(on(Yu,rx=ex),Yu.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},Yu.prototype.getClassifierChannelsIn=function(){return 128},Yu);function Yu(e){return void 0===e&&(e=new fy),rx.call(this,"FaceLandmark68TinyNet",e)||this}var Zd,py=(on(ax,Zd=Kd),ax);function ax(){return null!==Zd&&Zd.apply(this,arguments)||this}function Jd(e,t,n,a,s){void 0===s&&(s="same");var m,w,c=t.conv,f=c.bias,g=ga(e,c.filters,n,s);return m=g=xn(g,f),g=xn(yi(m,(w=t.scale).weights),w.biases),a?br(g):g}function ox(e,t){return Jd(e,t,[1,1],!1)}function sx(e,t){return Jd(e,t,[2,2],!0,"valid")}function xo(e,t){var n=Jd(e,t.conv1,[1,1],!0);return n=ox(n,t.conv2),n=xn(n,e),br(n)}function ju(e,t){var n=sx(e,t.conv1);n=ox(n,t.conv2);var a=wl(e,2,2,"valid"),s=sn(a.shape),c=a.shape[3]!==n.shape[3];if(a.shape[1]!==n.shape[1]||a.shape[2]!==n.shape[2]){var d=kc(n.shape);d[1]=1;var f=sn(d),g=kc((n=vt([n,f],1)).shape);g[2]=1;var m=sn(g);n=vt([n,m],2)}return a=c?vt([a,s],3):a,n=xn(a,n),br(n)}var lx,Qd=(on(Es,lx=vo),Es.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("FaceRecognitionNet - load model before inference");return ht(function(){var n=sx(Dl(e.toBatchTensor(150,!0).toFloat(),[122.782,117.001,104.298]).div(nt(256)),t.conv32_down),a=(n=ju(n=xo(n=xo(n=ju(n=xo(n=xo(n=ju(n=xo(n=xo(n=xo(n=ju(n=xo(n=xo(n=xo(n=Qr(n,3,2,"valid"),t.conv32_1),t.conv32_2),t.conv32_3),t.conv64_down),t.conv64_1),t.conv64_2),t.conv64_3),t.conv128_down),t.conv128_1),t.conv128_2),t.conv256_down),t.conv256_1),t.conv256_2),t.conv256_down_out)).mean([1,2]);return pc(a,t.fc)})},Es.prototype.forward=function(e){return Mt(this,void 0,void 0,function(){var t;return Nt(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,ti(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},Es.prototype.computeFaceDescriptor=function(e){return Mt(this,void 0,void 0,function(){var t,n,a,s=this;return Nt(this,function(c){switch(c.label){case 0:return[4,ti(e)];case 1:return t=c.sent(),n=ht(function(){return _r(s.forwardInput(t))}),[4,Promise.all(n.map(function(d){return d.data()}))];case 2:return a=c.sent(),n.forEach(function(d){return d.dispose()}),[2,t.isBatchInput?a:a[0]]}})})},Es.prototype.getDefaultModelName=function(){return"face_recognition_model"},Es.prototype.extractParamsFromWeigthMap=function(e){return function(t){var n=[],a=function vy(e,t){var n=As(e,t);function a(s){return{conv:{filters:n(s+"/conv/filters",4),bias:n(s+"/conv/bias",1)},scale:(c=s,{weights:n(c+"/scale/weights",1),biases:n(c+"/scale/biases",1)})};var c}return{extractConvLayerParams:a,extractResidualLayerParams:function(s){return{conv1:a(s+"/conv1"),conv2:a(s+"/conv2")}}}}(t,n),c=a.extractResidualLayerParams,d=(0,a.extractConvLayerParams)("conv32_down"),f=c("conv32_1"),g=c("conv32_2"),m=c("conv32_3"),w=c("conv64_down"),A=c("conv64_1"),T=c("conv64_2"),M=c("conv64_3"),O=c("conv128_down"),V=c("conv128_1"),H=c("conv128_2"),X=c("conv256_down"),$=c("conv256_1"),ee=c("conv256_2"),re=c("conv256_down_out"),te=t.fc;if(n.push({originalPath:"fc",paramPath:"fc"}),!sm(te))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+te);var le={conv32_down:d,conv32_1:f,conv32_2:g,conv32_3:m,conv64_down:w,conv64_1:A,conv64_2:T,conv64_3:M,conv128_down:O,conv128_1:V,conv128_2:H,conv256_down:X,conv256_1:$,conv256_2:ee,conv256_down_out:re,fc:te};return $o(t,n),{params:le,paramMappings:n}}(e)},Es.prototype.extractParams=function(e){return function(t){var n=Ko(t),a=n.extractWeights,s=n.getRemainingWeights,c=[],d=function gy(e,t){function n(s,c,d,f){var g=function(w,A,T){var M=e(w),O=M.length/(A*T*T);if(lm(O))throw new Error("depth has to be an integer: "+O+", weights.length: "+M.length+", numFilters: "+A+", filterSize: "+T);return ht(function(){return zo(er(M,[A,O,T,T]),[2,3,1,0])})}(s,c,d),m=tn(e(c));return t.push({paramPath:f+"/filters"},{paramPath:f+"/bias"}),{filters:g,bias:m}}function a(s,c,d,f){return{conv:n(s,c,d,f+"/conv"),scale:(g=c,m=f+"/scale",w=tn(e(g)),A=tn(e(g)),t.push({paramPath:m+"/weights"},{paramPath:m+"/biases"}),{weights:w,biases:A})};var g,m,w,A}return{extractConvLayerParams:a,extractResidualLayerParams:function(s,c,d,f,g){return void 0===g&&(g=!1),{conv1:a((g?.5:1)*s,c,d,f+"/conv1"),conv2:a(s,c,d,f+"/conv2")}}}}(a,c),g=d.extractResidualLayerParams,m=(0,d.extractConvLayerParams)(4704,32,7,"conv32_down"),w=g(9216,32,3,"conv32_1"),A=g(9216,32,3,"conv32_2"),T=g(9216,32,3,"conv32_3"),M=g(36864,64,3,"conv64_down",!0),O=g(36864,64,3,"conv64_1"),V=g(36864,64,3,"conv64_2"),H=g(36864,64,3,"conv64_3"),X=g(147456,128,3,"conv128_down",!0),$=g(147456,128,3,"conv128_1"),ee=g(147456,128,3,"conv128_2"),re=g(589824,256,3,"conv256_down",!0),te=g(589824,256,3,"conv256_1"),le=g(589824,256,3,"conv256_2"),se=g(589824,256,3,"conv256_down_out"),ie=ht(function(){return zo(vi(a(32768),[128,256]),[1,0])});if(c.push({paramPath:"fc"}),0!==s().length)throw new Error("weights remaing after extract: "+s().length);return{params:{conv32_down:m,conv32_1:w,conv32_2:A,conv32_3:T,conv64_down:M,conv64_1:O,conv64_2:V,conv64_3:H,conv128_down:X,conv128_1:$,conv128_2:ee,conv256_down:re,conv256_1:te,conv256_2:le,conv256_down_out:se,fc:ie},paramMappings:c}}(e)},Es);function Es(){return lx.call(this,"FaceRecognitionNet")||this}function ef(e,t){return Object.assign({},e,{descriptor:t})}function tf(e,t){return Object.assign({},e,{age:t})}function nf(e,t,n){return Object.assign({},e,{gender:t,genderProbability:n})}var Uu=(Object.defineProperty(Fl.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(Fl.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(Fl.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(Fl.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(Fl.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),Fl);function Fl(e){var t=void 0===e?{}:e,n=t.minFaceSize,a=t.scaleFactor,s=t.maxNumScales,c=t.scoreThresholds,d=t.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=n||20,this._scaleFactor=a||.709,this._maxNumScales=s||10,this._scoreThresholds=c||[.6,.7,.7],this._scaleSteps=d,"number"!=typeof this._minFaceSize||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if("number"!=typeof this._scaleFactor||this._scaleFactor<=0||1<=this._scaleFactor)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if("number"!=typeof this._maxNumScales||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||3!==this._scoreThresholds.length||this._scoreThresholds.some(function(f){return"number"!=typeof f}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(f){return"number"!=typeof f})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}function bo(e,t,n){return ht(function(){var a=ga(e,t.filters,n,"same");return a=xn(a,t.batch_norm_offset),su(a,0,6)})}function wy(e,t,n){var a=e.arraySync(),s=Math.min(a[t][0],a[t][2]),c=Math.min(a[t][1],a[t][3]),d=Math.max(a[t][0],a[t][2]),f=Math.max(a[t][1],a[t][3]),g=Math.min(a[n][0],a[n][2]),m=Math.min(a[n][1],a[n][3]),w=Math.max(a[n][0],a[n][2]),A=Math.max(a[n][1],a[n][3]),T=(d-s)*(f-c),M=(w-g)*(A-m);if(T<=0||M<=0)return 0;var O=Math.max(s,g),V=Math.max(c,m),H=Math.min(d,w),X=Math.min(f,A),$=Math.max(H-O,0)*Math.max(X-V,0);return $/(T+M-$)}function Ol(e,t){return ht(function(){var n=e.shape[0];return{boxPredictionEncoding:Gr(to(e,t.box_encoding_predictor),[n,-1,1,4]),classPrediction:Gr(to(e,t.class_predictor),[n,-1,3])}})}var Js=(Object.defineProperty(rf.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(rf.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),rf);function rf(e){var t=void 0===e?{}:e,n=t.minConfidence,a=t.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=n||.5,this._maxResults=a||100,"number"!=typeof this._minConfidence||this._minConfidence<=0||1<=this._minConfidence)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if("number"!=typeof this._maxResults)throw new Error(this._name+" - expected maxResults to be a number")}var cx,qu=(on(_s,cx=vo),_s.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("SsdMobilenetv1 - load model before inference");return ht(function(){var c,d,f,n=e.toBatchTensor(512,!1).toFloat(),a=function yy(e,t){return ht(function(){var n=null,a=bo(e,t.conv_0,[2,2]);if([t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13].forEach(function(s,c){var g,d=c+1,f=(g=d,[2,4,6,12].some(function(m){return m===g})?[2,2]:[1,1]);a=bo(a=function(g,m,w){return ht(function(){var A=fc(g,m.filters,w,"same");return A=Ih(A,m.batch_norm_mean,m.batch_norm_variance,m.batch_norm_offset,m.batch_norm_scale,.0010000000474974513),su(A,0,6)})}(a,s.depthwise_conv,f),s.pointwise_conv,[1,1]),11===d&&(n=a)}),null===n)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:a,conv11:n}})}(Yr(yi(n,nt(.007843137718737125)),nt(1)),t.mobilenetv1),s=(c=a.out,d=a.conv11,f=t.prediction_layer,ht(function(){var g=bo(bo(c,f.conv_0,[1,1]),f.conv_1,[2,2]),m=bo(bo(g,f.conv_2,[1,1]),f.conv_3,[2,2]),w=bo(bo(m,f.conv_4,[1,1]),f.conv_5,[2,2]),A=bo(bo(w,f.conv_6,[1,1]),f.conv_7,[2,2]),T=Ol(d,f.box_predictor_0),M=Ol(c,f.box_predictor_1),O=Ol(g,f.box_predictor_2),V=Ol(m,f.box_predictor_3),H=Ol(w,f.box_predictor_4),X=Ol(A,f.box_predictor_5);return{boxPredictions:vt([T.boxPredictionEncoding,M.boxPredictionEncoding,O.boxPredictionEncoding,V.boxPredictionEncoding,H.boxPredictionEncoding,X.boxPredictionEncoding],1),classPredictions:vt([T.classPrediction,M.classPrediction,O.classPrediction,V.classPrediction,H.classPrediction,X.classPrediction],1)}}));return function(c,d,f){return ht(function(){var g=c.shape[0],m=function Cy(e,t){var A,T,n=(A=_r(zo(e,[1,0])),{sizes:T=[Yr(A[2],A[0]),Yr(A[3],A[1])],centers:[xn(A[0],Ra(T[0],nt(2))),xn(A[1],Ra(T[1],nt(2)))]}),a=n.sizes,s=n.centers,c=_r(zo(t,[1,0])),d=Ra(yi(lu(Ra(c[2],nt(5))),a[0]),nt(2)),f=xn(yi(Ra(c[0],nt(10)),a[0]),s[0]),g=Ra(yi(lu(Ra(c[3],nt(5))),a[1]),nt(2)),m=xn(yi(Ra(c[1],nt(10)),a[1]),s[1]);return zo(li([Yr(f,d),Yr(m,g),xn(f,d),xn(m,g)]),[1,0])}(Gr(Ro(f.extra_dim,[g,1,1]),[-1,4]),Gr(c,[-1,4]));m=Gr(m,[g,m.shape[0]/g,4]);var w=Eh(Ka(d,[0,0,1],[-1,-1,-1])),A=Ka(w,[0,0,0],[-1,-1,1]);return A=Gr(A,[g,A.shape[1]]),{boxes:_r(m),scores:_r(A)}})}(s.boxPredictions,s.classPredictions,t.output_layer)})},_s.prototype.forward=function(e){return Mt(this,void 0,void 0,function(){var t;return Nt(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,ti(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},_s.prototype.locateFaces=function(e,t){return void 0===t&&(t={}),Mt(this,void 0,void 0,function(){var n,a,s,c,d,f,g,m,w,A,T,M,O,V,H,X,$,ee,re,te;return Nt(this,function(le){switch(le.label){case 0:return n=new Js(t),a=n.maxResults,s=n.minConfidence,[4,ti(e)];case 1:for(c=le.sent(),d=this.forwardInput(c),m=(f=d.boxes)[0],w=(g=d.scores)[0],A=1;A<f.length;A++)f[A].dispose(),g[A].dispose();return O=(M=Array).from,[4,w.data()];case 2:return T=O.apply(M,[le.sent()]),se=m,ie=T,be=s,Te=Math.min(a,se.shape[0]),We=ie.map(function(Ee,He){return{score:Ee,boxIndex:He}}).filter(function(Ee){return Ee.score>be}).sort(function(Ee,He){return He.score-Ee.score}),Fe=[],We.forEach(function(Ee){if(!(Fe.length>=Te)){for(var He=Ee.score,tt=Fe.length-1;0<=tt;--tt){var it=wy(se,Ee.boxIndex,Fe[tt]);if(0!==it&&(Ee.score*=it<=.5?1:0,Ee.score<=be))break}He===Ee.score&&Fe.push(Ee.boxIndex)}}),V=Fe,H=c.getReshapedInputDimensions(0),$=(X=c.inputSize)/H.width,ee=X/H.height,re=m.arraySync(),te=V.map(function(se){var ie=[Math.max(0,re[se][0]),Math.min(1,re[se][2])].map(function(We){return We*ee}),ce=ie[0],he=ie[1],be=[Math.max(0,re[se][1]),Math.min(1,re[se][3])].map(function(We){return We*$}),Ae=be[0];return new aa(T[se],new Ru(Ae,ce,be[1]-Ae,he-ce),{height:c.getInputHeight(0),width:c.getInputWidth(0)})}),m.dispose(),w.dispose(),[2,te]}var se,ie,be,Te,We,Fe})})},_s.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},_s.prototype.extractParamsFromWeigthMap=function(e){return function xy(e){var t=[],n=function(f,g){var m=As(f,g);function w(O,V,H){return{filters:m(O+"/Conv2d_"+V+"_pointwise/weights",4,H+"/filters"),batch_norm_offset:m(O+"/Conv2d_"+V+"_pointwise/convolution_bn_offset",1,H+"/batch_norm_offset")}}function A(O){var V="mobilenetv1/conv_"+O,H="MobilenetV1/Conv2d_"+O+"_depthwise",X=V+"/depthwise_conv",$=V+"/pointwise_conv";return{depthwise_conv:{filters:m(H+"/depthwise_weights",4,X+"/filters"),batch_norm_scale:m(H+"/BatchNorm/gamma",1,X+"/batch_norm_scale"),batch_norm_offset:m(H+"/BatchNorm/beta",1,X+"/batch_norm_offset"),batch_norm_mean:m(H+"/BatchNorm/moving_mean",1,X+"/batch_norm_mean"),batch_norm_variance:m(H+"/BatchNorm/moving_variance",1,X+"/batch_norm_variance")},pointwise_conv:w("MobilenetV1",O,$)}}function T(O,V){return{filters:m(O+"/weights",4,V+"/filters"),bias:m(O+"/biases",1,V+"/bias")}}function M(O){return{box_encoding_predictor:T("Prediction/BoxPredictor_"+O+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+O+"/box_encoding_predictor"),class_predictor:T("Prediction/BoxPredictor_"+O+"/ClassPredictor","prediction_layer/box_predictor_"+O+"/class_predictor")}}return{extractMobilenetV1Params:function(){return{conv_0:w("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:A(1),conv_2:A(2),conv_3:A(3),conv_4:A(4),conv_5:A(5),conv_6:A(6),conv_7:A(7),conv_8:A(8),conv_9:A(9),conv_10:A(10),conv_11:A(11),conv_12:A(12),conv_13:A(13)}},extractPredictionLayerParams:function(){return{conv_0:w("Prediction",0,"prediction_layer/conv_0"),conv_1:w("Prediction",1,"prediction_layer/conv_1"),conv_2:w("Prediction",2,"prediction_layer/conv_2"),conv_3:w("Prediction",3,"prediction_layer/conv_3"),conv_4:w("Prediction",4,"prediction_layer/conv_4"),conv_5:w("Prediction",5,"prediction_layer/conv_5"),conv_6:w("Prediction",6,"prediction_layer/conv_6"),conv_7:w("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:M(0),box_predictor_1:M(1),box_predictor_2:M(2),box_predictor_3:M(3),box_predictor_4:M(4),box_predictor_5:M(5)}}}}(e,t),a=n.extractMobilenetV1Params,s=n.extractPredictionLayerParams,c=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!Sc(c))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+c);var d={mobilenetv1:a(),prediction_layer:s(),output_layer:{extra_dim:c}};return $o(e,t),{params:d,paramMappings:t}}(e)},_s.prototype.extractParams=function(e){return function(t){var n=[],a=Ko(t),s=a.extractWeights,c=a.getRemainingWeights,d=function my(e,t){function n(c,d,f,g,m){var w=er(e(c*d*f*f),[f,f,c,d]),A=tn(e(d));return t.push({paramPath:g+"/filters"},{paramPath:g+"/"+(m?"batch_norm_offset":"bias")}),{filters:w,bias:A}}function a(c,d,f,g){var m=n(c,d,f,g,!0);return{filters:m.filters,batch_norm_offset:m.bias}}function s(c,d,f){return{depthwise_conv:(g=c,m=f+"/depthwise_conv",w=er(e(9*g),[3,3,g,1]),A=tn(e(g)),T=tn(e(g)),M=tn(e(g)),O=tn(e(g)),t.push({paramPath:m+"/filters"},{paramPath:m+"/batch_norm_scale"},{paramPath:m+"/batch_norm_offset"},{paramPath:m+"/batch_norm_mean"},{paramPath:m+"/batch_norm_variance"}),{filters:w,batch_norm_scale:A,batch_norm_offset:T,batch_norm_mean:M,batch_norm_variance:O}),pointwise_conv:a(c,d,1,f+"/pointwise_conv")};var g,m,w,A,T,M,O}return{extractMobilenetV1Params:function(){return{conv_0:a(3,32,3,"mobilenetv1/conv_0"),conv_1:s(32,64,"mobilenetv1/conv_1"),conv_2:s(64,128,"mobilenetv1/conv_2"),conv_3:s(128,128,"mobilenetv1/conv_3"),conv_4:s(128,256,"mobilenetv1/conv_4"),conv_5:s(256,256,"mobilenetv1/conv_5"),conv_6:s(256,512,"mobilenetv1/conv_6"),conv_7:s(512,512,"mobilenetv1/conv_7"),conv_8:s(512,512,"mobilenetv1/conv_8"),conv_9:s(512,512,"mobilenetv1/conv_9"),conv_10:s(512,512,"mobilenetv1/conv_10"),conv_11:s(512,512,"mobilenetv1/conv_11"),conv_12:s(512,1024,"mobilenetv1/conv_12"),conv_13:s(1024,1024,"mobilenetv1/conv_13")}},extractPredictionLayerParams:function(){return{conv_0:a(1024,256,1,"prediction_layer/conv_0"),conv_1:a(256,512,3,"prediction_layer/conv_1"),conv_2:a(512,128,1,"prediction_layer/conv_2"),conv_3:a(128,256,3,"prediction_layer/conv_3"),conv_4:a(256,128,1,"prediction_layer/conv_4"),conv_5:a(128,256,3,"prediction_layer/conv_5"),conv_6:a(256,64,1,"prediction_layer/conv_6"),conv_7:a(64,128,3,"prediction_layer/conv_7"),box_predictor_0:{box_encoding_predictor:n(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),class_predictor:n(512,9,1,"prediction_layer/box_predictor_0/class_predictor")},box_predictor_1:{box_encoding_predictor:n(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),class_predictor:n(1024,18,1,"prediction_layer/box_predictor_1/class_predictor")},box_predictor_2:{box_encoding_predictor:n(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),class_predictor:n(512,18,1,"prediction_layer/box_predictor_2/class_predictor")},box_predictor_3:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_3/class_predictor")},box_predictor_4:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_4/class_predictor")},box_predictor_5:{box_encoding_predictor:n(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),class_predictor:n(128,18,1,"prediction_layer/box_predictor_5/class_predictor")}}}}}(s,n),g=d.extractPredictionLayerParams,m=(0,d.extractMobilenetV1Params)(),w=g(),A={extra_dim:Wa(s(20472),[1,5118,4])};if(n.push({paramPath:"output_layer/extra_dim"}),0!==c().length)throw new Error("weights remaing after extract: "+c().length);return{params:{mobilenetv1:m,prediction_layer:w,output_layer:A},paramMappings:n}}(e)},_s);function _s(){return cx.call(this,"SsdMobilenetv1")||this}function ux(e){var t=new qu;return t.extractWeights(e),t}var af,ky=(on(hx,af=qu),hx);function hx(){return null!==af&&af.apply(this,arguments)||this}var Is,Ay=[new Fn(.738768,.874946),new Fn(2.42204,2.65704),new Fn(4.30971,7.04493),new Fn(10.246,4.59428),new Fn(12.6868,11.8741)],Sy=[new Fn(1.603231,2.094468),new Fn(6.041143,7.080126),new Fn(2.882459,3.518061),new Fn(4.266906,5.178857),new Fn(9.041765,10.66308)],Ey=[117.001,114.697,97.404],$u=function(e){return"number"==typeof e};function dx(e){if(!e)throw new Error("invalid config: "+e);if("boolean"!=typeof e.withSeparableConvs)throw new Error("config.withSeparableConvs has to be a boolean, have: "+e.withSeparableConvs);if(!$u(e.iouThreshold)||e.iouThreshold<0||1<e.iouThreshold)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+e.iouThreshold);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(function(t){return"string"==typeof t}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(e.classes));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(function(t){return t||{}}).every(function(t){return $u(t.x)&&$u(t.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(e.anchors));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||3!==e.meanRgb.length||!e.meanRgb.every($u)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(e.meanRgb))}function of(e){return ht(function(){var t=yi(e,nt(.10000000149011612));return xn(br(Yr(e,t)),t)})}function Ts(e,t){return ht(function(){var n=Vn(e,[[0,0],[1,1],[1,1],[0,0]]);return n=ga(n,t.conv.filters,[1,1],"valid"),n=Yr(n,t.bn.sub),n=yi(n,t.bn.truediv),of(n=xn(n,t.conv.bias))})}function Rs(e,t){return ht(function(){var n=Vn(e,[[0,0],[1,1],[1,1],[0,0]]);return n=fu(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),of(n=xn(n,t.bias))})}(Is=Ce.TinyYolov2SizeType||(Ce.TinyYolov2SizeType={}))[Is.XS=224]="XS",Is[Is.SM=320]="SM",Is[Is.MD=416]="MD",Is[Is.LG=608]="LG";var Pc=(Object.defineProperty(sf.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(sf.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),sf);function sf(e){var t=void 0===e?{}:e,n=t.inputSize,a=t.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=n||416,this._scoreThreshold=a||.5,"number"!=typeof this._inputSize||this._inputSize%32!=0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if("number"!=typeof this._scoreThreshold||this._scoreThreshold<=0||1<=this._scoreThreshold)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}var fx,px=(on(ki,fx=vo),Object.defineProperty(ki.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(ki.prototype,"withClassScores",{get:function(){return this.config.withClassScores||1<this.config.classes.length},enumerable:!0,configurable:!0}),Object.defineProperty(ki.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),ki.prototype.runTinyYolov2=function(e,t){var n=Ts(e,t.conv0);return n=Ts(n=Qr(n,[2,2],[2,2],"same"),t.conv1),n=Ts(n=Qr(n,[2,2],[2,2],"same"),t.conv2),n=Ts(n=Qr(n,[2,2],[2,2],"same"),t.conv3),n=Ts(n=Qr(n,[2,2],[2,2],"same"),t.conv4),n=Ts(n=Qr(n,[2,2],[2,2],"same"),t.conv5),to(n=Ts(n=Ts(n=Qr(n,[2,2],[1,1],"same"),t.conv6),t.conv7),t.conv8,"valid",!1)},ki.prototype.runMobilenet=function(e,t){var n=this.config.isFirstLayerConv2d?of(to(e,t.conv0,"valid",!1)):Rs(e,t.conv0);return n=Rs(n=Qr(n,[2,2],[2,2],"same"),t.conv1),n=Rs(n=Qr(n,[2,2],[2,2],"same"),t.conv2),n=Rs(n=Qr(n,[2,2],[2,2],"same"),t.conv3),n=Rs(n=Qr(n,[2,2],[2,2],"same"),t.conv4),n=Rs(n=Qr(n,[2,2],[2,2],"same"),t.conv5),n=Qr(n,[2,2],[1,1],"same"),n=t.conv6?Rs(n,t.conv6):n,to(n=t.conv7?Rs(n,t.conv7):n,t.conv8,"valid",!1)},ki.prototype.forwardInput=function(e,t){var n=this,a=this.params;if(!a)throw new Error("TinyYolov2 - load model before inference");return ht(function(){var s=e.toBatchTensor(t,!1).toFloat();return s=(s=n.config.meanRgb?Dl(s,n.config.meanRgb):s).div(nt(256)),n.config.withSeparableConvs?n.runMobilenet(s,a):n.runTinyYolov2(s,a)})},ki.prototype.forward=function(e,t){return Mt(this,void 0,void 0,function(){var n;return Nt(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,ti(e)];case 1:return[4,n.apply(this,[a.sent(),t])];case 2:return[2,a.sent()]}})})},ki.prototype.detect=function(e,t){return void 0===t&&(t={}),Mt(this,void 0,void 0,function(){var n,a,s,c,d,f,g,m,w,A,T,M,O=this;return Nt(this,function(V){switch(V.label){case 0:return n=new Pc(t),a=n.inputSize,s=n.scoreThreshold,[4,ti(e)];case 1:return c=V.sent(),[4,this.forwardInput(c,a)];case 2:return d=V.sent(),f=ht(function(){return _r(d)[0].expandDims()}),g={width:c.getInputWidth(0),height:c.getInputHeight(0)},[4,this.extractBoxes(f,c.getReshapedInputDimensions(0),s)];case 3:return m=V.sent(),d.dispose(),f.dispose(),w=m.map(function(H){return H.box}),A=m.map(function(H){return H.score}),T=m.map(function(H){return H.classScore}),M=m.map(function(H){return O.config.classes[H.label]}),[2,Rl(w.map(function(H){return H.rescale(a)}),A,this.config.iouThreshold,!0).map(function(H){return new Ed(A[H],T[H],M[H],w[H],g)})]}})})},ki.prototype.getDefaultModelName=function(){return""},ki.prototype.extractParamsFromWeigthMap=function(e){return function(t,n){var a,s=[],c=function Iy(e,t){var n=As(e,t);function a(s){return{filters:n(s+"/filters",4),bias:n(s+"/bias",1)}}return{extractConvParams:a,extractConvWithBatchNormParams:function(s){return{conv:a(s+"/conv"),bn:(c=s+"/bn",{sub:n(c+"/sub",1),truediv:n(c+"/truediv",1)})};var c},extractSeparableConvParams:Gd(n)}}(t,s),d=c.extractConvParams,f=c.extractConvWithBatchNormParams,g=c.extractSeparableConvParams;if(n.withSeparableConvs){var m=n.filterSizes&&n.filterSizes.length||9;a={conv0:n.isFirstLayerConv2d?d("conv0"):g("conv0"),conv1:g("conv1"),conv2:g("conv2"),conv3:g("conv3"),conv4:g("conv4"),conv5:g("conv5"),conv6:7<m?g("conv6"):void 0,conv7:8<m?g("conv7"):void 0,conv8:d("conv8")}}else a={conv0:f("conv0"),conv1:f("conv1"),conv2:f("conv2"),conv3:f("conv3"),conv4:f("conv4"),conv5:f("conv5"),conv6:f("conv6"),conv7:f("conv7"),conv8:d("conv8")};return $o(t,s),{params:a,paramMappings:s}}(e,this.config)},ki.prototype.extractParams=function(e){var t=this.config.filterSizes||ki.DEFAULT_FILTER_SIZES,n=t?t.length:void 0;if(7!==n&&8!==n&&9!==n)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+n+" filterSizes in config");return function(a,s,c,d){var f,g=Ko(a),w=g.getRemainingWeights,A=[],T=function _y(e,t){var n=Hu(e,t),a=Xd(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:function(s,c,d){return{conv:n(s,c,3,d+"/conv"),bn:(f=c,g=d+"/bn",m=tn(e(f)),w=tn(e(f)),t.push({paramPath:g+"/sub"},{paramPath:g+"/truediv"}),{sub:m,truediv:w})};var f,g,m,w},extractSeparableConvParams:a}}(g.extractWeights,A),M=T.extractConvParams,O=T.extractConvWithBatchNormParams,V=T.extractSeparableConvParams;if(s.withSeparableConvs){var H=d[0],X=d[1],$=d[2],ee=d[3],re=d[4],te=d[5],le=d[6],se=d[7],ie=d[8];f={conv0:s.isFirstLayerConv2d?M(H,X,3,"conv0"):V(H,X,"conv0"),conv1:V(X,$,"conv1"),conv2:V($,ee,"conv2"),conv3:V(ee,re,"conv3"),conv4:V(re,te,"conv4"),conv5:V(te,le,"conv5"),conv6:se?V(le,se,"conv6"):void 0,conv7:ie?V(se,ie,"conv7"):void 0,conv8:M(ie||se||le,5*c,1,"conv8")}}else $=d[2],ee=d[3],re=d[4],te=d[5],le=d[6],se=d[7],ie=d[8],f={conv0:O(H=d[0],X=d[1],"conv0"),conv1:O(X,$,"conv1"),conv2:O($,ee,"conv2"),conv3:O(ee,re,"conv3"),conv4:O(re,te,"conv4"),conv5:O(te,le,"conv5"),conv6:O(le,se,"conv6"),conv7:O(se,ie,"conv7"),conv8:M(ie,5*c,1,"conv8")};if(0!==w().length)throw new Error("weights remaing after extract: "+w().length);return{params:f,paramMappings:A}}(e,this.config,this.boxEncodingSize,t)},ki.prototype.extractBoxes=function(e,t,n){return Mt(this,void 0,void 0,function(){var a,s,c,d,f,g,m,w,A,T,M,O,V,H,X,$,ee,re,te,le,se,ie,ce,he,be,Ae,Te,We,Fe,Ee=this;return Nt(this,function(He){switch(He.label){case 0:return a=t.width,s=t.height,c=Math.max(a,s),d=c/a,f=c/s,g=e.shape[1],m=this.config.anchors.length,w=ht(function(){var tt=e.reshape([g,g,m,Ee.boxEncodingSize]);return[tt.slice([0,0,0,0],[g,g,m,4]),tt.slice([0,0,0,4],[g,g,m,1]),Ee.withClassScores?_a(tt.slice([0,0,0,5],[g,g,m,Ee.config.classes.length]),3):nt(0)]}),A=w[0],M=w[2],O=[],[4,(T=w[1]).array()];case 1:return V=He.sent(),[4,A.array()];case 2:H=He.sent(),X=0,He.label=3;case 3:if(!(X<g))return[3,12];$=0,He.label=4;case 4:if(!($<g))return[3,11];ee=0,He.label=5;case 5:return ee<m?(re=Tu(V[X][$][ee][0]),!n||n<re?(te=($+Tu(H[X][$][ee][0]))/g*d,le=(X+Tu(H[X][$][ee][1]))/g*f,se=Math.exp(H[X][$][ee][2])*this.config.anchors[ee].x/g*d,ie=Math.exp(H[X][$][ee][3])*this.config.anchors[ee].y/g*f,ce=te-se/2,he=le-ie/2,be={row:X,col:$,anchor:ee},this.withClassScores?[4,this.extractPredictedClass(M,be)]:[3,7]):[3,9]):[3,10];case 6:return Fe=He.sent(),[3,8];case 7:Fe={classScore:1,label:0},He.label=8;case 8:Te=(Ae=Fe).classScore,We=Ae.label,O.push(Yi({box:new Ec(ce,he,ce+se,he+ie),score:re,classScore:re*Te,label:We},be)),He.label=9;case 9:return ee++,[3,5];case 10:return $++,[3,4];case 11:return X++,[3,3];case 12:return A.dispose(),T.dispose(),M.dispose(),[2,O]}})})},ki.prototype.extractPredictedClass=function(e,t){return Mt(this,void 0,void 0,function(){var n,a,s,c;return Nt(this,function(d){switch(d.label){case 0:return n=t.row,a=t.col,s=t.anchor,[4,e.array()];case 1:return c=d.sent(),[2,Array(this.config.classes.length).fill(0).map(function(f,g){return c[n][a][s][g]}).map(function(f,g){return{classScore:f,label:g}}).reduce(function(f,g){return f.classScore>g.classScore?f:g})]}})})},ki.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],ki);function ki(e){var t=fx.call(this,"TinyYolov2")||this;return dx(e),t._config=e,t}var lf,cf=(on(Qs,lf=px),Object.defineProperty(Qs.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(Qs.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),Qs.prototype.locateFaces=function(e,t){return Mt(this,void 0,void 0,function(){return Nt(this,function(n){switch(n.label){case 0:return[4,this.detect(e,t)];case 1:return[2,n.sent().map(function(a){return new aa(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},Qs.prototype.getDefaultModelName=function(){return this.withSeparableConvs?"tiny_yolov2_separable_conv_model":"tiny_yolov2_model"},Qs.prototype.extractParamsFromWeigthMap=function(e){return lf.prototype.extractParamsFromWeigthMap.call(this,e)},Qs);function Qs(e){void 0===e&&(e=!0);var t=Object.assign({},{withSeparableConvs:e,iouThreshold:.4,classes:["face"]},e?{anchors:Sy,meanRgb:Ey}:{anchors:Ay,withClassScores:!0});return lf.call(this,t)||this}var uf,gx=(on(vx,uf=Pc),vx);function vx(){var e=null!==uf&&uf.apply(this,arguments)||this;return e._name="TinyFaceDetectorOptions",e}var Bl=(hf.prototype.then=function(e){return Mt(this,void 0,void 0,function(){var t;return Nt(this,function(n){switch(n.label){case 0:return t=e,[4,this.run()];case 1:return[2,t.apply(void 0,[n.sent()])]}})})},hf.prototype.run=function(){return Mt(this,void 0,void 0,function(){return Nt(this,function(e){throw new Error("ComposableTask - run is not implemented")})})},hf);function hf(){}function Ku(e,t,n,a,s){return void 0===s&&(s=function(c){return c.alignedRect}),Mt(this,void 0,void 0,function(){var c,d,f,g,m;return Nt(this,function(w){switch(w.label){case 0:return c=e.map(function(A){return Gu(A)?s(A):A.detection}),(f=a)?[3,5]:t instanceof rn?[4,Bu(t,c)]:[3,2];case 1:return g=w.sent(),[3,4];case 2:return[4,Ou(t,c)];case 3:g=w.sent(),w.label=4;case 4:f=g,w.label=5;case 5:return[4,n(d=f)];case 6:return m=w.sent(),d.forEach(function(A){return A instanceof rn&&A.dispose()}),[2,m]}})})}function df(e,t,n,a,s){return Mt(this,void 0,void 0,function(){var c=this;return Nt(this,function(d){return[2,Ku([e],t,function(f){return Mt(c,void 0,void 0,function(){return Nt(this,function(g){return[2,n(f[0])]})})},a,s)]})})}function ff(e,t){var a=t[1];return{height:Math.floor(t[0]*e),width:Math.floor(a*e)}}var mx,pf=(on(xx,mx=Ja),xx);function xx(e,t,n,a){return mx.call(this,{left:e,top:t,right:n,bottom:a},!0)||this}function bx(e){return ht(function(){return yi(Yr(e,nt(127.5)),nt(.0078125))})}function zl(e,t){return ht(function(){return xn(br(e),yi(t,cc(br(cc(e)))))})}function gf(e,t,n){return void 0===n&&(n=!1),ht(function(){var a=to(e,t.conv1,"valid");return a=zl(a,t.prelu1_alpha),a=zl(a=to(a=Qr(a,n?[2,2]:[3,3],[2,2],"same"),t.conv2,"valid"),t.prelu2_alpha),zl(a=to(a=n?a:Qr(a,[3,3],[2,2],"valid"),t.conv3,"valid"),t.prelu3_alpha)})}function Dy(e,t,n,a,s){s.stage1=[];var c=t.map(function(w){return ht(function(){var X,$,A={scale:w},T=(X=e,$=w,ht(function(){var ee=ff($,X.shape.slice(1)),le=bx(bu.resizeBilinear(X,[ee.height,ee.width]));return zo(le,[0,2,1,3])})),M=Date.now(),O=function(X,$){return ht(function(){var ee=gf(X,$,!0),re=to(ee,$.conv4_1,"valid"),te=Bt(gc(re,3),3);return{prob:_a(Yr(re,te),3),regions:to(ee,$.conv4_2,"valid")}})}(T,a),V=O.prob,H=O.regions;return A.pnet=Date.now()-M,{scoresTensor:_r(_r(V,3)[1])[0],regionsTensor:_r(H)[0],scale:w,statsForScale:A}})}).map(function(w){var A=w.scoresTensor,T=w.regionsTensor,O=w.statsForScale,V=function($,ee,re,te){for(var le=[],se=$.arraySync(),ie=0;ie<$.shape[0];ie++)for(var ce=0;ce<$.shape[1];ce++)se[ie][ce]>=te&&le.push(new Fn(ce,ie));return le.map(function(he){var be=new Ec(Math.round((2*he.y+1)/re),Math.round((2*he.x+1)/re),Math.round((2*he.y+12)/re),Math.round((2*he.x+12)/re)),Ae=se[he.y][he.x],Te=ee.arraySync();return{cell:be,score:Ae,region:new pf(Te[he.y][he.x][0],Te[he.y][he.x][1],Te[he.y][he.x][2],Te[he.y][he.x][3])}})}(A,T,w.scale,n);if(A.dispose(),T.dispose(),!V.length)return s.stage1.push(O),[];var H=Date.now(),X=Rl(V.map(function($){return $.cell}),V.map(function($){return $.score}),.5);return O.nms=Date.now()-H,O.numBoxes=X.length,s.stage1.push(O),X.map(function($){return V[$]})}).reduce(function(w,A){return w.concat(A)},[]),d=[],f=[];if(0<c.length){var g=Date.now(),m=Rl(c.map(function(w){return w.cell}),c.map(function(w){return w.score}),.7);s.stage1_nms=Date.now()-g,f=m.map(function(w){return c[w].score}),d=m.map(function(w){return c[w]}).map(function(w){var A=w.cell,T=w.region;return new Ec(A.left+T.left*A.width,A.top+T.top*A.height,A.right+T.right*A.width,A.bottom+T.bottom*A.height).toSquare().round()})}return{boxes:d,scores:f}}function yx(e,t,n){var a=n.width,s=n.height;return Mt(this,void 0,void 0,function(){var c,d,f,g=this;return Nt(this,function(m){switch(m.label){case 0:return c=eo(e),[4,Promise.all(t.map(function(w){return Mt(g,void 0,void 0,function(){var A,H,X,$;return Nt(this,function(ee){return A=w.padAtBorders(e.height,e.width),$=c.getImageData(H=A.x-1,X=A.y-1,A.ex-H,A.ey-X),[2,ui.isNodejs()?Fu($):createImageBitmap($)]})})}))];case 1:return d=m.sent(),f=[],d.forEach(function(w){var A=eo(Tc({width:a,height:s}));A.drawImage(w,0,0,a,s);for(var T=A.getImageData(0,0,a,s).data,M=[],O=0;O<T.length;O+=4)M.push(T[O+2]),M.push(T[O+1]),M.push(T[O]);f.push(M)}),[2,f.map(function(w){return ht(function(){return bx(zo(er(w,[1,a,s,3]),[0,2,1,3]).toFloat())})})]}})})}function Py(e,t,n,a,s){return Mt(this,void 0,void 0,function(){var c,d,f,g,m,w,A,T,M,O,V,H,X,$;return Nt(this,function(ee){switch(ee.label){case 0:return c=Date.now(),[4,yx(e,t,{width:24,height:24})];case 1:return d=ee.sent(),s.stage2_extractImagePatches=Date.now()-c,c=Date.now(),f=d.map(function(re){var le,se,te=(le=re,se=a,ht(function(){var ie=gf(le,se),ce=zl(mo(Gr(ie,[ie.shape[0],se.fc1.weights.shape[0]]),se.fc1),se.prelu4_alpha),he=mo(ce,se.fc2_1),be=Bt(gc(he,1),1),Ae=_a(Yr(he,be),1),Te=mo(ce,se.fc2_2);return{scores:_r(Ae,1)[1],regions:Te}}));return re.dispose(),te}),s.stage2_rnet=Date.now()-c,g=1<f.length?vt(f.map(function(re){return re.scores})):f[0].scores,A=(w=Array).from,[4,g.data()];case 2:return m=A.apply(w,[ee.sent()]),g.dispose(),T=m.map(function(re,te){return{score:re,idx:te}}).filter(function(re){return re.score>n}).map(function(re){return re.idx}),M=T.map(function(re){return t[re]}),O=T.map(function(re){return m[re]}),V=[],H=[],0<M.length&&(c=Date.now(),X=Rl(M,O,.7),s.stage2_nms=Date.now()-c,$=X.map(function(re){var te=f[T[re]].regions.arraySync();return new pf(te[0][0],te[0][1],te[0][2],te[0][3])}),H=X.map(function(re){return O[re]}),V=X.map(function(re,te){return M[re].calibrate($[te])})),f.forEach(function(re){re.regions.dispose(),re.scores.dispose()}),[2,{boxes:V,scores:H}]}})})}function My(e,t,n,a,s){return Mt(this,void 0,void 0,function(){var c,d,f,g,m,w,A,T,M,O,V,H,X,$,ee;return Nt(this,function(re){switch(re.label){case 0:return c=Date.now(),[4,yx(e,t,{width:48,height:48})];case 1:return d=re.sent(),s.stage3_extractImagePatches=Date.now()-c,c=Date.now(),f=d.map(function(te){var se,ie,le=(se=te,ie=a,ht(function(){var ce=gf(se,ie);ce=zl(ce=to(ce=Qr(ce,[2,2],[2,2],"same"),ie.conv4,"valid"),ie.prelu4_alpha);var he=zl(mo(Gr(ce,[ce.shape[0],ie.fc1.weights.shape[0]]),ie.fc1),ie.prelu5_alpha),be=mo(he,ie.fc2_1),Ae=Bt(gc(be,1),1),Te=_a(Yr(be,Ae),1),We=mo(he,ie.fc2_2),Fe=mo(he,ie.fc2_3);return{scores:_r(Te,1)[1],regions:We,points:Fe}}));return te.dispose(),le}),s.stage3_onet=Date.now()-c,g=1<f.length?vt(f.map(function(te){return te.scores})):f[0].scores,A=(w=Array).from,[4,g.data()];case 2:return m=A.apply(w,[re.sent()]),g.dispose(),T=m.map(function(te,le){return{score:te,idx:le}}).filter(function(te){return te.score>n}).map(function(te){return te.idx}),M=T.map(function(te){var le=f[te].regions.arraySync();return new pf(le[0][0],le[0][1],le[0][2],le[0][3])}),O=T.map(function(te,le){return t[te].calibrate(M[le])}),V=T.map(function(te){return m[te]}),H=[],X=[],$=[],0<O.length&&(c=Date.now(),ee=Rl(O,V,.7,!1),s.stage3_nms=Date.now()-c,H=ee.map(function(te){return O[te]}),X=ee.map(function(te){return V[te]}),$=ee.map(function(te,le){return Array(5).fill(0).map(function(se,ie){var ce=f[te].points.arraySync();return new Fn(ce[0][ie]*(H[le].width+1)+H[le].left,ce[0][ie+5]*(H[le].height+1)+H[le].top)})})),f.forEach(function(te){te.regions.dispose(),te.scores.dispose(),te.points.dispose()}),[2,{boxes:H,scores:X,points:$}]}})})}var Qu,vf=(on(yo,Qu=vo),yo.prototype.load=function(e){return Mt(this,void 0,void 0,function(){return Nt(this,function(t){return console.warn("mtcnn is deprecated and will be removed soon"),[2,Qu.prototype.load.call(this,e)]})})},yo.prototype.loadFromDisk=function(e){return Mt(this,void 0,void 0,function(){return Nt(this,function(t){return console.warn("mtcnn is deprecated and will be removed soon"),[2,Qu.prototype.loadFromDisk.call(this,e)]})})},yo.prototype.forwardInput=function(e,t){return void 0===t&&(t={}),Mt(this,void 0,void 0,function(){var n,a,s,c,d,f,g,m,w,A,T,M,O,V,X,$,ee,re,te,le;return Nt(this,function(se){switch(se.label){case 0:if(!(n=this.params))throw new Error("Mtcnn - load model before inference");if(!(a=e.canvases[0]))throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return s={},c=Date.now(),d=ht(function(){return ie=Bt(ku.fromPixels(a)).toFloat(),ht(function(){return li(_r(ie,3).reverse(),3)});var ie}),f=function(ie){return d.dispose(),s.total=Date.now()-c,ie},g=d.shape.slice(1),m=g[0],w=g[1],A=new Uu(t),T=A.minFaceSize,M=A.scaleFactor,O=A.maxNumScales,V=A.scoreThresholds,X=(A.scaleSteps||function(ie,ce,he){for(var Te=12/ie,We=[],Fe=Math.min(he[0],he[1])*Te,Ee=0;12<=Fe;)We.push(Te*Math.pow(ce,Ee)),Fe*=ce,Ee+=1;return We}(T,M,[m,w])).filter(function(ie){var ce=ff(ie,[m,w]);return Math.min(ce.width,ce.height)>12}).slice(0,O),s.scales=X,s.pyramid=X.map(function(ie){return ff(ie,[m,w])}),$=Date.now(),[4,Dy(d,X,V[0],n.pnet,s)];case 1:return ee=se.sent(),s.total_stage1=Date.now()-$,ee.boxes.length?(s.stage2_numInputBoxes=ee.boxes.length,$=Date.now(),[4,Py(a,ee.boxes,V[1],n.rnet,s)]):[2,f({results:[],stats:s})];case 2:return re=se.sent(),s.total_stage2=Date.now()-$,re.boxes.length?(s.stage3_numInputBoxes=re.boxes.length,$=Date.now(),[4,My(a,re.boxes,V[2],n.onet,s)]):[2,f({results:[],stats:s})];case 3:return te=se.sent(),s.total_stage3=Date.now()-$,le=te.boxes.map(function(ie,ce){return Dc(Nl({},new aa(te.scores[ce],new Ru(ie.left/w,ie.top/m,ie.width/w,ie.height/m),{height:m,width:w})),new mm(te.points[ce].map(function(he){return he.sub(new Fn(ie.left,ie.top)).div(new Fn(ie.width,ie.height))}),{width:ie.width,height:ie.height}))}),[2,f({results:le,stats:s})]}})})},yo.prototype.forward=function(e,t){return void 0===t&&(t={}),Mt(this,void 0,void 0,function(){var n;return Nt(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,ti(e)];case 1:return[4,n.apply(this,[a.sent(),t])];case 2:return[2,a.sent().results]}})})},yo.prototype.forwardWithStats=function(e,t){return void 0===t&&(t={}),Mt(this,void 0,void 0,function(){var n;return Nt(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,ti(e)];case 1:return[2,n.apply(this,[a.sent(),t])]}})})},yo.prototype.getDefaultModelName=function(){return"mtcnn_model"},yo.prototype.extractParamsFromWeigthMap=function(e){return function Ry(e){var t=[],n=function(m,w){var A=As(m,w);function T(H){return{filters:A(H+"/weights",4,H+"/filters"),bias:A(H+"/bias",1)}}function M(H){return{weights:A(H+"/weights",2),bias:A(H+"/bias",1)}}function O(H){return A(H,1)}function V(H){return{conv1:T(H+"/conv1"),prelu1_alpha:O(H+"/prelu1_alpha"),conv2:T(H+"/conv2"),prelu2_alpha:O(H+"/prelu2_alpha"),conv3:T(H+"/conv3"),prelu3_alpha:O(H+"/prelu3_alpha")}}return{extractPNetParams:function(){var H=V("pnet"),X=T("pnet/conv4_1"),$=T("pnet/conv4_2");return Yi(Yi({},H),{conv4_1:X,conv4_2:$})},extractRNetParams:function(){var H=V("rnet"),X=M("rnet/fc1"),$=O("rnet/prelu4_alpha"),ee=M("rnet/fc2_1"),re=M("rnet/fc2_2");return Yi(Yi({},H),{fc1:X,prelu4_alpha:$,fc2_1:ee,fc2_2:re})},extractONetParams:function(){var H=V("onet"),X=T("onet/conv4"),$=O("onet/prelu4_alpha"),ee=M("onet/fc1"),re=O("onet/prelu5_alpha"),te=M("onet/fc2_1"),le=M("onet/fc2_2"),se=M("onet/fc2_3");return Yi(Yi({},H),{conv4:X,prelu4_alpha:$,fc1:ee,prelu5_alpha:re,fc2_1:te,fc2_2:le,fc2_3:se})}}}(e,t),s=n.extractRNetParams,c=n.extractONetParams,d=(0,n.extractPNetParams)(),f=s(),g=c();return $o(e,t),{params:{pnet:d,rnet:f,onet:g},paramMappings:t}}(e)},yo.prototype.extractParams=function(e){return function Ty(e){var t=Ko(e),a=t.getRemainingWeights,s=[],c=function(T,M){var O=Hu(T,M),V=Hd(T,M);function H($,ee){var re=tn(T($));return M.push({paramPath:ee}),re}function X($,ee,re){return void 0===re&&(re=!1),{conv1:O($[0],$[1],3,ee+"/conv1"),prelu1_alpha:H($[1],ee+"/prelu1_alpha"),conv2:O($[1],$[2],3,ee+"/conv2"),prelu2_alpha:H($[2],ee+"/prelu2_alpha"),conv3:O($[2],$[3],re?2:3,ee+"/conv3"),prelu3_alpha:H($[3],ee+"/prelu3_alpha")}}return{extractPNetParams:function(){var $=X([3,10,16,32],"pnet"),ee=O(32,2,1,"pnet/conv4_1"),re=O(32,4,1,"pnet/conv4_2");return Yi(Yi({},$),{conv4_1:ee,conv4_2:re})},extractRNetParams:function(){var $=X([3,28,48,64],"rnet",!0),ee=V(576,128,"rnet/fc1"),re=H(128,"rnet/prelu4_alpha"),te=V(128,2,"rnet/fc2_1"),le=V(128,4,"rnet/fc2_2");return Yi(Yi({},$),{fc1:ee,prelu4_alpha:re,fc2_1:te,fc2_2:le})},extractONetParams:function(){var $=X([3,32,64,64],"onet"),ee=O(64,128,2,"onet/conv4"),re=H(128,"onet/prelu4_alpha"),te=V(1152,256,"onet/fc1"),le=H(256,"onet/prelu5_alpha"),se=V(256,2,"onet/fc2_1"),ie=V(256,4,"onet/fc2_2"),ce=V(256,10,"onet/fc2_3");return Yi(Yi({},$),{conv4:ee,prelu4_alpha:re,fc1:te,prelu5_alpha:le,fc2_1:se,fc2_2:ie,fc2_3:ce})}}}(t.extractWeights,s),f=c.extractRNetParams,g=c.extractONetParams,m=(0,c.extractPNetParams)(),w=f(),A=g();if(0!==a().length)throw new Error("weights remaing after extract: "+a().length);return{params:{pnet:m,rnet:w,onet:A},paramMappings:s}}(e)},yo);function yo(){return Qu.call(this,"Mtcnn")||this}var mf,Ny=[new Fn(1.603231,2.094468),new Fn(6.041143,7.080126),new Fn(2.882459,3.518061),new Fn(4.266906,5.178857),new Fn(9.041765,10.66308)],Ly=[117.001,114.697,97.404],xf=(on(Wl,mf=px),Object.defineProperty(Wl.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),Wl.prototype.locateFaces=function(e,t){return Mt(this,void 0,void 0,function(){return Nt(this,function(n){switch(n.label){case 0:return[4,this.detect(e,t)];case 1:return[2,n.sent().map(function(a){return new aa(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},Wl.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},Wl.prototype.extractParamsFromWeigthMap=function(e){return mf.prototype.extractParamsFromWeigthMap.call(this,e)},Wl);function Wl(){return mf.call(this,{withSeparableConvs:!0,iouThreshold:.4,classes:["face"],anchors:Ny,meanRgb:Ly,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]})||this}function wx(e,t){return Kn.ssdMobilenetv1.locateFaces(e,t)}function Cx(e){return Kn.faceLandmark68Net.detectLandmarks(e)}function kx(e){return Kn.ssdMobilenetv1.load(e)}var Ax,Kn={ssdMobilenetv1:new qu,tinyFaceDetector:new xf,tinyYolov2:new cf,mtcnn:new vf,faceLandmark68Net:new Kd,faceLandmark68TinyNet:new ix,faceRecognitionNet:new Qd,faceExpressionNet:new Ym,ageGenderNet:new Qm},Fy=kx,Oy=wx,By=Cx,Sx=(on(Ex,Ax=Bl),Ex);function Ex(e,t,n){var a=Ax.call(this)||this;return a.parentTask=e,a.input=t,a.extractedFaces=n,a}var bf,yf=(on(eh,bf=Sx),eh.prototype.run=function(){return Mt(this,void 0,void 0,function(){var e,t,n=this;return Nt(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return[4,Ku(e=a.sent(),this.input,function(s){return Mt(n,void 0,void 0,function(){return Nt(this,function(c){switch(c.label){case 0:return[4,Promise.all(s.map(function(d){return Kn.faceExpressionNet.predictExpressions(d)}))];case 1:return[2,c.sent()]}})})},this.extractedFaces)];case 2:return t=a.sent(),[2,e.map(function(s,c){return jd(s,t[c])})]}})})},eh.prototype.withAgeAndGender=function(){return new If(this,this.input)},eh);function eh(){return null!==bf&&bf.apply(this,arguments)||this}var wf,Cf=(on(th,wf=Sx),th.prototype.run=function(){return Mt(this,void 0,void 0,function(){var e,t;return Nt(this,function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:return(e=n.sent())?[4,df(e,this.input,function(a){return Kn.faceExpressionNet.predictExpressions(a)},this.extractedFaces)]:[2];case 2:return t=n.sent(),[2,jd(e,t)]}})})},th.prototype.withAgeAndGender=function(){return new Rf(this,this.input)},th);function th(){return null!==wf&&wf.apply(this,arguments)||this}var kf,Af=(on(nh,kf=yf),nh.prototype.withAgeAndGender=function(){return new Pf(this,this.input)},nh.prototype.withFaceDescriptors=function(){return new lh(this,this.input)},nh);function nh(){return null!==kf&&kf.apply(this,arguments)||this}var Sf,Ef=(on(rh,Sf=Cf),rh.prototype.withAgeAndGender=function(){return new Nf(this,this.input)},rh.prototype.withFaceDescriptor=function(){return new ch(this,this.input)},rh);function rh(){return null!==Sf&&Sf.apply(this,arguments)||this}var _x,Ix=(on(Tx,_x=Bl),Tx);function Tx(e,t,n){var a=_x.call(this)||this;return a.parentTask=e,a.input=t,a.extractedFaces=n,a}var _f,If=(on(ih,_f=Ix),ih.prototype.run=function(){return Mt(this,void 0,void 0,function(){var e,t,n=this;return Nt(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return[4,Ku(e=a.sent(),this.input,function(s){return Mt(n,void 0,void 0,function(){return Nt(this,function(c){switch(c.label){case 0:return[4,Promise.all(s.map(function(d){return Kn.ageGenderNet.predictAgeAndGender(d)}))];case 1:return[2,c.sent()]}})})},this.extractedFaces)];case 2:return t=a.sent(),[2,e.map(function(s,c){var d=t[c],f=d.age;return tf(nf(s,d.gender,d.genderProbability),f)})]}})})},ih.prototype.withFaceExpressions=function(){return new yf(this,this.input)},ih);function ih(){return null!==_f&&_f.apply(this,arguments)||this}var Tf,Rf=(on(ah,Tf=Ix),ah.prototype.run=function(){return Mt(this,void 0,void 0,function(){var e,t,n;return Nt(this,function(c){switch(c.label){case 0:return[4,this.parentTask];case 1:return(e=c.sent())?[4,df(e,this.input,function(d){return Kn.ageGenderNet.predictAgeAndGender(d)},this.extractedFaces)]:[2];case 2:return t=c.sent(),n=t.age,[2,tf(nf(e,t.gender,t.genderProbability),n)]}})})},ah.prototype.withFaceExpressions=function(){return new Cf(this,this.input)},ah);function ah(){return null!==Tf&&Tf.apply(this,arguments)||this}var Df,Pf=(on(oh,Df=If),oh.prototype.withFaceExpressions=function(){return new Af(this,this.input)},oh.prototype.withFaceDescriptors=function(){return new lh(this,this.input)},oh);function oh(){return null!==Df&&Df.apply(this,arguments)||this}var Mf,Nf=(on(sh,Mf=Rf),sh.prototype.withFaceExpressions=function(){return new Ef(this,this.input)},sh.prototype.withFaceDescriptor=function(){return new ch(this,this.input)},sh);function sh(){return null!==Mf&&Mf.apply(this,arguments)||this}var Rx,Lf=(on(Dx,Rx=Bl),Dx);function Dx(e,t){var n=Rx.call(this)||this;return n.parentTask=e,n.input=t,n}var Ff,lh=(on(Mc,Ff=Lf),Mc.prototype.run=function(){return Mt(this,void 0,void 0,function(){var e;return Nt(this,function(t){switch(t.label){case 0:return[4,this.parentTask];case 1:return[4,Ku(e=t.sent(),this.input,function(n){return Promise.all(n.map(function(a){return Kn.faceRecognitionNet.computeFaceDescriptor(a)}))},null,function(n){return n.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return[2,t.sent().map(function(n,a){return ef(e[a],n)})]}})})},Mc.prototype.withFaceExpressions=function(){return new Af(this,this.input)},Mc.prototype.withAgeAndGender=function(){return new Pf(this,this.input)},Mc);function Mc(){return null!==Ff&&Ff.apply(this,arguments)||this}var Of,ch=(on(Nc,Of=Lf),Nc.prototype.run=function(){return Mt(this,void 0,void 0,function(){var e,t;return Nt(this,function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:return(e=n.sent())?[4,df(e,this.input,function(a){return Kn.faceRecognitionNet.computeFaceDescriptor(a)},null,function(a){return a.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return t=n.sent(),[2,ef(e,t)]}})})},Nc.prototype.withFaceExpressions=function(){return new Ef(this,this.input)},Nc.prototype.withAgeAndGender=function(){return new Nf(this,this.input)},Nc);function Nc(){return null!==Of&&Of.apply(this,arguments)||this}var Px,Bf=(on(zf,Px=Bl),Object.defineProperty(zf.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?Kn.faceLandmark68TinyNet:Kn.faceLandmark68Net},enumerable:!0,configurable:!0}),zf);function zf(e,t,n){var a=Px.call(this)||this;return a.parentTask=e,a.input=t,a.useTinyLandmarkNet=n,a}var Wf,Mx=(on(Hl,Wf=Bf),Hl.prototype.run=function(){return Mt(this,void 0,void 0,function(){var e,t,n,a,s,c=this;return Nt(this,function(d){switch(d.label){case 0:return[4,this.parentTask];case 1:return e=d.sent(),t=e.map(function(f){return f.detection}),this.input instanceof rn?[4,Bu(this.input,t)]:[3,3];case 2:return a=d.sent(),[3,5];case 3:return[4,Ou(this.input,t)];case 4:a=d.sent(),d.label=5;case 5:return n=a,[4,Promise.all(n.map(function(f){return c.landmarkNet.detectLandmarks(f)}))];case 6:return s=d.sent(),n.forEach(function(f){return f instanceof rn&&f.dispose()}),[2,e.map(function(f,g){return Dc(f,s[g])})]}})})},Hl.prototype.withFaceExpressions=function(){return new Af(this,this.input)},Hl.prototype.withAgeAndGender=function(){return new Pf(this,this.input)},Hl.prototype.withFaceDescriptors=function(){return new lh(this,this.input)},Hl);function Hl(){return null!==Wf&&Wf.apply(this,arguments)||this}var Hf,Nx=(on(Xl,Hf=Bf),Xl.prototype.run=function(){return Mt(this,void 0,void 0,function(){var e,t,n,a,s;return Nt(this,function(c){switch(c.label){case 0:return[4,this.parentTask];case 1:return(e=c.sent())?(t=e.detection,this.input instanceof rn?[4,Bu(this.input,[t])]:[3,3]):[2];case 2:return a=c.sent(),[3,5];case 3:return[4,Ou(this.input,[t])];case 4:a=c.sent(),c.label=5;case 5:return[4,this.landmarkNet.detectLandmarks((n=a)[0])];case 6:return s=c.sent(),n.forEach(function(d){return d instanceof rn&&d.dispose()}),[2,Dc(e,s)]}})})},Xl.prototype.withFaceExpressions=function(){return new Ef(this,this.input)},Xl.prototype.withAgeAndGender=function(){return new Nf(this,this.input)},Xl.prototype.withFaceDescriptor=function(){return new ch(this,this.input)},Xl);function Xl(){return null!==Hf&&Hf.apply(this,arguments)||this}var Lx,Xf=(on(Fx,Lx=Bl),Fx);function Fx(e,t){void 0===t&&(t=new Js);var n=Lx.call(this)||this;return n.input=e,n.options=t,n}var Gf,Vf=(on(el,Gf=Xf),el.prototype.run=function(){return Mt(this,void 0,void 0,function(){var e,t,n,a;return Nt(this,function(s){switch(s.label){case 0:return t=(e=this).input,(n=e.options)instanceof Uu?[4,Kn.mtcnn.forward(t,n)]:[3,2];case 1:return[2,s.sent().map(function(c){return c.detection})];case 2:if(!(a=n instanceof gx?function(c){return Kn.tinyFaceDetector.locateFaces(c,n)}:n instanceof Js?function(c){return Kn.ssdMobilenetv1.locateFaces(c,n)}:n instanceof Pc?function(c){return Kn.tinyYolov2.locateFaces(c,n)}:null))throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,a(t)]}})})},el.prototype.runAndExtendWithFaceDetections=function(){var e=this;return new Promise(function(t){return Mt(e,void 0,void 0,function(){var n;return Nt(this,function(a){switch(a.label){case 0:return[4,this.run()];case 1:return n=a.sent(),[2,t(n.map(function(s){return Nl({},s)}))]}})})})},el.prototype.withFaceLandmarks=function(e){return void 0===e&&(e=!1),new Mx(this.runAndExtendWithFaceDetections(),this.input,e)},el.prototype.withFaceExpressions=function(){return new yf(this.runAndExtendWithFaceDetections(),this.input)},el.prototype.withAgeAndGender=function(){return new If(this.runAndExtendWithFaceDetections(),this.input)},el);function el(){return null!==Gf&&Gf.apply(this,arguments)||this}var Yf,Ox=(on(tl,Yf=Xf),tl.prototype.run=function(){return Mt(this,void 0,void 0,function(){var e,t;return Nt(this,function(n){switch(n.label){case 0:return[4,new Vf(this.input,this.options)];case 1:return e=n.sent(),t=e[0],e.forEach(function(a){a.score>t.score&&(t=a)}),[2,t]}})})},tl.prototype.runAndExtendWithFaceDetection=function(){var e=this;return new Promise(function(t){return Mt(e,void 0,void 0,function(){var n;return Nt(this,function(a){switch(a.label){case 0:return[4,this.run()];case 1:return n=a.sent(),[2,t(n?Nl({},n):void 0)]}})})})},tl.prototype.withFaceLandmarks=function(e){return void 0===e&&(e=!1),new Nx(this.runAndExtendWithFaceDetection(),this.input,e)},tl.prototype.withFaceExpressions=function(){return new Cf(this.runAndExtendWithFaceDetection(),this.input)},tl.prototype.withAgeAndGender=function(){return new Rf(this.runAndExtendWithFaceDetection(),this.input)},tl);function tl(){return null!==Yf&&Yf.apply(this,arguments)||this}function uh(e,t){return void 0===t&&(t=new Js),new Vf(e,t)}function Bx(e,t){return Mt(this,void 0,void 0,function(){return Nt(this,function(n){switch(n.label){case 0:return console.warn("allFacesSsdMobilenetv1 is deprecated and will be removed soon, use the high level api instead"),[4,uh(e,new Js(t?{minConfidence:t}:{})).withFaceLandmarks().withFaceDescriptors()];case 1:return[2,n.sent()]}})})}var zy=Bx;function zx(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(e),a=Array.from(t);return Math.sqrt(n.map(function(s,c){return s-a[c]}).reduce(function(s,c){return s+Math.pow(c,2)},0))}var Wy=(Object.defineProperty(Jo.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(Jo.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),Jo.prototype.computeMeanDistance=function(e,t){return t.map(function(n){return zx(n,e)}).reduce(function(n,a){return n+a},0)/(t.length||1)},Jo.prototype.matchDescriptor=function(e){var t=this;return this.labeledDescriptors.map(function(n){return new Pd(n.label,t.computeMeanDistance(e,n.descriptors))}).reduce(function(n,a){return n.distance<a.distance?n:a})},Jo.prototype.findBestMatch=function(e){var t=this.matchDescriptor(e);return t.distance<this.distanceThreshold?t:new Pd("unknown",t.distance)},Jo.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(e){return e.toJSON()})}},Jo.fromJSON=function(e){return new Jo(e.labeledDescriptors.map(function(t){return _c.fromJSON(t)}),e.distanceThreshold)},Jo);function Jo(e,t){void 0===t&&(t=.6),this._distanceThreshold=t;var n=Array.isArray(e)?e:[e];if(!n.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");function a(){return"person "+s++}var s=1;this._labeledDescriptors=n.map(function(c){if(c instanceof _c)return c;if(c instanceof Float32Array)return new _c(a(),[c]);if(c.descriptor&&c.descriptor instanceof Float32Array)return new _c(a(),[c.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}Ce.AgeGenderNet=Qm,Ce.BoundingBox=Ec,Ce.Box=Ja,Ce.ComposableTask=Bl,Ce.ComputeAllFaceDescriptorsTask=lh,Ce.ComputeFaceDescriptorsTaskBase=Lf,Ce.ComputeSingleFaceDescriptorTask=ch,Ce.DetectAllFaceLandmarksTask=Mx,Ce.DetectAllFacesTask=Vf,Ce.DetectFaceLandmarksTaskBase=Bf,Ce.DetectFacesTaskBase=Xf,Ce.DetectSingleFaceLandmarksTask=Nx,Ce.DetectSingleFaceTask=Ox,Ce.Dimensions=Cs,Ce.FACE_EXPRESSION_LABELS=Yd,Ce.FaceDetection=aa,Ce.FaceDetectionNet=ky,Ce.FaceExpressionNet=Ym,Ce.FaceExpressions=Xu,Ce.FaceLandmark68Net=Kd,Ce.FaceLandmark68TinyNet=ix,Ce.FaceLandmarkNet=py,Ce.FaceLandmarks=Us,Ce.FaceLandmarks5=mm,Ce.FaceLandmarks68=Dd,Ce.FaceMatch=Pd,Ce.FaceMatcher=Wy,Ce.FaceRecognitionNet=Qd,Ce.LabeledBox=Md,Ce.LabeledFaceDescriptors=_c,Ce.Mtcnn=vf,Ce.MtcnnOptions=Uu,Ce.NetInput=Rc,Ce.NeuralNetwork=vo,Ce.ObjectDetection=Ed,Ce.Point=Fn,Ce.PredictedBox=ly,Ce.Rect=Ru,Ce.SsdMobilenetv1=qu,Ce.SsdMobilenetv1Options=Js,Ce.TinyFaceDetector=xf,Ce.TinyFaceDetectorOptions=gx,Ce.TinyYolov2=cf,Ce.TinyYolov2Options=Pc,Ce.allFaces=zy,Ce.allFacesMtcnn=function(e,t){return void 0===t&&(t={}),Mt(this,void 0,void 0,function(){return Nt(this,function(n){switch(n.label){case 0:return console.warn("allFacesMtcnn is deprecated and will be removed soon, use the high level api instead"),[4,uh(e,new Uu(t)).withFaceLandmarks().withFaceDescriptors()];case 1:return[2,n.sent()]}})})},Ce.allFacesSsdMobilenetv1=Bx,Ce.allFacesTinyYolov2=function(e,t){return void 0===t&&(t={}),Mt(this,void 0,void 0,function(){return Nt(this,function(n){switch(n.label){case 0:return console.warn("allFacesTinyYolov2 is deprecated and will be removed soon, use the high level api instead"),[4,uh(e,new Pc(t)).withFaceLandmarks().withFaceDescriptors()];case 1:return[2,n.sent()]}})})},Ce.awaitMediaLoaded=Im,Ce.bufferToImage=Tm,Ce.computeFaceDescriptor=function(e){return Kn.faceRecognitionNet.computeFaceDescriptor(e)},Ce.createCanvas=Tc,Ce.createCanvasFromMedia=Fu,Ce.createFaceDetectionNet=function(e){return ux(e)},Ce.createFaceRecognitionNet=function(e){var t=new Qd;return t.extractWeights(e),t},Ce.createMtcnn=function(e){var t=new vf;return t.extractWeights(e),t},Ce.createSsdMobilenetv1=ux,Ce.createTinyFaceDetector=function(e){var t=new xf;return t.extractWeights(e),t},Ce.createTinyYolov2=function(e,t){void 0===t&&(t=!0);var n=new cf(t);return n.extractWeights(e),n},Ce.detectAllFaces=uh,Ce.detectFaceLandmarks=Cx,Ce.detectFaceLandmarksTiny=function(e){return Kn.faceLandmark68TinyNet.detectLandmarks(e)},Ce.detectLandmarks=By,Ce.detectSingleFace=function(e,t){return void 0===t&&(t=new Js),new Ox(e,t)},Ce.draw=cy,Ce.env=ui,Ce.euclideanDistance=zx,Ce.extendWithAge=tf,Ce.extendWithFaceDescriptor=ef,Ce.extendWithFaceDetection=Nl,Ce.extendWithFaceExpressions=jd,Ce.extendWithFaceLandmarks=Dc,Ce.extendWithGender=nf,Ce.extractFaceTensors=Bu,Ce.extractFaces=Ou,Ce.fetchImage=function(e){return Mt(this,void 0,void 0,function(){var t,n;return Nt(this,function(a){switch(a.label){case 0:return[4,zu(e)];case 1:return[4,(t=a.sent()).blob()];case 2:if(!(n=a.sent()).type.startsWith("image/"))throw new Error("fetchImage - expected blob type to be of type image/*, instead have: "+n.type+", for url: "+t.url);return[2,Tm(n)]}})})},Ce.fetchJson=Pm,Ce.fetchNetWeights=function(e){return Mt(this,void 0,void 0,function(){var t;return Nt(this,function(n){switch(n.label){case 0:return t=Float32Array.bind,[4,zu(e)];case 1:return[4,n.sent().arrayBuffer()];case 2:return[2,new(t.apply(Float32Array,[void 0,n.sent()]))]}})})},Ce.fetchOrThrow=zu,Ce.getContext2dOrThrow=eo,Ce.getMediaDimensions=Lu,Ce.imageTensorToCanvas=Rm,Ce.imageToSquare=Dm,Ce.inverseSigmoid=function(e){return Math.log(e/(1-e))},Ce.iou=dm,Ce.isMediaElement=zd,Ce.isMediaLoaded=Bd,Ce.isWithAge=function(e){return"number"==typeof e.age},Ce.isWithFaceDetection=Ml,Ce.isWithFaceExpressions=jm,Ce.isWithFaceLandmarks=Gu,Ce.isWithGender=function(e){return(e.gender===Ce.Gender.MALE||e.gender===Ce.Gender.FEMALE)&&_u(e.genderProbability)},Ce.loadAgeGenderModel=function(e){return Kn.ageGenderNet.load(e)},Ce.loadFaceDetectionModel=Fy,Ce.loadFaceExpressionModel=function(e){return Kn.faceExpressionNet.load(e)},Ce.loadFaceLandmarkModel=function(e){return Kn.faceLandmark68Net.load(e)},Ce.loadFaceLandmarkTinyModel=function(e){return Kn.faceLandmark68TinyNet.load(e)},Ce.loadFaceRecognitionModel=function(e){return Kn.faceRecognitionNet.load(e)},Ce.loadMtcnnModel=function(e){return Kn.mtcnn.load(e)},Ce.loadSsdMobilenetv1Model=kx,Ce.loadTinyFaceDetectorModel=function(e){return Kn.tinyFaceDetector.load(e)},Ce.loadTinyYolov2Model=function(e){return Kn.tinyYolov2.load(e)},Ce.loadWeightMap=Nm,Ce.locateFaces=Oy,Ce.matchDimensions=function(e,t,n){void 0===n&&(n=!1);var a=n?Lu(t):t,c=a.height;return{width:e.width=a.width,height:e.height=c}},Ce.minBbox=fm,Ce.mtcnn=function(e,t){return Kn.mtcnn.forward(e,t)},Ce.nets=Kn,Ce.nonMaxSuppression=Rl,Ce.normalize=Dl,Ce.padToSquare=pm,Ce.predictAgeAndGender=function(e){return Kn.ageGenderNet.predictAgeAndGender(e)},Ce.recognizeFaceExpressions=function(e){return Kn.faceExpressionNet.predictExpressions(e)},Ce.resizeResults=function e(t,n){var a=new Cs(n.width,n.height),s=a.width,c=a.height;if(s<=0||c<=0)throw new Error("resizeResults - invalid dimensions: "+JSON.stringify({width:s,height:c}));if(Array.isArray(t))return t.map(function(g){return e(g,{width:s,height:c})});if(Gu(t)){var d=t.detection.forSize(s,c),f=t.unshiftedLandmarks.forSize(d.box.width,d.box.height);return Dc(Nl(t,d),f)}return Ml(t)?Nl(t,t.detection.forSize(s,c)):t instanceof Us||t instanceof aa?t.forSize(s,c):t},Ce.resolveInput=Nu,Ce.shuffleArray=function(e){for(var t=e.slice(),n=t.length-1;0<n;n--){var a=Math.floor(Math.random()*(n+1)),s=t[n];t[n]=t[a],t[a]=s}return t},Ce.sigmoid=Tu,Ce.ssdMobilenetv1=wx,Ce.tf=oy,Ce.tinyFaceDetector=function(e,t){return Kn.tinyFaceDetector.locateFaces(e,t)},Ce.tinyYolov2=function(e,t){return Kn.tinyYolov2.locateFaces(e,t)},Ce.toNetInput=ti,Ce.utils=sy,Ce.validateConfig=dx,Object.defineProperty(Ce,"__esModule",{value:!0})});